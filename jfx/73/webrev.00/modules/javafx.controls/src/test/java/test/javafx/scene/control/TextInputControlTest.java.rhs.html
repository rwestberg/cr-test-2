<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.controls/src/test/java/test/javafx/scene/control/TextInputControlTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>   1 /*
   2  * Copyright (c) 2011, 2019, Oracle and/or its affiliates. All rights reserved.
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 package test.javafx.scene.control;
  27 
<a name="1" id="anc1"></a><span class="line-added">  28 import javafx.application.Platform;</span>
  29 import javafx.beans.InvalidationListener;
  30 import javafx.beans.Observable;
  31 import javafx.beans.property.BooleanProperty;
  32 import javafx.beans.property.SimpleBooleanProperty;
  33 import javafx.beans.property.SimpleStringProperty;
  34 import javafx.beans.property.StringProperty;
  35 import javafx.beans.value.ChangeListener;
  36 import javafx.beans.value.ObservableValue;
  37 import javafx.css.CssMetaData;
  38 import javafx.css.StyleableProperty;
<a name="2" id="anc2"></a><span class="line-added">  39 import javafx.event.Event;</span>
  40 import javafx.event.EventHandler;
  41 import javafx.scene.Scene;
  42 import javafx.scene.input.KeyCode;
  43 import javafx.scene.input.KeyEvent;
  44 import javafx.scene.input.Clipboard;
  45 import javafx.scene.input.ClipboardContent;
<a name="3" id="anc3"></a><span class="line-added">  46 import javafx.scene.layout.VBox;</span>
  47 import javafx.scene.text.Font;
  48 import javafx.scene.layout.StackPane;
  49 import javafx.stage.Stage;
  50 import java.util.Arrays;
  51 import java.util.Collection;
<a name="4" id="anc4"></a><span class="line-added">  52 import java.util.concurrent.Semaphore;</span>
<span class="line-added">  53 </span>
  54 import javafx.scene.control.IndexRange;
  55 import javafx.scene.control.PasswordField;
  56 import javafx.scene.control.TextArea;
  57 import javafx.scene.control.TextField;
  58 import javafx.scene.control.TextInputControl;
  59 import com.sun.javafx.tk.Toolkit;
  60 import org.junit.Before;
  61 import org.junit.Test;
  62 import org.junit.runner.RunWith;
  63 import org.junit.runners.Parameterized;
  64 import test.com.sun.javafx.scene.control.infrastructure.KeyEventFirer;
  65 import test.com.sun.javafx.pgstub.StubToolkit;
  66 import static org.junit.Assert.assertEquals;
  67 import static org.junit.Assert.assertFalse;
  68 import static org.junit.Assert.assertNull;
  69 import static org.junit.Assert.assertTrue;
  70 import static org.junit.Assert.fail;
  71 /**
  72  */
  73 @RunWith(Parameterized.class)
  74 public class TextInputControlTest {
  75     @SuppressWarnings(&quot;rawtypes&quot;)
  76     @Parameterized.Parameters public static Collection implementations() {
  77         return Arrays.asList(new Object[][]{
  78                 {TextField.class},
  79                 {PasswordField.class},
  80                 {TextArea.class}
  81         });
  82     }
  83 
  84     private TextInputControl textInput;
  85     private Class type;
  86 
  87     public TextInputControlTest(Class type) {
  88         this.type = type;
  89     }
  90 
  91     @Before public void setup() throws Exception {
  92         textInput = (TextInputControl) type.newInstance();
  93     }
  94 
  95     /******************************************************
  96      * Test the default states                            *
  97      *****************************************************/
  98 
  99     @Test public void textDefaultsToEmptyString() {
 100         assertEquals(&quot;&quot;, textInput.getText());
 101     }
 102 
 103     @Test public void editableDefaultsToTrue() {
 104         assertTrue(textInput.isEditable());
 105     }
 106 
 107     @Test public void anchorDefaultsToZero() {
 108         assertEquals(0, textInput.getAnchor());
 109     }
 110 
 111     @Test public void caretPositionDefaultsToZero() {
 112         assertEquals(0, textInput.getCaretPosition());
 113     }
 114 
 115     @Test public void lengthDefaultsToZero() {
 116         assertEquals(0, textInput.getLength());
 117     }
 118 
 119     @Test public void selectedTextDefaultsToEmptyString() {
 120         assertEquals(&quot;&quot;, textInput.getSelectedText());
 121     }
 122 
 123     @Test public void selectionDefaultsToEmpty() {
 124         assertEquals(0, textInput.getSelection().getLength());
 125     }
 126 
 127     @Test public void selectionStartDefaultsToZero() {
 128         assertEquals(0, textInput.getSelection().getStart());
 129     }
 130 
 131     @Test public void selectionEndDefaultsToZero() {
 132         assertEquals(0, textInput.getSelection().getEnd());
 133     }
 134 
 135     /*********************************************************************
 136      * Tests for CSS                                                     *
 137      ********************************************************************/
 138 
 139     @Test public void fontSetFromCSS() {
 140         textInput.setStyle(&quot;-fx-font: 24 Helvetica&quot;);
 141         Scene s = new Scene(textInput);
 142         textInput.applyCss();
 143         assertEquals(Font.font(&quot;Helvetica&quot;, 24), textInput.getFont());
 144     }
 145 
 146     /******************************************************
 147      * Test for text                                      *
 148      *****************************************************/
 149 
 150     @Test public void settingTextUpdatesTheText() {
 151         textInput.setText(&quot;This is a test&quot;);
 152         assertEquals(&quot;This is a test&quot;, textInput.getText());
 153         assertEquals(&quot;This is a test&quot;, textInput.textProperty().get());
 154     }
 155 
 156     @Test public void textCanBeNull() {
 157         textInput.setText(null);
 158         assertNull(textInput.getText());
 159     }
 160 
 161     @Test public void textCanBeSwitchedBetweenNullAndAValue() {
 162         textInput.setText(null);
 163         textInput.setText(&quot;Test&quot;);
 164         assertEquals(&quot;Test&quot;, textInput.getText());
 165     }
 166 
 167     @Test public void textCanBeSwitchedFromAValueToNull() {
 168         textInput.setText(&quot;Test&quot;);
 169         textInput.setText(null);
 170         assertNull(textInput.getText());
 171     }
 172 
 173     @Test public void textIsNullThenBoundThenUnboundAndShouldReturnTheValueWhenBound() {
 174         textInput.setText(null);
 175         StringProperty other = new SimpleStringProperty(&quot;Peppers&quot;);
 176         textInput.textProperty().bind(other);
 177         textInput.textProperty().unbind();
 178         assertEquals(&quot;Peppers&quot;, textInput.getText());
 179     }
 180 
 181     @Test public void textHasValueThenIsBoundToNullShouldReturnNullFromGet() {
 182         textInput.setText(&quot;Value&quot;);
 183         StringProperty other = new SimpleStringProperty(null);
 184         textInput.textProperty().bind(other);
 185         assertNull(textInput.getText());
 186     }
 187 
 188     @Test public void textHasValueThenIsBoundToNullAndUnboundShouldReturnNullFromGet() {
 189         textInput.setText(&quot;Value&quot;);
 190         StringProperty other = new SimpleStringProperty(null);
 191         textInput.textProperty().bind(other);
 192         textInput.textProperty().unbind();
 193         assertNull(textInput.getText());
 194     }
 195 
 196     @Test public void textHasValueThenIsBoundToNullAndUnboundThenSetShouldReturnNewValueFromGet() {
 197         textInput.setText(&quot;Value&quot;);
 198         StringProperty other = new SimpleStringProperty(null);
 199         textInput.textProperty().bind(other);
 200         textInput.textProperty().unbind();
 201         textInput.setText(&quot;New Value&quot;);
 202         assertEquals(&quot;New Value&quot;, textInput.getText());
 203     }
 204 
 205     @Test public void textCanBeBound() {
 206         StringProperty other = new SimpleStringProperty(&quot;Apples&quot;);
 207         textInput.textProperty().bind(other);
 208         assertEquals(&quot;Apples&quot;, textInput.getText());
 209         other.set(&quot;Oranges&quot;);
 210         assertEquals(&quot;Oranges&quot;, textInput.getText());
 211     }
 212 
 213     @Test public void cannotSpecifyTextViaCSS() {
 214         try {
 215             CssMetaData styleable = ((StyleableProperty)textInput.textProperty()).getCssMetaData();
 216             assertNull(styleable);
 217         } catch (ClassCastException ignored) {
 218             // pass!
 219         } catch (Exception e) {
 220             org.junit.Assert.fail(e.toString());
 221         }
 222     }
 223 
 224     @Test public void settingTextNotifiesOfChange() {
 225         final boolean[] passed = new boolean[] { false };
 226         textInput.textProperty().addListener((observable, oldValue, newValue) -&gt; {
 227             passed[0] = true;
 228         });
 229         textInput.setText(&quot;Apples&quot;);
 230         assertTrue(passed[0]);
 231     }
 232 
 233     // Test for JDK-8212102
 234     @Test public void testControlCharacters() {
 235         try {
 236             String cc = &quot;\r\n\n&quot;;
 237             String str = &quot;123456&quot;;
 238 
 239             textInput.setText(cc);
 240 
 241             textInput.setText(str);
 242             textInput.replaceText(0, 6, cc);
 243 
 244             textInput.setText(str);
 245             textInput.replaceText(new IndexRange(0, 6), cc);
 246 
 247             textInput.setText(str);
 248             textInput.selectAll();
 249             textInput.replaceSelection(cc);
 250 
 251             textInput.setText(str);
 252             textInput.selectRange(0, 6);
 253             textInput.replaceSelection(cc);
 254 
 255         } catch (Exception e) {
 256             fail(&quot;Control characters(\\r\\n) caused Exception: &quot; + e);
 257         }
 258     }
 259 
 260     @Test public void controlCharactersAreOmitted_setText_getText() {
 261         String s = &quot;This is &quot; + &#39;\0&#39; + &quot;a test&quot;;
 262         textInput.setText(s);
 263         assertEquals(&quot;This is a test&quot;, textInput.getText());
 264     }
 265 
 266     @Test public void controlCharactersAreOmitted_setText_textProperty_get() {
 267         String s = &quot;This is &quot; + &#39;\0&#39; + &quot;a test&quot;;
 268         textInput.setText(s);
 269         assertEquals(&quot;This is a test&quot;, textInput.textProperty().get());
 270     }
 271 
 272     @Test public void controlCharactersAreOmitted_bound_getText() {
 273         StringProperty other = new SimpleStringProperty(&quot;This is &quot; + &#39;\0&#39; + &quot;a test&quot;);
 274         textInput.textProperty().bind(other);
 275         assertEquals(&quot;This is a test&quot;, textInput.getText());
 276         other.set(&quot;Bro&quot; + &#39;\5&#39; + &quot;ken&quot;);
 277         assertEquals(&quot;Broken&quot;, textInput.getText());
 278     }
 279 
 280     @Test public void controlCharactersAreOmitted_bound_textProperty_get() {
 281         StringProperty other = new SimpleStringProperty(&quot;This is &quot; + &#39;\0&#39; + &quot;a test&quot;);
 282         textInput.textProperty().bind(other);
 283         assertEquals(&quot;This is a test&quot;, textInput.textProperty().get());
 284         other.set(&quot;Bro&quot; + &#39;\5&#39; + &quot;ken&quot;);
 285         assertEquals(&quot;Broken&quot;, textInput.textProperty().get());
 286     }
 287 
 288     // selection is changed when text is changed??
 289     // anchor and caret position updated when selection is changed due to text change??
 290     // selected text is updated when selection changes due to a text change??
 291     // length is updated when text changes
 292 
 293     /******************************************************
 294      * Test for editable                                  *
 295      *****************************************************/
 296 
 297     @Test public void settingEditableValueShouldWork() {
 298         textInput.setEditable(false);
 299         assertFalse(textInput.isEditable());
 300     }
 301 
 302     @Test public void settingEditableAndThenCreatingAModelAndReadingTheValueStillWorks() {
 303         textInput.setEditable(false);
 304         assertFalse(textInput.editableProperty().get());
 305     }
 306 
 307     @Test public void editableCanBeBound() {
 308         BooleanProperty other = new SimpleBooleanProperty(false);
 309         textInput.editableProperty().bind(other);
 310         assertFalse(textInput.isEditable());
 311         other.set(true);
 312         assertTrue(textInput.isEditable());
 313     }
 314 
 315     @Test public void cannotSpecifyEditableViaCSS() {
 316         try {
 317             CssMetaData styleable = ((StyleableProperty)textInput.editableProperty()).getCssMetaData();
 318             assertNull(styleable);
 319         } catch (ClassCastException ignored) {
 320             // pass!
 321         } catch (Exception e) {
 322             org.junit.Assert.fail(e.toString());
 323         }
 324     }
 325 
 326     @Test public void settingEditableNotifiesOfChange() {
 327         final boolean[] passed = new boolean[] { false };
 328         textInput.editableProperty().addListener((observable, oldValue, newValue) -&gt; {
 329             passed[0] = true;
 330         });
 331         textInput.setEditable(false);
 332         assertTrue(passed[0]);
 333     }
 334 
 335     /******************************************************
 336      * Test for anchor                                    *
 337      *****************************************************/
 338 
 339     @Test public void anchorIsSetWhenSelectionChanges() {
 340         textInput.setText(&quot;The quick brown fox&quot;);
 341         textInput.selectRange(4, 9);
 342         assertEquals(4, textInput.getAnchor());
 343     }
 344 
 345     @Test public void anchorIsSetWhenSelectionChanges2() {
 346         textInput.setText(&quot;The quick brown fox&quot;);
 347         textInput.selectRange(9, 4);
 348         assertEquals(9, textInput.getAnchor());
 349     }
 350 
 351     // updated when text changes
 352     @Test public void anchorIsSetToCaretPositionWhenTextChanges() {
 353         textInput.setText(&quot;The quick brown fox&quot;);
 354         textInput.selectRange(4, 9);
 355         textInput.setText(&quot;Gone&quot;);
 356         assertEquals(textInput.getCaretPosition(), textInput.getAnchor());
 357     }
 358 
 359     /******************************************************
 360      * Test for caretPosition                             *
 361      *****************************************************/
 362 
 363     @Test public void caretPositionIsSetWhenSelectionChanges() {
 364         textInput.setText(&quot;The quick brown fox&quot;);
 365         textInput.selectRange(4, 9);
 366         assertEquals(9, textInput.getCaretPosition());
 367     }
 368 
 369     @Test public void caretPositionIsSetWhenSelectionChanges2() {
 370         textInput.setText(&quot;The quick brown fox&quot;);
 371         textInput.selectRange(9, 4);
 372         assertEquals(4, textInput.getCaretPosition());
 373     }
 374 
 375     @Test
 376     public void caretAndAnchorPositionAfterSettingText() {
 377         textInput.setText(&quot;The quick brown fox&quot;);
 378         assertEquals(0, textInput.getCaretPosition());
 379         assertEquals(0, textInput.getAnchor());
 380     }
 381 
 382     // Test for JDK-8178417
 383     @Test public void caretPositionUndo() {
 384         Toolkit tk = (StubToolkit)Toolkit.getToolkit();
 385         StackPane root = new StackPane();
 386         Scene scene = new Scene(root);
 387         Stage stage = new Stage();
 388         String text = &quot;01234&quot;;
 389 
 390         textInput.setText(text);
 391         stage.setScene(scene);
 392         root.getChildren().removeAll();
 393         root.getChildren().add(textInput);
 394         stage.show();
 395         tk.firePulse();
 396 
 397         KeyEventFirer keyboard = new KeyEventFirer(textInput);
 398         keyboard.doKeyPress(KeyCode.HOME);
 399 
 400         for(int i = 1; i &lt; text.length() + 1; ++i) {
 401             keyboard.doKeyPress(KeyCode.RIGHT);
 402             tk.firePulse();
 403         }
 404         for(int i = 1; i &lt; text.length() + 1; ++i) {
 405             textInput.undo();
 406         }
 407         assertEquals(text.length(), textInput.getCaretPosition());
 408         root.getChildren().removeAll();
 409         stage.hide();
 410         tk.firePulse();
 411     }
 412 
 413     /******************************************************
 414      * Test for length                                    *
 415      *****************************************************/
 416 
 417     // TODO null text results in 0 length
 418 
 419     @Test public void emptyTextResultsInZeroLength() {
 420         textInput.setText(&quot;Hello&quot;);
 421         textInput.setText(&quot;&quot;);
 422         assertEquals(0, textInput.getLength());
 423     }
 424 
 425     @Test public void lengthMatchesStringLength() {
 426         final String string = &quot;Hello&quot;;
 427         textInput.setText(string);
 428         assertEquals(string.length(), textInput.getLength());
 429     }
 430 
 431     @Test public void lengthChangeNotificationWhenTextIsUpdatedToNonEmptyResult() {
 432         final boolean[] passed = new boolean[] { false };
 433         textInput.lengthProperty().addListener((observable, oldValue, newValue) -&gt; {
 434             passed[0] = true;
 435         });
 436         textInput.setText(&quot;Hello&quot;);
 437         assertTrue(passed[0]);
 438     }
 439 
 440     @Test public void lengthChangeNotificationWhenTextIsSetToEmptyResult() {
 441         textInput.setText(&quot;Goodbye&quot;);
 442         final boolean[] passed = new boolean[] { false };
 443         textInput.lengthProperty().addListener((observable, oldValue, newValue) -&gt; {
 444             passed[0] = true;
 445         });
 446         textInput.setText(&quot;&quot;);
 447         assertTrue(passed[0]);
 448     }
 449 
 450     /******************************************************
 451      * Test for maximumLength                             *
 452      *****************************************************/
 453 
 454     // set maximum length to less than current length
 455 
 456     /******************************************************
 457      * Test for selected text                             *
 458      *****************************************************/
 459 
 460     // TODO test null text and some random range
 461 
 462     @Test public void selectedTextMatchesTextAndSelection() {
 463         textInput.setText(&quot;The quick brown fox&quot;);
 464         textInput.selectRange(0, 3);
 465         assertEquals(&quot;The&quot;, textInput.getSelectedText());
 466     }
 467 
 468     @Test public void selectedTextMatchesTextAndSelection2() {
 469         textInput.setText(&quot;The quick brown fox&quot;);
 470         textInput.selectRange(4, 9);
 471         assertEquals(&quot;quick&quot;, textInput.getSelectedText());
 472     }
 473 
 474     @Test public void selectedTextMatchesTextAndSelection3() {
 475         textInput.setText(&quot;The quick brown fox&quot;);
 476         textInput.selectRange(10, 19);
 477         assertEquals(&quot;brown fox&quot;, textInput.getSelectedText());
 478     }
 479 
 480     @Test public void selectedTextIsClearedWhenTextChanges() {
 481         textInput.setText(&quot;The quick brown fox&quot;);
 482         textInput.selectRange(4, 9);
 483         textInput.setText(&quot;&quot;);
 484         assertEquals(&quot;&quot;, textInput.getSelectedText());
 485     }
 486 
 487     @Test public void selectedTextWorksWhenSelectionExceedsPossibleRange() {
 488         textInput.setText(&quot;The quick brown fox&quot;);
 489         textInput.selectRange(10, 180);
 490         assertEquals(&quot;brown fox&quot;, textInput.getSelectedText());
 491     }
 492 
 493     @Test public void selectedTextWorksWhenSelectionExceedsPossibleRange2() {
 494         textInput.setText(&quot;The quick brown fox&quot;);
 495         textInput.selectRange(100, 180);
 496         assertEquals(&quot;&quot;, textInput.getSelectedText());
 497     }
 498 
 499 //    @Test public void selectedTextWorksWhenSelectionIsBound() {
 500 //        ObjectProperty&lt;IndexRange&gt; other = new SimpleObjectProperty&lt;IndexRange&gt;(new IndexRange(4, 9));
 501 //        textInput.setText(&quot;The quick brown fox&quot;);
 502 //        textInput.selectionProperty().bind(other);
 503 //        assertEquals(&quot;quick&quot;, textInput.getSelectedText());
 504 //        other.set(new IndexRange(10, 19));
 505 //        assertEquals(&quot;brown fox&quot;, textInput.getSelectedText());
 506 //    }
 507 
 508     @Test public void selectedTextWorksWhenTextIsBound() {
 509         StringProperty other = new SimpleStringProperty(&quot;There and back again&quot;);
 510         textInput.textProperty().bind(other);
 511         textInput.selectRange(0, 5);
 512         assertEquals(&quot;There&quot;, textInput.getSelectedText());
 513         other.set(&quot;Cleared!&quot;);
 514         assertEquals(&quot;&quot;, textInput.getSelectedText());
 515     }
 516 
 517     @Test public void selectedTextChangeEvents() {
 518         final boolean[] passed = new boolean[] { false };
 519         textInput.setText(&quot;The quick brown fox&quot;);
 520         textInput.selectedTextProperty().addListener(observable -&gt; {
 521             passed[0] = true;
 522         });
 523         textInput.selectRange(0, 3);
 524         assertTrue(passed[0]);
 525     }
 526 
 527     @Test public void selectedTextChangeEvents2() {
 528         final boolean[] passed = new boolean[] { false };
 529         textInput.setText(&quot;The quick brown fox&quot;);
 530         textInput.selectRange(0, 3);
 531         textInput.selectedTextProperty().addListener(observable -&gt; {
 532             passed[0] = true;
 533         });
 534         textInput.selectRange(10, 180);
 535         assertTrue(passed[0]);
 536     }
 537 
 538     @Test public void selectedTextChangeEvents3() {
 539         final boolean[] passed = new boolean[] { false };
 540         StringProperty other = new SimpleStringProperty(&quot;There and back again&quot;);
 541         textInput.textProperty().bind(other);
 542         textInput.selectRange(0, 5);
 543         textInput.selectedTextProperty().addListener(observable -&gt; {
 544             passed[0] = true;
 545         });
 546         other.set(&quot;Cleared!&quot;);
 547         assertTrue(passed[0]);
 548     }
 549 
 550     /******************************************************
 551      * Test for selection                                 *
 552      *****************************************************/
 553 
 554     @Test public void selectionIsClearedWhenTextChanges() {
 555         textInput.setText(&quot;The quick brown fox&quot;);
 556         textInput.selectRange(4, 9);
 557         textInput.setText(&quot;&quot;);
 558         assertEquals(new IndexRange(0, 0), textInput.getSelection());
 559     }
 560 
 561     @Test public void selectionCannotBeSetToBeOutOfRange() {
 562         textInput.setText(&quot;The quick brown fox&quot;);
 563         textInput.selectRange(4, 99);
 564         assertEquals(new IndexRange(4, 19), textInput.getSelection());
 565     }
 566 
 567     @Test public void selectionCannotBeSetToBeOutOfRange2() {
 568         textInput.setText(&quot;The quick brown fox&quot;);
 569         textInput.selectRange(44, 99);
 570         assertEquals(new IndexRange(19, 19), textInput.getSelection());
 571     }
 572 
 573 //    @Test public void selectionCanBeBound() {
 574 //        ObjectProperty&lt;IndexRange&gt; other = new SimpleObjectProperty&lt;IndexRange&gt;(new IndexRange(4, 9));
 575 //        textInput.selectionProperty().bind(other);
 576 //        assertEquals(new IndexRange(4, 9), textInput.getSelection());
 577 //        other.set(new IndexRange(10, 19));
 578 //        assertEquals(new IndexRange(10, 19), textInput.getSelection());
 579 //    }
 580 
 581     @Test public void selectionChangeEventsHappen() {
 582         final boolean[] passed = new boolean[] { false };
 583         textInput.selectionProperty().addListener(observable -&gt; {
 584             passed[0] = true;
 585         });
 586         textInput.selectRange(0, 3);
 587         assertTrue(passed[0]);
 588     }
 589 
 590 //    @Test public void selectionChangeEventsHappenWhenBound() {
 591 //        final boolean[] passed = new boolean[] { false };
 592 //        ObjectProperty&lt;IndexRange&gt; other = new SimpleObjectProperty&lt;IndexRange&gt;(new IndexRange(0, 5));
 593 //        textInput.selectionProperty().addListener(new InvalidationListener() {
 594 //            @Override public void invalidated(Observable observable) {
 595 //                passed[0] = true;
 596 //            }
 597 //        });
 598 //        textInput.selectionProperty().bind(other);
 599 //        assertTrue(passed[0]);
 600 //    }
 601 
 602 //    @Test public void selectionChangeEventsHappenWhenBound2() {
 603 //        final boolean[] passed = new boolean[] { false };
 604 //        ObjectProperty&lt;IndexRange&gt; other = new SimpleObjectProperty&lt;IndexRange&gt;(new IndexRange(0, 5));
 605 //        textInput.selectionProperty().bind(other);
 606 //        textInput.selectionProperty().addListener(new InvalidationListener() {
 607 //            @Override public void invalidated(Observable observable) {
 608 //                passed[0] = true;
 609 //            }
 610 //        });
 611 //        assertFalse(passed[0]);
 612 //        other.set(new IndexRange(1, 2));
 613 //        assertTrue(passed[0]);
 614 //    }
 615 
 616     @Test public void selectionChangeEventsHappenWhenTextIsChanged() {
 617         final boolean[] passed = new boolean[] { false };
 618         StringProperty other = new SimpleStringProperty(&quot;There and back again&quot;);
 619         textInput.textProperty().bind(other);
 620         textInput.selectRange(0, 5);
 621         textInput.selectionProperty().addListener(observable -&gt; {
 622             passed[0] = true;
 623         });
 624         other.set(&quot;Cleared!&quot;);
 625         assertTrue(passed[0]);
 626     }
 627 
 628     /******************************************************
 629      * Test for cut/copy/paste                            *
 630      *****************************************************/
 631 
 632     @Test public void cutRemovesSelection() {
 633         // Skip for PasswordField
 634         if (textInput instanceof PasswordField) return;
 635         textInput.setText(&quot;The quick brown fox&quot;);
 636         textInput.selectRange(4, 9);
 637         textInput.cut();
 638         assertEquals(&quot;The  brown fox&quot;, textInput.getText());
 639     }
 640 
 641     @Test public void pasteReplacesSelection() {
 642         textInput.setText(&quot;The quick brown fox&quot;);
 643         textInput.selectRange(4, 9);
 644         copy(&quot;slow&quot;);
 645         textInput.paste();
 646         assertEquals(&quot;The slow brown fox&quot;, textInput.getText());
 647     }
 648 
 649     @Test public void pasteIllegalCharacters() {
 650         textInput.setText(&quot;The quick brown fox&quot;);
 651         textInput.selectRange(19, 19);
 652         copy(&quot;&quot; + &#39;\0&#39;);
 653         textInput.paste();
 654         assertEquals(&quot;The quick brown fox&quot;, textInput.getText());
 655     }
 656 
 657     @Test public void pasteIllegalCharactersCaretNotAtZero() {
 658         textInput.setText(&quot;The quick brown fox&quot;);
 659         textInput.selectRange(4, 4);
 660         copy(&quot;slow&quot; + &#39;\0&#39;);
 661         textInput.paste();
 662         assertEquals(8, textInput.getCaretPosition());
 663         assertEquals(8, textInput.getAnchor());
 664     }
 665 
 666     @Test public void pasteIllegalCharactersSelection() {
 667         textInput.setText(&quot;The quick brown fox&quot;);
 668         textInput.selectRange(4, 9);
 669         copy(&quot;slow&quot; + &#39;\0&#39;);
 670         textInput.paste();
 671         assertEquals(&quot;The slow brown fox&quot;, textInput.getText());
 672     }
 673 
 674     @Test public void pasteIllegalCharactersIntoSelectionPositionsCaretCorrectly() {
 675         textInput.setText(&quot;The quick brown fox&quot;);
 676         textInput.selectRange(4, 9);
 677         copy(&quot;slow&quot; + &#39;\0&#39;);
 678         textInput.paste();
 679         assertEquals(8, textInput.getCaretPosition());
 680         assertEquals(8, textInput.getAnchor());
 681     }
 682 
 683     /******************************************************
 684      * Test for manipulating selection via methods        *
 685      *****************************************************/
 686 
 687     // cut ends up removing the selection, and setting anchor / caretPosition to match index
 688     @Test public void cutRemovesSelectionAndResetsAnchorAndCaretPositionToIndex() {
 689         // Skip for PasswordField
 690         if (textInput instanceof PasswordField) return;
 691         textInput.setText(&quot;The quick brown fox&quot;);
 692         textInput.selectRange(4, 9);
 693         textInput.cut();
 694         assertEquals(4, textInput.getAnchor());
 695         assertEquals(4, textInput.getCaretPosition());
 696         assertEquals(new IndexRange(4, 4), textInput.getSelection());
 697         assertEquals(&quot;&quot;, textInput.getSelectedText());
 698     }
 699 
 700     @Test public void pasteWithEmptySelection() {
 701         textInput.setText(&quot;quick brown fox&quot;);
 702         textInput.selectRange(0,0);
 703         copy(&quot;The &quot;);
 704         textInput.paste();
 705         assertEquals(4, textInput.getAnchor());
 706         assertEquals(4, textInput.getCaretPosition());
 707         assertEquals(new IndexRange(4, 4), textInput.getSelection());
 708         assertEquals(&quot;&quot;, textInput.getSelectedText());
 709     }
 710 
 711     @Test public void pasteWithSelection() {
 712         textInput.setText(&quot;The quick brown fox&quot;);
 713         textInput.selectRange(4, 9);
 714         copy(&quot;slow&quot;);
 715         textInput.paste();
 716         assertEquals(8, textInput.getAnchor());
 717         assertEquals(8, textInput.getCaretPosition());
 718         assertEquals(new IndexRange(8, 8), textInput.getSelection());
 719         assertEquals(&quot;&quot;, textInput.getSelectedText());
 720     }
 721 
 722     @Test public void pasteAll() {
 723         textInput.setText(&quot;The quick brown fox&quot;);
 724         textInput.selectAll();
 725         copy(&quot;Gone&quot;);
 726         textInput.paste();
 727         assertEquals(4, textInput.getAnchor());
 728         assertEquals(4, textInput.getCaretPosition());
 729         assertEquals(new IndexRange(4, 4), textInput.getSelection());
 730         assertEquals(&quot;&quot;, textInput.getSelectedText());
 731     }
 732 
 733     @Test public void selectBackwardHasNoEffectWhenCaretPositionIsAlreadyZero() {
 734         textInput.setText(&quot;The quick brown fox&quot;);
 735         textInput.selectRange(3, 0);
 736         textInput.selectBackward();
 737         assertEquals(0, textInput.getCaretPosition());
 738         assertEquals(new IndexRange(0, 3), textInput.getSelection());
 739     }
 740 
 741     @Test public void selectBackwardMovesCaretPositionOnePlaceLeft_CaretPositionRightOfAnchor() {
 742         textInput.setText(&quot;The quick brown fox&quot;);
 743         textInput.selectRange(0, 3);
 744         textInput.selectBackward();
 745         assertEquals(2, textInput.getCaretPosition());
 746         assertEquals(new IndexRange(0, 2), textInput.getSelection());
 747     }
 748 
 749     @Test public void selectBackwardMovesCaretPositionOnePlaceLeft_CaretPositionEqualsAnchor() {
 750         textInput.setText(&quot;The quick brown fox&quot;);
 751         textInput.selectRange(3, 3);
 752         textInput.selectBackward();
 753         assertEquals(2, textInput.getCaretPosition());
 754         assertEquals(new IndexRange(2, 3), textInput.getSelection());
 755     }
 756 
 757     @Test public void selectBackwardMovesCaretPositionOnePlaceLeft_CaretPositionLeftOfAnchor() {
 758         textInput.setText(&quot;The quick brown fox&quot;);
 759         textInput.selectRange(6, 3);
 760         textInput.selectBackward();
 761         assertEquals(2, textInput.getCaretPosition());
 762         assertEquals(new IndexRange(2, 6), textInput.getSelection());
 763     }
 764 
 765     @Test public void selectForwardHasNoEffectWhenCaretPositionIsAtLength() {
 766         textInput.setText(&quot;The quick brown fox&quot;);
 767         textInput.selectRange(3, 19);
 768         textInput.selectForward();
 769         assertEquals(19, textInput.getCaretPosition());
 770         assertEquals(new IndexRange(3, 19), textInput.getSelection());
 771     }
 772 
 773     @Test public void selectForwardMovesCaretPositionOnePlaceRight_CaretPositionRightOfAnchor() {
 774         textInput.setText(&quot;The quick brown fox&quot;);
 775         textInput.selectRange(0, 3);
 776         textInput.selectForward();
 777         assertEquals(4, textInput.getCaretPosition());
 778         assertEquals(new IndexRange(0, 4), textInput.getSelection());
 779     }
 780 
 781     @Test public void selectForwardMovesCaretPositionOnePlaceRight_CaretPositionEqualsAnchor() {
 782         textInput.setText(&quot;The quick brown fox&quot;);
 783         textInput.selectRange(3, 3);
 784         textInput.selectForward();
 785         assertEquals(4, textInput.getCaretPosition());
 786         assertEquals(new IndexRange(3, 4), textInput.getSelection());
 787     }
 788 
 789     @Test public void selectForwardMovesCaretPositionOnePlaceRight_CaretPositionLeftOfAnchor() {
 790         textInput.setText(&quot;The quick brown fox&quot;);
 791         textInput.selectRange(6, 3);
 792         textInput.selectForward();
 793         assertEquals(4, textInput.getCaretPosition());
 794         assertEquals(new IndexRange(4, 6), textInput.getSelection());
 795     }
 796 
 797     @Test public void previousWordWithNoText() {
 798         textInput.previousWord();
 799         assertEquals(0, textInput.getCaretPosition());
 800         assertEquals(0, textInput.getAnchor());
 801         assertEquals(new IndexRange(0, 0), textInput.getSelection());
 802     }
 803 
 804     @Test public void previousWordWithSelection_caretPositionBeforeAnchor() {
 805         textInput.setText(&quot;The quick brown fox&quot;);
 806         textInput.selectRange(15, 10);
 807         textInput.previousWord();
 808         assertEquals(4, textInput.getCaretPosition());
 809         assertEquals(4, textInput.getAnchor());
 810         assertEquals(new IndexRange(4, 4), textInput.getSelection());
 811     }
 812 
 813     @Test public void previousWordWithSelection_caretPositionBeforeAnchor2() {
 814         textInput.setText(&quot;The quick brown fox&quot;);
 815         textInput.selectRange(12, 6);
 816         textInput.previousWord();
 817         assertEquals(4, textInput.getCaretPosition());
 818         assertEquals(4, textInput.getAnchor());
 819         assertEquals(new IndexRange(4, 4), textInput.getSelection());
 820     }
 821 
 822     @Test public void previousWordWithSelection_caretPositionAfterAnchor() {
 823         textInput.setText(&quot;The quick brown fox&quot;);
 824         textInput.selectRange(10, 15);
 825         textInput.previousWord();
 826         assertEquals(10, textInput.getCaretPosition());
 827         assertEquals(10, textInput.getAnchor());
 828         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 829     }
 830 
 831     @Test public void previousWordWithSelection_caretPositionAfterAnchor2() {
 832         textInput.setText(&quot;The quick brown fox&quot;);
 833         textInput.selectRange(6, 12);
 834         textInput.previousWord();
 835         assertEquals(10, textInput.getCaretPosition());
 836         assertEquals(10, textInput.getAnchor());
 837         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 838     }
 839 
 840     @Test public void previousWord_caretWithinAWord() {
 841         textInput.setText(&quot;The quick brown fox&quot;);
 842         textInput.positionCaret(12);
 843         textInput.previousWord();
 844         assertEquals(10, textInput.getCaretPosition());
 845         assertEquals(10, textInput.getAnchor());
 846         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 847     }
 848 
 849     @Test public void previousWord_caretAfterWord() {
 850         textInput.setText(&quot;The quick brown fox&quot;);
 851         textInput.positionCaret(15);
 852         textInput.previousWord();
 853         assertEquals(10, textInput.getCaretPosition());
 854         assertEquals(10, textInput.getAnchor());
 855         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 856     }
 857 
 858     @Test public void previousWord_caretBeforeWord() {
 859         textInput.setText(&quot;The quick brown fox&quot;);
 860         textInput.positionCaret(10);
 861         textInput.previousWord();
 862         assertEquals(4, textInput.getCaretPosition());
 863         assertEquals(4, textInput.getAnchor());
 864         assertEquals(new IndexRange(4, 4), textInput.getSelection());
 865     }
 866 
 867     @Test public void previousWord_caretWithinWhitespace() {
 868         textInput.setText(&quot;The quick  brown fox&quot;);
 869         textInput.positionCaret(10);
 870         textInput.previousWord();
 871         assertEquals(4, textInput.getCaretPosition());
 872         assertEquals(4, textInput.getAnchor());
 873         assertEquals(new IndexRange(4, 4), textInput.getSelection());
 874     }
 875 
 876     @Test public void previousWord_multipleWhitespaceInARow() {
 877         textInput.setText(&quot;The quick  brown fox&quot;);
 878         textInput.positionCaret(11);
 879         textInput.previousWord();
 880         assertEquals(4, textInput.getCaretPosition());
 881         assertEquals(4, textInput.getAnchor());
 882         assertEquals(new IndexRange(4, 4), textInput.getSelection());
 883     }
 884 
 885     @Test public void previousWord_withANumber() {
 886         textInput.setText(&quot;There are 5 cards in the hand&quot;);
 887         textInput.positionCaret(12);
 888         textInput.previousWord();
 889         assertEquals(10, textInput.getCaretPosition());
 890         assertEquals(10, textInput.getAnchor());
 891         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 892     }
 893 
 894     @Test public void previousWord_withALongNumber() {
 895         textInput.setText(&quot;There are 52 cards in the deck&quot;);
 896         textInput.positionCaret(13);
 897         textInput.previousWord();
 898         assertEquals(10, textInput.getCaretPosition());
 899         assertEquals(10, textInput.getAnchor());
 900         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 901     }
 902 
 903     @Test public void nextWordWithNoText() {
 904         textInput.nextWord();
 905         assertEquals(0, textInput.getCaretPosition());
 906         assertEquals(0, textInput.getAnchor());
 907         assertEquals(new IndexRange(0, 0), textInput.getSelection());
 908     }
 909 
 910     @Test public void nextWordWithSelection_caretPositionBeforeAnchor() {
 911         textInput.setText(&quot;The quick brown fox&quot;);
 912         textInput.selectRange(9, 4);
 913         textInput.nextWord();
 914         assertEquals(10, textInput.getCaretPosition());
 915         assertEquals(10, textInput.getAnchor());
 916         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 917     }
 918 
 919     @Test public void nextWordWithSelection_caretPositionBeforeAnchor2() {
 920         textInput.setText(&quot;The quick brown fox&quot;);
 921         textInput.selectRange(9, 2);
 922         textInput.nextWord();
 923         assertEquals(4, textInput.getCaretPosition());
 924         assertEquals(4, textInput.getAnchor());
 925         assertEquals(new IndexRange(4, 4), textInput.getSelection());
 926     }
 927 
 928     @Test public void nextWordWithSelection_caretPositionAfterAnchor() {
 929         textInput.setText(&quot;The quick brown fox&quot;);
 930         textInput.selectRange(4, 9);
 931         textInput.nextWord();
 932         assertEquals(10, textInput.getCaretPosition());
 933         assertEquals(10, textInput.getAnchor());
 934         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 935     }
 936 
 937     @Test public void nextWordWithSelection_caretPositionAfterAnchor2() {
 938         textInput.setText(&quot;The quick brown fox&quot;);
 939         textInput.selectRange(5, 11);
 940         textInput.nextWord();
 941         assertEquals(16, textInput.getCaretPosition());
 942         assertEquals(16, textInput.getAnchor());
 943         assertEquals(new IndexRange(16, 16), textInput.getSelection());
 944     }
 945 
 946     @Test public void nextWord_caretWithinAWord() {
 947         textInput.setText(&quot;The quick brown fox&quot;);
 948         textInput.positionCaret(6);
 949         textInput.nextWord();
 950         assertEquals(10, textInput.getCaretPosition());
 951         assertEquals(10, textInput.getAnchor());
 952         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 953     }
 954 
 955     @Test public void nextWord_caretAfterWord() {
 956         textInput.setText(&quot;The quick brown fox&quot;);
 957         textInput.positionCaret(9);
 958         textInput.nextWord();
 959         assertEquals(10, textInput.getCaretPosition());
 960         assertEquals(10, textInput.getAnchor());
 961         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 962     }
 963 
 964     @Test public void nextWord_caretBeforeWord() {
 965         textInput.setText(&quot;The quick brown fox&quot;);
 966         textInput.positionCaret(4);
 967         textInput.nextWord();
 968         assertEquals(10, textInput.getCaretPosition());
 969         assertEquals(10, textInput.getAnchor());
 970         assertEquals(new IndexRange(10, 10), textInput.getSelection());
 971     }
 972 
 973     @Test public void nextWord_caretWithinWhitespace() {
 974         textInput.setText(&quot;The quick  brown fox&quot;);
 975         textInput.positionCaret(10);
 976         textInput.nextWord();
 977         assertEquals(11, textInput.getCaretPosition());
 978         assertEquals(11, textInput.getAnchor());
 979         assertEquals(new IndexRange(11, 11), textInput.getSelection());
 980     }
 981 
 982     @Test public void nextWord_multipleWhitespaceInARow() {
 983         textInput.setText(&quot;The quick  brown fox&quot;);
 984         textInput.positionCaret(9);
 985         textInput.nextWord();
 986         assertEquals(11, textInput.getCaretPosition());
 987         assertEquals(11, textInput.getAnchor());
 988         assertEquals(new IndexRange(11, 11), textInput.getSelection());
 989     }
 990 
 991     @Test public void nextWord_toTheEnd() {
 992         textInput.setText(&quot;The quick brown fox&quot;);
 993         textInput.positionCaret(16);
 994         textInput.nextWord();
 995         assertEquals(19, textInput.getCaretPosition());
 996         assertEquals(19, textInput.getAnchor());
 997         assertEquals(new IndexRange(19, 19), textInput.getSelection());
 998     }
 999 
1000     @Test public void nextWord_withANumber() {
1001         textInput.setText(&quot;There are 5 cards in the hand&quot;);
1002         textInput.positionCaret(6);
1003         textInput.nextWord();
1004         assertEquals(10, textInput.getCaretPosition());
1005         assertEquals(10, textInput.getAnchor());
1006         assertEquals(new IndexRange(10, 10), textInput.getSelection());
1007     }
1008 
1009     @Test public void nextWord_withALongNumber() {
1010         textInput.setText(&quot;There are 52 cards in the deck&quot;);
1011         textInput.positionCaret(10);
1012         textInput.nextWord();
1013         assertEquals(13, textInput.getCaretPosition());
1014         assertEquals(13, textInput.getAnchor());
1015         assertEquals(new IndexRange(13, 13), textInput.getSelection());
1016     }
1017 
1018     @Test public void endOfNextWordWithNoText() {
1019         textInput.endOfNextWord();
1020         assertEquals(0, textInput.getCaretPosition());
1021         assertEquals(0, textInput.getAnchor());
1022         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1023     }
1024 
1025     @Test public void endOfNextWordWithSelection_caretPositionBeforeAnchor() {
1026         textInput.setText(&quot;The quick brown fox&quot;);
1027         textInput.selectRange(9, 4);
1028         textInput.endOfNextWord();
1029         assertEquals(9, textInput.getCaretPosition());
1030         assertEquals(9, textInput.getAnchor());
1031         assertEquals(new IndexRange(9, 9), textInput.getSelection());
1032     }
1033 
1034     @Test public void endOfNextWordWithSelection_caretPositionBeforeAnchor2() {
1035         textInput.setText(&quot;The quick brown fox&quot;);
1036         textInput.selectRange(9, 2);
1037         textInput.endOfNextWord();
1038         assertEquals(3, textInput.getCaretPosition());
1039         assertEquals(3, textInput.getAnchor());
1040         assertEquals(new IndexRange(3, 3), textInput.getSelection());
1041     }
1042 
1043     @Test public void endOfNextWordWithSelection_caretPositionAfterAnchor() {
1044         textInput.setText(&quot;The quick brown fox&quot;);
1045         textInput.selectRange(4, 9);
1046         textInput.endOfNextWord();
1047         assertEquals(15, textInput.getCaretPosition());
1048         assertEquals(15, textInput.getAnchor());
1049         assertEquals(new IndexRange(15, 15), textInput.getSelection());
1050     }
1051 
1052     @Test public void endOfNextWordWithSelection_caretPositionAfterAnchor2() {
1053         textInput.setText(&quot;The quick brown fox&quot;);
1054         textInput.selectRange(5, 11);
1055         textInput.endOfNextWord();
1056         assertEquals(15, textInput.getCaretPosition());
1057         assertEquals(15, textInput.getAnchor());
1058         assertEquals(new IndexRange(15, 15), textInput.getSelection());
1059     }
1060 
1061     @Test public void endOfNextWord_caretWithinAWord() {
1062         textInput.setText(&quot;The quick brown fox&quot;);
1063         textInput.positionCaret(6);
1064         textInput.endOfNextWord();
1065         assertEquals(9, textInput.getCaretPosition());
1066         assertEquals(9, textInput.getAnchor());
1067         assertEquals(new IndexRange(9, 9), textInput.getSelection());
1068     }
1069 
1070     @Test public void endOfNextWord_caretAfterWord() {
1071         textInput.setText(&quot;The quick brown fox&quot;);
1072         textInput.positionCaret(9);
1073         textInput.endOfNextWord();
1074         assertEquals(15, textInput.getCaretPosition());
1075         assertEquals(15, textInput.getAnchor());
1076         assertEquals(new IndexRange(15, 15), textInput.getSelection());
1077     }
1078 
1079     @Test public void endOfNextWord_caretBeforeWord() {
1080         textInput.setText(&quot;The quick brown fox&quot;);
1081         textInput.positionCaret(4);
1082         textInput.endOfNextWord();
1083         assertEquals(9, textInput.getCaretPosition());
1084         assertEquals(9, textInput.getAnchor());
1085         assertEquals(new IndexRange(9, 9), textInput.getSelection());
1086     }
1087 
1088     @Test public void endOfNextWord_caretWithinWhitespace() {
1089         textInput.setText(&quot;The quick  brown fox&quot;);
1090         textInput.positionCaret(10);
1091         textInput.endOfNextWord();
1092         assertEquals(16, textInput.getCaretPosition());
1093         assertEquals(16, textInput.getAnchor());
1094         assertEquals(new IndexRange(16, 16), textInput.getSelection());
1095     }
1096 
1097     @Test public void endOfNextWord_multipleWhitespaceInARow() {
1098         textInput.setText(&quot;The quick  brown fox&quot;);
1099         textInput.positionCaret(9);
1100         textInput.endOfNextWord();
1101         assertEquals(16, textInput.getCaretPosition());
1102         assertEquals(16, textInput.getAnchor());
1103         assertEquals(new IndexRange(16, 16), textInput.getSelection());
1104     }
1105 
1106     @Test public void endOfNextWord_withANumber() {
1107         textInput.setText(&quot;There are 5 cards in the hand&quot;);
1108         textInput.positionCaret(6);
1109         textInput.endOfNextWord();
1110         assertEquals(9, textInput.getCaretPosition());
1111         assertEquals(9, textInput.getAnchor());
1112         assertEquals(new IndexRange(9, 9), textInput.getSelection());
1113     }
1114 
1115     @Test public void endOfNextWord_withANumber_CaretOnANumber() {
1116         textInput.setText(&quot;There are 5 cards in the hand&quot;);
1117         textInput.positionCaret(10);
1118         textInput.endOfNextWord();
1119         assertEquals(11, textInput.getCaretPosition());
1120         assertEquals(11, textInput.getAnchor());
1121         assertEquals(new IndexRange(11, 11), textInput.getSelection());
1122     }
1123 
1124     @Test public void endOfNextWord_withALongNumber_CaretOnANumber() {
1125         textInput.setText(&quot;There are 52 cards in the deck&quot;);
1126         textInput.positionCaret(10);
1127         textInput.endOfNextWord();
1128         assertEquals(12, textInput.getCaretPosition());
1129         assertEquals(12, textInput.getAnchor());
1130         assertEquals(new IndexRange(12, 12), textInput.getSelection());
1131     }
1132 
1133     @Test public void selectPreviousWordWithNoText() {
1134         textInput.selectPreviousWord();
1135         assertEquals(0, textInput.getCaretPosition());
1136         assertEquals(0, textInput.getAnchor());
1137         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1138     }
1139 
1140     @Test public void selectPreviousWordWithSelection_caretPositionBeforeAnchor() {
1141         textInput.setText(&quot;The quick brown fox&quot;);
1142         textInput.selectRange(15, 10);
1143         textInput.selectPreviousWord();
1144         assertEquals(4, textInput.getCaretPosition());
1145         assertEquals(15, textInput.getAnchor());
1146         assertEquals(new IndexRange(4, 15), textInput.getSelection());
1147     }
1148 
1149     @Test public void selectPreviousWordWithSelection_caretPositionAfterAnchor() {
1150         textInput.setText(&quot;The quick brown fox&quot;);
1151         textInput.selectRange(10, 15);
1152         textInput.selectPreviousWord();
1153         assertEquals(10, textInput.getCaretPosition());
1154         assertEquals(10, textInput.getAnchor());
1155         assertEquals(new IndexRange(10, 10), textInput.getSelection());
1156     }
1157 
1158     @Test public void selectPreviousWordWithSelection_caretPositionAfterAnchor2() {
1159         textInput.setText(&quot;The quick brown fox&quot;);
1160         textInput.selectRange(11, 15);
1161         textInput.selectPreviousWord();
1162         assertEquals(10, textInput.getCaretPosition());
1163         assertEquals(11, textInput.getAnchor());
1164         assertEquals(new IndexRange(10, 11), textInput.getSelection());
1165     }
1166 
1167     @Test public void selectPreviousWord_caretWithinAWord() {
1168         textInput.setText(&quot;The quick brown fox&quot;);
1169         textInput.positionCaret(12);
1170         textInput.selectPreviousWord();
1171         assertEquals(10, textInput.getCaretPosition());
1172         assertEquals(12, textInput.getAnchor());
1173         assertEquals(new IndexRange(10, 12), textInput.getSelection());
1174     }
1175 
1176     @Test public void selectPreviousWord_caretAfterWord() {
1177         textInput.setText(&quot;The quick brown fox&quot;);
1178         textInput.positionCaret(15);
1179         textInput.selectPreviousWord();
1180         assertEquals(10, textInput.getCaretPosition());
1181         assertEquals(15, textInput.getAnchor());
1182         assertEquals(new IndexRange(10, 15), textInput.getSelection());
1183     }
1184 
1185     @Test public void selectPreviousWord_caretBeforeWord() {
1186         textInput.setText(&quot;The quick brown fox&quot;);
1187         textInput.positionCaret(10);
1188         textInput.selectPreviousWord();
1189         assertEquals(4, textInput.getCaretPosition());
1190         assertEquals(10, textInput.getAnchor());
1191         assertEquals(new IndexRange(4, 10), textInput.getSelection());
1192     }
1193 
1194     @Test public void selectPreviousWord_caretWithinWhitespace() {
1195         textInput.setText(&quot;The quick  brown fox&quot;);
1196         textInput.positionCaret(10);
1197         textInput.selectPreviousWord();
1198         assertEquals(4, textInput.getCaretPosition());
1199         assertEquals(10, textInput.getAnchor());
1200         assertEquals(new IndexRange(4, 10), textInput.getSelection());
1201     }
1202 
1203     @Test public void selectPreviousWord_multipleWhitespaceInARow() {
1204         textInput.setText(&quot;The quick  brown fox&quot;);
1205         textInput.positionCaret(11);
1206         textInput.selectPreviousWord();
1207         assertEquals(4, textInput.getCaretPosition());
1208         assertEquals(11, textInput.getAnchor());
1209         assertEquals(new IndexRange(4, 11), textInput.getSelection());
1210     }
1211 
1212     @Test public void selectNextWordWithNoText() {
1213         textInput.selectNextWord();
1214         assertEquals(0, textInput.getCaretPosition());
1215         assertEquals(0, textInput.getAnchor());
1216         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1217     }
1218 
1219     @Test public void selectNextWordWithSelection_caretPositionBeforeAnchor() {
1220         textInput.setText(&quot;The quick brown fox&quot;);
1221         textInput.selectRange(9, 4);
1222         textInput.selectNextWord();
1223         assertEquals(10, textInput.getCaretPosition());
1224         assertEquals(9, textInput.getAnchor());
1225         assertEquals(new IndexRange(9, 10), textInput.getSelection());
1226     }
1227 
1228     @Test public void selectNextWordWithSelection_caretPositionBeforeAnchor2() {
1229         textInput.setText(&quot;The quick brown fox&quot;);
1230         textInput.selectRange(9, 2);
1231         textInput.selectNextWord();
1232         assertEquals(4, textInput.getCaretPosition());
1233         assertEquals(9, textInput.getAnchor());
1234         assertEquals(new IndexRange(4, 9), textInput.getSelection());
1235     }
1236 
1237     @Test public void selectNextWordWithSelection_caretPositionAfterAnchor() {
1238         textInput.setText(&quot;The quick brown fox&quot;);
1239         textInput.selectRange(4, 9);
1240         textInput.selectNextWord();
1241         assertEquals(10, textInput.getCaretPosition());
1242         assertEquals(4, textInput.getAnchor());
1243         assertEquals(new IndexRange(4, 10), textInput.getSelection());
1244     }
1245 
1246     @Test public void selectNextWordWithSelection_caretPositionAfterAnchor2() {
1247         textInput.setText(&quot;The quick brown fox&quot;);
1248         textInput.selectRange(5, 11);
1249         textInput.selectNextWord();
1250         assertEquals(16, textInput.getCaretPosition());
1251         assertEquals(5, textInput.getAnchor());
1252         assertEquals(new IndexRange(5, 16), textInput.getSelection());
1253     }
1254 
1255     @Test public void selectNextWord_caretWithinAWord() {
1256         textInput.setText(&quot;The quick brown fox&quot;);
1257         textInput.positionCaret(6);
1258         textInput.selectNextWord();
1259         assertEquals(10, textInput.getCaretPosition());
1260         assertEquals(6, textInput.getAnchor());
1261         assertEquals(new IndexRange(6, 10), textInput.getSelection());
1262     }
1263 
1264     @Test public void selectNextWord_caretAfterWord() {
1265         textInput.setText(&quot;The quick brown fox&quot;);
1266         textInput.positionCaret(9);
1267         textInput.selectNextWord();
1268         assertEquals(10, textInput.getCaretPosition());
1269         assertEquals(9, textInput.getAnchor());
1270         assertEquals(new IndexRange(9, 10), textInput.getSelection());
1271     }
1272 
1273     @Test public void selectNextWord_caretBeforeWord() {
1274         textInput.setText(&quot;The quick brown fox&quot;);
1275         textInput.positionCaret(4);
1276         textInput.selectNextWord();
1277         assertEquals(10, textInput.getCaretPosition());
1278         assertEquals(4, textInput.getAnchor());
1279         assertEquals(new IndexRange(4, 10), textInput.getSelection());
1280     }
1281 
1282     @Test public void selectNextWord_caretWithinWhitespace() {
1283         textInput.setText(&quot;The quick  brown fox&quot;);
1284         textInput.positionCaret(10);
1285         textInput.selectNextWord();
1286         assertEquals(11, textInput.getCaretPosition());
1287         assertEquals(10, textInput.getAnchor());
1288         assertEquals(new IndexRange(10, 11), textInput.getSelection());
1289     }
1290 
1291     @Test public void selectNextWord_multipleWhitespaceInARow() {
1292         textInput.setText(&quot;The quick  brown fox&quot;);
1293         textInput.positionCaret(9);
1294         textInput.selectNextWord();
1295         assertEquals(11, textInput.getCaretPosition());
1296         assertEquals(9, textInput.getAnchor());
1297         assertEquals(new IndexRange(9, 11), textInput.getSelection());
1298     }
1299 
1300     @Test public void selectNextWord_toTheEnd() {
1301         textInput.setText(&quot;The quick brown fox&quot;);
1302         textInput.positionCaret(16);
1303         textInput.selectNextWord();
1304         assertEquals(19, textInput.getCaretPosition());
1305         assertEquals(16, textInput.getAnchor());
1306         assertEquals(new IndexRange(16, 19), textInput.getSelection());
1307     }
1308 
1309     @Test public void selectEndOfNextWordWithNoText() {
1310         textInput.selectEndOfNextWord();
1311         assertEquals(0, textInput.getCaretPosition());
1312         assertEquals(0, textInput.getAnchor());
1313         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1314     }
1315 
1316     @Test public void selectEndOfNextWordWithSelection_caretPositionBeforeAnchor() {
1317         textInput.setText(&quot;The quick brown fox&quot;);
1318         textInput.selectRange(9, 4);
1319         textInput.selectEndOfNextWord();
1320         assertEquals(9, textInput.getCaretPosition());
1321         assertEquals(9, textInput.getAnchor());
1322         assertEquals(new IndexRange(9, 9), textInput.getSelection());
1323     }
1324 
1325     @Test public void selectEndOfNextWordWithSelection_caretPositionBeforeAnchor2() {
1326         textInput.setText(&quot;The quick brown fox&quot;);
1327         textInput.selectRange(9, 2);
1328         textInput.selectEndOfNextWord();
1329         assertEquals(3, textInput.getCaretPosition());
1330         assertEquals(9, textInput.getAnchor());
1331         assertEquals(new IndexRange(3, 9), textInput.getSelection());
1332     }
1333 
1334     @Test public void selectEndOfNextWordWithSelection_caretPositionAfterAnchor() {
1335         textInput.setText(&quot;The quick brown fox&quot;);
1336         textInput.selectRange(4, 9);
1337         textInput.selectEndOfNextWord();
1338         assertEquals(15, textInput.getCaretPosition());
1339         assertEquals(4, textInput.getAnchor());
1340         assertEquals(new IndexRange(4, 15), textInput.getSelection());
1341     }
1342 
1343     @Test public void selectEndOfNextWordWithSelection_caretPositionAfterAnchor2() {
1344         textInput.setText(&quot;The quick brown fox&quot;);
1345         textInput.selectRange(5, 11);
1346         textInput.selectEndOfNextWord();
1347         assertEquals(15, textInput.getCaretPosition());
1348         assertEquals(5, textInput.getAnchor());
1349         assertEquals(new IndexRange(5, 15), textInput.getSelection());
1350     }
1351 
1352     @Test public void selectEndOfNextWord_caretWithinAWord() {
1353         textInput.setText(&quot;The quick brown fox&quot;);
1354         textInput.positionCaret(6);
1355         textInput.selectEndOfNextWord();
1356         assertEquals(9, textInput.getCaretPosition());
1357         assertEquals(6, textInput.getAnchor());
1358         assertEquals(new IndexRange(6, 9), textInput.getSelection());
1359     }
1360 
1361     @Test public void selectEndOfNextWord_caretAfterWord() {
1362         textInput.setText(&quot;The quick brown fox&quot;);
1363         textInput.positionCaret(9);
1364         textInput.selectEndOfNextWord();
1365         assertEquals(15, textInput.getCaretPosition());
1366         assertEquals(9, textInput.getAnchor());
1367         assertEquals(new IndexRange(9, 15), textInput.getSelection());
1368     }
1369 
1370     @Test public void selectEndOfNextWord_caretBeforeWord() {
1371         textInput.setText(&quot;The quick brown fox&quot;);
1372         textInput.positionCaret(4);
1373         textInput.selectEndOfNextWord();
1374         assertEquals(9, textInput.getCaretPosition());
1375         assertEquals(4, textInput.getAnchor());
1376         assertEquals(new IndexRange(4, 9), textInput.getSelection());
1377     }
1378 
1379     @Test public void selectEndOfNextWord_caretWithinWhitespace() {
1380         textInput.setText(&quot;The quick  brown fox&quot;);
1381         textInput.positionCaret(10);
1382         textInput.selectEndOfNextWord();
1383         assertEquals(16, textInput.getCaretPosition());
1384         assertEquals(10, textInput.getAnchor());
1385         assertEquals(new IndexRange(10, 16), textInput.getSelection());
1386     }
1387 
1388     @Test public void selectEndOfNextWord_multipleWhitespaceInARow() {
1389         textInput.setText(&quot;The quick  brown fox&quot;);
1390         textInput.positionCaret(9);
1391         textInput.selectEndOfNextWord();
1392         assertEquals(16, textInput.getCaretPosition());
1393         assertEquals(9, textInput.getAnchor());
1394         assertEquals(new IndexRange(9, 16), textInput.getSelection());
1395     }
1396 
1397     @Test public void selectAllWithNoText() {
1398         textInput.setText(&quot;&quot;);
1399         textInput.selectAll();
1400         assertEquals(0, textInput.getCaretPosition());
1401         assertEquals(0, textInput.getAnchor());
1402         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1403     }
1404 
1405     @Test public void selectAllWithText_caretPositionIsAlwaysAtTheEnd() {
1406         textInput.setText(&quot;The quick brown fox&quot;);
1407         textInput.selectAll();
1408         assertEquals(19, textInput.getCaretPosition());
1409         assertEquals(0, textInput.getAnchor());
1410         assertEquals(new IndexRange(0, 19), textInput.getSelection());
1411     }
1412 
1413     @Test public void homeClearsSelection() {
1414         textInput.setText(&quot;The quick brown fox&quot;);
1415         textInput.selectRange(4, 9);
1416         textInput.home();
1417         assertEquals(0, textInput.getCaretPosition());
1418         assertEquals(0, textInput.getAnchor());
1419         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1420     }
1421 
1422     @Test public void endClearsSelection() {
1423         textInput.setText(&quot;The quick brown fox&quot;);
1424         textInput.selectRange(4, 9);
1425         textInput.end();
1426         assertEquals(19, textInput.getCaretPosition());
1427         assertEquals(19, textInput.getAnchor());
1428         assertEquals(new IndexRange(19, 19), textInput.getSelection());
1429     }
1430 
1431     @Test public void selectHomeHasNoEffectWhenCaretPositionIsAtZero() {
1432         textInput.setText(&quot;The quick brown fox&quot;);
1433         textInput.selectRange(3, 0);
1434         textInput.selectHome();
1435         assertEquals(0, textInput.getCaretPosition());
1436         assertEquals(3, textInput.getAnchor());
1437         assertEquals(new IndexRange(0, 3), textInput.getSelection());
1438     }
1439 
1440     @Test public void selectHomeMovesCaretPositionToZero_CaretPositionRightOfAnchor() {
1441         textInput.setText(&quot;The quick brown fox&quot;);
1442         textInput.selectRange(4, 9);
1443         textInput.selectHome();
1444         assertEquals(0, textInput.getCaretPosition());
1445         assertEquals(4, textInput.getAnchor());
1446         assertEquals(new IndexRange(0, 4), textInput.getSelection());
1447     }
1448 
1449     @Test public void selectHomeMovesCaretPositionToZero_CaretPositionEqualsAnchor() {
1450         textInput.setText(&quot;The quick brown fox&quot;);
1451         textInput.selectRange(3, 3);
1452         textInput.selectHome();
1453         assertEquals(0, textInput.getCaretPosition());
1454         assertEquals(3, textInput.getAnchor());
1455         assertEquals(new IndexRange(0, 3), textInput.getSelection());
1456     }
1457 
1458     @Test public void selectHomeMovesCaretPositionToZero_CaretPositionLeftOfAnchor() {
1459         textInput.setText(&quot;The quick brown fox&quot;);
1460         textInput.selectRange(6, 3);
1461         textInput.selectHome();
1462         assertEquals(0, textInput.getCaretPosition());
1463         assertEquals(6, textInput.getAnchor());
1464         assertEquals(new IndexRange(0, 6), textInput.getSelection());
1465     }
1466 
1467     @Test public void selectEndHasNoEffectWhenCaretPositionIsAtLength() {
1468         textInput.setText(&quot;The quick brown fox&quot;);
1469         textInput.selectRange(3, 19);
1470         textInput.selectEnd();
1471         assertEquals(19, textInput.getCaretPosition());
1472         assertEquals(3, textInput.getAnchor());
1473         assertEquals(new IndexRange(3, 19), textInput.getSelection());
1474     }
1475 
1476     @Test public void selectEndMovesCaretPositionToLength_CaretPositionRightOfAnchor() {
1477         textInput.setText(&quot;The quick brown fox&quot;);
1478         textInput.selectRange(0, 3);
1479         textInput.selectEnd();
1480         assertEquals(19, textInput.getCaretPosition());
1481         assertEquals(0, textInput.getAnchor());
1482         assertEquals(new IndexRange(0, 19), textInput.getSelection());
1483     }
1484 
1485     @Test public void selectEndMovesCaretPositionToLength_CaretPositionEqualsAnchor() {
1486         textInput.setText(&quot;The quick brown fox&quot;);
1487         textInput.selectRange(3, 3);
1488         textInput.selectEnd();
1489         assertEquals(19, textInput.getCaretPosition());
1490         assertEquals(3, textInput.getAnchor());
1491         assertEquals(new IndexRange(3, 19), textInput.getSelection());
1492     }
1493 
1494     @Test public void selectEndMovesCaretPositionToLength_CaretPositionLeftOfAnchor() {
1495         textInput.setText(&quot;The quick brown fox&quot;);
1496         textInput.selectRange(6, 3);
1497         textInput.selectEnd();
1498         assertEquals(19, textInput.getCaretPosition());
1499         assertEquals(6, textInput.getAnchor());
1500         assertEquals(new IndexRange(6, 19), textInput.getSelection());
1501     }
1502 
1503     @Test public void deletePreviousCharDeletesOnlySelectedText_anchorLessThanCaretPosition() {
1504         textInput.setText(&quot;The quick brown fox&quot;);
1505         textInput.selectRange(4, 10);
1506         textInput.deletePreviousChar();
1507         assertEquals(&quot;The brown fox&quot;, textInput.getText());
1508         assertEquals(4, textInput.getCaretPosition());
1509         assertEquals(4, textInput.getAnchor());
1510         assertEquals(new IndexRange(4, 4), textInput.getSelection());
1511     }
1512 
1513     @Test public void deletePreviousCharDeletesOnlySelectedText_caretPositionLessThanAnchor() {
1514         textInput.setText(&quot;The quick brown fox&quot;);
1515         textInput.selectRange(10, 4);
1516         textInput.deletePreviousChar();
1517         assertEquals(&quot;The brown fox&quot;, textInput.getText());
1518         assertEquals(4, textInput.getCaretPosition());
1519         assertEquals(4, textInput.getAnchor());
1520         assertEquals(new IndexRange(4, 4), textInput.getSelection());
1521     }
1522 
1523     @Test public void deletePreviousCharDeletesPreviousCharWhenCaretPositionEqualsAnchor() {
1524         textInput.setText(&quot;The quick brown fox&quot;);
1525         textInput.selectRange(10, 10);
1526         textInput.deletePreviousChar();
1527         assertEquals(&quot;The quickbrown fox&quot;, textInput.getText());
1528         assertEquals(9, textInput.getCaretPosition());
1529         assertEquals(9, textInput.getAnchor());
1530         assertEquals(new IndexRange(9, 9), textInput.getSelection());
1531     }
1532 
1533     @Test public void deletePreviousCharDoesNothingWhenSelectionIs0_0() {
1534         textInput.setText(&quot;The quick brown fox&quot;);
1535         textInput.selectRange(0, 0);
1536         textInput.deletePreviousChar();
1537         assertEquals(&quot;The quick brown fox&quot;, textInput.getText());
1538         assertEquals(0, textInput.getCaretPosition());
1539         assertEquals(0, textInput.getAnchor());
1540         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1541     }
1542 
1543     @Test public void deleteNextCharDeletesOnlySelectedText_anchorLessThanCaretPosition() {
1544         textInput.setText(&quot;The quick brown fox&quot;);
1545         textInput.selectRange(4, 10);
1546         textInput.deleteNextChar();
1547         assertEquals(&quot;The brown fox&quot;, textInput.getText());
1548         assertEquals(4, textInput.getCaretPosition());
1549         assertEquals(4, textInput.getAnchor());
1550         assertEquals(new IndexRange(4, 4), textInput.getSelection());
1551     }
1552 
1553     @Test public void deleteNextCharDeletesOnlySelectedText_caretPositionLessThanAnchor() {
1554         textInput.setText(&quot;The quick brown fox&quot;);
1555         textInput.selectRange(10, 4);
1556         textInput.deleteNextChar();
1557         assertEquals(&quot;The brown fox&quot;, textInput.getText());
1558         assertEquals(4, textInput.getCaretPosition());
1559         assertEquals(4, textInput.getAnchor());
1560         assertEquals(new IndexRange(4, 4), textInput.getSelection());
1561     }
1562 
1563     @Test public void deleteNextCharDeletesNextCharWhenCaretPositionEqualsAnchor() {
1564         textInput.setText(&quot;The quick brown fox&quot;);
1565         textInput.selectRange(10, 10);
1566         textInput.deleteNextChar();
1567         assertEquals(&quot;The quick rown fox&quot;, textInput.getText());
1568         assertEquals(10, textInput.getCaretPosition());
1569         assertEquals(10, textInput.getAnchor());
1570         assertEquals(new IndexRange(10, 10), textInput.getSelection());
1571     }
1572 
1573     @Test public void deleteNextCharDoesNothingWhenSelectionIsEmptyAtEnd() {
1574         textInput.setText(&quot;The quick brown fox&quot;);
1575         textInput.selectRange(19, 19);
1576         textInput.deleteNextChar();
1577         assertEquals(&quot;The quick brown fox&quot;, textInput.getText());
1578         assertEquals(19, textInput.getCaretPosition());
1579         assertEquals(19, textInput.getAnchor());
1580         assertEquals(new IndexRange(19, 19), textInput.getSelection());
1581     }
1582 
1583     @Test public void forwardSkipsSelection() {
1584         textInput.setText(&quot;The quick brown fox&quot;);
1585         textInput.selectRange(4, 9);
1586         textInput.forward();
1587         assertEquals(9, textInput.getCaretPosition());
1588         assertEquals(9, textInput.getAnchor());
1589         assertEquals(new IndexRange(9, 9), textInput.getSelection());
1590     }
1591 
1592     @Test public void forwardSkipsSelection2() {
1593         textInput.setText(&quot;The quick brown fox&quot;);
1594         textInput.selectRange(9, 4);
1595         textInput.forward();
1596         assertEquals(9, textInput.getCaretPosition());
1597         assertEquals(9, textInput.getAnchor());
1598         assertEquals(new IndexRange(9, 9), textInput.getSelection());
1599     }
1600 
1601     @Test public void forwardMovesForwardWhenNotAtEnd() {
1602         textInput.setText(&quot;The quick brown fox&quot;);
1603         textInput.selectRange(0, 0);
1604         textInput.forward();
1605         assertEquals(1, textInput.getCaretPosition());
1606         assertEquals(1, textInput.getAnchor());
1607         assertEquals(new IndexRange(1, 1), textInput.getSelection());
1608     }
1609 
1610     @Test public void forwardDoesNothingWhenAtEnd() {
1611         textInput.setText(&quot;The quick brown fox&quot;);
1612         textInput.selectRange(19, 19);
1613         textInput.forward();
1614         assertEquals(19, textInput.getCaretPosition());
1615         assertEquals(19, textInput.getAnchor());
1616         assertEquals(new IndexRange(19, 19), textInput.getSelection());
1617     }
1618 
1619     @Test public void backwardSkipsSelection() {
1620         textInput.setText(&quot;The quick brown fox&quot;);
1621         textInput.selectRange(4, 9);
1622         textInput.backward();
1623         assertEquals(4, textInput.getCaretPosition());
1624         assertEquals(4, textInput.getAnchor());
1625         assertEquals(new IndexRange(4, 4), textInput.getSelection());
1626     }
1627 
1628     @Test public void backwardSkipsSelection2() {
1629         textInput.setText(&quot;The quick brown fox&quot;);
1630         textInput.selectRange(9, 4);
1631         textInput.backward();
1632         assertEquals(4, textInput.getCaretPosition());
1633         assertEquals(4, textInput.getAnchor());
1634         assertEquals(new IndexRange(4, 4), textInput.getSelection());
1635     }
1636 
1637     @Test public void backwardMovesBackwardWhenNotAtStart() {
1638         textInput.setText(&quot;The quick brown fox&quot;);
1639         textInput.positionCaret(14);
1640         textInput.backward();
1641         assertEquals(13, textInput.getCaretPosition());
1642         assertEquals(13, textInput.getAnchor());
1643         assertEquals(new IndexRange(13, 13), textInput.getSelection());
1644     }
1645 
1646     @Test public void backwardDoesNothingWhenAtStart() {
1647         textInput.setText(&quot;The quick brown fox&quot;);
1648         textInput.selectRange(0, 0);
1649         textInput.backward();
1650         assertEquals(0, textInput.getCaretPosition());
1651         assertEquals(0, textInput.getAnchor());
1652         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1653     }
1654 
1655     @Test public void positionCaretAtStart() {
1656         textInput.setText(&quot;The quick brown fox&quot;);
1657         textInput.positionCaret(0);
1658         assertEquals(0, textInput.getCaretPosition());
1659         assertEquals(0, textInput.getAnchor());
1660         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1661     }
1662 
1663     @Test public void positionCaretInMiddle() {
1664         textInput.setText(&quot;The quick brown fox&quot;);
1665         textInput.positionCaret(10);
1666         assertEquals(10, textInput.getCaretPosition());
1667         assertEquals(10, textInput.getAnchor());
1668         assertEquals(new IndexRange(10, 10), textInput.getSelection());
1669     }
1670 
1671     @Test public void positionCaretAtEnd() {
1672         textInput.setText(&quot;The quick brown fox&quot;);
1673         textInput.positionCaret(19);
1674         assertEquals(19, textInput.getCaretPosition());
1675         assertEquals(19, textInput.getAnchor());
1676         assertEquals(new IndexRange(19, 19), textInput.getSelection());
1677     }
1678 
1679     @Test public void positionCaretBeyondStartClamps() {
1680         textInput.setText(&quot;The quick brown fox&quot;);
1681         textInput.positionCaret(-10);
1682         assertEquals(0, textInput.getCaretPosition());
1683         assertEquals(0, textInput.getAnchor());
1684         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1685     }
1686 
1687     @Test public void positionCaretBeyondEndClamps() {
1688         textInput.setText(&quot;The quick brown fox&quot;);
1689         textInput.positionCaret(1000);
1690         assertEquals(19, textInput.getCaretPosition());
1691         assertEquals(19, textInput.getAnchor());
1692         assertEquals(new IndexRange(19, 19), textInput.getSelection());
1693     }
1694 
1695     @Test public void selectPositionCaretWhenAnchorAndCaretAreBothZero() {
1696         textInput.setText(&quot;The quick brown fox&quot;);
1697         textInput.selectRange(0, 0);
1698         textInput.selectPositionCaret(10);
1699         assertEquals(10, textInput.getCaretPosition());
1700         assertEquals(0, textInput.getAnchor());
1701         assertEquals(new IndexRange(0, 10), textInput.getSelection());
1702     }
1703 
1704     @Test public void selectPositionCaret_anchorLessThanCaretPosition() {
1705         textInput.setText(&quot;The quick brown fox&quot;);
1706         textInput.selectRange(4, 10);
1707         textInput.selectPositionCaret(1);
1708         assertEquals(1, textInput.getCaretPosition());
1709         assertEquals(4, textInput.getAnchor());
1710         assertEquals(new IndexRange(1, 4), textInput.getSelection());
1711     }
1712 
1713     @Test public void selectPositionCaret_anchorLessThanCaretPosition2() {
1714         textInput.setText(&quot;The quick brown fox&quot;);
1715         textInput.selectRange(4, 10);
1716         textInput.selectPositionCaret(15);
1717         assertEquals(15, textInput.getCaretPosition());
1718         assertEquals(4, textInput.getAnchor());
1719         assertEquals(new IndexRange(4, 15), textInput.getSelection());
1720     }
1721 
1722     @Test public void selectPositionCaret_anchorLessThanCaretPosition3() {
1723         textInput.setText(&quot;The quick brown fox&quot;);
1724         textInput.selectRange(4, 10);
1725         textInput.selectPositionCaret(4);
1726         assertEquals(4, textInput.getCaretPosition());
1727         assertEquals(4, textInput.getAnchor());
1728         assertEquals(new IndexRange(4, 4), textInput.getSelection());
1729     }
1730 
1731     @Test public void selectPositionCaret_caretPositionLessThanAnchor() {
1732         textInput.setText(&quot;The quick brown fox&quot;);
1733         textInput.selectRange(10, 4);
1734         textInput.selectPositionCaret(1);
1735         assertEquals(1, textInput.getCaretPosition());
1736         assertEquals(10, textInput.getAnchor());
1737         assertEquals(new IndexRange(1, 10), textInput.getSelection());
1738     }
1739 
1740     @Test public void selectPositionCaret_caretPositionLessThanAnchor2() {
1741         textInput.setText(&quot;The quick brown fox&quot;);
1742         textInput.selectRange(10, 4);
1743         textInput.selectPositionCaret(14);
1744         assertEquals(14, textInput.getCaretPosition());
1745         assertEquals(10, textInput.getAnchor());
1746         assertEquals(new IndexRange(10, 14), textInput.getSelection());
1747     }
1748 
1749     @Test public void selectPositionCaret_caretPositionLessThanAnchor3() {
1750         textInput.setText(&quot;The quick brown fox&quot;);
1751         textInput.selectRange(10, 4);
1752         textInput.selectPositionCaret(10);
1753         assertEquals(10, textInput.getCaretPosition());
1754         assertEquals(10, textInput.getAnchor());
1755         assertEquals(new IndexRange(10, 10), textInput.getSelection());
1756     }
1757 
1758     @Test public void selectPositionCaretWhenCaretPositionEqualsAnchor() {
1759         textInput.setText(&quot;The quick brown fox&quot;);
1760         textInput.selectRange(10, 10);
1761         textInput.selectPositionCaret(4);
1762         assertEquals(4, textInput.getCaretPosition());
1763         assertEquals(10, textInput.getAnchor());
1764         assertEquals(new IndexRange(4, 10), textInput.getSelection());
1765     }
1766 
1767     @Test public void selectPositionCaretWhenCaretPositionEqualsAnchor2() {
1768         textInput.setText(&quot;The quick brown fox&quot;);
1769         textInput.selectRange(10, 10);
1770         textInput.selectPositionCaret(14);
1771         assertEquals(14, textInput.getCaretPosition());
1772         assertEquals(10, textInput.getAnchor());
1773         assertEquals(new IndexRange(10, 14), textInput.getSelection());
1774     }
1775 
1776     @Test public void extendSelectionWithNoText() {
1777         textInput.extendSelection(0);
1778         assertEquals(0, textInput.getCaretPosition());
1779         assertEquals(0, textInput.getAnchor());
1780         assertEquals(new IndexRange(0, 0), textInput.getSelection());
1781     }
1782 
1783     @Test public void extendSelectionWithOutOfRangePos() {
1784         textInput.setText(&quot;The quick brown fox&quot;);
1785         textInput.selectRange(0, 0);
1786         textInput.extendSelection(1000);
1787         assertEquals(19, textInput.getCaretPosition());
1788         assertEquals(0, textInput.getAnchor());
1789         assertEquals(new IndexRange(0, 19), textInput.getSelection());
1790     }
1791 
1792     @Test public void extendSelectionWithOutOfRangePos2() {
1793         textInput.setText(&quot;The quick brown fox&quot;);
1794         textInput.positionCaret(4);
1795         textInput.extendSelection(-19);
1796         assertEquals(0, textInput.getCaretPosition());
1797         assertEquals(4, textInput.getAnchor());
1798         assertEquals(new IndexRange(0, 4), textInput.getSelection());
1799     }
1800 
1801     @Test public void test_rt26250_caret_issue_for_thai_characters() {
1802         // Thai string containing two characters, consisting of three
1803         // codepoints each.
1804         String thaiStr = &quot;\u0E17\u0E35\u0E48\u0E17\u0E35\u0E48&quot;;
1805         textInput.setText(thaiStr);
1806         textInput.positionCaret(0);
1807 
1808         // Step past one character
1809         textInput.forward();
1810         assertEquals(3, textInput.getCaretPosition());
1811 
1812         // Goto beginning
1813         textInput.backward();
1814         assertEquals(0, textInput.getCaretPosition());
1815 
1816         // Delete entire first character forwards
1817         textInput.deleteNextChar();
1818         assertEquals(&quot;\u0E17\u0E35\u0E48&quot;, textInput.getText());
1819 
1820         // Break up and delete remaining character backwards in three steps
1821         textInput.forward();
1822         textInput.deletePreviousChar();
1823         assertEquals(&quot;\u0E17\u0E35&quot;, textInput.getText());
1824         textInput.deletePreviousChar();
1825         assertEquals(&quot;\u0E17&quot;, textInput.getText());
1826         textInput.deletePreviousChar();
1827         assertEquals(&quot;&quot;, textInput.getText());
1828     }
1829 
1830     @Test public void test_rt40376_delete_next_when_text_is_null() {
1831         textInput.setText(null);
1832         textInput.deleteNextChar();
1833     }
1834 
1835     @Test public void test_jdk_8171229_replaceText() {
1836         textInput.setText(&quot;&quot;);
1837         assertEquals(&quot;&quot;, textInput.getText());
1838 
1839         textInput.replaceText(0, 0, &quot;a&quot;);
1840         assertEquals(&quot;a&quot;, textInput.getText());
1841 
1842         textInput.replaceText(1, 1, &quot;b&quot;);
1843         assertEquals(&quot;ab&quot;, textInput.getText());
1844 
1845         textInput.replaceText(2, 2, &quot;c&quot;);
1846         assertEquals(&quot;abc&quot;, textInput.getText());
1847 
1848         textInput.replaceText(3, 3, &quot;d&quot;);
1849         assertEquals(&quot;abcd&quot;, textInput.getText());
1850 
1851         textInput.replaceText(3, 4, &quot;efg&quot;);
1852         assertEquals(&quot;abcefg&quot;, textInput.getText());
1853 
1854         textInput.replaceText(3, 6, &quot;d&quot;);
1855         assertEquals(&quot;abcd&quot;, textInput.getText());
1856 
1857         textInput.replaceText(0, 4, &quot;&quot;);
1858         assertEquals(&quot;&quot;, textInput.getText());
1859 
1860         textInput.undo();
1861         assertEquals(&quot;abcd&quot;, textInput.getText());
1862 
1863         textInput.undo();
1864         assertEquals(&quot;abcefg&quot;, textInput.getText());
1865 
1866         textInput.undo();
1867         assertEquals(&quot;abcd&quot;, textInput.getText());
1868 
1869         textInput.undo();
1870         assertEquals(&quot;&quot;, textInput.getText());
1871     }
1872 
1873     // Test for JDK-8178418
1874     @Test public void UndoRedoSpaceSequence() {
1875         Toolkit tk = (StubToolkit)Toolkit.getToolkit();
1876         StackPane root = new StackPane();
1877         Scene scene = new Scene(root);
1878         Stage stage = new Stage();
1879         String text = &quot;123456789&quot;;
1880         String tempText = &quot;&quot;;
1881 
1882         textInput.setText(text);
1883         stage.setScene(scene);
1884         root.getChildren().removeAll();
1885         root.getChildren().add(textInput);
1886         stage.show();
1887         tk.firePulse();
1888 
1889         KeyEventFirer keyboard = new KeyEventFirer(textInput);
1890 
1891         // Test sequence of spaces
1892         keyboard.doKeyPress(KeyCode.HOME);
1893         tk.firePulse();
1894         for (int i = 0; i &lt; 10; ++i) {
1895             keyboard.doKeyTyped(KeyCode.SPACE);
1896             tk.firePulse();
1897             tempText += &quot; &quot;;
1898         }
1899         assertTrue(textInput.getText().equals(tempText + text));
1900 
1901         textInput.undo();
1902         assertTrue(textInput.getText().equals(text));
1903 
1904         textInput.redo();
1905         assertTrue(textInput.getText().equals(tempText + text));
1906 
1907         root.getChildren().removeAll();
1908         stage.hide();
1909         tk.firePulse();
1910     }
1911 
1912     // Test for JDK-8178418
1913     @Test public void UndoRedoReverseSpaceSequence() {
1914         Toolkit tk = (StubToolkit)Toolkit.getToolkit();
1915         StackPane root = new StackPane();
1916         Scene scene = new Scene(root);
1917         Stage stage = new Stage();
1918         String text = &quot;123456789&quot;;
1919         String tempText = &quot;&quot;;
1920 
1921         textInput.setText(text);
1922         stage.setScene(scene);
1923         root.getChildren().removeAll();
1924         root.getChildren().add(textInput);
1925         stage.show();
1926         tk.firePulse();
1927 
1928         KeyEventFirer keyboard = new KeyEventFirer(textInput);
1929         // Test reverse sequence of spaces
1930         keyboard.doKeyPress(KeyCode.HOME);
1931         tk.firePulse();
1932         for (int i = 0; i &lt; 10; ++i) {
1933             keyboard.doKeyTyped(KeyCode.SPACE);
1934             keyboard.doKeyPress(KeyCode.LEFT);
1935             tk.firePulse();
1936             tempText += &quot; &quot;;
1937             assertTrue(textInput.getText().equals(tempText + text));
1938         }
1939 
1940         for (int i = 0; i &lt; 10; ++i) {
1941             textInput.undo();
1942             tk.firePulse();
1943         }
1944         assertTrue(textInput.getText().equals(text));
1945 
1946         tempText = &quot;&quot;;
1947         for (int i = 0; i &lt; 10; ++i) {
1948             textInput.redo();
1949             tk.firePulse();
1950             tempText += &quot; &quot;;
1951             assertTrue(textInput.getText().equals(tempText + text));
1952         }
1953 
1954         root.getChildren().removeAll();
1955         stage.hide();
1956         tk.firePulse();
1957     }
1958 
1959     // Test for JDK-8178418
1960     @Test public void UndoRedoWords() {
1961         Toolkit tk = (StubToolkit)Toolkit.getToolkit();
1962         StackPane root = new StackPane();
1963         Scene scene = new Scene(root);
1964         Stage stage = new Stage();
1965         String text = &quot;123456789&quot;;
1966         String tempText = &quot;&quot;;
1967 
1968         textInput.setText(text);
1969         stage.setScene(scene);
1970         root.getChildren().removeAll();
1971         root.getChildren().add(textInput);
1972         stage.show();
1973         tk.firePulse();
1974 
1975         KeyEventFirer keyboard = new KeyEventFirer(textInput);
1976 
1977         // Test words separated by space
1978         keyboard.doKeyPress(KeyCode.HOME);
1979         tk.firePulse();
1980         for (int i = 0; i &lt; 10; ++i) {
1981             keyboard.doKeyTyped(KeyCode.SPACE);
1982             keyboard.doKeyTyped(KeyCode.A);
1983             keyboard.doKeyTyped(KeyCode.B);
1984             tk.firePulse();
1985             tempText += &quot; AB&quot;;
1986             assertTrue(textInput.getText().equals(tempText + text));
1987         }
1988 
1989         for (int i = 0; i &lt; 10; ++i) {
1990             textInput.undo();
1991             tk.firePulse();
1992         }
1993         assertTrue(textInput.getText().equals(text));
1994 
1995         tempText = &quot;&quot;;
1996         for (int i = 0; i &lt; 10; ++i) {
1997             textInput.redo();
1998             tk.firePulse();
1999             tempText += &quot; AB&quot;;
2000             assertTrue(textInput.getText().equals(tempText + text));
2001         }
2002 
2003         root.getChildren().removeAll();
2004         stage.hide();
2005         tk.firePulse();
2006     }
2007 
2008     // Test for JDK-8178418
2009     @Test public void UndoRedoTimestampBased() {
2010         Toolkit tk = (StubToolkit)Toolkit.getToolkit();
2011         StackPane root = new StackPane();
2012         Scene scene = new Scene(root);
2013         Stage stage = new Stage();
2014         String text = &quot;123456789&quot;;
2015         String tempText = &quot;&quot;;
2016 
2017         textInput.setText(text);
2018         stage.setScene(scene);
2019         root.getChildren().removeAll();
2020         root.getChildren().add(textInput);
2021         stage.show();
2022         tk.firePulse();
2023 
2024         KeyEventFirer keyboard = new KeyEventFirer(textInput);
2025 
2026         // Test continuos sequence of characters.
2027         // In this case an undo-redo record is added after 2500 milliseconds.
2028         keyboard.doKeyPress(KeyCode.HOME);
2029         tk.firePulse();
2030 
2031         long startTime = System.currentTimeMillis();
2032         while (System.currentTimeMillis() - startTime &lt; 4000) {
2033 
2034             keyboard.doKeyTyped(KeyCode.A);
2035             tk.firePulse();
2036             tempText += &quot;A&quot;;
2037             assertTrue(textInput.getText().equals(tempText + text));
2038         }
2039 
2040         textInput.undo();
2041         assertFalse(textInput.getText().equals(text));
2042         textInput.undo();
2043         tk.firePulse();
2044         assertTrue(textInput.getText().equals(text));
2045 
2046         root.getChildren().removeAll();
2047         stage.hide();
2048         tk.firePulse();
2049     }
2050 
<a name="5" id="anc5"></a><span class="line-added">2051     // Test for case 1 of JDK-8176270</span>
<span class="line-added">2052     @Test public void addingListenerWorks() {</span>
<span class="line-added">2053         VBox vBox = new VBox();</span>
<span class="line-added">2054         TextField textField = new TextField();</span>
<span class="line-added">2055         textField.setText(&quot;1234 5678&quot;);</span>
<span class="line-added">2056         vBox.getChildren().add(textField);</span>
<span class="line-added">2057         textField.selectedTextProperty()</span>
<span class="line-added">2058                  .addListener((observable -&gt; {}));</span>
<span class="line-added">2059 </span>
<span class="line-added">2060         Scene scene = new Scene(vBox);</span>
<span class="line-added">2061         Stage stage = new Stage();</span>
<span class="line-added">2062         stage.setScene(scene);</span>
<span class="line-added">2063         stage.show();</span>
<span class="line-added">2064     }</span>
<span class="line-added">2065 </span>
<span class="line-added">2066     // Test for case 2 of JDK-8176270</span>
<span class="line-added">2067     @Test public void replaceSelectionWorks() throws Exception {</span>
<span class="line-added">2068         VBox vBox = new VBox();</span>
<span class="line-added">2069         TextField textField = new TextField();</span>
<span class="line-added">2070         textField.setText(&quot;1234 5678&quot;);</span>
<span class="line-added">2071         vBox.getChildren().add(textField);</span>
<span class="line-added">2072         textField.selectedTextProperty()</span>
<span class="line-added">2073                  .addListener((observable -&gt; {}));</span>
<span class="line-added">2074 </span>
<span class="line-added">2075         Scene scene = new Scene(vBox);</span>
<span class="line-added">2076         Stage stage = new Stage();</span>
<span class="line-added">2077         stage.setScene(scene);</span>
<span class="line-added">2078         stage.show();</span>
<span class="line-added">2079 </span>
<span class="line-added">2080         textField.selectedTextProperty()</span>
<span class="line-added">2081                  .addListener(observable -&gt; {</span>
<span class="line-added">2082                      // accessing the selectedTextProperty causes a</span>
<span class="line-added">2083                      // StringOutOfBoundsException</span>
<span class="line-added">2084                      observable.toString();</span>
<span class="line-added">2085                  });</span>
<span class="line-added">2086         textField.positionCaret(5);</span>
<span class="line-added">2087         Semaphore semaphore = new Semaphore(0);</span>
<span class="line-added">2088         Platform.runLater(semaphore::release);</span>
<span class="line-added">2089         semaphore.acquire();</span>
<span class="line-added">2090 </span>
<span class="line-added">2091         // select 2nd word</span>
<span class="line-added">2092         textField.selectNextWord();</span>
<span class="line-added">2093         semaphore = new Semaphore(0);</span>
<span class="line-added">2094         Platform.runLater(semaphore::release);</span>
<span class="line-added">2095         semaphore.acquire();</span>
<span class="line-added">2096 </span>
<span class="line-added">2097         // replace selection</span>
<span class="line-added">2098         Platform.runLater(() -&gt; {Event.fireEvent(scene, new KeyEvent(KeyEvent.KEY_PRESSED, &quot;&quot;, KeyCode.DIGIT0.getName(), KeyCode.DIGIT0, false, false, false, false));});</span>
<span class="line-added">2099         Platform.runLater(() -&gt; {Event.fireEvent(scene, new KeyEvent(KeyEvent.KEY_RELEASED, &quot;&quot;, KeyCode.DIGIT0.getName(), KeyCode.DIGIT0, false, false, false, false));});</span>
<span class="line-added">2100         semaphore = new Semaphore(0);</span>
<span class="line-added">2101         Platform.runLater(semaphore::release);</span>
<span class="line-added">2102         semaphore.acquire();</span>
<span class="line-added">2103     }</span>
<span class="line-added">2104 </span>
<span class="line-added">2105     // Test for workaround of JDK-8176270</span>
<span class="line-added">2106     @Test public void accessingTheValueInInvalidationListenerWorks() throws Exception {</span>
<span class="line-added">2107         VBox vBox = new VBox();</span>
<span class="line-added">2108         TextField textField = new TextField();</span>
<span class="line-added">2109         textField.setText(&quot;1234 5678&quot;);</span>
<span class="line-added">2110         vBox.getChildren().add(textField);</span>
<span class="line-added">2111         textField.selectedTextProperty()</span>
<span class="line-added">2112                  .addListener((observable -&gt; {}));</span>
<span class="line-added">2113 </span>
<span class="line-added">2114         Scene scene = new Scene(vBox);</span>
<span class="line-added">2115         Stage stage = new Stage();</span>
<span class="line-added">2116         stage.setScene(scene);</span>
<span class="line-added">2117         stage.show();</span>
<span class="line-added">2118 </span>
<span class="line-added">2119         textField.selectedTextProperty()</span>
<span class="line-added">2120                  .addListener(new InvalidationListener() {</span>
<span class="line-added">2121                      @Override</span>
<span class="line-added">2122                      public void invalidated(Observable observable) {</span>
<span class="line-added">2123                          Platform.runLater(() -&gt; observable.toString());</span>
<span class="line-added">2124                      }</span>
<span class="line-added">2125                  });</span>
<span class="line-added">2126 </span>
<span class="line-added">2127         textField.positionCaret(5);</span>
<span class="line-added">2128         Semaphore semaphore = new Semaphore(0);</span>
<span class="line-added">2129         Platform.runLater(semaphore::release);</span>
<span class="line-added">2130         semaphore.acquire();</span>
<span class="line-added">2131 </span>
<span class="line-added">2132         // select 2nd word</span>
<span class="line-added">2133         textField.selectNextWord();</span>
<span class="line-added">2134         semaphore = new Semaphore(0);</span>
<span class="line-added">2135         Platform.runLater(semaphore::release);</span>
<span class="line-added">2136         semaphore.acquire();</span>
<span class="line-added">2137 </span>
<span class="line-added">2138         // replace selection</span>
<span class="line-added">2139         Platform.runLater(() -&gt; {Event.fireEvent(scene,</span>
<span class="line-added">2140                 new KeyEvent(KeyEvent.KEY_PRESSED, &quot;&quot;, KeyCode.DIGIT0.getName(), KeyCode.DIGIT0,</span>
<span class="line-added">2141                         false, false, false, false));});</span>
<span class="line-added">2142         Platform.runLater(() -&gt; {Event.fireEvent(scene,</span>
<span class="line-added">2143                 new KeyEvent(KeyEvent.KEY_RELEASED, &quot;&quot;, KeyCode.DIGIT0.getName(), KeyCode.DIGIT0,</span>
<span class="line-added">2144                         false, false, false, false));});</span>
<span class="line-added">2145         semaphore = new Semaphore(0);</span>
<span class="line-added">2146         Platform.runLater(semaphore::release);</span>
<span class="line-added">2147         semaphore.acquire();</span>
<span class="line-added">2148     }</span>
<span class="line-added">2149 </span>
2150     // TODO tests for Content firing event notification properly
2151 
2152     // TODO tests for Content not allowing illegal characters
2153 
2154     private void copy(String string) {
2155         ClipboardContent content = new ClipboardContent();
2156         content.putString(string);
2157         Clipboard.getSystemClipboard().setContent(content);
2158     }
2159 }
<a name="6" id="anc6"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="6" type="hidden" />
</body>
</html>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.controls/src/main/java/javafx/scene/control/skin/ColorPickerSkin.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (c) 2012, 2018, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package javafx.scene.control.skin;
 27 
 28 import com.sun.javafx.css.StyleManager;
 29 
 30 import com.sun.javafx.scene.control.Properties;
 31 import com.sun.javafx.scene.control.behavior.ComboBoxBaseBehavior;
 32 import com.sun.javafx.scene.control.skin.Utils;
 33 import javafx.beans.property.StringProperty;
 34 import javafx.css.StyleOrigin;
 35 import javafx.css.StyleableBooleanProperty;
 36 import javafx.css.CssMetaData;
 37 
 38 import javafx.css.converter.BooleanConverter;
 39 
 40 import java.util.ArrayList;
 41 import java.util.Collections;
 42 import java.util.List;
 43 
 44 import javafx.css.StyleableDoubleProperty;
 45 import javafx.css.StyleableStringProperty;
 46 import javafx.geometry.Pos;
 47 import javafx.scene.Node;
 48 import javafx.scene.control.Control;
 49 import javafx.scene.image.ImageView;
 50 import javafx.scene.layout.StackPane;
 51 import javafx.scene.shape.Rectangle;
 52 
 53 import javafx.css.converter.SizeConverter;
 54 import javafx.css.converter.StringConverter;
 55 import com.sun.javafx.scene.control.behavior.ColorPickerBehavior;
 56 
<a name="1" id="anc1"></a><span class="line-removed"> 57 import java.util.HashMap;</span>
 58 import java.util.Map;
 59 
 60 import javafx.scene.control.ColorPicker;
 61 import javafx.scene.control.TextField;
 62 import javafx.beans.property.BooleanProperty;
 63 import javafx.beans.value.WritableValue;
 64 import javafx.css.Styleable;
 65 import javafx.css.StyleableProperty;
 66 import javafx.scene.control.Label;
 67 import javafx.scene.paint.Color;
 68 
 69 import static javafx.scene.paint.Color.*;
 70 
 71 /**
 72  * Default skin implementation for the {@link ColorPicker} control.
 73  *
 74  * @see ColorPicker
 75  * @since 9
 76  */
 77 public class ColorPickerSkin extends ComboBoxPopupControl&lt;Color&gt; {
 78 
 79     /***************************************************************************
 80      *                                                                         *
 81      * Private fields                                                          *
 82      *                                                                         *
 83      **************************************************************************/
 84 
 85     private Label displayNode;
 86     private StackPane pickerColorBox;
 87     private Rectangle colorRect;
 88     private ColorPalette popupContent;
 89 
 90     private final ColorPickerBehavior behavior;
 91 
 92 
 93 
 94     /***************************************************************************
 95      *                                                                         *
 96      * Constructors                                                            *
 97      *                                                                         *
 98      **************************************************************************/
 99 
100     /**
101      * Creates a new ColorPickerSkin instance, installing the necessary child
102      * nodes into the Control {@link Control#getChildren() children} list, as
103      * well as the necessary input mappings for handling key, mouse, etc events.
104      *
105      * @param control The control that this skin should be installed onto.
106      */
107     public ColorPickerSkin(final ColorPicker control) {
108         super(control);
109 
110         // install default input map for the control
111         this.behavior = new ColorPickerBehavior(control);
112 //        control.setInputMap(behavior.getInputMap());
113 
114         updateComboBoxMode();
115         registerChangeListener(control.valueProperty(), e -&gt; updateColor());
116 
117         // create displayNode
118         displayNode = new Label();
119         displayNode.getStyleClass().add(&quot;color-picker-label&quot;);
120         displayNode.setManaged(false);
121 
122         // label graphic
123         pickerColorBox = new PickerColorBox();
124         pickerColorBox.getStyleClass().add(&quot;picker-color&quot;);
125         colorRect = new Rectangle(12, 12);
126         colorRect.getStyleClass().add(&quot;picker-color-rect&quot;);
127 
128         updateColor();
129 
130         pickerColorBox.getChildren().add(colorRect);
131         displayNode.setGraphic(pickerColorBox);
132 
133         if (control.isShowing()) {
134             show();
135         }
136     }
137 
138 
139 
140     /***************************************************************************
141      *                                                                         *
142      * Properties                                                              *
143      *                                                                         *
144      **************************************************************************/
145 
146     // --- color label visible
147     BooleanProperty colorLabelVisible = new StyleableBooleanProperty(true) {
148         @Override public void invalidated() {
149             if (displayNode != null) {
150                 if (colorLabelVisible.get()) {
151                     displayNode.setText(colorDisplayName(((ColorPicker)getSkinnable()).getValue()));
152                 } else {
153                     displayNode.setText(&quot;&quot;);
154                 }
155             }
156         }
157         @Override public Object getBean() {
158             return ColorPickerSkin.this;
159         }
160         @Override public String getName() {
161             return &quot;colorLabelVisible&quot;;
162         }
163         @Override public CssMetaData&lt;ColorPicker,Boolean&gt; getCssMetaData() {
164             return StyleableProperties.COLOR_LABEL_VISIBLE;
165         }
166     };
167 
168     // --- image url
169     private final StringProperty imageUrlProperty() { return imageUrl; }
170     private final StyleableStringProperty imageUrl = new StyleableStringProperty() {
171         @Override public void applyStyle(StyleOrigin origin, String v) {
172             super.applyStyle(origin, v);
173             if (v == null) {
174                 // remove old image view
175                 if (pickerColorBox.getChildren().size() == 2) pickerColorBox.getChildren().remove(1);
176             } else {
177                 if (pickerColorBox.getChildren().size() == 2) {
178                     ImageView imageView = (ImageView)pickerColorBox.getChildren().get(1);
179                     imageView.setImage(StyleManager.getInstance().getCachedImage(v));
180                 } else {
181                     pickerColorBox.getChildren().add(new ImageView(StyleManager.getInstance().getCachedImage(v)));
182                 }
183             }
184         }
185         @Override public Object getBean() {
186             return ColorPickerSkin.this;
187         }
188         @Override public String getName() {
189             return &quot;imageUrl&quot;;
190         }
191         @Override public CssMetaData&lt;ColorPicker,String&gt; getCssMetaData() {
192             return StyleableProperties.GRAPHIC;
193         }
194     };
195 
196     // --- color rect width
197     private final StyleableDoubleProperty colorRectWidth =  new StyleableDoubleProperty(12) {
198         @Override protected void invalidated() {
199             if(pickerColorBox!=null) pickerColorBox.requestLayout();
200         }
201         @Override public CssMetaData&lt;ColorPicker,Number&gt; getCssMetaData() {
202             return StyleableProperties.COLOR_RECT_WIDTH;
203         }
204         @Override public Object getBean() {
205             return ColorPickerSkin.this;
206         }
207         @Override public String getName() {
208             return &quot;colorRectWidth&quot;;
209         }
210     };
211 
212     // --- color rect height
213     private final StyleableDoubleProperty colorRectHeight =  new StyleableDoubleProperty(12) {
214         @Override protected void invalidated() {
215             if(pickerColorBox!=null) pickerColorBox.requestLayout();
216         }
217         @Override public CssMetaData&lt;ColorPicker,Number&gt; getCssMetaData() {
218             return StyleableProperties.COLOR_RECT_HEIGHT;
219         }
220         @Override public Object getBean() {
221             return ColorPickerSkin.this;
222         }
223         @Override public String getName() {
224             return &quot;colorRectHeight&quot;;
225         }
226     };
227 
228     // --- color rect X
229     private final StyleableDoubleProperty colorRectX =  new StyleableDoubleProperty(0) {
230         @Override protected void invalidated() {
231             if(pickerColorBox!=null) pickerColorBox.requestLayout();
232         }
233         @Override public CssMetaData&lt;ColorPicker,Number&gt; getCssMetaData() {
234             return StyleableProperties.COLOR_RECT_X;
235         }
236         @Override public Object getBean() {
237             return ColorPickerSkin.this;
238         }
239         @Override public String getName() {
240             return &quot;colorRectX&quot;;
241         }
242     };
243 
244     // --- color rect Y
245     private final StyleableDoubleProperty colorRectY =  new StyleableDoubleProperty(0) {
246         @Override protected void invalidated() {
247             if(pickerColorBox!=null) pickerColorBox.requestLayout();
248         }
249         @Override public CssMetaData&lt;ColorPicker,Number&gt; getCssMetaData() {
250             return StyleableProperties.COLOR_RECT_Y;
251         }
252         @Override public Object getBean() {
253             return ColorPickerSkin.this;
254         }
255         @Override public String getName() {
256             return &quot;colorRectY&quot;;
257         }
258     };
259 
260 
261 
262     /***************************************************************************
263      *                                                                         *
264      * Public API                                                              *
265      *                                                                         *
266      **************************************************************************/
267 
268     /** {@inheritDoc} */
269     @Override public void dispose() {
270         super.dispose();
271 
272         if (behavior != null) {
273             behavior.dispose();
274         }
275     }
276 
277     /** {@inheritDoc} */
278     @Override protected double computePrefWidth(double height, double topInset, double rightInset, double bottomInset, double leftInset) {
279         if (!colorLabelVisible.get()) {
280             return super.computePrefWidth(height, topInset, rightInset, bottomInset, leftInset);
281         }
282         String displayNodeText = displayNode.getText();
283         double width = 0;
<a name="2" id="anc2"></a><span class="line-modified">284         for (String name : colorNameMap.values()) {</span>
285             displayNode.setText(name);
286             width = Math.max(width, super.computePrefWidth(height, topInset, rightInset, bottomInset, leftInset));
287         }
288         displayNode.setText(Utils.formatHexString(Color.BLACK)); // #000000
289         width = Math.max(width, super.computePrefWidth(height, topInset, rightInset, bottomInset, leftInset));
290         displayNode.setText(displayNodeText);
291         return width;
292     }
293 
294     /** {@inheritDoc} */
295     @Override protected Node getPopupContent() {
296         if (popupContent == null) {
297 //            popupContent = new ColorPalette(colorPicker.getValue(), colorPicker);
298             popupContent = new ColorPalette((ColorPicker)getSkinnable());
299             popupContent.setPopupControl(getPopup());
300         }
301         return popupContent;
302     }
303 
304     /** {@inheritDoc} */
305     @Override public void show() {
306         super.show();
307         final ColorPicker colorPicker = (ColorPicker)getSkinnable();
308         popupContent.updateSelection(colorPicker.getValue());
309     }
310 
311     /** {@inheritDoc} */
312     @Override public Node getDisplayNode() {
313         return displayNode;
314     }
315 
316     /** {@inheritDoc} */
317     @Override protected void layoutChildren(final double x, final double y,
318                                             final double w, final double h) {
319         updateComboBoxMode();
320         super.layoutChildren(x, y, w, h);
321     }
322 
323 
324 
325     /***************************************************************************
326      *                                                                         *
327      * Private implementation                                                  *
328      *                                                                         *
329      **************************************************************************/
330 
331     /** {@inheritDoc} */
332     @Override void focusLost() {
333         // do nothing
334     }
335 
336     /** {@inheritDoc} */
337     @Override ComboBoxBaseBehavior getBehavior() {
338         return behavior;
339     }
340 
341     private void updateComboBoxMode() {
342         List&lt;String&gt; styleClass = getSkinnable().getStyleClass();
343         if (styleClass.contains(ColorPicker.STYLE_CLASS_BUTTON)) {
344             setMode(ComboBoxMode.BUTTON);
345         } else if (styleClass.contains(ColorPicker.STYLE_CLASS_SPLIT_BUTTON)) {
346             setMode(ComboBoxMode.SPLITBUTTON);
347         }
348     }
349 
<a name="3" id="anc3"></a><span class="line-modified">350     private static final Map&lt;Color, String&gt; colorNameMap = new HashMap&lt;&gt;(30);</span>
<span class="line-modified">351     private static final Map&lt;Color, String&gt; cssNameMap = new HashMap&lt;&gt;(139);</span>
<span class="line-modified">352     static {</span>
<span class="line-modified">353         // Translatable display names for the most common colors</span>
<span class="line-modified">354         colorNameMap.put(TRANSPARENT, Properties.getColorPickerString(&quot;colorName.transparent&quot;));</span>
<span class="line-modified">355         colorNameMap.put(BLACK,       Properties.getColorPickerString(&quot;colorName.black&quot;));</span>
<span class="line-modified">356         colorNameMap.put(BLUE,        Properties.getColorPickerString(&quot;colorName.blue&quot;));</span>
<span class="line-modified">357         colorNameMap.put(CYAN,        Properties.getColorPickerString(&quot;colorName.cyan&quot;));</span>
<span class="line-modified">358         colorNameMap.put(DARKBLUE,    Properties.getColorPickerString(&quot;colorName.darkblue&quot;));</span>
<span class="line-modified">359         colorNameMap.put(DARKCYAN,    Properties.getColorPickerString(&quot;colorName.darkcyan&quot;));</span>
<span class="line-modified">360         colorNameMap.put(DARKGRAY,    Properties.getColorPickerString(&quot;colorName.darkgray&quot;));</span>
<span class="line-modified">361         colorNameMap.put(DARKGREEN,   Properties.getColorPickerString(&quot;colorName.darkgreen&quot;));</span>
<span class="line-modified">362         colorNameMap.put(DARKMAGENTA, Properties.getColorPickerString(&quot;colorName.darkmagenta&quot;));</span>
<span class="line-modified">363         colorNameMap.put(DARKRED,     Properties.getColorPickerString(&quot;colorName.darkred&quot;));</span>
<span class="line-modified">364         colorNameMap.put(GRAY,        Properties.getColorPickerString(&quot;colorName.gray&quot;));</span>
<span class="line-modified">365         colorNameMap.put(GREEN,       Properties.getColorPickerString(&quot;colorName.green&quot;));</span>
<span class="line-modified">366         colorNameMap.put(LIGHTBLUE,   Properties.getColorPickerString(&quot;colorName.lightblue&quot;));</span>
<span class="line-modified">367         colorNameMap.put(LIGHTCYAN,   Properties.getColorPickerString(&quot;colorName.lightcyan&quot;));</span>
<span class="line-modified">368         colorNameMap.put(LIGHTGRAY,   Properties.getColorPickerString(&quot;colorName.lightgray&quot;));</span>
<span class="line-modified">369         colorNameMap.put(LIGHTGREEN,  Properties.getColorPickerString(&quot;colorName.lightgreen&quot;));</span>
<span class="line-modified">370         colorNameMap.put(LIGHTYELLOW, Properties.getColorPickerString(&quot;colorName.lightyellow&quot;));</span>
<span class="line-modified">371         colorNameMap.put(LIME,        Properties.getColorPickerString(&quot;colorName.lime&quot;));</span>
<span class="line-modified">372         colorNameMap.put(MAGENTA,     Properties.getColorPickerString(&quot;colorName.magenta&quot;));</span>
<span class="line-modified">373         colorNameMap.put(MAROON,      Properties.getColorPickerString(&quot;colorName.maroon&quot;));</span>
<span class="line-modified">374         colorNameMap.put(MEDIUMBLUE,  Properties.getColorPickerString(&quot;colorName.mediumblue&quot;));</span>
<span class="line-modified">375         colorNameMap.put(NAVY,        Properties.getColorPickerString(&quot;colorName.navy&quot;));</span>
<span class="line-modified">376         colorNameMap.put(OLIVE,       Properties.getColorPickerString(&quot;colorName.olive&quot;));</span>
<span class="line-modified">377         colorNameMap.put(ORANGE,      Properties.getColorPickerString(&quot;colorName.orange&quot;));</span>
<span class="line-modified">378         colorNameMap.put(PINK,        Properties.getColorPickerString(&quot;colorName.pink&quot;));</span>
<span class="line-modified">379         colorNameMap.put(PURPLE,      Properties.getColorPickerString(&quot;colorName.purple&quot;));</span>
<span class="line-modified">380         colorNameMap.put(RED,         Properties.getColorPickerString(&quot;colorName.red&quot;));</span>
<span class="line-modified">381         colorNameMap.put(TEAL,        Properties.getColorPickerString(&quot;colorName.teal&quot;));</span>
<span class="line-modified">382         colorNameMap.put(WHITE,       Properties.getColorPickerString(&quot;colorName.white&quot;));</span>
<span class="line-modified">383         colorNameMap.put(YELLOW,      Properties.getColorPickerString(&quot;colorName.yellow&quot;));</span>
<span class="line-modified">384 </span>
<span class="line-modified">385         // CSS names.</span>
<span class="line-modified">386         // Note that synonyms (such as &quot;grey&quot;) have been removed here,</span>
<span class="line-modified">387         // since a color can be presented with only one name in this</span>
<span class="line-modified">388         // skin. If a reverse map is created for parsing names in the</span>
<span class="line-modified">389         // future, then the synonyms should be included there. For a</span>
<span class="line-modified">390         // full list of CSS names, see Color.java.</span>
<span class="line-modified">391         cssNameMap.put(ALICEBLUE,            &quot;aliceblue&quot;);</span>
<span class="line-modified">392         cssNameMap.put(ANTIQUEWHITE,         &quot;antiquewhite&quot;);</span>
<span class="line-modified">393         cssNameMap.put(AQUAMARINE,           &quot;aquamarine&quot;);</span>
<span class="line-modified">394         cssNameMap.put(AZURE,                &quot;azure&quot;);</span>
<span class="line-modified">395         cssNameMap.put(BEIGE,                &quot;beige&quot;);</span>
<span class="line-modified">396         cssNameMap.put(BISQUE,               &quot;bisque&quot;);</span>
<span class="line-modified">397         cssNameMap.put(BLACK,                &quot;black&quot;);</span>
<span class="line-modified">398         cssNameMap.put(BLANCHEDALMOND,       &quot;blanchedalmond&quot;);</span>
<span class="line-modified">399         cssNameMap.put(BLUE,                 &quot;blue&quot;);</span>
<span class="line-modified">400         cssNameMap.put(BLUEVIOLET,           &quot;blueviolet&quot;);</span>
<span class="line-modified">401         cssNameMap.put(BROWN,                &quot;brown&quot;);</span>
<span class="line-modified">402         cssNameMap.put(BURLYWOOD,            &quot;burlywood&quot;);</span>
<span class="line-modified">403         cssNameMap.put(CADETBLUE,            &quot;cadetblue&quot;);</span>
<span class="line-modified">404         cssNameMap.put(CHARTREUSE,           &quot;chartreuse&quot;);</span>
<span class="line-modified">405         cssNameMap.put(CHOCOLATE,            &quot;chocolate&quot;);</span>
<span class="line-modified">406         cssNameMap.put(CORAL,                &quot;coral&quot;);</span>
<span class="line-modified">407         cssNameMap.put(CORNFLOWERBLUE,       &quot;cornflowerblue&quot;);</span>
<span class="line-modified">408         cssNameMap.put(CORNSILK,             &quot;cornsilk&quot;);</span>
<span class="line-modified">409         cssNameMap.put(CRIMSON,              &quot;crimson&quot;);</span>
<span class="line-modified">410         cssNameMap.put(CYAN,                 &quot;cyan&quot;);</span>
<span class="line-modified">411         cssNameMap.put(DARKBLUE,             &quot;darkblue&quot;);</span>
<span class="line-modified">412         cssNameMap.put(DARKCYAN,             &quot;darkcyan&quot;);</span>
<span class="line-modified">413         cssNameMap.put(DARKGOLDENROD,        &quot;darkgoldenrod&quot;);</span>
<span class="line-modified">414         cssNameMap.put(DARKGRAY,             &quot;darkgray&quot;);</span>
<span class="line-modified">415         cssNameMap.put(DARKGREEN,            &quot;darkgreen&quot;);</span>
<span class="line-modified">416         cssNameMap.put(DARKKHAKI,            &quot;darkkhaki&quot;);</span>
<span class="line-modified">417         cssNameMap.put(DARKMAGENTA,          &quot;darkmagenta&quot;);</span>
<span class="line-modified">418         cssNameMap.put(DARKOLIVEGREEN,       &quot;darkolivegreen&quot;);</span>
<span class="line-modified">419         cssNameMap.put(DARKORANGE,           &quot;darkorange&quot;);</span>
<span class="line-modified">420         cssNameMap.put(DARKORCHID,           &quot;darkorchid&quot;);</span>
<span class="line-modified">421         cssNameMap.put(DARKRED,              &quot;darkred&quot;);</span>
<span class="line-modified">422         cssNameMap.put(DARKSALMON,           &quot;darksalmon&quot;);</span>
<span class="line-modified">423         cssNameMap.put(DARKSEAGREEN,         &quot;darkseagreen&quot;);</span>
<span class="line-modified">424         cssNameMap.put(DARKSLATEBLUE,        &quot;darkslateblue&quot;);</span>
<span class="line-modified">425         cssNameMap.put(DARKSLATEGRAY,        &quot;darkslategray&quot;);</span>
<span class="line-modified">426         cssNameMap.put(DARKTURQUOISE,        &quot;darkturquoise&quot;);</span>
<span class="line-modified">427         cssNameMap.put(DARKVIOLET,           &quot;darkviolet&quot;);</span>
<span class="line-modified">428         cssNameMap.put(DEEPPINK,             &quot;deeppink&quot;);</span>
<span class="line-modified">429         cssNameMap.put(DEEPSKYBLUE,          &quot;deepskyblue&quot;);</span>
<span class="line-modified">430         cssNameMap.put(DIMGRAY,              &quot;dimgray&quot;);</span>
<span class="line-modified">431         cssNameMap.put(DODGERBLUE,           &quot;dodgerblue&quot;);</span>
<span class="line-modified">432         cssNameMap.put(FIREBRICK,            &quot;firebrick&quot;);</span>
<span class="line-modified">433         cssNameMap.put(FLORALWHITE,          &quot;floralwhite&quot;);</span>
<span class="line-modified">434         cssNameMap.put(FORESTGREEN,          &quot;forestgreen&quot;);</span>
<span class="line-modified">435         cssNameMap.put(GAINSBORO,            &quot;gainsboro&quot;);</span>
<span class="line-modified">436         cssNameMap.put(GHOSTWHITE,           &quot;ghostwhite&quot;);</span>
<span class="line-modified">437         cssNameMap.put(GOLD,                 &quot;gold&quot;);</span>
<span class="line-modified">438         cssNameMap.put(GOLDENROD,            &quot;goldenrod&quot;);</span>
<span class="line-modified">439         cssNameMap.put(GRAY,                 &quot;gray&quot;);</span>
<span class="line-modified">440         cssNameMap.put(GREEN,                &quot;green&quot;);</span>
<span class="line-modified">441         cssNameMap.put(GREENYELLOW,          &quot;greenyellow&quot;);</span>
<span class="line-modified">442         cssNameMap.put(HONEYDEW,             &quot;honeydew&quot;);</span>
<span class="line-modified">443         cssNameMap.put(HOTPINK,              &quot;hotpink&quot;);</span>
<span class="line-modified">444         cssNameMap.put(INDIANRED,            &quot;indianred&quot;);</span>
<span class="line-modified">445         cssNameMap.put(INDIGO,               &quot;indigo&quot;);</span>
<span class="line-modified">446         cssNameMap.put(IVORY,                &quot;ivory&quot;);</span>
<span class="line-modified">447         cssNameMap.put(KHAKI,                &quot;khaki&quot;);</span>
<span class="line-modified">448         cssNameMap.put(LAVENDER,             &quot;lavender&quot;);</span>
<span class="line-modified">449         cssNameMap.put(LAVENDERBLUSH,        &quot;lavenderblush&quot;);</span>
<span class="line-modified">450         cssNameMap.put(LAWNGREEN,            &quot;lawngreen&quot;);</span>
<span class="line-modified">451         cssNameMap.put(LEMONCHIFFON,         &quot;lemonchiffon&quot;);</span>
<span class="line-modified">452         cssNameMap.put(LIGHTBLUE,            &quot;lightblue&quot;);</span>
<span class="line-modified">453         cssNameMap.put(LIGHTCORAL,           &quot;lightcoral&quot;);</span>
<span class="line-modified">454         cssNameMap.put(LIGHTCYAN,            &quot;lightcyan&quot;);</span>
<span class="line-modified">455         cssNameMap.put(LIGHTGOLDENRODYELLOW, &quot;lightgoldenrodyellow&quot;);</span>
<span class="line-modified">456         cssNameMap.put(LIGHTGRAY,            &quot;lightgray&quot;);</span>
<span class="line-modified">457         cssNameMap.put(LIGHTGREEN,           &quot;lightgreen&quot;);</span>
<span class="line-modified">458         cssNameMap.put(LIGHTPINK,            &quot;lightpink&quot;);</span>
<span class="line-modified">459         cssNameMap.put(LIGHTSALMON,          &quot;lightsalmon&quot;);</span>
<span class="line-modified">460         cssNameMap.put(LIGHTSEAGREEN,        &quot;lightseagreen&quot;);</span>
<span class="line-modified">461         cssNameMap.put(LIGHTSKYBLUE,         &quot;lightskyblue&quot;);</span>
<span class="line-modified">462         cssNameMap.put(LIGHTSLATEGRAY,       &quot;lightslategray&quot;);</span>
<span class="line-modified">463         cssNameMap.put(LIGHTSTEELBLUE,       &quot;lightsteelblue&quot;);</span>
<span class="line-modified">464         cssNameMap.put(LIGHTYELLOW,          &quot;lightyellow&quot;);</span>
<span class="line-modified">465         cssNameMap.put(LIME,                 &quot;lime&quot;);</span>
<span class="line-modified">466         cssNameMap.put(LIMEGREEN,            &quot;limegreen&quot;);</span>
<span class="line-modified">467         cssNameMap.put(LINEN,                &quot;linen&quot;);</span>
<span class="line-modified">468         cssNameMap.put(MAGENTA,              &quot;magenta&quot;);</span>
<span class="line-modified">469         cssNameMap.put(MAROON,               &quot;maroon&quot;);</span>
<span class="line-modified">470         cssNameMap.put(MEDIUMAQUAMARINE,     &quot;mediumaquamarine&quot;);</span>
<span class="line-modified">471         cssNameMap.put(MEDIUMBLUE,           &quot;mediumblue&quot;);</span>
<span class="line-modified">472         cssNameMap.put(MEDIUMORCHID,         &quot;mediumorchid&quot;);</span>
<span class="line-modified">473         cssNameMap.put(MEDIUMPURPLE,         &quot;mediumpurple&quot;);</span>
<span class="line-modified">474         cssNameMap.put(MEDIUMSEAGREEN,       &quot;mediumseagreen&quot;);</span>
<span class="line-modified">475         cssNameMap.put(MEDIUMSLATEBLUE,      &quot;mediumslateblue&quot;);</span>
<span class="line-modified">476         cssNameMap.put(MEDIUMSPRINGGREEN,    &quot;mediumspringgreen&quot;);</span>
<span class="line-modified">477         cssNameMap.put(MEDIUMTURQUOISE,      &quot;mediumturquoise&quot;);</span>
<span class="line-modified">478         cssNameMap.put(MEDIUMVIOLETRED,      &quot;mediumvioletred&quot;);</span>
<span class="line-modified">479         cssNameMap.put(MIDNIGHTBLUE,         &quot;midnightblue&quot;);</span>
<span class="line-modified">480         cssNameMap.put(MINTCREAM,            &quot;mintcream&quot;);</span>
<span class="line-modified">481         cssNameMap.put(MISTYROSE,            &quot;mistyrose&quot;);</span>
<span class="line-modified">482         cssNameMap.put(MOCCASIN,             &quot;moccasin&quot;);</span>
<span class="line-modified">483         cssNameMap.put(NAVAJOWHITE,          &quot;navajowhite&quot;);</span>
<span class="line-modified">484         cssNameMap.put(NAVY,                 &quot;navy&quot;);</span>
<span class="line-modified">485         cssNameMap.put(OLDLACE,              &quot;oldlace&quot;);</span>
<span class="line-modified">486         cssNameMap.put(OLIVE,                &quot;olive&quot;);</span>
<span class="line-modified">487         cssNameMap.put(OLIVEDRAB,            &quot;olivedrab&quot;);</span>
<span class="line-modified">488         cssNameMap.put(ORANGE,               &quot;orange&quot;);</span>
<span class="line-modified">489         cssNameMap.put(ORANGERED,            &quot;orangered&quot;);</span>
<span class="line-modified">490         cssNameMap.put(ORCHID,               &quot;orchid&quot;);</span>
<span class="line-modified">491         cssNameMap.put(PALEGOLDENROD,        &quot;palegoldenrod&quot;);</span>
<span class="line-modified">492         cssNameMap.put(PALEGREEN,            &quot;palegreen&quot;);</span>
<span class="line-modified">493         cssNameMap.put(PALETURQUOISE,        &quot;paleturquoise&quot;);</span>
<span class="line-modified">494         cssNameMap.put(PALEVIOLETRED,        &quot;palevioletred&quot;);</span>
<span class="line-modified">495         cssNameMap.put(PAPAYAWHIP,           &quot;papayawhip&quot;);</span>
<span class="line-modified">496         cssNameMap.put(PEACHPUFF,            &quot;peachpuff&quot;);</span>
<span class="line-modified">497         cssNameMap.put(PERU,                 &quot;peru&quot;);</span>
<span class="line-modified">498         cssNameMap.put(PINK,                 &quot;pink&quot;);</span>
<span class="line-modified">499         cssNameMap.put(PLUM,                 &quot;plum&quot;);</span>
<span class="line-modified">500         cssNameMap.put(POWDERBLUE,           &quot;powderblue&quot;);</span>
<span class="line-modified">501         cssNameMap.put(PURPLE,               &quot;purple&quot;);</span>
<span class="line-modified">502         cssNameMap.put(RED,                  &quot;red&quot;);</span>
<span class="line-modified">503         cssNameMap.put(ROSYBROWN,            &quot;rosybrown&quot;);</span>
<span class="line-modified">504         cssNameMap.put(ROYALBLUE,            &quot;royalblue&quot;);</span>
<span class="line-modified">505         cssNameMap.put(SADDLEBROWN,          &quot;saddlebrown&quot;);</span>
<span class="line-modified">506         cssNameMap.put(SALMON,               &quot;salmon&quot;);</span>
<span class="line-modified">507         cssNameMap.put(SANDYBROWN,           &quot;sandybrown&quot;);</span>
<span class="line-modified">508         cssNameMap.put(SEAGREEN,             &quot;seagreen&quot;);</span>
<span class="line-modified">509         cssNameMap.put(SEASHELL,             &quot;seashell&quot;);</span>
<span class="line-modified">510         cssNameMap.put(SIENNA,               &quot;sienna&quot;);</span>
<span class="line-modified">511         cssNameMap.put(SILVER,               &quot;silver&quot;);</span>
<span class="line-modified">512         cssNameMap.put(SKYBLUE,              &quot;skyblue&quot;);</span>
<span class="line-modified">513         cssNameMap.put(SLATEBLUE,            &quot;slateblue&quot;);</span>
<span class="line-modified">514         cssNameMap.put(SLATEGRAY,            &quot;slategray&quot;);</span>
<span class="line-modified">515         cssNameMap.put(SNOW,                 &quot;snow&quot;);</span>
<span class="line-modified">516         cssNameMap.put(SPRINGGREEN,          &quot;springgreen&quot;);</span>
<span class="line-modified">517         cssNameMap.put(STEELBLUE,            &quot;steelblue&quot;);</span>
<span class="line-modified">518         cssNameMap.put(TAN,                  &quot;tan&quot;);</span>
<span class="line-modified">519         cssNameMap.put(TEAL,                 &quot;teal&quot;);</span>
<span class="line-modified">520         cssNameMap.put(THISTLE,              &quot;thistle&quot;);</span>
<span class="line-modified">521         cssNameMap.put(TOMATO,               &quot;tomato&quot;);</span>
<span class="line-modified">522         cssNameMap.put(TRANSPARENT,          &quot;transparent&quot;);</span>
<span class="line-modified">523         cssNameMap.put(TURQUOISE,            &quot;turquoise&quot;);</span>
<span class="line-modified">524         cssNameMap.put(VIOLET,               &quot;violet&quot;);</span>
<span class="line-modified">525         cssNameMap.put(WHEAT,                &quot;wheat&quot;);</span>
<span class="line-modified">526         cssNameMap.put(WHITE,                &quot;white&quot;);</span>
<span class="line-modified">527         cssNameMap.put(WHITESMOKE,           &quot;whitesmoke&quot;);</span>
<span class="line-modified">528         cssNameMap.put(YELLOW,               &quot;yellow&quot;);</span>
<span class="line-removed">529         cssNameMap.put(YELLOWGREEN,          &quot;yellowgreen&quot;);</span>
<span class="line-removed">530     }</span>
531 
532     static String colorDisplayName(Color c) {
533         if (c != null) {
<a name="4" id="anc4"></a><span class="line-modified">534             String displayName = colorNameMap.get(c);</span>
535             if (displayName == null) {
536                 displayName = Utils.formatHexString(c);
537             }
538             return displayName;
539         } else {
540             return null;
541         }
542     }
543 
544     static String tooltipString(Color c) {
545         if (c != null) {
546             String tooltipStr = &quot;&quot;;
<a name="5" id="anc5"></a><span class="line-modified">547             String displayName = colorNameMap.get(c);</span>
548             if (displayName != null) {
549                 tooltipStr += displayName + &quot; &quot;;
550             }
551 
552             tooltipStr += Utils.formatHexString(c);
553 
<a name="6" id="anc6"></a><span class="line-modified">554             String cssName = cssNameMap.get(c);</span>
555             if (cssName != null) {
556                 tooltipStr += &quot; (css: &quot; + cssName + &quot;)&quot;;
557             }
558             return tooltipStr;
559         } else {
560             return null;
561         }
562     }
563 
564     private void updateColor() {
565         final ColorPicker colorPicker = (ColorPicker)getSkinnable();
566         colorRect.setFill(colorPicker.getValue());
567         if (colorLabelVisible.get()) {
568             displayNode.setText(colorDisplayName(colorPicker.getValue()));
569         } else {
570             displayNode.setText(&quot;&quot;);
571         }
572     }
573 
574 
575 
576     /***************************************************************************
577     *                                                                         *
578     *                         picker-color-cell                               *
579     *                                                                         *
580     **************************************************************************/
581 
582     private class PickerColorBox extends StackPane {
583         @Override protected void layoutChildren() {
584             final double top = snappedTopInset();
585             final double left = snappedLeftInset();
586             final double width = getWidth();
587             final double height = getHeight();
588             final double right = snappedRightInset();
589             final double bottom = snappedBottomInset();
590             colorRect.setX(snapPosition(colorRectX.get()));
591             colorRect.setY(snapPosition(colorRectY.get()));
592             colorRect.setWidth(snapSize(colorRectWidth.get()));
593             colorRect.setHeight(snapSize(colorRectHeight.get()));
594             if (getChildren().size() == 2) {
595                 final ImageView icon = (ImageView) getChildren().get(1);
596                 Pos childAlignment = StackPane.getAlignment(icon);
597                 layoutInArea(icon, left, top,
598                              width - left - right, height - top - bottom,
599                              0, getMargin(icon),
600                              childAlignment != null? childAlignment.getHpos() : getAlignment().getHpos(),
601                              childAlignment != null? childAlignment.getVpos() : getAlignment().getVpos());
602                 colorRect.setLayoutX(icon.getLayoutX());
603                 colorRect.setLayoutY(icon.getLayoutY());
604             } else {
605                 Pos childAlignment = StackPane.getAlignment(colorRect);
606                 layoutInArea(colorRect, left, top,
607                              width - left - right, height - top - bottom,
608                              0, getMargin(colorRect),
609                              childAlignment != null? childAlignment.getHpos() : getAlignment().getHpos(),
610                              childAlignment != null? childAlignment.getVpos() : getAlignment().getVpos());
611             }
612         }
613     }
614 
615     /***************************************************************************
616     *                                                                         *
617     *                         Stylesheet Handling                             *
618     *                                                                         *
619     **************************************************************************/
620 
621      private static class StyleableProperties {
622         private static final CssMetaData&lt;ColorPicker,Boolean&gt; COLOR_LABEL_VISIBLE =
623                 new CssMetaData&lt;ColorPicker,Boolean&gt;(&quot;-fx-color-label-visible&quot;,
624                 BooleanConverter.getInstance(), Boolean.TRUE) {
625 
626             @Override public boolean isSettable(ColorPicker n) {
627                 final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
628                 return skin.colorLabelVisible == null || !skin.colorLabelVisible.isBound();
629             }
630 
631             @Override public StyleableProperty&lt;Boolean&gt; getStyleableProperty(ColorPicker n) {
632                 final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
633                 return (StyleableProperty&lt;Boolean&gt;)(WritableValue&lt;Boolean&gt;)skin.colorLabelVisible;
634             }
635         };
636         private static final CssMetaData&lt;ColorPicker,Number&gt; COLOR_RECT_WIDTH =
637                 new CssMetaData&lt;ColorPicker,Number&gt;(&quot;-fx-color-rect-width&quot;, SizeConverter.getInstance(), 12d) {
638                     @Override public boolean isSettable(ColorPicker n) {
639                         final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
640                         return !skin.colorRectWidth.isBound();
641                     }
642                     @Override public StyleableProperty&lt;Number&gt; getStyleableProperty(ColorPicker n) {
643                         final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
644                         return skin.colorRectWidth;
645                     }
646                 };
647         private static final CssMetaData&lt;ColorPicker,Number&gt; COLOR_RECT_HEIGHT =
648                 new CssMetaData&lt;ColorPicker,Number&gt;(&quot;-fx-color-rect-height&quot;, SizeConverter.getInstance(), 12d) {
649                     @Override public boolean isSettable(ColorPicker n) {
650                         final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
651                         return !skin.colorRectHeight.isBound();
652                     }
653                     @Override public StyleableProperty&lt;Number&gt; getStyleableProperty(ColorPicker n) {
654                         final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
655                         return skin.colorRectHeight;
656                     }
657                 };
658         private static final CssMetaData&lt;ColorPicker,Number&gt; COLOR_RECT_X =
659                 new CssMetaData&lt;ColorPicker,Number&gt;(&quot;-fx-color-rect-x&quot;, SizeConverter.getInstance(), 0) {
660                     @Override public boolean isSettable(ColorPicker n) {
661                         final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
662                         return !skin.colorRectX.isBound();
663                     }
664                     @Override public StyleableProperty&lt;Number&gt; getStyleableProperty(ColorPicker n) {
665                         final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
666                         return skin.colorRectX;
667                     }
668                 };
669         private static final CssMetaData&lt;ColorPicker,Number&gt; COLOR_RECT_Y =
670                 new CssMetaData&lt;ColorPicker,Number&gt;(&quot;-fx-color-rect-y&quot;, SizeConverter.getInstance(), 0) {
671                     @Override public boolean isSettable(ColorPicker n) {
672                         final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
673                         return !skin.colorRectY.isBound();
674                     }
675                     @Override public StyleableProperty&lt;Number&gt; getStyleableProperty(ColorPicker n) {
676                         final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
677                         return skin.colorRectY;
678                     }
679                 };
680         private static final CssMetaData&lt;ColorPicker,String&gt; GRAPHIC =
681             new CssMetaData&lt;ColorPicker,String&gt;(&quot;-fx-graphic&quot;, StringConverter.getInstance()) {
682                 @Override public boolean isSettable(ColorPicker n) {
683                     final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
684                     return !skin.imageUrl.isBound();
685                 }
686                 @Override public StyleableProperty&lt;String&gt; getStyleableProperty(ColorPicker n) {
687                     final ColorPickerSkin skin = (ColorPickerSkin) n.getSkin();
688                     return skin.imageUrl;
689                 }
690             };
691         private static final List&lt;CssMetaData&lt;? extends Styleable, ?&gt;&gt; STYLEABLES;
692         static {
693             final List&lt;CssMetaData&lt;? extends Styleable, ?&gt;&gt; styleables =
694                 new ArrayList&lt;CssMetaData&lt;? extends Styleable, ?&gt;&gt;(ComboBoxBaseSkin.getClassCssMetaData());
695             styleables.add(COLOR_LABEL_VISIBLE);
696             styleables.add(COLOR_RECT_WIDTH);
697             styleables.add(COLOR_RECT_HEIGHT);
698             styleables.add(COLOR_RECT_X);
699             styleables.add(COLOR_RECT_Y);
700             styleables.add(GRAPHIC);
701             STYLEABLES = Collections.unmodifiableList(styleables);
702         }
703     }
704 
705     /**
706      * Returns the CssMetaData associated with this class, which may include the
707      * CssMetaData of its superclasses.
708      * @return the CssMetaData associated with this class, which may include the
709      * CssMetaData of its superclasses
710      */
711     public static List&lt;CssMetaData&lt;? extends Styleable, ?&gt;&gt; getClassCssMetaData() {
712         return StyleableProperties.STYLEABLES;
713     }
714 
715     /**
716      * {@inheritDoc}
717      */
718     @Override
719     public List&lt;CssMetaData&lt;? extends Styleable, ?&gt;&gt; getCssMetaData() {
720         return getClassCssMetaData();
721     }
722 
723     /** {@inheritDoc} */
724     @Override protected javafx.util.StringConverter&lt;Color&gt; getConverter() {
725         return null;
726     }
727 
728     /**
729      * ColorPicker does not use a main text field, so this method has been
730      * overridden to return null.
731      */
732     @Override protected TextField getEditor() {
733         return null;
734     }
735 }
<a name="7" id="anc7"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="7" type="hidden" />
</body>
</html>
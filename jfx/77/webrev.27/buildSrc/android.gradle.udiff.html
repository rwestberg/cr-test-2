<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff buildSrc/android.gradle</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center><a href="../build.properties.udiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="../modules/javafx.base/src/test/java/test/com/sun/javafx/runtime/VersionInfoTest.java.udiff.html" target="_top">next &gt;</a></center>    <h2>buildSrc/android.gradle</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2013, 2018, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2013, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -21,154 +21,39 @@</span>
   * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
   * or visit www.oracle.com if you need additional information or have any
   * questions.
   */
  
<span class="udiff-line-removed">- /**</span>
<span class="udiff-line-removed">-  * Gets the most recent android platform installed, relative to the given path.</span>
<span class="udiff-line-removed">-  * The path will either be ANDROID_SDK or ANDROID_NDK</span>
<span class="udiff-line-removed">-  * TODO Shouldn&#39;t we instead just ask people to point to the one they want to use?</span>
<span class="udiff-line-removed">-  *</span>
<span class="udiff-line-removed">-  * @param path The path to the Android SDK or NDK</span>
<span class="udiff-line-removed">-  * @return The name of the most recent platform</span>
<span class="udiff-line-removed">-  */</span>
<span class="udiff-line-removed">- String getLatestPlatform(String path) {</span>
<span class="udiff-line-removed">-     def max = 0</span>
<span class="udiff-line-removed">-     file(cygpath(&quot;$path/platforms&quot;)).eachFile() {file-&gt;</span>
<span class="udiff-line-removed">-         def pname = file.getName() - &quot;android-&quot;</span>
<span class="udiff-line-removed">-         def ptf = pname?.isInteger() ? pname.toInteger() : 0</span>
<span class="udiff-line-removed">-         if (max &lt; ptf) {</span>
<span class="udiff-line-removed">-             max = ptf</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">-     if (max == 0) {</span>
<span class="udiff-line-removed">-         return null;</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">-     return &quot;android-&quot; + max</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- int compareVersions(String s1, String s2) {</span>
<span class="udiff-line-removed">-     def v1t = s1.tokenize(&quot;.&quot;)</span>
<span class="udiff-line-removed">-     def v2t = s2.tokenize(&quot;.&quot;)</span>
<span class="udiff-line-removed">-     for(int i = 0; i &lt; v1t.size(); i++) {</span>
<span class="udiff-line-removed">-         if (i == v2t.size()) {</span>
<span class="udiff-line-removed">-             return 1</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-         int n1 = v1t[i].isInteger() ? v1t[i].toInteger() : 0</span>
<span class="udiff-line-removed">-         int n2 = v2t[i].isInteger() ? v2t[i].toInteger() : 0</span>
<span class="udiff-line-removed">-         if (n1 == n2) {</span>
<span class="udiff-line-removed">-             continue</span>
<span class="udiff-line-removed">-         } else if (n1 &gt; n2) {</span>
<span class="udiff-line-removed">-             return 1;</span>
<span class="udiff-line-removed">-         } else {</span>
<span class="udiff-line-removed">-             return -1</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">-     return (v2t.size() &gt; v1t.size()) ? -1 : 0</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- String getLatestToolchain(String ndk, String tch) {</span>
<span class="udiff-line-removed">-     def max = &quot;0.0&quot;</span>
<span class="udiff-line-removed">-     def matchFile = null</span>
<span class="udiff-line-removed">-     file(cygpath(&quot;$ndk/toolchains&quot;)).eachFile() {file-&gt;</span>
<span class="udiff-line-removed">-         def filename = file.getName()</span>
<span class="udiff-line-removed">-         if (filename.startsWith(tch)) {</span>
<span class="udiff-line-removed">-             def p = filename - &quot;$tch-&quot;</span>
<span class="udiff-line-removed">-             if (compareVersions(p, max) &gt; 0) {</span>
<span class="udiff-line-removed">-                 max = p</span>
<span class="udiff-line-removed">-                 matchFile = file</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">-     return matchFile.getAbsolutePath()</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- boolean assertDir(File dir) {</span>
<span class="udiff-line-removed">-     return dir != null &amp;&amp; dir.exists() &amp;&amp; dir.isDirectory() &amp;&amp; dir.canRead();</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- boolean assertDir(String dir) {</span>
<span class="udiff-line-removed">-     return assertDir(file(dir))</span>
<span class="udiff-line-removed">- }</span>
  
  def closedDir = file(&quot;$projectDir/../rt-closed&quot;)
<span class="udiff-line-added">+ def sdk = project.hasProperty(&quot;ANDROID_SDK&quot;) ? &quot;${ANDROID_SDK}&quot; : &quot;/opt/android-sdk&quot;;</span>
<span class="udiff-line-added">+ def ndk = project.hasProperty(&quot;ANDROID_NDK&quot;) ? &quot;${ANDROID_NDK}&quot; : &quot;/opt/android-ndk&quot;;</span>
<span class="udiff-line-added">+ def sdk_target = &quot;android-25&quot;</span>
<span class="udiff-line-added">+ def ndk_target=&quot;android-21&quot;</span>
<span class="udiff-line-added">+ def platform=&quot;aarch64-linux-android21&quot;</span>
  
<span class="udiff-line-removed">- def toolchainArchs = [&quot;arm-linux-androideabi&quot;, &quot;mipsel-linux-android&quot;, &quot;x86&quot;]</span>
<span class="udiff-line-removed">- def armArchs = [&quot;armeabi&quot;, &quot;armeabiv-7a&quot;]</span>
  
<span class="udiff-line-modified-removed">- ANDROID = [:]</span>
<span class="udiff-line-modified-added">+ ext.ANDROID = [:]</span>
  ANDROID.compileSwing = false;
  ANDROID.compileSWT = false;
<span class="udiff-line-added">+ ANDROID.compileDesignTime = false;</span>
  ANDROID.glassPlatform = &quot;android&quot;
<span class="udiff-line-modified-removed">- ANDROID.armArch = armArchs[0]</span>
<span class="udiff-line-modified-added">+ ANDROID.armArch = &quot;arm64-v8a&quot;</span>
  ANDROID.libDest = &quot;lib&quot;
  ANDROID.jfxdvklib = &quot;jfxdvk.jar&quot;
<span class="udiff-line-modified-removed">- ANDROID.library = { name -&gt; return &quot;lib${name}.so&quot; as String }</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">- def sdk = project.hasProperty(&quot;ANDROID_SDK&quot;) ? &quot;${ANDROID_SDK}&quot; : null;</span>
<span class="udiff-line-modified-removed">- def ndk = project.hasProperty(&quot;ANDROID_NDK&quot;) ? &quot;${ANDROID_NDK}&quot; : null;</span>
<span class="udiff-line-removed">- ANDROID.canBuild = sdk != null &amp;&amp; ndk != null</span>
<span class="udiff-line-removed">- if (!ANDROID.canBuild) {</span>
<span class="udiff-line-removed">-     fail(&quot;Can&#39;t build Android. Path to SDK or NDK was not set or is invalid!&quot;)</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- ANDROID.canBuild = assertDir(sdk) &amp;&amp; assertDir(ndk)</span>
<span class="udiff-line-removed">- if (!ANDROID.canBuild) {</span>
<span class="udiff-line-removed">-     if (!assertDir(sdk)) {</span>
<span class="udiff-line-removed">-         logger.error(&quot;Path to ANDROID_SDK is invalid! [$sdk]&quot;)</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">-     if (!assertDir(ndk)) {</span>
<span class="udiff-line-removed">-         logger.error(&quot;Path to ANDROID_NDK is invalid! [$ndk]&quot;)</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-removed">-     fail(&quot;Cannot build, missing android tools&quot;)</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- def sdk_target = project.hasProperty(&quot;ANDROID_SDK_TARGET&quot;) ?  &quot;${ANDROID_SDK_TARGET}&quot; : getLatestPlatform(sdk);</span>
<span class="udiff-line-removed">- if (!assertDir(file(&quot;$sdk/platforms/$sdk_target&quot;))) {</span>
<span class="udiff-line-removed">-     sdk_target = getLatestPlatform(sdk);</span>
<span class="udiff-line-removed">-     logger.warn(&quot;Redefine ANDROID_SDK_TARGET to: [$sdk_target]&quot;)</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- def ndk_target = project.hasProperty(&quot;ANDROID_NDK_TARGET&quot;) ? &quot;${ANDROID_NDK_TARGET}&quot; : getLatestPlatform(ndk);</span>
<span class="udiff-line-removed">- if (!assertDir(file(&quot;$ndk/platforms/$ndk_target&quot;))) {</span>
<span class="udiff-line-removed">-     ndk_target = getLatestPlatform(ndk);</span>
<span class="udiff-line-removed">-     logger.warn(&quot;Redefine ANDROID_NDK_TARGET to: [$ndk_target]&quot;)</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- ANDROID.canBuild = sdk_target != null &amp;&amp; ndk_target != null</span>
<span class="udiff-line-removed">- if (!ANDROID.canBuild) {</span>
<span class="udiff-line-removed">-     fail(&quot;Can&#39;t determine sdk or ndk target platform!&quot;)</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- def toolchainHome = project.hasProperty(&quot;ANDROID_CROSS_TOOLS_VER&quot;) ?</span>
<span class="udiff-line-removed">-     &quot;$ndk/toolchains/${ANDROID_CROSS_TOOLS_VER}&quot; : getLatestToolchain(ndk, toolchainArchs[0])</span>
<span class="udiff-line-removed">- if (!assertDir(toolchainHome)) {</span>
<span class="udiff-line-removed">-     toolchainHome = getLatestToolchain(ndk, toolchainArchs[0])</span>
<span class="udiff-line-removed">-     logger.warn(&quot;Redefine toolchain to [$toolchainHome]&quot;)</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- // Look for the the Android SDK &amp; NDK to use, as well as the compiler stuff</span>
<span class="udiff-line-removed">- def compilerHome = null</span>
<span class="udiff-line-removed">- file(&quot;$toolchainHome/prebuilt&quot;).eachDir() {subdir -&gt;</span>
<span class="udiff-line-removed">-     compilerHome = subdir.getAbsolutePath()</span>
<span class="udiff-line-removed">-     return</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- ANDROID.canBuild = compilerHome != null</span>
<span class="udiff-line-removed">- if (!ANDROID.canBuild) {</span>
<span class="udiff-line-removed">-     fail(&quot;Failed to access toolchain [$toolchainHome/prebuilt/$toolsPlatform]!&quot;)</span>
<span class="udiff-line-removed">- }</span>
<span class="udiff-line-modified-added">+ ANDROID.library = { name -&gt; return IS_STATIC_BUILD ? &quot;lib${name}.a&quot; : &quot;lib${name}.so&quot; as String }</span>
<span class="udiff-line-modified-added">+ ANDROID.includeMonocle = true</span>
<span class="udiff-line-modified-added">+ ANDROID.includeLens = false</span>
<span class="udiff-line-modified-added">+ ANDROID.canBuild = true</span>
  
<span class="udiff-line-added">+ def toolchainHome = &quot;$ndk/toolchains/llvm&quot;</span>
<span class="udiff-line-added">+ def compilerHome = &quot;$toolchainHome/prebuilt/linux-x86_64&quot;</span>
  def freetypeDir = project.hasProperty(&quot;FREETYPE_DIR&quot;) ? &quot;${FREETYPE_DIR}&quot; : null
<span class="udiff-line-removed">- if (!assertDir(freetypeDir)) {</span>
<span class="udiff-line-removed">-     logger.warn(&quot;FREETYPE_DIR $freetypeDir doesn&#39;t exists! Build continues without native text support.&quot;)</span>
<span class="udiff-line-removed">-     freetypeDir = null</span>
<span class="udiff-line-removed">- }</span>
  def compileNativeText = freetypeDir != null
  
<span class="udiff-line-modified-removed">- def compiler = file(&quot;$compilerHome/bin/${toolchainArchs[0]}-gcc&quot;).getAbsolutePath()</span>
<span class="udiff-line-modified-removed">- def linker = file(&quot;$compilerHome/bin/${toolchainArchs[0]}-g++&quot;).getAbsolutePath()</span>
<span class="udiff-line-modified-added">+ def compiler = file(&quot;$compilerHome/bin/clang&quot;).getAbsolutePath()</span>
<span class="udiff-line-modified-added">+ def linker =  IS_STATIC_BUILD ? file(&quot;$compilerHome/bin/llvm-ar&quot;).getAbsolutePath() : file(&quot;$compilerHome/bin/clang&quot;).getAbsolutePath()</span>
  
  // Log the settings we&#39;re building with
  logger.quiet(&quot;ANDROID_SDK: $sdk&quot;)
  logger.quiet(&quot;ANDROID_SDK_TARGET: $sdk_target&quot;)
  logger.quiet(&quot;ANDROID_NDK: $ndk&quot;)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -176,275 +61,166 @@</span>
  logger.quiet(&quot;FREETYPE_DIR: $freetypeDir&quot;)
  logger.quiet(&quot;Compile native text: $compileNativeText&quot;)
  logger.quiet(&quot;Android Compiler: $compiler&quot;)
  logger.quiet(&quot;Android Linker: $linker&quot;)
  
<span class="udiff-line-modified-removed">- project(&quot;:graphics&quot;) {</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-     task compileDalvikLibs(type: JavaCompile, group: &quot;Build&quot;) {</span>
<span class="udiff-line-removed">-         description = &quot;Task compiles dalvik vm based libraries.&quot;</span>
<span class="udiff-line-removed">-         sourceCompatibility = JavaVersion.VERSION_1_6</span>
<span class="udiff-line-removed">-         targetCompatibility = JavaVersion.VERSION_1_6</span>
<span class="udiff-line-removed">-         options.bootClasspath = &quot;$sdk/platforms/$sdk_target/android.jar&quot;</span>
<span class="udiff-line-removed">-         classpath = files(&quot;build/classes/android&quot;)</span>
<span class="udiff-line-removed">-         destinationDir = file(&quot;build/classes/android&quot;)</span>
<span class="udiff-line-removed">-         dependencyCacheDir = file(&quot;build/dependency-cache&quot;)</span>
<span class="udiff-line-removed">-         source fileTree(dir: &#39;src/android/java&#39;).matching { include &#39;com/oracle/dalvik/**&#39; }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-modified-added">+ //exclude from build</span>
<span class="udiff-line-modified-added">+ project(&quot;:swing&quot;) {</span>
<span class="udiff-line-modified-added">+     apply plugin: &#39;java&#39;</span>
  
<span class="udiff-line-modified-removed">-     task jarDalvikLibs(type: Jar, group: &quot;Build&quot;, dependsOn: compileDalvikLibs) {</span>
<span class="udiff-line-modified-removed">-         description = &quot;Creates jfxdvk.jar with all dalvik based classes.&quot;</span>
<span class="udiff-line-removed">-         archiveName = &quot;jfxdvk.jar&quot;</span>
<span class="udiff-line-removed">-         includeEmptyDirs = false</span>
<span class="udiff-line-removed">-         from(&quot;build/classes/android&quot;)</span>
<span class="udiff-line-removed">-         include(&quot;com/oracle/dalvik/**/*&quot;)</span>
<span class="udiff-line-removed">-         dependsOn(compileDalvikLibs)</span>
<span class="udiff-line-modified-added">+     compileJava {</span>
<span class="udiff-line-modified-added">+         enabled = false</span>
      }
<span class="udiff-line-added">+ }</span>
  
<span class="udiff-line-modified-removed">-     afterEvaluate {</span>
<span class="udiff-line-modified-removed">-         addNative(project, &quot;surface&quot;, [&quot;android&quot;])</span>
<span class="udiff-line-removed">-         addNative(project, &quot;vmlauncher&quot;, [&quot;android&quot;])</span>
<span class="udiff-line-removed">-         if (compileNativeText) {</span>
<span class="udiff-line-removed">-             addNative(project, &quot;fontNativeFreetype&quot;, [&quot;android&quot;])</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-         tasks[&quot;javahAndroidVmlauncher&quot;].dependsOn(compileDalvikLibs)</span>
<span class="udiff-line-removed">-         tasks[&quot;native&quot;].dependsOn(&quot;nativeSurface&quot;, &quot;nativeVmlauncher&quot;)</span>
<span class="udiff-line-removed">-         if (compileNativeText) {</span>
<span class="udiff-line-removed">-             tasks[&quot;native&quot;].dependsOn(&quot;nativeFontNativeFreetype&quot;)</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-modified-added">+ project(&quot;:fxml&quot;) {</span>
<span class="udiff-line-modified-added">+     apply plugin: &#39;java&#39;</span>
  
<span class="udiff-line-modified-removed">-         sdkAndroid  {</span>
<span class="udiff-line-modified-removed">-             dependsOn(jarDalvikLibs)</span>
<span class="udiff-line-removed">-             doLast {</span>
<span class="udiff-line-removed">-                 def props = project.ext[&quot;ANDROID&quot;]</span>
<span class="udiff-line-removed">-                 copy {</span>
<span class="udiff-line-removed">-                     from(</span>
<span class="udiff-line-removed">-                          &quot;${project(&quot;graphics&quot;).buildDir}/libs/vmlauncher/android/${props.library(props.vmlauncher.lib)}&quot;,</span>
<span class="udiff-line-removed">-                          &quot;${project(&quot;graphics&quot;).buildDir}/libs/surface/android/${props.library(props.surface.lib)}&quot;</span>
<span class="udiff-line-removed">-                     )</span>
<span class="udiff-line-removed">-                     into (&quot;build/android-sdk/dalvik/${props.libDest}&quot;)</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-                 copy {</span>
<span class="udiff-line-removed">-                     from (&quot;${project(&quot;graphics&quot;).buildDir}/libs/${props.jfxdvklib}&quot;)</span>
<span class="udiff-line-removed">-                     into (&quot;build/android-sdk/dalvik/lib&quot;)</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-                 if (compileNativeText) {</span>
<span class="udiff-line-removed">-                     copy {</span>
<span class="udiff-line-removed">-                         from (&quot;${project(&quot;graphics&quot;).buildDir}/libs/fontNativeFreetype/android&quot;)</span>
<span class="udiff-line-removed">-                         into (&quot;build/android-sdk/$ANDROID.libDest&quot;)</span>
<span class="udiff-line-removed">-                     }</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-modified-added">+     compileJava {</span>
<span class="udiff-line-modified-added">+         enabled = true</span>
      }
  }
  
<span class="udiff-line-modified-removed">- project(&quot;:controls&quot;) {</span>
<span class="udiff-line-modified-removed">-     afterEvaluate {</span>
<span class="udiff-line-modified-removed">-         task compileControlsJavaAndroid(type: JavaCompile, group: &quot;Build&quot;, dependsOn: [&quot;:graphics:compileJava&quot;, &quot;:controls:compileJava&quot;]) {</span>
<span class="udiff-line-modified-removed">-             description = &quot;Task compiles controls for Android&quot;</span>
<span class="udiff-line-modified-removed">-             classpath = files(&quot;${project(&quot;base&quot;).buildDir}/classes/main&quot;,</span>
<span class="udiff-line-removed">-                 &quot;${project(&quot;graphics&quot;).buildDir}/classes/main&quot;,</span>
<span class="udiff-line-removed">-                 &quot;${project(&quot;controls&quot;).buildDir}/classes/main&quot;</span>
<span class="udiff-line-removed">-             )</span>
<span class="udiff-line-removed">-             destinationDir = file(&quot;${project(&quot;controls&quot;).buildDir}/classes/android&quot;)</span>
<span class="udiff-line-removed">-             dependencyCacheDir = file(&quot;${project(&quot;controls&quot;).buildDir}/dependency-cache&quot;)</span>
<span class="udiff-line-removed">-             source file(&quot;${project(&quot;controls&quot;).projectDir}/src/android/java&quot;)</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-modified-added">+ allprojects() {</span>
<span class="udiff-line-modified-added">+     repositories {</span>
<span class="udiff-line-modified-added">+         mavenCentral()</span>
<span class="udiff-line-modified-added">+     }</span>
<span class="udiff-line-modified-added">+ }</span>
  
<span class="udiff-line-removed">-        task processControlsResourcesAndroid() {</span>
<span class="udiff-line-removed">-            copy {</span>
<span class="udiff-line-removed">-                from (&quot;${project(&quot;controls&quot;).projectDir}/src/android/resources&quot;)</span>
<span class="udiff-line-removed">-                into (&quot;${project(&quot;controls&quot;).buildDir}/resources/android&quot;)</span>
<span class="udiff-line-removed">-            }</span>
<span class="udiff-line-removed">-         }</span>
  
<span class="udiff-line-modified-removed">-         sdkAndroid {</span>
<span class="udiff-line-modified-removed">-             dependsOn(compileControlsJavaAndroid, processControlsResourcesAndroid)</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-     }</span>
<span class="udiff-line-modified-added">+ project(&quot;:base&quot;) {</span>
<span class="udiff-line-modified-added">+     apply plugin: &#39;java&#39;</span>
  }
  
  project(&quot;:web&quot;) {
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ }</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ project(&quot;:graphics&quot;) {</span>
<span class="udiff-line-added">+ </span>
      apply plugin: &#39;java&#39;
  
<span class="udiff-line-modified-removed">-     compileJava {</span>
<span class="udiff-line-modified-removed">-         enabled = false</span>
<span class="udiff-line-modified-added">+     sourceSets.main.java {</span>
<span class="udiff-line-modified-added">+         exclude &quot;com/sun/glass/ui/swt/**&quot;</span>
      }
  
      afterEvaluate {
<span class="udiff-line-modified-removed">-         if (!BUILD_CLOSED) {</span>
<span class="udiff-line-modified-removed">-             logger.warn(&quot;OpenJFX build. Skipping webkit build on Android.&quot;)</span>
<span class="udiff-line-removed">-             return</span>
<span class="udiff-line-modified-added">+         if (compileNativeText) {</span>
<span class="udiff-line-modified-added">+             addNative(project, &quot;fontNativeFreetype&quot;)</span>
          }
<span class="udiff-line-modified-removed">-         def compileWebJavaAndroid = task(&quot;compileWebJavaAndroid&quot;,</span>
<span class="udiff-line-modified-removed">-             type: JavaCompile, group: &quot;Build&quot;) {</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-             dependsOn(project(&quot;:graphics&quot;).classes, project(&quot;:base&quot;).classes)</span>
<span class="udiff-line-removed">-             description = &quot;Task compiles web component for Android.&quot;</span>
<span class="udiff-line-removed">-             classpath = files(</span>
<span class="udiff-line-removed">-                 project(&quot;:controls&quot;).sourceSets.main.java.outputDir,</span>
<span class="udiff-line-removed">-                 project(&quot;:graphics&quot;).sourceSets.main.java.outputDir,</span>
<span class="udiff-line-removed">-                 project(&quot;:base&quot;).sourceSets.main.java.outputDir</span>
<span class="udiff-line-removed">-             )</span>
<span class="udiff-line-removed">-             destinationDir = file(&quot;${project(&quot;web&quot;).buildDir}/classes/android&quot;)</span>
<span class="udiff-line-removed">-             dependencyCacheDir = file(&quot;${project(&quot;web&quot;).buildDir}/dependency-cache&quot;)</span>
<span class="udiff-line-removed">-             source file(&quot;${project(&quot;web&quot;).projectDir}/src/android/java&quot;)</span>
<span class="udiff-line-modified-added">+         if (compileNativeText) {</span>
<span class="udiff-line-modified-added">+             tasks[&quot;native&quot;].dependsOn(&quot;nativeFontNativeFreetype&quot;)</span>
          }
<span class="udiff-line-added">+         tasks[&quot;ccAndroidPrismSW&quot;].enabled = false;</span>
<span class="udiff-line-added">+         tasks[&quot;linkAndroidPrismSW&quot;].enabled = false;</span>
  
<span class="udiff-line-modified-removed">-         def jarWebJavaAndroid = task(&quot;jarWebJavaAndroid&quot;,</span>
<span class="udiff-line-modified-removed">-             type: Jar, group: &quot;Build&quot;) {</span>
<span class="udiff-line-removed">-             description = &quot;Creates web.jar for Android.&quot;</span>
<span class="udiff-line-removed">-             dependsOn(compileWebJavaAndroid)</span>
<span class="udiff-line-removed">-             archiveName = &quot;web.jar&quot;</span>
<span class="udiff-line-removed">-             includeEmptyDirs = false</span>
<span class="udiff-line-removed">-             destinationDir = project.file(&quot;build/libs/android&quot;)</span>
<span class="udiff-line-removed">-             from(&quot;build/classes/android&quot;)</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-modified-added">+     }</span>
<span class="udiff-line-modified-added">+ }</span>
  
<span class="udiff-line-modified-removed">-         addNative(project, &quot;webview&quot;, [&quot;android&quot;])</span>
<span class="udiff-line-removed">-         addNative(project, &quot;dvkwebview&quot;, [&quot;android&quot;])</span>
<span class="udiff-line-removed">-         javahAndroidWebview.dependsOn(compileWebJavaAndroid)</span>
<span class="udiff-line-removed">-         javahAndroidDvkwebview.dependsOn(compileWebJavaAndroid)</span>
<span class="udiff-line-modified-added">+ project(&quot;:controls&quot;) {</span>
  
<span class="udiff-line-modified-removed">-         jfxrtAndroid {</span>
<span class="udiff-line-removed">-             from &quot;${project(&quot;web&quot;).buildDir}/classes/android&quot;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-modified-added">+     apply plugin: &#39;java&#39;</span>
  
<span class="udiff-line-modified-removed">-         sdkAndroid  {</span>
<span class="udiff-line-modified-removed">-             dependsOn(jarWebJavaAndroid)</span>
<span class="udiff-line-modified-removed">-             doLast {</span>
<span class="udiff-line-modified-removed">-                 def props = project.ext[&quot;ANDROID&quot;]</span>
<span class="udiff-line-removed">-                 copy {</span>
<span class="udiff-line-removed">-                     from(</span>
<span class="udiff-line-removed">-                          &quot;${project(&quot;web&quot;).buildDir}/libs/dvkwebview/android/${props.library(props.dvkwebview.lib)}&quot;</span>
<span class="udiff-line-removed">-                     )</span>
<span class="udiff-line-removed">-                     into (&quot;build/android-sdk/dalvik/${props.libDest}&quot;)</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-                 copy {</span>
<span class="udiff-line-removed">-                     from (&quot;${project(&quot;web&quot;).buildDir}/libs/webview/android/${props.library(props.webview.lib)}&quot;)</span>
<span class="udiff-line-removed">-                     into (&quot;build/android-sdk/${props.libDest}&quot;)</span>
<span class="udiff-line-removed">-                 }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-modified-added">+     task copyResources()  {</span>
<span class="udiff-line-modified-added">+         copy {</span>
<span class="udiff-line-modified-added">+             from (&quot;src/android/resources&quot;)</span>
<span class="udiff-line-modified-added">+             into (&quot;build/classes/java/main/javafx.controls&quot;)</span>
          }
      }
<span class="udiff-line-removed">- }</span>
  
<span class="udiff-line-added">+     assemble.dependsOn(&quot;copyResources&quot;);</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+ }</span>
  
  ANDROID.jfxrtJarExcludes = [
      &quot;**/*.hlsl&quot;,
      &quot;com/sun/glass/ui/win&quot;,
<span class="udiff-line-modified-removed">-     &quot;com/sun/prism/d3d&quot;,</span>
<span class="udiff-line-modified-removed">-     &quot;com/sun/prism/es2/gl/win&quot;,</span>
<span class="udiff-line-modified-removed">-     &quot;com/sun/prism/null3d&quot;,</span>
<span class="udiff-line-modified-removed">-     &quot;com/sun/scenario/effect/impl/hw/d3d&quot;,</span>
<span class="udiff-line-removed">-     &quot;com/sun/glass/events/mac&quot;,</span>
<span class="udiff-line-removed">-     &quot;com/sun/glass/ui/mac&quot;,</span>
<span class="udiff-line-removed">-     &quot;com/sun/prism/es2/gl/mac&quot;,</span>
<span class="udiff-line-removed">-     &quot;com/sun/glass/ui/gtk&quot;,</span>
<span class="udiff-line-modified-added">+     &quot;com/sun/glass/ui/accessible/win&quot;,</span>
<span class="udiff-line-modified-added">+     &quot;com/sun/prism/j2d&quot;,</span>
<span class="udiff-line-modified-added">+     &quot;com/sun/prism/sw&quot;,</span>
<span class="udiff-line-modified-added">+     &quot;com/sun/glass/ui/accessible/mac&quot;,</span>
      &quot;com/sun/glass/ui/ios&quot;,
<span class="udiff-line-removed">-     &quot;com/sun/prism/es2/gl/eglx11&quot;,</span>
<span class="udiff-line-removed">-     &quot;com/sun/prism/es2/gl/x11&quot;,</span>
      &quot;com/sun/glass/ui/swt&quot;, // SWT glass
<span class="udiff-line-modified-removed">-     &quot;javafx/embed/swing&quot;, // Swing Interop</span>
<span class="udiff-line-modified-removed">-     &quot;javafx/embed/swt&quot;, // SWT Interop</span>
<span class="udiff-line-modified-removed">-     &quot;com/oracle/dalvik&quot;</span>
<span class="udiff-line-modified-added">+     &quot;com/oracle/dalvik&quot;,</span>
<span class="udiff-line-modified-added">+     // &quot;javafx/scene/media&quot;, //exclude all media for now</span>
<span class="udiff-line-modified-added">+     // &quot;com/sun/media&quot;,</span>
<span class="udiff-line-added">+     // &quot;com/sun/javafx/media&quot;,</span>
<span class="udiff-line-added">+     &quot;com/sun/javafx/font/directwrite&quot;, //exclude non freetype font support</span>
<span class="udiff-line-added">+     &quot;com/sun/javafx/font/coretext&quot;,</span>
<span class="udiff-line-added">+     // &quot;com/sun/javafx/font/freetype/Pango*&quot;,</span>
<span class="udiff-line-added">+     // &quot;com/sun/javafx/font/freetype/OSPango*&quot;,</span>
<span class="udiff-line-added">+     // &quot;com/sun/webkit&quot;,   //exclude all WebView for now</span>
<span class="udiff-line-added">+     // &quot;com/sun/javafx/webkit&quot;,</span>
<span class="udiff-line-added">+     // &quot;com/sun/javafx/scene/web&quot;,</span>
<span class="udiff-line-added">+     // &quot;javafx/scene/web&quot;,</span>
<span class="udiff-line-added">+     // &quot;com/sun/javafx/sg/prism/NGWeb*&quot;,</span>
<span class="udiff-line-added">+     // &quot;com/sun/javafx/sg/prism/web*&quot;,</span>
<span class="udiff-line-added">+     &quot;javafx/print&quot;, //exclude printing</span>
<span class="udiff-line-added">+     &quot;com/sun/javafx/print&quot;,</span>
<span class="udiff-line-added">+     &quot;com/sun/javafx/tk/Print*&quot;</span>
  ]
  
  def text = (compileNativeText) ? &quot;native&quot; : &quot;&quot;
  
  ANDROID.javafxPlatformProperties = &quot;&quot;&quot;
  javafx.platform=android
<span class="udiff-line-modified-removed">- android.glass.platform=Lens</span>
<span class="udiff-line-modified-removed">- android.glass.lens=eglfb</span>
<span class="udiff-line-modified-added">+ android.javax.xml.stream.XMLInputFactory=com.sun.xml.stream.ZephyrParserFactory</span>
<span class="udiff-line-modified-added">+ android.javax.xml.stream.XMLOutputFactory=com.sun.xml.stream.ZephyrWriterFactory</span>
<span class="udiff-line-added">+ android.javax.xml.stream.XMLEventFactory=com.sun.xml.stream.events.ZephyrEventFactory</span>
<span class="udiff-line-added">+ android.glass.platform=Monocle</span>
<span class="udiff-line-added">+ android.prism.verbose=true</span>
<span class="udiff-line-added">+ ANDROID.prism.verbose=true</span>
  android.prism.glDepthSize=16
  android.prism.lcdtext=false
  android.prism.debugfonts=true
  android.prism.text=$text
<span class="udiff-line-modified-removed">- android.embedded=eglfb</span>
<span class="udiff-line-modified-removed">- android.prism.allowhidpi=false</span>
<span class="udiff-line-modified-added">+ android.embedded=monocle</span>
<span class="udiff-line-modified-added">+ android.prism.allowhidpi=true</span>
  android.prism.maxTextureSize=2048
  android.prism.dirtyopts=true
  android.prism.vsync=false
<span class="udiff-line-removed">- android.log.lens=FINE</span>
  android.use.egl=true
  android.com.sun.javafx.isEmbedded=true
<span class="udiff-line-added">+ com.sun.javafx.gestures.zoom=true</span>
<span class="udiff-line-added">+ com.sun.javafx.gestures.rotate=true</span>
<span class="udiff-line-added">+ com.sun.javafx.gestures.scroll=true</span>
  &quot;&quot;&quot;
  def sysroot = &quot;$ndk/platforms/$ndk_target/arch-arm&quot;
  
<span class="udiff-line-modified-removed">- def ccFlags = [&quot;--sysroot=$sysroot&quot;,&quot;-std=c99&quot;, &quot;-DANDROID&quot;, &quot;-c&quot;, &quot;-nostdlib&quot;,</span>
<span class="udiff-line-modified-removed">-                &quot;-DANDROID_NDK&quot;]</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-removed">- if (project.hasProperty(&quot;DALVIK_VM&quot;)) {</span>
<span class="udiff-line-removed">-     ccFlags += [&quot;-DDALVIK_VM&quot;]</span>
<span class="udiff-line-modified-added">+ def ccFlags = [&quot;-target&quot;,platform, &quot;-c&quot;, &quot;-I$JDK_HOME/include&quot;, &quot;-I$JDK_HOME/include/linux&quot;, &quot;-DANDROID_NDK&quot;, &quot;-DANDROID_VM&quot;]</span>
<span class="udiff-line-modified-added">+ if ( IS_STATIC_BUILD )  {</span>
<span class="udiff-line-modified-added">+     ccFlags += &quot;-DSTATIC_BUILD&quot;</span>
  }
  
<span class="udiff-line-modified-removed">- def ccOptFlags = [&quot;-fpic&quot;, &quot;-ffunction-sections&quot;, &quot;-funwind-tables&quot;,&quot;-fstack-protector&quot;,</span>
<span class="udiff-line-modified-removed">-                   &quot;-Os&quot;, &quot;-O2&quot;, &quot;-fno-strict-aliasing&quot;, &quot;-finline-limit=64&quot;, &quot;-fomit-frame-pointer&quot;]</span>
<span class="udiff-line-modified-removed">- def ccWarnFlags = [&quot;-Wa,--noexecstack&quot;, &quot;-Wno-psabi&quot;]</span>
<span class="udiff-line-modified-removed">- def ccArchFlags = [&quot;-mthumb&quot;, &quot;-msoft-float&quot;, &quot;-D__ARM_ARCH_5__&quot;, &quot;-D__ARM_ARCH_5T__&quot;, &quot;-D__ARM_ARCH_5E__&quot;,</span>
<span class="udiff-line-modified-removed">-                    &quot;-D__ARM_ARCH_5TE__&quot;, &quot;-march=armv5te&quot; , &quot;-mtune=xscale&quot;]</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+ def ccOptFlags = [&quot;-fPIC&quot;, &quot;-ffunction-sections&quot;, &quot;-funwind-tables&quot;,&quot;-fstack-protector&quot;,</span>
<span class="udiff-line-modified-added">+                   &quot;-Os&quot;, &quot;-O2&quot;, &quot;-fno-strict-aliasing&quot;, &quot;-fomit-frame-pointer&quot;]</span>
<span class="udiff-line-modified-added">+ def ccWarnFlags = [&quot;-Wa,--noexecstack&quot;]</span>
<span class="udiff-line-modified-added">+ def ccArchFlags = []</span>
  def ccDebugFlags = [IS_DEBUG_NATIVE ? &quot;-DDEBUG&quot; : &quot;-DNDEBUG&quot;]
  def ccDefaultIncludeFlags = [&quot;-I$ndk/platforms/$ndk_target/arch-arm/usr/include&quot;]
  
<span class="udiff-line-modified-removed">- def linkFlags = [&quot;--sysroot=$sysroot&quot;,</span>
<span class="udiff-line-modified-added">+ def linkFlags = IS_STATIC_BUILD ? [] : [&quot;-target&quot;, platform,</span>
                   &quot;-Wl,--no-undefined&quot;, &quot;-Wl,-z,noexecstack&quot;, &quot;-lc&quot;, &quot;-lm&quot;, &quot;-shared&quot;,
<span class="udiff-line-modified-removed">-                  &quot;-L$ndk/platforms/$ndk_target/arch-arm/usr/lib&quot;]</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- ANDROID.vmlauncher = [:]</span>
<span class="udiff-line-removed">- ANDROID.vmlauncher.classpath = files(&quot;$sdk/platforms/$sdk_target/android.jar&quot;,</span>
<span class="udiff-line-removed">-                                      &quot;${project(&quot;graphics&quot;).buildDir}/classes/android&quot;)</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- ANDROID.vmlauncher.javahSource = files(&quot;${project(&quot;graphics&quot;).buildDir}/classes/android&quot;)</span>
<span class="udiff-line-removed">- ANDROID.vmlauncher.javahClasspath = files(&quot;${project(&quot;graphics&quot;).buildDir}/classes/android&quot;,</span>
<span class="udiff-line-removed">-                                           &quot;$sdk/platforms/$sdk_target/android.jar&quot;)</span>
<span class="udiff-line-removed">- ANDROID.vmlauncher.javahInclude = [</span>
<span class="udiff-line-removed">-     &quot;com/oracle/dalvik/*&quot;</span>
<span class="udiff-line-removed">- ]</span>
<span class="udiff-line-removed">- ANDROID.vmlauncher.nativeSource = [</span>
<span class="udiff-line-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/android/native/VMLauncher.c&quot;),</span>
<span class="udiff-line-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/android/native/NativePipeReader.c&quot;),</span>
<span class="udiff-line-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/android/native/DalvikProxySelector.c&quot;)</span>
<span class="udiff-line-removed">- ]</span>
<span class="udiff-line-removed">- ANDROID.vmlauncher.compiler = compiler</span>
<span class="udiff-line-removed">- ANDROID.vmlauncher.linker = linker</span>
<span class="udiff-line-removed">- ANDROID.vmlauncher.lib = &quot;vmlauncher&quot;</span>
<span class="udiff-line-removed">- ANDROID.vmlauncher.ccFlags = [ccFlags, ccWarnFlags, ccArchFlags, ccOptFlags,</span>
<span class="udiff-line-removed">-     ccDebugFlags, ccDefaultIncludeFlags].flatten()</span>
<span class="udiff-line-removed">- ANDROID.vmlauncher.linkFlags = [linkFlags, &quot;-llog&quot;].flatten()</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">- ANDROID.surface = [:]</span>
<span class="udiff-line-removed">- ANDROID.surface.javahInclude = [</span>
<span class="udiff-line-removed">-     &quot;com/sun/glass/events/*&quot;,</span>
<span class="udiff-line-removed">-     &quot;com/sun/glass/ui/android/*&quot;</span>
<span class="udiff-line-removed">- ]</span>
<span class="udiff-line-removed">- ANDROID.surface.nativeSource = [</span>
<span class="udiff-line-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/lens/android&quot;)</span>
<span class="udiff-line-removed">- ]</span>
<span class="udiff-line-removed">- ANDROID.surface.compiler = compiler</span>
<span class="udiff-line-removed">- ANDROID.surface.linker = linker</span>
<span class="udiff-line-removed">- ANDROID.surface.lib = &quot;glass_lens_android&quot;</span>
<span class="udiff-line-removed">- ANDROID.surface.ccFlags = [ccFlags, ccWarnFlags, ccArchFlags, ccOptFlags,</span>
<span class="udiff-line-removed">-     ccDebugFlags, ccDefaultIncludeFlags, &quot;-Isrc/main/native-glass/lens&quot;].flatten()</span>
<span class="udiff-line-removed">- ANDROID.surface.linkFlags = [linkFlags, &quot;-ldl&quot;, &quot;-landroid&quot;, &quot;-llog&quot;].flatten()</span>
<span class="udiff-line-modified-added">+                  &quot;-L$ndk/platforms/$ndk_target/arch-arm/usr/lib&quot;, &quot;-landroid&quot;, &quot;-llog&quot;]</span>
  
  ANDROID.webview = [:]
  ANDROID.webview.javahSource = files(&quot;${project(&quot;web&quot;).buildDir}/classes/android&quot;)
  ANDROID.webview.javahClasspath = files(&quot;${project(&quot;web&quot;).buildDir}/classes/android&quot;)
  ANDROID.webview.javahInclude = [
      &quot;com/sun/webkit/NativeWebView.class&quot;
  ]
  ANDROID.webview.nativeSource = [
<span class="udiff-line-modified-removed">-     file(&quot;${project(&quot;web&quot;).projectDir}/src/android/native/native_webview.c&quot;)</span>
<span class="udiff-line-modified-added">+     files(&quot;${project(&quot;web&quot;).projectDir}/src/android/native/native_webview.c&quot;,</span>
<span class="udiff-line-added">+ &quot;${project(&quot;web&quot;).projectDir}/src/android/native/android_webview.c&quot;)</span>
  ]
  ANDROID.webview.compiler = compiler
  ANDROID.webview.linker = linker
  ANDROID.webview.lib = &quot;webview&quot;
  ANDROID.webview.ccFlags = [ccFlags, ccWarnFlags, ccArchFlags, ccOptFlags,
      ccDebugFlags, ccDefaultIncludeFlags].flatten()
<span class="udiff-line-modified-removed">- ANDROID.webview.linkFlags = [linkFlags, &quot;-ldl&quot;, &quot;-llog&quot;].flatten()</span>
<span class="udiff-line-modified-added">+ ANDROID.webview.linkFlags = IS_STATIC_BUILD ? [linkFlags].flatten() : [linkFlags, &quot;-ldl&quot;, &quot;-llog&quot;].flatten()</span>
  
  ANDROID.dvkwebview = [:]
  ANDROID.dvkwebview.javahSource = files(&quot;${project(&quot;web&quot;).buildDir}/classes/android&quot;)
  ANDROID.dvkwebview.javahClasspath = files(&quot;${project(&quot;web&quot;).buildDir}/classes/android&quot;)
  ANDROID.dvkwebview.javahInclude = [
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -456,48 +232,67 @@</span>
  ANDROID.dvkwebview.compiler = compiler
  ANDROID.dvkwebview.linker = linker
  ANDROID.dvkwebview.lib = &quot;android_webview&quot;
  ANDROID.dvkwebview.ccFlags = [ccFlags, ccWarnFlags, ccArchFlags, ccOptFlags,
      ccDebugFlags, ccDefaultIncludeFlags].flatten()
<span class="udiff-line-modified-removed">- ANDROID.dvkwebview.linkFlags = [linkFlags, &quot;-ldl&quot;, &quot;-llog&quot;].flatten()</span>
<span class="udiff-line-modified-added">+ ANDROID.dvkwebview.linkFlags = IS_STATIC_BUILD ? [linkFlags].flatten() : [linkFlags, &quot;-ldl&quot;, &quot;-llog&quot;].flatten()</span>
  
  ANDROID.glass = [:]
<span class="udiff-line-modified-removed">- ANDROID.glass.variants = [&quot;eglfb&quot;, &quot;lensport&quot;]</span>
<span class="udiff-line-modified-added">+ ANDROID.glass.variants = []</span>
<span class="udiff-line-added">+ ANDROID.glass.variants = [&quot;monocle&quot;]</span>
<span class="udiff-line-added">+ ANDROID.glass.javahSource = files(&quot;${project(&quot;graphics&quot;).buildDir}/classes/dalvik&quot;,</span>
<span class="udiff-line-added">+  &quot;${project(&quot;graphics&quot;).buildDir}/classes/main&quot;)</span>
<span class="udiff-line-added">+ ANDROID.glass.javahClasspath = files(&quot;${project(&quot;graphics&quot;).buildDir}/classes/main&quot;,</span>
<span class="udiff-line-added">+  &quot;${project(&quot;graphics&quot;).buildDir}/classes/dalvik&quot;,</span>
<span class="udiff-line-added">+  &quot;${project(&quot;base&quot;).buildDir}/classes/main&quot;,</span>
<span class="udiff-line-added">+  &quot;$sdk/platforms/$sdk_target/android.jar&quot;)</span>
  ANDROID.glass.javahInclude = [
<span class="udiff-line-added">+     &quot;javafxports/android/**&quot;,</span>
<span class="udiff-line-added">+     &quot;com/sun/glass/ui/monocle/*&quot;,</span>
<span class="udiff-line-added">+     &quot;com/sun/glass/ui/monocle/util/*&quot;,</span>
      &quot;com/sun/glass/events/**&quot;,
      &quot;com/sun/glass/ui/*&quot;,
      &quot;com/sun/glass/ui/android/*&quot;,
      &quot;com/sun/glass/ui/lens/*&quot;]
  
<span class="udiff-line-modified-removed">- ANDROID.glass.lensport = [:]</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.lensport.nativeSource = [</span>
<span class="udiff-line-modified-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/lens/lensport&quot;),</span>
<span class="udiff-line-modified-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/lens/lensport/initPlatform.c&quot;),</span>
<span class="udiff-line-modified-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/lens/lensport/wrapped_functions.c&quot;)</span>
<span class="udiff-line-modified-removed">- ]</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.lensport.compiler = compiler</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.lensport.linker = linker</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.lensport.lib = &quot;lens_porting&quot;</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.lensport.ccFlags = [ccFlags, ccWarnFlags, ccArchFlags, ccOptFlags,</span>
<span class="udiff-line-modified-removed">-     ccDebugFlags, ccDefaultIncludeFlags, &quot;-DISEGLFB&quot;, &quot;-DLENSPORT&quot;,</span>
<span class="udiff-line-modified-removed">-     &quot;-I&quot;, file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/lens&quot;)].flatten()</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.lensport.linkFlags = [linkFlags, &quot;-ldl&quot;, &quot;-llog&quot;].flatten()</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">- ANDROID.glass.eglfb = [:]</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.eglfb.nativeSource = [</span>
<span class="udiff-line-modified-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/lens&quot;),</span>
<span class="udiff-line-modified-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/lens/wm&quot;),</span>
<span class="udiff-line-modified-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/lens/cursor/nullCursor&quot;),</span>
<span class="udiff-line-modified-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/lens/input/android&quot;),</span>
<span class="udiff-line-modified-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/lens/wm/screen/androidScreen.c&quot;)</span>
<span class="udiff-line-modified-removed">- ]</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.eglfb.compiler = compiler</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.eglfb.linker = linker</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.eglfb.lib = &quot;glass_lens_eglfb&quot;</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.eglfb.ccFlags = [ccFlags, ccWarnFlags, ccArchFlags, ccOptFlags,</span>
<span class="udiff-line-modified-removed">-     ccDebugFlags, ccDefaultIncludeFlags].flatten()</span>
<span class="udiff-line-modified-removed">- ANDROID.glass.eglfb.linkFlags = [linkFlags, &quot;-ldl&quot;, &quot;-landroid&quot;, &quot;-llog&quot;].flatten()</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+ def monocleCFlags = [ccFlags, ccWarnFlags, ccArchFlags, ccOptFlags,</span>
<span class="udiff-line-modified-added">+     ccDebugFlags, ccDefaultIncludeFlags, &quot;-DISEGLFB&quot;,</span>
<span class="udiff-line-modified-added">+     &quot;-I&quot;, file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/monocle/&quot;),</span>
<span class="udiff-line-modified-added">+     &quot;-I&quot;, file(&quot;${project(&quot;graphics&quot;).projectDir}/src/dalvik/native/&quot;)</span>
<span class="udiff-line-modified-added">+ ].flatten()</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+ ANDROID.glass.monocle = [:]</span>
<span class="udiff-line-modified-added">+ ANDROID.glass.monocle.nativeSource = [</span>
<span class="udiff-line-modified-added">+         file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/monocle&quot;),</span>
<span class="udiff-line-modified-added">+         file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/monocle/android&quot;),</span>
<span class="udiff-line-modified-added">+         file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-glass/monocle/util&quot;) ]</span>
<span class="udiff-line-modified-added">+ ANDROID.glass.monocle.compiler = compiler</span>
<span class="udiff-line-modified-added">+ ANDROID.glass.monocle.ccFlags = monocleCFlags</span>
<span class="udiff-line-modified-added">+ ANDROID.glass.monocle.linker = linker</span>
<span class="udiff-line-modified-added">+ ANDROID.glass.monocle.linkFlags =  IS_STATIC_BUILD ? [linkFlags].flatten() : [linkFlags, &quot;-ldl&quot;, &quot;-llog&quot;, &quot;-landroid&quot;, &quot;-lGLESv2&quot;, &quot;-lEGL&quot;].flatten()</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+ ANDROID.glass.monocle.lib = &quot;glass_monocle&quot;</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+ ANDROID.javafxPlatformDefault=&quot;glass&quot;</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+ def monoclePlatformAdditions = &quot;&quot;&quot;</span>
<span class="udiff-line-modified-added">+ monocle.glass.platform=Monocle</span>
<span class="udiff-line-modified-added">+ monocle.prism.order=es2,sw</span>
<span class="udiff-line-modified-added">+ monocle.prism.lcdtext=false</span>
<span class="udiff-line-modified-added">+ monocle.prism.maxvram=128m</span>
<span class="udiff-line-modified-added">+ monocle.prism.targetvram=112m</span>
<span class="udiff-line-modified-added">+ monocle.use.egl=true</span>
<span class="udiff-line-added">+ monocle.use.gles2=true</span>
<span class="udiff-line-added">+ monocle.embedded=monocle</span>
<span class="udiff-line-added">+ monocle.com.sun.javafx.isEmbedded=true</span>
<span class="udiff-line-added">+ monocle.doNativeComposite=true</span>
<span class="udiff-line-added">+ monocle.com.sun.javafx.scene.control.skin.FXVK.cache=true</span>
<span class="udiff-line-added">+ monocle.prism.glDepthSize=0</span>
<span class="udiff-line-added">+ monocle.com.sun.javafx.gestures.zoom=true</span>
<span class="udiff-line-added">+ monocle.com.sun.javafx.gestures.rotate=true</span>
<span class="udiff-line-added">+ monocle.com.sun.javafx.gestures.scroll=true&quot;&quot;&quot;</span>
  
  ANDROID.prism = [:]
  ANDROID.prism.javahInclude = [&quot;com/sun/prism/impl/**/*&quot;, &quot;com/sun/prism/PresentableState*&quot;]
  ANDROID.prism.nativeSource = file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-prism&quot;)
  ANDROID.prism.compiler = compiler
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -536,24 +331,26 @@</span>
  ANDROID.iio.linker = linker
  ANDROID.iio.linkFlags = [linkFlags].flatten()
  ANDROID.iio.lib = &quot;javafx_iio&quot;
  
  ANDROID.prismES2 = [:]
<span class="udiff-line-modified-removed">- ANDROID.prismES2.variants = [&quot;eglfb&quot;]</span>
<span class="udiff-line-modified-added">+ ANDROID.prismES2.variants = [&quot;monocle&quot;]</span>
  ANDROID.prismES2.javahInclude = [&quot;com/sun/prism/es2/**/*&quot;]
  
<span class="udiff-line-modified-removed">- ANDROID.prismES2.eglfb = [:]</span>
<span class="udiff-line-modified-removed">- ANDROID.prismES2.eglfb.nativeSource = [</span>
<span class="udiff-line-modified-added">+ ANDROID.prismES2.monocle= [:]</span>
<span class="udiff-line-modified-added">+ ANDROID.prismES2.monocle.nativeSource = [</span>
      file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-prism-es2&quot;),
      file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-prism-es2/GL&quot;),
<span class="udiff-line-modified-removed">-     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-prism-es2/eglfb&quot;)]</span>
<span class="udiff-line-modified-removed">- ANDROID.prismES2.eglfb.compiler = compiler</span>
<span class="udiff-line-modified-removed">- ANDROID.prismES2.eglfb.ccFlags = [ccFlags, ccWarnFlags, ccArchFlags, ccOptFlags,</span>
<span class="udiff-line-modified-added">+     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-prism-es2/eglWrapper&quot;),</span>
<span class="udiff-line-modified-added">+     file(&quot;${project(&quot;graphics&quot;).projectDir}/src/main/native-prism-es2/monocle&quot;)</span>
<span class="udiff-line-modified-added">+ ]</span>
<span class="udiff-line-added">+ ANDROID.prismES2.monocle.compiler = compiler</span>
<span class="udiff-line-added">+ ANDROID.prismES2.monocle.ccFlags = [ccFlags, ccWarnFlags, ccArchFlags, ccOptFlags,</span>
      ccDebugFlags, ccDefaultIncludeFlags, &quot;-DIS_EGLFB&quot;].flatten()
<span class="udiff-line-modified-removed">- ANDROID.prismES2.eglfb.linker = linker</span>
<span class="udiff-line-modified-removed">- ANDROID.prismES2.eglfb.linkFlags = [linkFlags, &quot;-ldl&quot;, &quot;-llog&quot;, &quot;-lGLESv2&quot;, &quot;-lEGL&quot;].flatten()</span>
<span class="udiff-line-modified-removed">- ANDROID.prismES2.eglfb.lib = &quot;prism_es2_eglfb&quot;</span>
<span class="udiff-line-modified-added">+ ANDROID.prismES2.monocle.linker = linker</span>
<span class="udiff-line-modified-added">+ ANDROID.prismES2.monocle.linkFlags = IS_STATIC_BUILD ? [linkFlags].flatten() : [linkFlags, &quot;-ldl&quot;, &quot;-llog&quot;, &quot;-lGLESv2&quot;, &quot;-lEGL&quot;].flatten()</span>
<span class="udiff-line-modified-added">+ ANDROID.prismES2.monocle.lib = &quot;prism_es2_monocle&quot;</span>
  
  ANDROID.font = [:]
  ANDROID.font.javahInclude = [
          &quot;com/sun/javafx/font/**/*&quot;,
          &quot;com/sun/javafx/text/**/*&quot;]
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -583,13 +380,12 @@</span>
          [ccFlags, ccWarnFlags, ccArchFlags, ccOptFlags,
          ccDebugFlags, ccDefaultIncludeFlags,
          &quot;-I$freetypeDir/include&quot;, &quot;-I$freetypeDir/include/freetype2&quot;].flatten()
  
      ANDROID.fontNativeFreetype.linkFlags =
<span class="udiff-line-added">+ IS_STATIC_BUILD ? [linkFlags].flatten() : </span>
          [linkFlags, &quot;-llog&quot;,
           &quot;-L$freetypeDir/lib&quot;, &quot;$freetypeDir/lib/libfreetype.a&quot;].flatten()
  }
  
  ANDROID.media = [:]
<span class="udiff-line-modified-removed">- ANDROID.media.compiler = compiler</span>
<span class="udiff-line-removed">- ANDROID.media.linker = linker</span>
<span class="udiff-line-removed">- ANDROID.media.lib = file(&quot;$compilerHome/bin/${toolchainArchs[0]}-ar&quot;).getAbsolutePath()</span>
<span class="udiff-line-modified-added">+ ext.IS_COMPILE_PANGO = false</span>
</pre>
<center><a href="../build.properties.udiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="../modules/javafx.base/src/test/java/test/com/sun/javafx/runtime/VersionInfoTest.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>
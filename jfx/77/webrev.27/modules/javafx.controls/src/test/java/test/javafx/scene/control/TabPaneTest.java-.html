<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old modules/javafx.controls/src/test/java/test/javafx/scene/control/TabPaneTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 /*
   2  * Copyright (c) 2010, 2018, Oracle and/or its affiliates. All rights reserved.
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 package test.javafx.scene.control;
  27 
  28 import com.sun.javafx.scene.SceneHelper;
  29 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.assertPseudoClassDoesNotExist;
  30 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.assertPseudoClassExists;
  31 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.assertStyleClassContains;
  32 import static org.junit.Assert.assertEquals;
  33 import static org.junit.Assert.assertFalse;
  34 import static org.junit.Assert.assertNotNull;
  35 import static org.junit.Assert.assertNull;
  36 import static org.junit.Assert.assertSame;
  37 import static org.junit.Assert.assertTrue;
  38 import static org.junit.Assert.fail;
  39 
  40 import test.com.sun.javafx.scene.control.infrastructure.StageLoader;
  41 import javafx.application.Platform;
  42 import javafx.beans.property.BooleanProperty;
  43 import javafx.beans.property.DoubleProperty;
  44 import javafx.beans.property.ObjectProperty;
  45 import javafx.beans.property.SimpleBooleanProperty;
  46 import javafx.beans.property.SimpleDoubleProperty;
  47 import javafx.beans.property.SimpleObjectProperty;
  48 import javafx.beans.value.ChangeListener;
  49 import javafx.css.CssMetaData;
  50 import javafx.css.StyleableProperty;
  51 import javafx.event.Event;
  52 import javafx.geometry.Bounds;
  53 import javafx.geometry.Side;
  54 import javafx.scene.Group;
  55 import javafx.scene.Scene;
  56 import javafx.scene.input.KeyEvent;
  57 import javafx.scene.input.MouseEvent;
  58 import javafx.scene.layout.StackPane;
  59 import javafx.scene.layout.VBox;
  60 import javafx.stage.Stage;
  61 
  62 import org.junit.Before;
  63 import org.junit.Ignore;
  64 import org.junit.Test;
  65 
  66 import test.com.sun.javafx.pgstub.StubToolkit;
  67 import test.com.sun.javafx.scene.control.infrastructure.KeyEventFirer;
  68 import test.com.sun.javafx.scene.control.infrastructure.MouseEventGenerator;
  69 import com.sun.javafx.scene.input.KeyCodeMap;
  70 import com.sun.javafx.tk.Toolkit;
  71 
  72 import java.util.Arrays;
  73 import java.util.HashMap;
  74 import java.util.LinkedList;
  75 import java.util.List;
  76 import java.util.Map;
  77 import javafx.scene.control.Button;
  78 import javafx.scene.control.ContextMenu;
  79 import javafx.scene.control.ScrollPane;
  80 import javafx.scene.control.SingleSelectionModel;
  81 import javafx.scene.control.SingleSelectionModelShim;
  82 import javafx.scene.control.skin.TabPaneSkin;
  83 import javafx.scene.control.skin.TabPaneSkinShim;
  84 import javafx.scene.control.SplitPane;
  85 import javafx.scene.control.Tab;
  86 import javafx.scene.control.TabPane;
  87 import javafx.scene.control.TabPaneShim;
  88 
  89 import java.lang.ref.WeakReference;
  90 
  91 public class TabPaneTest {
  92     private TabPane tabPane;//Empty string
  93     private Toolkit tk;
  94     private SingleSelectionModel&lt;Tab&gt; sm;
  95     private Tab tab1;
  96     private Tab tab2;
  97     private Tab tab3;
  98     private Scene scene;
  99     private Stage stage;
 100     private StackPane root;
 101 
 102     @Before public void setup() {
 103         tk = (StubToolkit)Toolkit.getToolkit();//This step is not needed (Just to make sure StubToolkit is loaded into VM)
 104         tabPane = new TabPane();
 105         tab1 = new Tab(&quot;one&quot;);
 106         tab2 = new Tab(&quot;two&quot;);
 107         tab3 = new Tab(&quot;three&quot;);
 108         sm = TabPaneShim.getTabPaneSelectionModel(tabPane);
 109         root = new StackPane();
 110         scene = new Scene(root);
 111         stage = new Stage();
 112         stage.setScene(scene);
 113     }
 114 
 115     /*********************************************************************
 116      * Helper methods                                                    *
 117      ********************************************************************/
 118 
 119     private void show() {
 120         stage.show();
 121         stage.requestFocus();
 122     }
 123 
 124     /*********************************************************************
 125      * Tests for default values                                         *
 126      ********************************************************************/
 127 
 128     @Test public void defaultConstructorShouldSetStyleClassTo_tabpane() {
 129         assertStyleClassContains(tabPane, &quot;tab-pane&quot;);
 130     }
 131 
 132     @Test public void defaultConstructorSelectionModelNotNull() {
 133         assertNotNull(tabPane.getSelectionModel());
 134     }
 135 
 136     @Test public void defaultConstructorInitialTabsEmpty() {
 137         assertNotNull(tabPane.getTabs());
 138         assertEquals(tabPane.getTabs().size(), 0.0, 0.0);
 139     }
 140 
 141     @Test public void defaultSideIsTop() {
 142         assertSame(tabPane.getSide(), Side.TOP);
 143     }
 144 
 145     @Test public void defaultConstructorTabClosingPolicy() {
 146         assertNotNull(tabPane.getTabClosingPolicy());
 147         assertSame(tabPane.getTabClosingPolicy(), TabPane.TabClosingPolicy.SELECTED_TAB);
 148     }
 149 
 150     @Test public void defaultConstructorRotateGraphic() {
 151         assertFalse(tabPane.isRotateGraphic());
 152     }
 153 
 154     @Test public void defaultTabMinWidth() {
 155         assertEquals(tabPane.getTabMinWidth(), 0.0, 0.0);
 156     }
 157 
 158     @Test public void defaultTabMaxWidth() {
 159         assertEquals(tabPane.getTabMaxWidth(), Double.MAX_VALUE, 0.0);
 160     }
 161 
 162     @Test public void defaultTabMinHeight() {
 163         assertEquals(tabPane.getTabMinHeight(), 0.0, 0.0);
 164     }
 165 
 166     @Test public void defaultTabMaxHeight() {
 167         assertEquals(tabPane.getTabMaxHeight(), Double.MAX_VALUE, 0.0);
 168     }
 169 
 170     @Test public void defaultSelectionModelEmpty() {
 171         assertTrue(tabPane.getSelectionModel().isEmpty());
 172     }
 173 
 174     @Test public void initialBoundsInParentMatchesWidthAndHeight() {
 175         TabPane testPane = new TabPane();
 176         testPane.resize(400, 400);
 177         testPane.setSkin(new TabPaneSkin(testPane));
 178         Bounds boundsInParent = testPane.getBoundsInParent();
 179         assertEquals(testPane.getWidth(), boundsInParent.getWidth(), 0.0);
 180         assertEquals(testPane.getHeight(), boundsInParent.getHeight(), 0.0);
 181     }
 182 
 183     /*********************************************************************
 184      * Tests for property binding                                        *
 185      ********************************************************************/
 186 
 187     @Test public void checkSelectionModelPropertyBind() {
 188         ObjectProperty objPr = new SimpleObjectProperty&lt;SingleSelectionModel&lt;Tab&gt;&gt;(null);
 189         tabPane.selectionModelProperty().bind(objPr);
 190         assertNull(&quot;selectionModel cannot be bound&quot;, tabPane.selectionModelProperty().getValue());
 191         objPr.setValue(sm);
 192         assertSame(&quot;selectionModel cannot be bound&quot;, tabPane.selectionModelProperty().getValue(), sm);
 193     }
 194 
 195     @Test public void checkSidePropertyBind() {
 196         ObjectProperty objPr = new SimpleObjectProperty&lt;Side&gt;(Side.BOTTOM);
 197         tabPane.sideProperty().bind(objPr);
 198         assertSame(&quot;side cannot be bound&quot;, tabPane.sideProperty().getValue(), Side.BOTTOM);
 199         objPr.setValue(Side.RIGHT);
 200         assertSame(&quot;side cannot be bound&quot;, tabPane.sideProperty().getValue(), Side.RIGHT);
 201     }
 202 
 203     @Test public void checkTabClosingPropertyBind() {
 204         ObjectProperty objPr = new SimpleObjectProperty&lt;TabPane.TabClosingPolicy&gt;(TabPane.TabClosingPolicy.UNAVAILABLE);
 205         tabPane.tabClosingPolicyProperty().bind(objPr);
 206         assertSame(&quot;side cannot be bound&quot;, tabPane.tabClosingPolicyProperty().getValue(), TabPane.TabClosingPolicy.UNAVAILABLE);
 207         objPr.setValue(TabPane.TabClosingPolicy.ALL_TABS);
 208         assertSame(&quot;side cannot be bound&quot;, tabPane.tabClosingPolicyProperty().getValue(), TabPane.TabClosingPolicy.ALL_TABS);
 209     }
 210 
 211     @Test public void checkRotateGraphicsPropertyBind() {
 212         BooleanProperty objPr = new SimpleBooleanProperty(false);
 213         tabPane.rotateGraphicProperty().bind(objPr);
 214         assertFalse(&quot;rotateGraphic cannot be bound&quot;, tabPane.rotateGraphicProperty().getValue());
 215         objPr.setValue(true);
 216         assertTrue(&quot;rotateGraphic cannot be bound&quot;, tabPane.rotateGraphicProperty().getValue());
 217     }
 218 
 219     @Test public void checkTabMinWidthPropertyBind() {
 220         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 221         tabPane.tabMinWidthProperty().bind(objPr);
 222         assertEquals(&quot;tabMinWidthProperty cannot be bound&quot;, tabPane.tabMinWidthProperty().getValue(), 2.0, 0.0);
 223         objPr.setValue(5.0);
 224         assertEquals(&quot;tabMinWidthProperty cannot be bound&quot;, tabPane.tabMinWidthProperty().getValue(), 5.0, 0.0);
 225     }
 226 
 227     @Test public void checkTabMaxWidthPropertyBind() {
 228         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 229         tabPane.tabMaxWidthProperty().bind(objPr);
 230         assertEquals(&quot;tabMaxWidthProperty cannot be bound&quot;, tabPane.tabMaxWidthProperty().getValue(), 2.0, 0.0);
 231         objPr.setValue(5.0);
 232         assertEquals(&quot;tabMaxWidthProperty cannot be bound&quot;, tabPane.tabMaxWidthProperty().getValue(), 5.0, 0.0);
 233     }
 234 
 235 
 236     @Test public void checkTabMinHeightPropertyBind() {
 237         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 238         tabPane.tabMinHeightProperty().bind(objPr);
 239         assertEquals(&quot;tabMinHeightProperty cannot be bound&quot;, tabPane.tabMinHeightProperty().getValue(), 2.0, 0.0);
 240         objPr.setValue(5.0);
 241         assertEquals(&quot;tabMinHeightProperty cannot be bound&quot;, tabPane.tabMinHeightProperty().getValue(), 5.0, 0.0);
 242     }
 243 
 244     @Test public void checkTabMaxHeightPropertyBind() {
 245         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 246         tabPane.tabMaxHeightProperty().bind(objPr);
 247         assertEquals(&quot;tabMaxHeightProperty cannot be bound&quot;, tabPane.tabMaxHeightProperty().getValue(), 2.0, 0.0);
 248         objPr.setValue(5.0);
 249         assertEquals(&quot;tabMaxHeightProperty cannot be bound&quot;, tabPane.tabMaxHeightProperty().getValue(), 5.0, 0.0);
 250     }
 251 
 252     @Test public void selectionModelPropertyHasBeanReference() {
 253         assertSame(tabPane, tabPane.selectionModelProperty().getBean());
 254     }
 255 
 256     @Test public void selectionModelPropertyHasName() {
 257         assertEquals(&quot;selectionModel&quot;, tabPane.selectionModelProperty().getName());
 258     }
 259 
 260     @Test public void sidePropertyHasBeanReference() {
 261         assertSame(tabPane, tabPane.sideProperty().getBean());
 262     }
 263 
 264     @Test public void sidePropertyHasName() {
 265         assertEquals(&quot;side&quot;, tabPane.sideProperty().getName());
 266     }
 267 
 268     @Test public void tabClosingPolicyPropertyHasBeanReference() {
 269         assertSame(tabPane, tabPane.tabClosingPolicyProperty().getBean());
 270     }
 271 
 272     @Test public void tabClosingPolicyPropertyHasName() {
 273         assertEquals(&quot;tabClosingPolicy&quot;, tabPane.tabClosingPolicyProperty().getName());
 274     }
 275 
 276     @Test public void rotateGraphicPropertyHasBeanReference() {
 277         assertSame(tabPane, tabPane.rotateGraphicProperty().getBean());
 278     }
 279 
 280     @Test public void rotateGraphicPropertyHasName() {
 281         assertEquals(&quot;rotateGraphic&quot;, tabPane.rotateGraphicProperty().getName());
 282     }
 283 
 284     @Test public void tabMinWidthPropertyHasBeanReference() {
 285         assertSame(tabPane, tabPane.tabMinWidthProperty().getBean());
 286     }
 287 
 288     @Test public void tabMinWidthPropertyHasName() {
 289         assertEquals(&quot;tabMinWidth&quot;, tabPane.tabMinWidthProperty().getName());
 290     }
 291 
 292     @Test public void tabMaxWidthPropertyHasBeanReference() {
 293         assertSame(tabPane, tabPane.tabMaxWidthProperty().getBean());
 294     }
 295 
 296     @Test public void tabMaxWidthPropertyHasName() {
 297         assertEquals(&quot;tabMaxWidth&quot;, tabPane.tabMaxWidthProperty().getName());
 298     }
 299 
 300     @Test public void tabMinHeightPropertyHasBeanReference() {
 301         assertSame(tabPane, tabPane.tabMinHeightProperty().getBean());
 302     }
 303 
 304     @Test public void tabMinHeightPropertyHasName() {
 305         assertEquals(&quot;tabMinHeight&quot;, tabPane.tabMinHeightProperty().getName());
 306     }
 307 
 308     @Test public void tabMaxHeightPropertyHasBeanReference() {
 309         assertSame(tabPane, tabPane.tabMaxHeightProperty().getBean());
 310     }
 311 
 312     @Test public void tabMaxHeightPropertyHasName() {
 313         assertEquals(&quot;tabMaxHeight&quot;, tabPane.tabMaxHeightProperty().getName());
 314     }
 315 
 316 
 317     /*********************************************************************
 318      * Check for Pseudo classes                                          *
 319      ********************************************************************/
 320 
 321     @Test public void settingSideSetsPseudoClass() {
 322         tabPane.setSide(Side.BOTTOM);
 323         assertPseudoClassExists(tabPane, &quot;bottom&quot;);
 324         assertPseudoClassDoesNotExist(tabPane, &quot;top&quot;);
 325         assertPseudoClassDoesNotExist(tabPane, &quot;left&quot;);
 326         assertPseudoClassDoesNotExist(tabPane, &quot;right&quot;);
 327     }
 328 
 329     @Test public void clearingSideClearsPseudoClass() {
 330         tabPane.setSide(Side.BOTTOM);
 331         tabPane.setSide(Side.LEFT);
 332         assertPseudoClassExists(tabPane, &quot;left&quot;);
 333         assertPseudoClassDoesNotExist(tabPane, &quot;bottom&quot;);
 334         assertPseudoClassDoesNotExist(tabPane, &quot;top&quot;);
 335         assertPseudoClassDoesNotExist(tabPane, &quot;right&quot;);
 336     }
 337 
 338 
 339     /*********************************************************************
 340      * CSS related Tests                                                 *
 341      ********************************************************************/
 342 
 343     @Test public void whenTabMinWidthIsBound_impl_cssSettable_ReturnsFalse() {
 344         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinWidthProperty()).getCssMetaData();
 345         assertTrue(styleable.isSettable(tabPane));
 346         DoubleProperty other = new SimpleDoubleProperty(30.0);
 347         tabPane.tabMinWidthProperty().bind(other);
 348         assertFalse(styleable.isSettable(tabPane));
 349     }
 350 
 351     @Test public void whenTabMinWidthIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 352         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinWidthProperty()).getCssMetaData();
 353         assertTrue(styleable.isSettable(tabPane));
 354     }
 355 
 356     @Test public void canSpecifyTabMinWidthViaCSS() {
 357         ((StyleableProperty)tabPane.tabMinWidthProperty()).applyStyle(null, 34.0);
 358         assertEquals(34.0, tabPane.getTabMinWidth(), 0.0);
 359     }
 360 
 361     @Test public void whenTabMaxWidthIsBound_impl_cssSettable_ReturnsFalse() {
 362         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxWidthProperty()).getCssMetaData();
 363         assertTrue(styleable.isSettable(tabPane));
 364         DoubleProperty other = new SimpleDoubleProperty(30.0);
 365         tabPane.tabMaxWidthProperty().bind(other);
 366         assertFalse(styleable.isSettable(tabPane));
 367     }
 368 
 369     @Test public void whenTabMaxWidthIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 370         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxWidthProperty()).getCssMetaData();
 371         assertTrue(styleable.isSettable(tabPane));
 372     }
 373 
 374     @Test public void canSpecifyTabMaxWidthViaCSS() {
 375         ((StyleableProperty)tabPane.tabMaxWidthProperty()).applyStyle(null, 34.0);
 376         assertEquals(34.0, tabPane.getTabMaxWidth(), 0.0);
 377     }
 378 
 379     @Test public void whenTabMinHeightIsBound_impl_cssSettable_ReturnsFalse() {
 380         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinHeightProperty()).getCssMetaData();
 381         assertTrue(styleable.isSettable(tabPane));
 382         DoubleProperty other = new SimpleDoubleProperty(30.0);
 383         tabPane.tabMinHeightProperty().bind(other);
 384         assertFalse(styleable.isSettable(tabPane));
 385     }
 386 
 387     @Test public void whenTabMinHeightIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 388         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinHeightProperty()).getCssMetaData();
 389         assertTrue(styleable.isSettable(tabPane));
 390     }
 391 
 392     @Test public void canSpecifyTabMinHeightViaCSS() {
 393         ((StyleableProperty)tabPane.tabMinHeightProperty()).applyStyle(null, 34.0);
 394         assertEquals(34.0, tabPane.getTabMinHeight(), 0.0);
 395     }
 396 
 397     @Test public void whenTabMaxHeightIsBound_impl_cssSettable_ReturnsFalse() {
 398         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxHeightProperty()).getCssMetaData();
 399         assertTrue(styleable.isSettable(tabPane));
 400         DoubleProperty other = new SimpleDoubleProperty(30.0);
 401         tabPane.tabMaxHeightProperty().bind(other);
 402         assertFalse(styleable.isSettable(tabPane));
 403     }
 404 
 405     @Test public void whenTabMaxHeightIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 406         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxHeightProperty()).getCssMetaData();
 407         assertTrue(styleable.isSettable(tabPane));
 408     }
 409 
 410     @Test public void canSpecifyTabMaxHeightViaCSS() {
 411         ((StyleableProperty)tabPane.tabMaxHeightProperty()).applyStyle(null, 34.0);
 412         assertEquals(34.0, tabPane.getTabMaxHeight(), 0.0);
 413     }
 414 
 415 
 416     /*********************************************************************
 417      * Miscellaneous Tests                                               *
 418      ********************************************************************/
 419 
 420     @Test public void setSelectionModelAndSeeValueIsReflectedInModel() {
 421         tabPane.setSelectionModel(sm);
 422         assertSame(tabPane.selectionModelProperty().getValue(), sm);
 423     }
 424 
 425     @Test public void setselectionModelAndSeeValue() {
 426         tabPane.setSelectionModel(sm);
 427         assertSame(tabPane.getSelectionModel(), sm);
 428     }
 429 
 430     @Test public void setSideAndSeeValueIsReflectedInModel() {
 431         tabPane.setSide(Side.BOTTOM);
 432         assertSame(tabPane.sideProperty().getValue(), Side.BOTTOM);
 433     }
 434 
 435     @Test public void setSideAndSeeValue() {
 436         tabPane.setSide(Side.LEFT);
 437         assertSame(tabPane.getSide(), Side.LEFT);
 438     }
 439 
 440     @Test public void setTabClosingPolicyAndSeeValueIsReflectedInModel() {
 441         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.ALL_TABS);
 442         assertSame(tabPane.tabClosingPolicyProperty().getValue(), TabPane.TabClosingPolicy.ALL_TABS);
 443     }
 444 
 445     @Test public void setTabClosingPolicyAndSeeValue() {
 446         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.UNAVAILABLE);
 447         assertSame(tabPane.getTabClosingPolicy(), TabPane.TabClosingPolicy.UNAVAILABLE);
 448     }
 449 
 450     @Test public void setTabDragPolicyAndSeeValueIsReflectedInModel() {
 451         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.REORDER);
 452         assertSame(TabPane.TabDragPolicy.REORDER, tabPane.tabDragPolicyProperty().getValue());
 453 
 454         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.FIXED);
 455         assertSame(TabPane.TabDragPolicy.FIXED, tabPane.tabDragPolicyProperty().getValue());
 456     }
 457 
 458     @Test public void setTabDragPolicyAndSeeValue() {
 459         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.REORDER);
 460         assertSame(TabPane.TabDragPolicy.REORDER, tabPane.getTabDragPolicy());
 461 
 462         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.FIXED);
 463         assertSame(TabPane.TabDragPolicy.FIXED, tabPane.getTabDragPolicy());
 464     }
 465 
 466     @Test public void setRotateGraphicAndSeeValueIsReflectedInModel() {
 467         tabPane.setRotateGraphic(true);
 468         assertTrue(tabPane.rotateGraphicProperty().getValue());
 469     }
 470 
 471     @Test public void setRotateGraphicAndSeeValue() {
 472         tabPane.setRotateGraphic(true);
 473         assertTrue(tabPane.isRotateGraphic());
 474     }
 475 
 476     @Test public void setTabMinWidthAndSeeValueIsReflectedInModel() {
 477         tabPane.setTabMinWidth(30.0);
 478         assertEquals(tabPane.tabMinWidthProperty().getValue(), 30.0, 0.0);
 479     }
 480 
 481     @Test public void setTabMinWidthAndSeeValue() {
 482         tabPane.setTabMinWidth(30.0);
 483         assertEquals(tabPane.getTabMinWidth(), 30.0, 0.0);
 484     }
 485 
 486     @Test public void setTabMaxWidthAndSeeValueIsReflectedInModel() {
 487         tabPane.setTabMaxWidth(30.0);
 488         assertEquals(tabPane.tabMaxWidthProperty().getValue(), 30.0, 0.0);
 489     }
 490 
 491     @Test public void setTabMaxWidthAndSeeValue() {
 492         tabPane.setTabMaxWidth(30.0);
 493         assertEquals(tabPane.getTabMaxWidth(), 30.0, 0.0);
 494     }
 495 
 496     @Test public void setTabMinHeightAndSeeValueIsReflectedInModel() {
 497         tabPane.setTabMinHeight(30.0);
 498         assertEquals(tabPane.tabMinHeightProperty().getValue(), 30.0, 0.0);
 499     }
 500 
 501     @Test public void setTabMinHeightAndSeeValue() {
 502         tabPane.setTabMinHeight(30.0);
 503         assertEquals(tabPane.getTabMinHeight(), 30.0, 0.0);
 504     }
 505 
 506     @Test public void setTabMaxHeightAndSeeValueIsReflectedInModel() {
 507         tabPane.setTabMaxHeight(30.0);
 508         assertEquals(tabPane.tabMaxHeightProperty().getValue(), 30.0, 0.0);
 509     }
 510 
 511     @Test public void setTabMaxHeightAndSeeValue() {
 512         tabPane.setTabMaxHeight(30.0);
 513         assertEquals(tabPane.getTabMaxHeight(), 30.0, 0.0);
 514     }
 515 
 516     @Test public void addTabsCheckItemCountInSelectionModel() {
 517         tabPane.getTabs().add(tab1);
 518         tabPane.getTabs().add(tab2);
 519         assertEquals(SingleSelectionModelShim.getItemCount(tabPane.getSelectionModel()), 2.0, 0.0);
 520     }
 521 
 522     @Test public void addTabsCheckItemInSelectionModel() {
 523         tabPane.getTabs().add(tab1);
 524         tabPane.getTabs().add(tab2);
 525         assertSame(SingleSelectionModelShim.getModelItem(tabPane.getSelectionModel(), 0), tab1);
 526         assertSame(SingleSelectionModelShim.getModelItem(tabPane.getSelectionModel(), 1), tab2);
 527     }
 528 
 529     @Test public void addTabsCheckSelectUsingObjInSelectionModel() {
 530         tabPane.getTabs().add(tab1);
 531         tabPane.getTabs().add(tab2);
 532         tabPane.getSelectionModel().select(tab1);
 533         assertTrue(tabPane.getSelectionModel().isSelected(0));
 534     }
 535 
 536     @Test public void addTabsCheckSelectUsingIndexInSelectionModel() {
 537         tabPane.getTabs().add(tab1);
 538         tabPane.getTabs().add(tab2);
 539         tabPane.getSelectionModel().select(1);
 540         assertTrue(tabPane.getSelectionModel().isSelected(1));
 541     }
 542 
 543     @Test public void addTabsCheckClearAndSelectUsingIndexInSelectionModel() {
 544         tabPane.getTabs().add(tab1);
 545         tabPane.getTabs().add(tab2);
 546         tabPane.getSelectionModel().clearAndSelect(1);
 547         assertTrue(tabPane.getSelectionModel().isSelected(1));
 548     }
 549 
 550     @Test public void addTabsCheckSelectMultipleItemsAndClearOneItemInSelectionModel() {
 551         tabPane.getTabs().add(tab1);
 552         tabPane.getTabs().add(tab2);
 553         tabPane.getSelectionModel().select(0);
 554         tabPane.getSelectionModel().select(1);
 555         tabPane.getSelectionModel().clearSelection(0);
 556         assertFalse(tabPane.getSelectionModel().isSelected(0));
 557         assertTrue(tabPane.getSelectionModel().isSelected(1));
 558     }
 559 
 560     @Test public void addTabsCheckSelectMultipleItemsAndClearAllSelectionInSelectionModel() {
 561         tabPane.getTabs().add(tab1);
 562         tabPane.getTabs().add(tab2);
 563         tabPane.getSelectionModel().select(0);
 564         tabPane.getSelectionModel().select(1);
 565         tabPane.getSelectionModel().clearSelection();
 566         assertFalse(tabPane.getSelectionModel().isSelected(0));
 567         assertFalse(tabPane.getSelectionModel().isSelected(1));
 568         assertTrue(tabPane.getSelectionModel().isEmpty());
 569     }
 570 
 571     @Test public void addTabsCheckSelectUsingIteratorKindOfMethodsInSelectionModel() {
 572         tabPane.getTabs().add(tab1);
 573         tabPane.getTabs().add(tab2);
 574         tabPane.getSelectionModel().selectFirst();
 575         assertTrue(tabPane.getSelectionModel().isSelected(0));
 576         assertFalse(tabPane.getSelectionModel().isSelected(1));
 577         tabPane.getSelectionModel().selectNext();
 578         assertFalse(tabPane.getSelectionModel().isSelected(0));
 579         assertTrue(tabPane.getSelectionModel().isSelected(1));
 580         tabPane.getSelectionModel().clearSelection();
 581         tabPane.getSelectionModel().selectLast();
 582         assertFalse(tabPane.getSelectionModel().isSelected(0));
 583         assertTrue(tabPane.getSelectionModel().isSelected(1));
 584         tabPane.getSelectionModel().selectPrevious();
 585         assertTrue(tabPane.getSelectionModel().isSelected(0));
 586         assertFalse(tabPane.getSelectionModel().isSelected(1));
 587     }
 588 
 589     @Test public void flipTabOrder_RT20156() {
 590         tabPane.setSkin(new TabPaneSkin(tabPane));
 591         tabPane.getTabs().add(tab1);
 592         tabPane.getTabs().add(tab2);
 593         tabPane.getTabs().add(tab3);
 594 
 595         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 596         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 597         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 598 
 599         final int lastTabIndex = tabPane.getTabs().size()-1;
 600         final Tab lastTab = tabPane.getTabs().get(lastTabIndex);
 601         tabPane.getTabs().remove(lastTabIndex);
 602         tabPane.getTabs().add(0, lastTab);
 603 
 604         assertEquals(&quot;three&quot;, tabPane.getTabs().get(0).getText());
 605         assertEquals(&quot;one&quot;, tabPane.getTabs().get(1).getText());
 606         assertEquals(&quot;two&quot;, tabPane.getTabs().get(2).getText());
 607         assertTrue(tabPane.getSelectionModel().isSelected(1));
 608     }
 609 
 610     @Test public void disableAllTabs() {
 611         tabPane.setSkin(new TabPaneSkin(tabPane));
 612         tabPane.getTabs().add(tab1);
 613         tabPane.getTabs().add(tab2);
 614         tabPane.getTabs().add(tab3);
 615 
 616         tab1.setDisable(true);
 617         tab2.setDisable(true);
 618         tab3.setDisable(true);
 619 
 620         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 621         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 622     }
 623 
 624     @Test public void disableFirstTabs() {
 625         tabPane.setSkin(new TabPaneSkin(tabPane));
 626         tabPane.getTabs().add(tab1);
 627         tabPane.getTabs().add(tab2);
 628         tabPane.getTabs().add(tab3);
 629 
 630         tab1.setDisable(true);
 631         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 632         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 633     }
 634 
 635     @Test public void disableATabAndSelectItByIndex() {
 636         tabPane.setSkin(new TabPaneSkin(tabPane));
 637         tabPane.getTabs().add(tab1);
 638         tabPane.getTabs().add(tab2);
 639         tabPane.getTabs().add(tab3);
 640 
 641         tab2.setDisable(true);
 642         tabPane.getSelectionModel().select(1);
 643         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 644         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 645     }
 646 
 647     @Test public void selectByIndexADisableTab() {
 648         tabPane.setSkin(new TabPaneSkin(tabPane));
 649         tabPane.getTabs().add(tab1);
 650         tabPane.getTabs().add(tab2);
 651         tabPane.getTabs().add(tab3);
 652 
 653         tabPane.getSelectionModel().select(1);
 654         tab2.setDisable(true);
 655         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 656         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 657         assertTrue(tab2.isDisable());
 658     }
 659 
 660     @Test public void disableATabAndSelectItByTab() {
 661         tabPane.setSkin(new TabPaneSkin(tabPane));
 662         tabPane.getTabs().add(tab1);
 663         tabPane.getTabs().add(tab2);
 664         tabPane.getTabs().add(tab3);
 665 
 666         tab2.setDisable(true);
 667         tabPane.getSelectionModel().select(tab2);
 668         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 669         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 670     }
 671 
 672     @Test public void selectByTabADisableTab() {
 673         tabPane.setSkin(new TabPaneSkin(tabPane));
 674         tabPane.getTabs().add(tab1);
 675         tabPane.getTabs().add(tab2);
 676         tabPane.getTabs().add(tab3);
 677 
 678         tabPane.getSelectionModel().select(tab2);
 679         tab2.setDisable(true);
 680         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 681         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 682         assertTrue(tab2.isDisable());
 683     }
 684 
 685     @Test public void navigateOverDisableTab() {
 686         tabPane.getTabs().add(tab1);
 687         tabPane.getTabs().add(tab2);
 688         tabPane.getTabs().add(tab3);
 689 
 690         root.getChildren().add(tabPane);
 691         show();
 692         tabPane.requestFocus();
 693 
 694         assertTrue(tabPane.isFocused());
 695 
 696         tab2.setDisable(true);
 697         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 698         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 699         assertTrue(tab2.isDisable());
 700 
 701         KeyEventFirer keyboard = new KeyEventFirer(tabPane);
 702         keyboard.doRightArrowPress();
 703 
 704         assertEquals(2, tabPane.getSelectionModel().getSelectedIndex());
 705         assertEquals(tab3, tabPane.getSelectionModel().getSelectedItem());
 706 
 707         keyboard.doLeftArrowPress();
 708 
 709         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 710         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 711     }
 712 
 713     @Ignore
 714     @Test public void mousePressSelectsATab_RT20476() {
 715         tabPane.getTabs().add(tab1);
 716         tabPane.getTabs().add(tab2);
 717         tabPane.getTabs().add(tab3);
 718 
 719         tab1.setContent(new Button(&quot;TAB1&quot;));
 720         tab2.setContent(new Button(&quot;TAB2&quot;));
 721         tab3.setContent(new Button(&quot;TAB3&quot;));
 722 
 723         root.getChildren().add(tabPane);
 724         show();
 725 
 726         root.applyCss();
 727         root.resize(300, 300);
 728         root.layout();
 729 
 730         tk.firePulse();
 731         assertTrue(tabPane.isFocused());
 732 
 733         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
 734         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
 735 
 736         SceneHelper.processMouseEvent(scene,
 737             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval+75, yval+20));
 738         tk.firePulse();
 739 
 740         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 741         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 742     }
 743 
 744     private int counter = 0;
 745     @Ignore
 746     @Test public void setOnSelectionChangedFiresTwice_RT21089() {
 747         tabPane.getTabs().add(tab1);
 748         tabPane.getTabs().add(tab2);
 749 
 750         tab1.setContent(new Button(&quot;TAB1&quot;));
 751         tab2.setContent(new Button(&quot;TAB2&quot;));
 752 
 753         root.getChildren().add(tabPane);
 754         show();
 755 
 756         root.applyCss();
 757         root.resize(300, 300);
 758         root.layout();
 759 
 760         tk.firePulse();
 761         assertTrue(tabPane.isFocused());
 762 
 763         tab2.setOnSelectionChanged(event -&gt; {
 764             assertEquals(0, counter++);
 765         });
 766 
 767         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
 768         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
 769 
 770         SceneHelper.processMouseEvent(scene,
 771             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval+75, yval+20));
 772         tk.firePulse();
 773 
 774         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 775 
 776         SceneHelper.processMouseEvent(scene,
 777             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval+75, yval+20));
 778         tk.firePulse();
 779         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 780     }
 781 
 782     @Test public void unableToSelectNextTabWhenFirstTabIsClosed_RT22326() {
 783         tabPane.getTabs().add(tab1);
 784         tabPane.getTabs().add(tab2);
 785         tabPane.getTabs().add(tab3);
 786 
 787         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 788         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 789         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 790 
 791         tabPane.getTabs().remove(tab1);
 792 
 793         assertEquals(2, tabPane.getTabs().size());
 794         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 795         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 796         tabPane.getSelectionModel().selectNext();
 797         assertEquals(tab3, tabPane.getSelectionModel().getSelectedItem());
 798     }
 799 
 800     @Test public void removeFirstTabNextTabShouldBeSelected() {
 801         tabPane.getTabs().add(tab1);
 802         tabPane.getTabs().add(tab2);
 803         tabPane.getTabs().add(tab3);
 804 
 805         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 806         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 807         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 808 
 809         tabPane.getTabs().remove(tab1);
 810 
 811         assertEquals(2, tabPane.getTabs().size());
 812         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 813         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 814     }
 815 
 816     @Test public void selectionModelShouldNotBeNullWhenClosingFirstTab_RT22925() {
 817         tabPane.getTabs().add(tab1);
 818         tabPane.getTabs().add(tab2);
 819         tabPane.getTabs().add(tab3);
 820 
 821         tabPane.getSelectionModel().selectedItemProperty().addListener((ov, t, t1) -&gt; {
 822             assertEquals(t.getText(), &quot;one&quot;);
 823             assertEquals(t1.getText(), &quot;two&quot;);
 824         });
 825 
 826         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 827         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 828         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 829 
 830         tabPane.getTabs().remove(tab1);
 831 
 832         assertEquals(2, tabPane.getTabs().size());
 833         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 834         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 835     }
 836 
 837 
 838     boolean button1Focused = false;
 839     @Test public void focusTraversalShouldLookInsideEmbeddedEngines() {
 840 
 841         Button b1 = new Button(&quot;Button1&quot;);
 842         final ChangeListener&lt;Boolean&gt; focusListener = (observable, oldVal, newVal) -&gt; {
 843             button1Focused = true;
 844         };
 845         b1.focusedProperty().addListener(focusListener);
 846 
 847         final ScrollPane sp = new ScrollPane();
 848         final VBox vbox1 = new VBox();
 849         vbox1.setSpacing(10);
 850         vbox1.setTranslateX(10);
 851         vbox1.setTranslateY(10);
 852         vbox1.getChildren().addAll(b1);
 853         tab1.setContent(vbox1);
 854         sp.setContent(vbox1);
 855         tab1.setContent(sp);
 856         tabPane.getTabs().add(tab1);
 857 
 858         tabPane.getTabs().add(tab2);
 859 
 860         final Scene scene1 = new Scene(new Group(), 400, 400);
 861         ((Group)scene1.getRoot()).getChildren().add(tabPane);
 862 
 863         stage.setScene(scene1);
 864         stage.show();
 865         stage.requestFocus();
 866 
 867         final KeyEvent tabEvent = new KeyEvent(KeyEvent.KEY_PRESSED, &quot;&quot;, &quot;&quot;, KeyCodeMap.valueOf(0x09),
 868                                                          false, false, false, false);
 869         Platform.runLater(() -&gt; {
 870             tabPane.requestFocus();
 871             Event.fireEvent(tabPane, tabEvent);
 872 
 873         });
 874 
 875         assertTrue(button1Focused);
 876 
 877     }
 878 
 879     @Test public void test_rt_35013() {
 880         SplitPane splitPane = new SplitPane();
 881         splitPane.getItems().addAll(new Button(&quot;Button1&quot;), new Button(&quot;Button2&quot;));
 882 
 883         TabPane tabPane = new TabPane();
 884         Tab emptyTab;
 885         Tab splitTab = new Tab(&quot;SplitPane Tab&quot;);
 886         splitTab.setContent(splitPane);
 887         tabPane.getTabs().addAll(emptyTab = new Tab(&quot;Empty Tab&quot;), splitTab);
 888 
 889         StageLoader sl = new StageLoader(tabPane);
 890 
 891         tabPane.getSelectionModel().select(emptyTab);
 892         Toolkit.getToolkit().firePulse();
 893         assertFalse(splitPane.getParent().isVisible());
 894 
 895         tabPane.getSelectionModel().select(splitTab);
 896         Toolkit.getToolkit().firePulse();
 897         assertTrue(splitPane.getParent().isVisible());
 898 
 899         sl.dispose();
 900     }
 901 
 902     @Test public void test_rt_36456_default_selectionMovesBackwardOne() {
 903         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 904         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 905         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 906 
 907         TabPane tabPane = new TabPane();
 908         tabPane.getTabs().addAll(tab0, tab1, tab2);
 909         tabPane.getSelectionModel().select(tab1);
 910 
 911         StageLoader sl = new StageLoader(tabPane);
 912 
 913         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 914         tabPane.getTabs().remove(tab1);
 915         assertEquals(tab0, tabPane.getSelectionModel().getSelectedItem());
 916 
 917         sl.dispose();
 918     }
 919 
 920     @Test public void test_rt_36456_selectionMovesBackwardTwoSkippingDisabledTab() {
 921         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 922         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 923         tab1.setDisable(true);
 924         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 925 
 926         TabPane tabPane = new TabPane();
 927         tabPane.getTabs().addAll(tab0, tab1, tab2);
 928         tabPane.getSelectionModel().select(tab2);
 929 
 930         StageLoader sl = new StageLoader(tabPane);
 931 
 932         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 933         tabPane.getTabs().remove(tab2);
 934 
 935         // selection should jump from tab2 to tab0, as tab1 is disabled
 936         assertEquals(tab0, tabPane.getSelectionModel().getSelectedItem());
 937 
 938         sl.dispose();
 939     }
 940 
 941     @Test public void test_rt_36456_selectionMovesForwardOne() {
 942         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 943         tab0.setDisable(true);
 944         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 945         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 946 
 947         TabPane tabPane = new TabPane();
 948         tabPane.getTabs().addAll(tab0, tab1, tab2);
 949         tabPane.getSelectionModel().select(tab1);
 950 
 951         StageLoader sl = new StageLoader(tabPane);
 952 
 953         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 954         tabPane.getTabs().remove(tab1);
 955 
 956         // selection should move to the next non-disabled tab - in this case tab2
 957         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 958 
 959         sl.dispose();
 960     }
 961 
 962     @Test public void test_rt_36456_selectionMovesForwardTwoSkippingDisabledTab() {
 963         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 964         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 965         tab1.setDisable(true);
 966         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 967 
 968         TabPane tabPane = new TabPane();
 969         tabPane.getTabs().addAll(tab0, tab1, tab2);
 970         tabPane.getSelectionModel().select(tab0);
 971 
 972         StageLoader sl = new StageLoader(tabPane);
 973 
 974         Tab selectedTab = tabPane.getSelectionModel().getSelectedItem();
 975         assertEquals(tab0, selectedTab);
 976         tabPane.getTabs().remove(tab0);
 977 
 978         // selection should move to the next non-disabled tab - in this case tab2
 979         selectedTab = tabPane.getSelectionModel().getSelectedItem();
 980         assertEquals(tab2.getText() + &quot; != &quot; +  tab2.getText(), tab2, selectedTab);
 981 
 982         sl.dispose();
 983     }
 984 
 985     @Test public void test_rt_36908() {
 986         TabPane pane = new TabPane();
 987         final Tab disabled = new Tab(&quot;Disabled&quot;);
 988         disabled.setDisable(true);
 989 
 990         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 991         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 992         pane.getTabs().addAll(disabled, tab1, tab2);
 993 
 994         assertEquals(1, pane.getSelectionModel().getSelectedIndex());
 995         assertEquals(tab1, pane.getSelectionModel().getSelectedItem());
 996     }
 997 
 998     @Test public void test_rt_24658() {
 999         Button btn = new Button(&quot;Button&quot;);
1000         final Tab disabled = new Tab(&quot;Disabled&quot;);
1001         disabled.setContent(btn);
1002 
1003         TabPane pane = new TabPane();
1004         pane.getTabs().addAll(disabled);
1005 
1006         assertEquals(0, pane.getSelectionModel().getSelectedIndex());
1007         assertEquals(disabled, pane.getSelectionModel().getSelectedItem());
1008         assertFalse(btn.isDisabled());
1009 
1010         disabled.setDisable(true);
1011         assertTrue(btn.isDisabled());
1012 
1013         disabled.setDisable(false);
1014         assertFalse(btn.isDisabled());
1015     }
1016 
1017     @Test public void test_rt_38382_noAddToTabPane() {
1018         test_rt_38382(false);
1019     }
1020 
1021     @Test public void test_rt_38382_addToTabPane() {
1022         test_rt_38382(true);
1023     }
1024 
1025     public void test_rt_38382(boolean addToTabPane) {
1026         final List&lt;String&gt; names = Arrays.asList(
1027                 &quot;Biomass&quot;,
1028                 &quot;Exploitable Population Biomass&quot;,
1029                 &quot;MSY&quot;,
1030                 &quot;Yield&quot;,
1031                 &quot;Recruitment&quot;,
1032                 &quot;Catch&quot;,
1033                 &quot;Effort&quot;);
1034         final Map&lt;Tab, List&lt;String&gt;&gt; fooMap = new HashMap&lt;&gt;();
1035         final List&lt;Tab&gt; tabList = new LinkedList&lt;&gt;();
1036         for (String name : names) {
1037             final Tab tab = new Tab();
1038             tab.setText(name);
1039             fooMap.put(tab, new LinkedList&lt;&gt;());
1040             tabList.add(tab);
1041         }
1042         TabPane tabPane = new TabPane();
1043 
1044         if (addToTabPane) {
1045             tabPane.getTabs().setAll(tabList);
1046         }
1047 
1048         fooMap.entrySet().forEach(entry -&gt; {
1049             final Tab tab = entry.getKey();
1050             assertTrue(tabList.contains(tab));
1051             assertTrue(fooMap.containsKey(tab));
1052         });
1053     }
1054 
1055     // Test for JDK-8189424
1056     int selectionChangeCount = 0;
1057     @Test public void testTabClosingEventAndSelectionChange() {
1058         Tab t1 = new Tab(&quot;&quot;);
1059         Tab t2 = new Tab(&quot;&quot;);
1060         tabPane.getTabs().add(t1);
1061         tabPane.getTabs().add(t2);
1062         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.ALL_TABS);
1063 
1064         tabPane.getSelectionModel().selectedItemProperty().addListener((ov, oldTab, newTab) -&gt; {
1065             selectionChangeCount++;
1066         });
1067         t1.setOnCloseRequest((event) -&gt; {
1068             event.consume();
1069             tabPane.getTabs().remove(t1);
1070         });
1071 
1072         root.getChildren().add(tabPane);
1073         show();
1074 
1075         root.applyCss();
1076         root.resize(300, 300);
1077         root.layout();
1078 
1079         tk.firePulse();
1080         assertTrue(tabPane.isFocused());
1081 
1082         tabPane.getSelectionModel().select(t1);
1083 
1084         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
1085         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
1086 
1087         SceneHelper.processMouseEvent(scene,
1088             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval + 19, yval + 17));
1089         tk.firePulse();
1090         SceneHelper.processMouseEvent(scene,
1091             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_RELEASED, xval + 19, yval + 17));
1092         tk.firePulse();
1093 
1094         assertEquals(1, tabPane.getTabs().size());
1095         assertEquals(t2, tabPane.getSelectionModel().getSelectedItem());
1096         assertEquals(1, selectionChangeCount);
1097 
1098         tabPane.getTabs().remove(t2);
1099     }
1100 
1101     // Test for JDK-8193495
1102     @Test public void testQuickRemoveAddTab() {
1103         int tabHeaderMinWidth = 200;
1104         int tabHeaderMinHeight = 50;
1105         tabPane.setMaxSize(400, 200);
1106         tabPane.setTabMinWidth(tabHeaderMinWidth);
1107         tabPane.setTabMinHeight(tabHeaderMinHeight);
1108         tabPane.getTabs().addAll(tab1, tab2, tab3);
1109         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.UNAVAILABLE);
1110 
1111         root.getChildren().add(tabPane);
1112         show();
1113         tabPane.requestFocus();
1114         tk.firePulse();
1115         assertTrue(tabPane.isFocused());
1116 
1117         tabPane.getTabs().add(1, tabPane.getTabs().remove(0));
1118         tk.firePulse();
1119         tabPane.getSelectionModel().select(tab1);
1120         tk.firePulse();
1121 
1122         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
1123         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
1124 
1125         SceneHelper.processMouseEvent(scene,
1126             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval + 19, yval + 17));
1127         tk.firePulse();
1128         SceneHelper.processMouseEvent(scene,
1129             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval + 19, yval + 17));
1130         tk.firePulse();
1131 
1132         assertEquals(&quot;Tabpane should have 3 tabs.&quot;, 3, tabPane.getTabs().size());
1133         assertEquals(&quot;tab2 should be at index 0.&quot;, tab2, tabPane.getSelectionModel().getSelectedItem());
1134     }
1135 
1136     // Test for JDK-8154039
1137     WeakReference&lt;Tab&gt; weakTab;
1138     @Test public void testSelectNonChildTab() {
1139         tabPane.getTabs().addAll(tab1);
1140         root.getChildren().add(tabPane);
1141         show();
1142         tk.firePulse();
1143         weakTab = new WeakReference&lt;&gt;(new Tab(&quot;NonChildTab&quot;));
1144         tabPane.getSelectionModel().select(weakTab.get());
1145         tk.firePulse();
1146         attemptGC(10);
1147         tk.firePulse();
1148         assertNull(weakTab.get());
1149     }
1150 
1151     private void attemptGC(int n) {
1152         // Attempt gc n times
1153         for (int i = 0; i &lt; n; i++) {
1154             System.gc();
1155             System.runFinalization();
1156 
1157             if (weakTab.get() == null) {
1158                 break;
1159             }
1160             try {
1161                 Thread.sleep(500);
1162             } catch (InterruptedException e) {
1163                 fail(&quot;InterruptedException occurred during Thread.sleep()&quot;);
1164             }
1165         }
1166     }
1167 
1168     // Test for JDK-8157690
1169     @Test public void testPopupItemsOnSortingTabs() {
1170         tabPane.setMaxSize(20, 20);
1171         root.getChildren().add(tabPane);
1172         tabPane.getTabs().addAll(tab1, tab2, tab3);
1173         show();
1174         tk.firePulse();
1175         TabPaneSkin tbSkin = (TabPaneSkin) tabPane.getSkin();
1176         assertNotNull(tbSkin);
1177         ContextMenu tabsMenu = TabPaneSkinShim.getTabsMenu(tbSkin);
1178         assertNotNull(tabsMenu);
1179         assertEquals(&quot;ContextMenu should contain 3 items.&quot;, 3, tabsMenu.getItems().size());
1180 
1181         tabPane.getTabs().sort((o1, o2) -&gt; sortCompare(o1, o2));
1182         tk.firePulse();
1183         assertEquals(&quot;ContextMenu should contain 3 items.&quot;, 3, tabsMenu.getItems().size());
1184     }
1185 
1186     private int sortCompare(Tab t1, Tab t2) {
1187         return t2.getText().compareTo(t1.getText());
1188     }
1189 }
    </pre>
  </body>
</html>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/html/ColorInputType.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CheckboxInputType.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ColorInputType.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/html/ColorInputType.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 92     ASSERT(element());
 93 #if PLATFORM(IOS_FAMILY)
 94     if (element()-&gt;isReadOnly())
 95         return false;
 96 
 97     return element()-&gt;isTextFormControlFocusable();
 98 #endif
 99     return false;
100 }
101 
102 bool ColorInputType::isColorControl() const
103 {
104     return true;
105 }
106 
107 bool ColorInputType::isPresentingAttachedView() const
108 {
109     return !!m_chooser;
110 }
111 
<span class="line-modified">112 const AtomicString&amp; ColorInputType::formControlType() const</span>
113 {
114     return InputTypeNames::color();
115 }
116 
117 bool ColorInputType::supportsRequired() const
118 {
119     return false;
120 }
121 
122 String ColorInputType::fallbackValue() const
123 {
124     return &quot;#000000&quot;_s;
125 }
126 
127 String ColorInputType::sanitizeValue(const String&amp; proposedValue) const
128 {
129     if (!isValidSimpleColor(proposedValue))
130         return fallbackValue();
131 
132     return proposedValue.convertToASCIILowercase();
133 }
134 
135 Color ColorInputType::valueAsColor() const
136 {
137     ASSERT(element());
138     return parseSimpleColorValue(element()-&gt;value()).value();
139 }
140 
141 void ColorInputType::createShadowSubtree()
142 {
143     ASSERT(element());
144     ASSERT(element()-&gt;shadowRoot());
145 
146     Document&amp; document = element()-&gt;document();
147     auto wrapperElement = HTMLDivElement::create(document);
<span class="line-modified">148     wrapperElement-&gt;setPseudo(AtomicString(&quot;-webkit-color-swatch-wrapper&quot;, AtomicString::ConstructFromLiteral));</span>
149     auto colorSwatch = HTMLDivElement::create(document);
<span class="line-modified">150     colorSwatch-&gt;setPseudo(AtomicString(&quot;-webkit-color-swatch&quot;, AtomicString::ConstructFromLiteral));</span>
151     wrapperElement-&gt;appendChild(colorSwatch);
152     element()-&gt;userAgentShadowRoot()-&gt;appendChild(wrapperElement);
153 
154     updateColorSwatch();
155 }
156 
157 void ColorInputType::setValue(const String&amp; value, bool valueChanged, TextFieldEventBehavior eventBehavior)
158 {
159     InputType::setValue(value, valueChanged, eventBehavior);
160 
161     if (!valueChanged)
162         return;
163 
164     updateColorSwatch();
165     if (m_chooser)
166         m_chooser-&gt;setSelectedColor(valueAsColor());
167 }
168 
169 void ColorInputType::handleDOMActivateEvent(Event&amp; event)
170 {
</pre>
</td>
<td>
<hr />
<pre>
 92     ASSERT(element());
 93 #if PLATFORM(IOS_FAMILY)
 94     if (element()-&gt;isReadOnly())
 95         return false;
 96 
 97     return element()-&gt;isTextFormControlFocusable();
 98 #endif
 99     return false;
100 }
101 
102 bool ColorInputType::isColorControl() const
103 {
104     return true;
105 }
106 
107 bool ColorInputType::isPresentingAttachedView() const
108 {
109     return !!m_chooser;
110 }
111 
<span class="line-modified">112 const AtomString&amp; ColorInputType::formControlType() const</span>
113 {
114     return InputTypeNames::color();
115 }
116 
117 bool ColorInputType::supportsRequired() const
118 {
119     return false;
120 }
121 
122 String ColorInputType::fallbackValue() const
123 {
124     return &quot;#000000&quot;_s;
125 }
126 
127 String ColorInputType::sanitizeValue(const String&amp; proposedValue) const
128 {
129     if (!isValidSimpleColor(proposedValue))
130         return fallbackValue();
131 
132     return proposedValue.convertToASCIILowercase();
133 }
134 
135 Color ColorInputType::valueAsColor() const
136 {
137     ASSERT(element());
138     return parseSimpleColorValue(element()-&gt;value()).value();
139 }
140 
141 void ColorInputType::createShadowSubtree()
142 {
143     ASSERT(element());
144     ASSERT(element()-&gt;shadowRoot());
145 
146     Document&amp; document = element()-&gt;document();
147     auto wrapperElement = HTMLDivElement::create(document);
<span class="line-modified">148     wrapperElement-&gt;setPseudo(AtomString(&quot;-webkit-color-swatch-wrapper&quot;, AtomString::ConstructFromLiteral));</span>
149     auto colorSwatch = HTMLDivElement::create(document);
<span class="line-modified">150     colorSwatch-&gt;setPseudo(AtomString(&quot;-webkit-color-swatch&quot;, AtomString::ConstructFromLiteral));</span>
151     wrapperElement-&gt;appendChild(colorSwatch);
152     element()-&gt;userAgentShadowRoot()-&gt;appendChild(wrapperElement);
153 
154     updateColorSwatch();
155 }
156 
157 void ColorInputType::setValue(const String&amp; value, bool valueChanged, TextFieldEventBehavior eventBehavior)
158 {
159     InputType::setValue(value, valueChanged, eventBehavior);
160 
161     if (!valueChanged)
162         return;
163 
164     updateColorSwatch();
165     if (m_chooser)
166         m_chooser-&gt;setSelectedColor(valueAsColor());
167 }
168 
169 void ColorInputType::handleDOMActivateEvent(Event&amp; event)
170 {
</pre>
</td>
</tr>
</table>
<center><a href="CheckboxInputType.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="ColorInputType.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old modules/javafx.web/src/main/native/Source/WebCore/css/makevalues.pl</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 #! /usr/bin/env perl
  2 #
  3 #   This file is part of the WebKit project
  4 #
  5 #   Copyright (C) 1999 Waldo Bastian (bastian@kde.org)
  6 #   Copyright (C) 2007, 2012 Apple Inc. All rights reserved.
  7 #   Copyright (C) 2008 Nokia Corporation and/or its subsidiary(-ies)
  8 #   Copyright (C) 2010 Andras Becsi (abecsi@inf.u-szeged.hu), University of Szeged
  9 #
 10 #   This library is free software; you can redistribute it and/or
 11 #   modify it under the terms of the GNU Library General Public
 12 #   License as published by the Free Software Foundation; either
 13 #   version 2 of the License, or (at your option) any later version.
 14 #
 15 #   This library is distributed in the hope that it will be useful,
 16 #   but WITHOUT ANY WARRANTY; without even the implied warranty of
 17 #   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 18 #   Library General Public License for more details.
 19 #
 20 #   You should have received a copy of the GNU Library General Public License
 21 #   along with this library; see the file COPYING.LIB.  If not, write to
 22 #   the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 23 #   Boston, MA 02110-1301, USA.
 24 use FindBin;
 25 use lib &quot;$FindBin::Bin/../bindings/scripts&quot;;
 26 
 27 use Getopt::Long;
 28 use preprocessor;
 29 use strict;
 30 use warnings;
 31 
 32 my $defines;
 33 my $preprocessor;
 34 my $gperf;
 35 GetOptions(&#39;defines=s&#39; =&gt; \$defines,
 36            &#39;preprocessor=s&#39; =&gt; \$preprocessor,
 37            &#39;gperf-executable=s&#39; =&gt; \$gperf);
 38 
 39 my @NAMES = applyPreprocessor(&quot;CSSValueKeywords.in&quot;, $defines, $preprocessor);
 40 
 41 my %namesHash;
 42 my @duplicates = ();
 43 
 44 my @names = ();
 45 my @lower_names = ();
 46 my $numPredefinedProperties = 1;
 47 
 48 foreach (@NAMES) {
 49   next if (m/(^\s*$)/);
 50   next if (/^#/);
 51 
 52   # Input may use a different EOL sequence than $/, so avoid chomp.
 53   $_ =~ s/[\r\n]+$//g;
 54   # CSS values need to be lower case.
 55   if (exists $namesHash{$_}) {
 56     push @duplicates, $_;
 57   } else {
 58     $namesHash{$_} = 1;
 59   }
 60   push @names, $_;
 61   push @lower_names, lc $_;
 62 }
 63 
 64 if (@duplicates &gt; 0) {
 65     die &#39;Duplicate CSS value keywords  values: &#39;, join(&#39;, &#39;, @duplicates) . &quot;\n&quot;;
 66 }
 67 
 68 open GPERF, &quot;&gt;CSSValueKeywords.gperf&quot; || die &quot;Could not open CSSValueKeywords.gperf for writing&quot;;
 69 print GPERF &lt;&lt; &quot;EOF&quot;;
 70 %{
 71 /* This file is automatically generated from CSSValueKeywords.in by makevalues, do not edit */
 72 
 73 #include \&quot;config.h\&quot;
 74 #include \&quot;CSSValueKeywords.h\&quot;
 75 #include \&quot;HashTools.h\&quot;
 76 #include &lt;wtf/ASCIICType.h&gt;
 77 #include &lt;wtf/text/AtomicString.h&gt;
 78 #include &lt;wtf/text/WTFString.h&gt;
 79 #include &lt;string.h&gt;
 80 
 81 IGNORE_WARNINGS_BEGIN(\&quot;implicit-fallthrough\&quot;)
 82 
 83 // Older versions of gperf like to use the `register` keyword.
 84 #define register
 85 
 86 namespace WebCore {
 87 %}
 88 %struct-type
 89 struct Value;
 90 %omit-struct-type
 91 %language=C++
 92 %readonly-tables
 93 %compare-strncmp
 94 %define class-name CSSValueKeywordsHash
 95 %define lookup-function-name findValueImpl
 96 %define hash-function-name value_hash_function
 97 %define word-array-name value_word_list
 98 %enum
 99 %%
100 EOF
101 
102 for my $i (0 .. $#names) {
103   my $id = $names[$i];
104   $id =~ s/(^[^-])|-(.)/uc($1||$2)/ge;
105   print GPERF $lower_names[$i] . &quot;, CSSValue&quot; . $id . &quot;\n&quot;;
106 }
107 
108 print GPERF &lt;&lt; &quot;EOF&quot;;
109 %%
110 static const char* const valueList[] = {
111     &quot;&quot;,
112 EOF
113 
114 foreach my $name (@names) {
115   print GPERF &quot;    \&quot;&quot; . $name . &quot;\&quot;,\n&quot;;
116 }
117 
118 print GPERF &lt;&lt; &quot;EOF&quot;;
119     0
120 };
121 
122 const Value* findValue(const char* str, unsigned int len)
123 {
124     return CSSValueKeywordsHash::findValueImpl(str, len);
125 }
126 
127 const char* getValueName(unsigned short id)
128 {
129     if (id &gt; lastCSSValueKeyword)
130         return 0;
131     return valueList[id];
132 }
133 
134 const AtomicString&amp; getValueNameAtomicString(CSSValueID id)
135 {
136     if (id &lt; firstCSSValueKeyword || id &gt; lastCSSValueKeyword)
137         return nullAtom();
138 
139     static AtomicString* valueKeywordStrings = new AtomicString[numCSSValueKeywords]; // Leaked intentionally.
140     AtomicString&amp; valueKeywordString = valueKeywordStrings[id];
141     if (valueKeywordString.isNull())
142         valueKeywordString = getValueName(id);
143     return valueKeywordString;
144 }
145 
146 String getValueNameString(CSSValueID id)
147 {
148     // We share the StringImpl with the AtomicStrings.
149     return getValueNameAtomicString(id).string();
150 }
151 
152 } // namespace WebCore
153 
154 IGNORE_WARNINGS_END
155 EOF
156 close GPERF;
157 
158 
159 open HEADER, &quot;&gt;CSSValueKeywords.h&quot; || die &quot;Could not open CSSValueKeywords.h for writing&quot;;
160 print HEADER &lt;&lt; &quot;EOF&quot;;
161 /* This file is automatically generated from CSSValueKeywords.in by makevalues, do not edit */
162 
163 #pragma once
164 
165 #include &lt;string.h&gt;
166 #include &lt;wtf/Forward.h&gt;
167 
168 namespace WebCore {
169 
170 enum CSSValueID {
171     CSSValueInvalid = 0,
172 EOF
173 
174 my $first = 0; # Include CSSValueInvalid in the total number of values
175 my $i = $numPredefinedProperties;
176 my $maxLen = 0;
177 foreach my $name (@names) {
178   my $id = $name;
179   $id =~ s/(^[^-])|-(.)/uc($1||$2)/ge;
180   print HEADER &quot;    CSSValue&quot; . $id . &quot; = &quot; . $i . &quot;,\n&quot;;
181   $i = $i + 1;
182   if (length($name) &gt; $maxLen) {
183     $maxLen = length($name);
184   }
185 }
186 my $num = $i - $first;
187 my $last = $i - 1;
188 
189 print HEADER &quot;};\n\n&quot;;
190 print HEADER &quot;const int firstCSSValueKeyword = $first;\n&quot;;
191 print HEADER &quot;const int numCSSValueKeywords = $num;\n&quot;;
192 print HEADER &quot;const int lastCSSValueKeyword = $last;\n&quot;;
193 print HEADER &quot;const size_t maxCSSValueKeywordLength = &quot; . $maxLen . &quot;;\n&quot;;
194 print HEADER &lt;&lt; &quot;EOF&quot;;
195 
196 const char* getValueName(unsigned short id);
197 const WTF::AtomicString&amp; getValueNameAtomicString(CSSValueID id);
198 WTF::String getValueNameString(CSSValueID id);
199 
200 inline CSSValueID convertToCSSValueID(int value)
201 {
202     ASSERT(value &gt;= firstCSSValueKeyword &amp;&amp; value &lt;= lastCSSValueKeyword);
203     return static_cast&lt;CSSValueID&gt;(value);
204 }
205 
206 } // namespace WebCore
207 EOF
208 close HEADER;
209 
210 if (not $gperf) {
211     $gperf = $ENV{GPERF} ? $ENV{GPERF} : &quot;gperf&quot;;
212 }
213 system(&quot;\&quot;$gperf\&quot; --key-positions=\&quot;*\&quot; -D -n -s 2 CSSValueKeywords.gperf --output-file=CSSValueKeywords.cpp&quot;) == 0 || die &quot;calling gperf failed: $?&quot;;
    </pre>
  </body>
</html>
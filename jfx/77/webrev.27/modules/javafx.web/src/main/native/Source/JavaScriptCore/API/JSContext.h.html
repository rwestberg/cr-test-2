<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/JavaScriptCore/API/JSContext.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 2013-2019 Apple Inc. All rights reserved.
  3  *
  4  * Redistribution and use in source and binary forms, with or without
  5  * modification, are permitted provided that the following conditions
  6  * are met:
  7  * 1. Redistributions of source code must retain the above copyright
  8  *    notice, this list of conditions and the following disclaimer.
  9  * 2. Redistributions in binary form must reproduce the above copyright
 10  *    notice, this list of conditions and the following disclaimer in the
 11  *    documentation and/or other materials provided with the distribution.
 12  *
 13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 14  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 15  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 16  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 17  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 18  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 19  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 20  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 21  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 22  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 23  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 24  */
 25 
 26 #ifndef JSContext_h
 27 #define JSContext_h
 28 
 29 #include &lt;JavaScriptCore/JavaScript.h&gt;
 30 #include &lt;JavaScriptCore/WebKitAvailability.h&gt;
 31 
 32 #if JSC_OBJC_API_ENABLED
 33 
 34 @class JSScript, JSVirtualMachine, JSValue, JSContext;
 35 
 36 /*!
 37 @interface
 38 @discussion A JSContext is a JavaScript execution environment. All
 39  JavaScript execution takes place within a context, and all JavaScript values
 40  are tied to a context.
 41 */
 42 JSC_CLASS_AVAILABLE(macos(10.9), ios(7.0))
 43 @interface JSContext : NSObject
 44 
 45 /*!
 46 @methodgroup Creating New JSContexts
 47 */
 48 /*!
 49 @method
 50 @abstract Create a JSContext.
 51 @result The new context.
 52 */
 53 - (instancetype)init;
 54 
 55 /*!
 56 @method
 57 @abstract Create a JSContext in the specified virtual machine.
 58 @param virtualMachine The JSVirtualMachine in which the context will be created.
 59 @result The new context.
 60 */
 61 - (instancetype)initWithVirtualMachine:(JSVirtualMachine *)virtualMachine;
 62 
 63 /*!
 64 @methodgroup Evaluating Scripts
 65 */
 66 /*!
 67 @method
 68 @abstract Evaluate a string of JavaScript code.
 69 @param script A string containing the JavaScript code to evaluate.
 70 @result The last value generated by the script.
 71 */
 72 - (JSValue *)evaluateScript:(NSString *)script;
 73 
 74 /*!
 75 @method
 76 @abstract Evaluate a string of JavaScript code, with a URL for the script&#39;s source file.
 77 @param script A string containing the JavaScript code to evaluate.
 78 @param sourceURL A URL for the script&#39;s source file. Used by debuggers and when reporting exceptions. This parameter is informative only: it does not change the behavior of the script.
 79 @result The last value generated by the script.
 80 */
 81 - (JSValue *)evaluateScript:(NSString *)script withSourceURL:(NSURL *)sourceURL JSC_API_AVAILABLE(macos(10.10), ios(8.0));
 82 
 83 /*!
 84 @methodgroup Callback Accessors
 85 */
 86 /*!
 87 @method
 88 @abstract Get the JSContext that is currently executing.
 89 @discussion This method may be called from within an Objective-C block or method invoked
 90  as a callback from JavaScript to retrieve the callback&#39;s context. Outside of
 91  a callback from JavaScript this method will return nil.
 92 @result The currently executing JSContext or nil if there isn&#39;t one.
 93 */
 94 + (JSContext *)currentContext;
 95 
 96 /*!
 97 @method
 98 @abstract Get the JavaScript function that is currently executing.
 99 @discussion This method may be called from within an Objective-C block or method invoked
100  as a callback from JavaScript to retrieve the callback&#39;s context. Outside of
101  a callback from JavaScript this method will return nil.
102 @result The currently executing JavaScript function or nil if there isn&#39;t one.
103 */
104 + (JSValue *)currentCallee JSC_API_AVAILABLE(macos(10.10), ios(8.0));
105 
106 /*!
107 @method
108 @abstract Get the &lt;code&gt;this&lt;/code&gt; value of the currently executing method.
109 @discussion This method may be called from within an Objective-C block or method invoked
110  as a callback from JavaScript to retrieve the callback&#39;s this value. Outside
111  of a callback from JavaScript this method will return nil.
112 @result The current &lt;code&gt;this&lt;/code&gt; value or nil if there isn&#39;t one.
113 */
114 + (JSValue *)currentThis;
115 
116 /*!
117 @method
118 @abstract Get the arguments to the current callback.
119 @discussion This method may be called from within an Objective-C block or method invoked
120  as a callback from JavaScript to retrieve the callback&#39;s arguments, objects
121  in the returned array are instances of JSValue. Outside of a callback from
122  JavaScript this method will return nil.
123 @result An NSArray of the arguments nil if there is no current callback.
124 */
125 + (NSArray *)currentArguments;
126 
127 /*!
128 @functiongroup Global Properties
129 */
130 
131 /*!
132 @property
133 @abstract Get the global object of the context.
134 @discussion This method retrieves the global object of the JavaScript execution context.
135  Instances of JSContext originating from WebKit will return a reference to the
136  WindowProxy object.
137 @result The global object.
138 */
139 @property (readonly, strong) JSValue *globalObject;
140 
141 /*!
142 @property
143 @discussion The &lt;code&gt;exception&lt;/code&gt; property may be used to throw an exception to JavaScript.
144 
145  Before a callback is made from JavaScript to an Objective-C block or method,
146  the prior value of the exception property will be preserved and the property
147  will be set to nil. After the callback has completed the new value of the
148  exception property will be read, and prior value restored. If the new value
149  of exception is not nil, the callback will result in that value being thrown.
150 
151  This property may also be used to check for uncaught exceptions arising from
152  API function calls (since the default behaviour of &lt;code&gt;exceptionHandler&lt;/code&gt; is to
153  assign an uncaught exception to this property).
154 */
155 @property (strong) JSValue *exception;
156 
157 /*!
158 @property
159 @discussion If a call to an API function results in an uncaught JavaScript exception, the
160  &lt;code&gt;exceptionHandler&lt;/code&gt; block will be invoked. The default implementation for the
161  exception handler will store the exception to the exception property on
162  context. As a consequence the default behaviour is for uncaught exceptions
163  occurring within a callback from JavaScript to be rethrown upon return.
164  Setting this value to nil will cause all exceptions occurring
165  within a callback from JavaScript to be silently caught.
166 */
167 @property (copy) void(^exceptionHandler)(JSContext *context, JSValue *exception);
168 
169 /*!
170 @property
171 @discussion All instances of JSContext are associated with a JSVirtualMachine.
172 */
173 @property (readonly, strong) JSVirtualMachine *virtualMachine;
174 
175 /*!
176 @property
177 @discussion Name of the JSContext. Exposed when remote debugging the context.
178 */
179 @property (copy) NSString *name JSC_API_AVAILABLE(macos(10.10), ios(8.0));
180 @end
181 
182 /*!
183 @category
184 @discussion Instances of JSContext implement the following methods in order to enable
185  support for subscript access by key and index, for example:
186 
187 @textblock
188     JSContext *context;
189     JSValue *v = context[@&quot;X&quot;]; // Get value for &quot;X&quot; from the global object.
190     context[@&quot;Y&quot;] = v;          // Assign &#39;v&#39; to &quot;Y&quot; on the global object.
191 @/textblock
192 
193  An object key passed as a subscript will be converted to a JavaScript value,
194  and then the value converted to a string used to resolve a property of the
195  global object.
196 */
197 @interface JSContext (SubscriptSupport)
198 
199 /*!
200 @method
201 @abstract Get a particular property on the global object.
202 @result The JSValue for the global object&#39;s property.
203 */
204 - (JSValue *)objectForKeyedSubscript:(id)key;
205 
206 /*!
207 @method
208 @abstract Set a particular property on the global object.
209 */
210 - (void)setObject:(id)object forKeyedSubscript:(NSObject &lt;NSCopying&gt; *)key;
211 
212 @end
213 
214 /*!
215 @category
216 @discussion These functions are for bridging between the C API and the Objective-C API.
217 */
218 @interface JSContext (JSContextRefSupport)
219 
220 /*!
221 @method
222 @abstract Create a JSContext, wrapping its C API counterpart.
223 @result The JSContext equivalent of the provided JSGlobalContextRef.
224 */
225 + (JSContext *)contextWithJSGlobalContextRef:(JSGlobalContextRef)jsGlobalContextRef;
226 
227 /*!
228 @property
229 @abstract Get the C API counterpart wrapped by a JSContext.
230 @result The C API equivalent of this JSContext.
231 */
232 @property (readonly) JSGlobalContextRef JSGlobalContextRef;
233 
234 @end
235 
236 #endif
237 
238 #endif // JSContext_h
    </pre>
  </body>
</html>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/JavaScriptCore/tools/JSDollarVM.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="HeapVerifier.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SigillCrashAnalyzer.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/JavaScriptCore/tools/JSDollarVM.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (C) 2015-2018 Apple Inc. All rights reserved.</span>
   *
   * Redistribution and use in source and binary forms, with or without
   * modification, are permitted provided that the following conditions
   * are met:
   * 1. Redistributions of source code must retain the above copyright
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (C) 2015-2019 Apple Inc. All rights reserved.</span>
   *
   * Redistribution and use in source and binary forms, with or without
   * modification, are permitted provided that the following conditions
   * are met:
   * 1. Redistributions of source code must retain the above copyright
</pre>
<hr />
<pre>
<span class="line-old-header">*** 38,16 ***</span>
<span class="line-new-header">--- 38,18 ---</span>
  #include &quot;JSCInlines.h&quot;
  #include &quot;JSFunction.h&quot;
  #include &quot;JSONObject.h&quot;
  #include &quot;JSProxy.h&quot;
  #include &quot;JSString.h&quot;
<span class="line-added">+ #include &quot;Parser.h&quot;</span>
  #include &quot;ShadowChicken.h&quot;
  #include &quot;Snippet.h&quot;
  #include &quot;SnippetParams.h&quot;
  #include &quot;TypeProfiler.h&quot;
  #include &quot;TypeProfilerLog.h&quot;
  #include &quot;VMInspector.h&quot;
<span class="line-added">+ #include &quot;WasmCapabilities.h&quot;</span>
  #include &lt;wtf/Atomics.h&gt;
  #include &lt;wtf/DataLog.h&gt;
  #include &lt;wtf/ProcessID.h&gt;
  #include &lt;wtf/StringPrintStream.h&gt;
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 75,11 ***</span>
      static JSDollarVMCallFrame* create(ExecState* exec, unsigned requestedFrameIndex)
      {
          VM&amp; vm = exec-&gt;vm();
          JSGlobalObject* globalObject = exec-&gt;lexicalGlobalObject();
          Structure* structure = createStructure(vm, globalObject, jsNull());
<span class="line-modified">!         JSDollarVMCallFrame* frame = new (NotNull, allocateCell&lt;JSDollarVMCallFrame&gt;(vm.heap, sizeof(JSDollarVMCallFrame))) JSDollarVMCallFrame(vm, structure);</span>
          frame-&gt;finishCreation(vm, exec, requestedFrameIndex);
          return frame;
      }
  
      void finishCreation(VM&amp; vm, CallFrame* frame, unsigned requestedFrameIndex)
<span class="line-new-header">--- 77,11 ---</span>
      static JSDollarVMCallFrame* create(ExecState* exec, unsigned requestedFrameIndex)
      {
          VM&amp; vm = exec-&gt;vm();
          JSGlobalObject* globalObject = exec-&gt;lexicalGlobalObject();
          Structure* structure = createStructure(vm, globalObject, jsNull());
<span class="line-modified">!         JSDollarVMCallFrame* frame = new (NotNull, allocateCell&lt;JSDollarVMCallFrame&gt;(vm.heap)) JSDollarVMCallFrame(vm, structure);</span>
          frame-&gt;finishCreation(vm, exec, requestedFrameIndex);
          return frame;
      }
  
      void finishCreation(VM&amp; vm, CallFrame* frame, unsigned requestedFrameIndex)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 95,11 ***</span>
          frame-&gt;iterate([&amp;] (StackVisitor&amp; visitor) {
  
              if (frameIndex++ != requestedFrameIndex)
                  return StackVisitor::Continue;
  
<span class="line-modified">!             addProperty(vm, &quot;name&quot;, jsString(&amp;vm, visitor-&gt;functionName()));</span>
  
              if (visitor-&gt;callee().isCell())
                  addProperty(vm, &quot;callee&quot;, visitor-&gt;callee().asCell());
  
              CodeBlock* codeBlock = visitor-&gt;codeBlock();
<span class="line-new-header">--- 97,11 ---</span>
          frame-&gt;iterate([&amp;] (StackVisitor&amp; visitor) {
  
              if (frameIndex++ != requestedFrameIndex)
                  return StackVisitor::Continue;
  
<span class="line-modified">!             addProperty(vm, &quot;name&quot;, jsString(vm, visitor-&gt;functionName()));</span>
  
              if (visitor-&gt;callee().isCell())
                  addProperty(vm, &quot;callee&quot;, visitor-&gt;callee().asCell());
  
              CodeBlock* codeBlock = visitor-&gt;codeBlock();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 119,11 ***</span>
      DECLARE_INFO;
  
  private:
      void addProperty(VM&amp; vm, const char* name, JSValue value)
      {
<span class="line-modified">!         Identifier identifier = Identifier::fromString(&amp;vm, name);</span>
          putDirect(vm, identifier, value);
      }
  };
  
  const ClassInfo JSDollarVMCallFrame::s_info = { &quot;CallFrame&quot;, &amp;Base::s_info, nullptr, nullptr, CREATE_METHOD_TABLE(JSDollarVMCallFrame) };
<span class="line-new-header">--- 121,11 ---</span>
      DECLARE_INFO;
  
  private:
      void addProperty(VM&amp; vm, const char* name, JSValue value)
      {
<span class="line-modified">!         Identifier identifier = Identifier::fromString(vm, name);</span>
          putDirect(vm, identifier, value);
      }
  };
  
  const ClassInfo JSDollarVMCallFrame::s_info = { &quot;CallFrame&quot;, &amp;Base::s_info, nullptr, nullptr, CREATE_METHOD_TABLE(JSDollarVMCallFrame) };
</pre>
<hr />
<pre>
<span class="line-old-header">*** 144,11 ***</span>
      void setRoot(VM&amp; vm, Root* root) { m_root.set(vm, this, root); }
  
      static Element* create(VM&amp; vm, JSGlobalObject* globalObject, Root* root)
      {
          Structure* structure = createStructure(vm, globalObject, jsNull());
<span class="line-modified">!         Element* element = new (NotNull, allocateCell&lt;Element&gt;(vm.heap, sizeof(Element))) Element(vm, structure);</span>
          element-&gt;finishCreation(vm, root);
          return element;
      }
  
      void finishCreation(VM&amp;, Root*);
<span class="line-new-header">--- 146,11 ---</span>
      void setRoot(VM&amp; vm, Root* root) { m_root.set(vm, this, root); }
  
      static Element* create(VM&amp; vm, JSGlobalObject* globalObject, Root* root)
      {
          Structure* structure = createStructure(vm, globalObject, jsNull());
<span class="line-modified">!         Element* element = new (NotNull, allocateCell&lt;Element&gt;(vm.heap)) Element(vm, structure);</span>
          element-&gt;finishCreation(vm, root);
          return element;
      }
  
      void finishCreation(VM&amp;, Root*);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 173,10 ***</span>
<span class="line-new-header">--- 175,11 ---</span>
  private:
      WriteBarrier&lt;Root&gt; m_root;
  };
  
  class ElementHandleOwner : public WeakHandleOwner {
<span class="line-added">+     WTF_MAKE_FAST_ALLOCATED;</span>
  public:
      bool isReachableFromOpaqueRoots(Handle&lt;JSC::Unknown&gt; handle, void*, SlotVisitor&amp; visitor, const char** reason) override
      {
          if (UNLIKELY(reason))
              *reason = &quot;JSC::Element is opaque root&quot;;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 204,11 ***</span>
      }
  
      static Root* create(VM&amp; vm, JSGlobalObject* globalObject)
      {
          Structure* structure = createStructure(vm, globalObject, jsNull());
<span class="line-modified">!         Root* root = new (NotNull, allocateCell&lt;Root&gt;(vm.heap, sizeof(Root))) Root(vm, structure);</span>
          root-&gt;finishCreation(vm);
          return root;
      }
  
      typedef JSDestructibleObject Base;
<span class="line-new-header">--- 207,11 ---</span>
      }
  
      static Root* create(VM&amp; vm, JSGlobalObject* globalObject)
      {
          Structure* structure = createStructure(vm, globalObject, jsNull());
<span class="line-modified">!         Root* root = new (NotNull, allocateCell&lt;Root&gt;(vm.heap)) Root(vm, structure);</span>
          root-&gt;finishCreation(vm);
          return root;
      }
  
      typedef JSDestructibleObject Base;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 220,10 ***</span>
<span class="line-new-header">--- 223,11 ---</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(ObjectType, StructureFlags), info());
      }
  
      static void visitChildren(JSCell* thisObject, SlotVisitor&amp; visitor)
      {
<span class="line-added">+         ASSERT_GC_OBJECT_INHERITS(thisObject, info());</span>
          Base::visitChildren(thisObject, visitor);
          visitor.addOpaqueRoot(thisObject);
      }
  
  private:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 241,11 ***</span>
      static const bool needsDestruction = false;
  
      static SimpleObject* create(VM&amp; vm, JSGlobalObject* globalObject)
      {
          Structure* structure = createStructure(vm, globalObject, jsNull());
<span class="line-modified">!         SimpleObject* simpleObject = new (NotNull, allocateCell&lt;SimpleObject&gt;(vm.heap, sizeof(SimpleObject))) SimpleObject(vm, structure);</span>
          simpleObject-&gt;finishCreation(vm);
          return simpleObject;
      }
  
      static void visitChildren(JSCell* cell, SlotVisitor&amp; visitor)
<span class="line-new-header">--- 245,11 ---</span>
      static const bool needsDestruction = false;
  
      static SimpleObject* create(VM&amp; vm, JSGlobalObject* globalObject)
      {
          Structure* structure = createStructure(vm, globalObject, jsNull());
<span class="line-modified">!         SimpleObject* simpleObject = new (NotNull, allocateCell&lt;SimpleObject&gt;(vm.heap)) SimpleObject(vm, structure);</span>
          simpleObject-&gt;finishCreation(vm);
          return simpleObject;
      }
  
      static void visitChildren(JSCell* cell, SlotVisitor&amp; visitor)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 294,11 ***</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(ObjectType, StructureFlags), info());
      }
  
      static ImpureGetter* create(VM&amp; vm, Structure* structure, JSObject* delegate)
      {
<span class="line-modified">!         ImpureGetter* getter = new (NotNull, allocateCell&lt;ImpureGetter&gt;(vm.heap, sizeof(ImpureGetter))) ImpureGetter(vm, structure);</span>
          getter-&gt;finishCreation(vm, delegate);
          return getter;
      }
  
      void finishCreation(VM&amp; vm, JSObject* delegate)
<span class="line-new-header">--- 298,11 ---</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(ObjectType, StructureFlags), info());
      }
  
      static ImpureGetter* create(VM&amp; vm, Structure* structure, JSObject* delegate)
      {
<span class="line-modified">!         ImpureGetter* getter = new (NotNull, allocateCell&lt;ImpureGetter&gt;(vm.heap)) ImpureGetter(vm, structure);</span>
          getter-&gt;finishCreation(vm, delegate);
          return getter;
      }
  
      void finishCreation(VM&amp; vm, JSObject* delegate)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 323,10 ***</span>
<span class="line-new-header">--- 327,11 ---</span>
          return Base::getOwnPropertySlot(object, exec, name, slot);
      }
  
      static void visitChildren(JSCell* cell, SlotVisitor&amp; visitor)
      {
<span class="line-added">+         ASSERT_GC_OBJECT_INHERITS(cell, info());</span>
          Base::visitChildren(cell, visitor);
          ImpureGetter* thisObject = jsCast&lt;ImpureGetter*&gt;(cell);
          visitor.append(thisObject-&gt;m_delegate);
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 355,24 ***</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(ObjectType, StructureFlags), info());
      }
  
      static CustomGetter* create(VM&amp; vm, Structure* structure)
      {
<span class="line-modified">!         CustomGetter* getter = new (NotNull, allocateCell&lt;CustomGetter&gt;(vm.heap, sizeof(CustomGetter))) CustomGetter(vm, structure);</span>
          getter-&gt;finishCreation(vm);
          return getter;
      }
  
      static bool getOwnPropertySlot(JSObject* object, ExecState* exec, PropertyName propertyName, PropertySlot&amp; slot)
      {
          CustomGetter* thisObject = jsCast&lt;CustomGetter*&gt;(object);
<span class="line-modified">!         if (propertyName == PropertyName(Identifier::fromString(exec, &quot;customGetter&quot;))) {</span>
              slot.setCacheableCustom(thisObject, PropertyAttribute::DontDelete | PropertyAttribute::ReadOnly | PropertyAttribute::DontEnum, thisObject-&gt;customGetter);
              return true;
          }
  
<span class="line-modified">!         if (propertyName == PropertyName(Identifier::fromString(exec, &quot;customGetterAccessor&quot;))) {</span>
              slot.setCacheableCustom(thisObject, PropertyAttribute::DontDelete | PropertyAttribute::ReadOnly | PropertyAttribute::DontEnum | PropertyAttribute::CustomAccessor, thisObject-&gt;customGetterAcessor);
              return true;
          }
  
          return JSObject::getOwnPropertySlot(thisObject, exec, propertyName, slot);
<span class="line-new-header">--- 360,25 ---</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(ObjectType, StructureFlags), info());
      }
  
      static CustomGetter* create(VM&amp; vm, Structure* structure)
      {
<span class="line-modified">!         CustomGetter* getter = new (NotNull, allocateCell&lt;CustomGetter&gt;(vm.heap)) CustomGetter(vm, structure);</span>
          getter-&gt;finishCreation(vm);
          return getter;
      }
  
      static bool getOwnPropertySlot(JSObject* object, ExecState* exec, PropertyName propertyName, PropertySlot&amp; slot)
      {
<span class="line-added">+         VM&amp; vm = exec-&gt;vm();</span>
          CustomGetter* thisObject = jsCast&lt;CustomGetter*&gt;(object);
<span class="line-modified">!         if (propertyName == PropertyName(Identifier::fromString(vm, &quot;customGetter&quot;))) {</span>
              slot.setCacheableCustom(thisObject, PropertyAttribute::DontDelete | PropertyAttribute::ReadOnly | PropertyAttribute::DontEnum, thisObject-&gt;customGetter);
              return true;
          }
  
<span class="line-modified">!         if (propertyName == PropertyName(Identifier::fromString(vm, &quot;customGetterAccessor&quot;))) {</span>
              slot.setCacheableCustom(thisObject, PropertyAttribute::DontDelete | PropertyAttribute::ReadOnly | PropertyAttribute::DontEnum | PropertyAttribute::CustomAccessor, thisObject-&gt;customGetterAcessor);
              return true;
          }
  
          return JSObject::getOwnPropertySlot(thisObject, exec, propertyName, slot);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 385,11 ***</span>
          auto scope = DECLARE_THROW_SCOPE(vm);
  
          CustomGetter* thisObject = jsDynamicCast&lt;CustomGetter*&gt;(vm, JSValue::decode(thisValue));
          if (!thisObject)
              return throwVMTypeError(exec, scope);
<span class="line-modified">!         bool shouldThrow = thisObject-&gt;get(exec, PropertyName(Identifier::fromString(exec, &quot;shouldThrow&quot;))).toBoolean(exec);</span>
          RETURN_IF_EXCEPTION(scope, encodedJSValue());
          if (shouldThrow)
              return throwVMTypeError(exec, scope);
          return JSValue::encode(jsNumber(100));
      }
<span class="line-new-header">--- 391,11 ---</span>
          auto scope = DECLARE_THROW_SCOPE(vm);
  
          CustomGetter* thisObject = jsDynamicCast&lt;CustomGetter*&gt;(vm, JSValue::decode(thisValue));
          if (!thisObject)
              return throwVMTypeError(exec, scope);
<span class="line-modified">!         bool shouldThrow = thisObject-&gt;get(exec, PropertyName(Identifier::fromString(vm, &quot;shouldThrow&quot;))).toBoolean(exec);</span>
          RETURN_IF_EXCEPTION(scope, encodedJSValue());
          if (shouldThrow)
              return throwVMTypeError(exec, scope);
          return JSValue::encode(jsNumber(100));
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 400,11 ***</span>
          auto scope = DECLARE_THROW_SCOPE(vm);
  
          JSObject* thisObject = jsDynamicCast&lt;JSObject*&gt;(vm, JSValue::decode(thisValue));
          if (!thisObject)
              return throwVMTypeError(exec, scope);
<span class="line-modified">!         bool shouldThrow = thisObject-&gt;get(exec, PropertyName(Identifier::fromString(exec, &quot;shouldThrow&quot;))).toBoolean(exec);</span>
          RETURN_IF_EXCEPTION(scope, encodedJSValue());
          if (shouldThrow)
              return throwVMTypeError(exec, scope);
          return JSValue::encode(jsNumber(100));
      }
<span class="line-new-header">--- 406,11 ---</span>
          auto scope = DECLARE_THROW_SCOPE(vm);
  
          JSObject* thisObject = jsDynamicCast&lt;JSObject*&gt;(vm, JSValue::decode(thisValue));
          if (!thisObject)
              return throwVMTypeError(exec, scope);
<span class="line-modified">!         bool shouldThrow = thisObject-&gt;get(exec, PropertyName(Identifier::fromString(vm, &quot;shouldThrow&quot;))).toBoolean(exec);</span>
          RETURN_IF_EXCEPTION(scope, encodedJSValue());
          if (shouldThrow)
              return throwVMTypeError(exec, scope);
          return JSValue::encode(jsNumber(100));
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 548,11 ***</span>
      }
  #endif
  
      static DOMJITNode* create(VM&amp; vm, Structure* structure)
      {
<span class="line-modified">!         DOMJITNode* getter = new (NotNull, allocateCell&lt;DOMJITNode&gt;(vm.heap, sizeof(DOMJITNode))) DOMJITNode(vm, structure);</span>
          getter-&gt;finishCreation(vm);
          return getter;
      }
  
      int32_t value() const
<span class="line-new-header">--- 554,11 ---</span>
      }
  #endif
  
      static DOMJITNode* create(VM&amp; vm, Structure* structure)
      {
<span class="line-modified">!         DOMJITNode* getter = new (NotNull, allocateCell&lt;DOMJITNode&gt;(vm.heap)) DOMJITNode(vm, structure);</span>
          getter-&gt;finishCreation(vm);
          return getter;
      }
  
      int32_t value() const
</pre>
<hr />
<pre>
<span class="line-old-header">*** 582,11 ***</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(JSC::JSType(LastJSCObjectType + 1), StructureFlags), info());
      }
  
      static DOMJITGetter* create(VM&amp; vm, Structure* structure)
      {
<span class="line-modified">!         DOMJITGetter* getter = new (NotNull, allocateCell&lt;DOMJITGetter&gt;(vm.heap, sizeof(DOMJITGetter))) DOMJITGetter(vm, structure);</span>
          getter-&gt;finishCreation(vm);
          return getter;
      }
  
      class DOMJITAttribute : public DOMJIT::GetterSetter {
<span class="line-new-header">--- 588,11 ---</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(JSC::JSType(LastJSCObjectType + 1), StructureFlags), info());
      }
  
      static DOMJITGetter* create(VM&amp; vm, Structure* structure)
      {
<span class="line-modified">!         DOMJITGetter* getter = new (NotNull, allocateCell&lt;DOMJITGetter&gt;(vm.heap)) DOMJITGetter(vm, structure);</span>
          getter-&gt;finishCreation(vm);
          return getter;
      }
  
      class DOMJITAttribute : public DOMJIT::GetterSetter {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 605,11 ***</span>
  
  #if ENABLE(JIT)
          static EncodedJSValue JIT_OPERATION slowCall(ExecState* exec, void* pointer)
          {
              VM&amp; vm = exec-&gt;vm();
<span class="line-modified">!             NativeCallFrameTracer tracer(&amp;vm, exec);</span>
              return JSValue::encode(jsNumber(static_cast&lt;DOMJITGetter*&gt;(pointer)-&gt;value()));
          }
  
          static Ref&lt;DOMJIT::CallDOMGetterSnippet&gt; callDOMGetter()
          {
<span class="line-new-header">--- 611,11 ---</span>
  
  #if ENABLE(JIT)
          static EncodedJSValue JIT_OPERATION slowCall(ExecState* exec, void* pointer)
          {
              VM&amp; vm = exec-&gt;vm();
<span class="line-modified">!             NativeCallFrameTracer tracer(vm, exec);</span>
              return JSValue::encode(jsNumber(static_cast&lt;DOMJITGetter*&gt;(pointer)-&gt;value()));
          }
  
          static Ref&lt;DOMJIT::CallDOMGetterSnippet&gt; callDOMGetter()
          {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 644,11 ***</span>
  void DOMJITGetter::finishCreation(VM&amp; vm)
  {
      Base::finishCreation(vm);
      const DOMJIT::GetterSetter* domJIT = &amp;DOMJITGetterDOMJIT;
      auto* customGetterSetter = DOMAttributeGetterSetter::create(vm, domJIT-&gt;getter(), nullptr, DOMAttributeAnnotation { DOMJITNode::info(), domJIT });
<span class="line-modified">!     putDirectCustomAccessor(vm, Identifier::fromString(&amp;vm, &quot;customGetter&quot;), customGetterSetter, PropertyAttribute::ReadOnly | PropertyAttribute::CustomAccessor);</span>
  }
  
  class DOMJITGetterComplex : public DOMJITNode {
  public:
      DOMJITGetterComplex(VM&amp; vm, Structure* structure)
<span class="line-new-header">--- 650,11 ---</span>
  void DOMJITGetter::finishCreation(VM&amp; vm)
  {
      Base::finishCreation(vm);
      const DOMJIT::GetterSetter* domJIT = &amp;DOMJITGetterDOMJIT;
      auto* customGetterSetter = DOMAttributeGetterSetter::create(vm, domJIT-&gt;getter(), nullptr, DOMAttributeAnnotation { DOMJITNode::info(), domJIT });
<span class="line-modified">!     putDirectCustomAccessor(vm, Identifier::fromString(vm, &quot;customGetter&quot;), customGetterSetter, PropertyAttribute::ReadOnly | PropertyAttribute::CustomAccessor);</span>
  }
  
  class DOMJITGetterComplex : public DOMJITNode {
  public:
      DOMJITGetterComplex(VM&amp; vm, Structure* structure)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 665,11 ***</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(JSC::JSType(LastJSCObjectType + 1), StructureFlags), info());
      }
  
      static DOMJITGetterComplex* create(VM&amp; vm, JSGlobalObject* globalObject, Structure* structure)
      {
<span class="line-modified">!         DOMJITGetterComplex* getter = new (NotNull, allocateCell&lt;DOMJITGetterComplex&gt;(vm.heap, sizeof(DOMJITGetterComplex))) DOMJITGetterComplex(vm, structure);</span>
          getter-&gt;finishCreation(vm, globalObject);
          return getter;
      }
  
      class DOMJITAttribute : public DOMJIT::GetterSetter {
<span class="line-new-header">--- 671,11 ---</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(JSC::JSType(LastJSCObjectType + 1), StructureFlags), info());
      }
  
      static DOMJITGetterComplex* create(VM&amp; vm, JSGlobalObject* globalObject, Structure* structure)
      {
<span class="line-modified">!         DOMJITGetterComplex* getter = new (NotNull, allocateCell&lt;DOMJITGetterComplex&gt;(vm.heap)) DOMJITGetterComplex(vm, structure);</span>
          getter-&gt;finishCreation(vm, globalObject);
          return getter;
      }
  
      class DOMJITAttribute : public DOMJIT::GetterSetter {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 688,11 ***</span>
  
  #if ENABLE(JIT)
          static EncodedJSValue JIT_OPERATION slowCall(ExecState* exec, void* pointer)
          {
              VM&amp; vm = exec-&gt;vm();
<span class="line-modified">!             NativeCallFrameTracer tracer(&amp;vm, exec);</span>
              auto scope = DECLARE_THROW_SCOPE(vm);
              auto* object = static_cast&lt;DOMJITNode*&gt;(pointer);
              auto* domjitGetterComplex = jsDynamicCast&lt;DOMJITGetterComplex*&gt;(vm, object);
              if (domjitGetterComplex) {
                  if (domjitGetterComplex-&gt;m_enableException)
<span class="line-new-header">--- 694,11 ---</span>
  
  #if ENABLE(JIT)
          static EncodedJSValue JIT_OPERATION slowCall(ExecState* exec, void* pointer)
          {
              VM&amp; vm = exec-&gt;vm();
<span class="line-modified">!             NativeCallFrameTracer tracer(vm, exec);</span>
              auto scope = DECLARE_THROW_SCOPE(vm);
              auto* object = static_cast&lt;DOMJITNode*&gt;(pointer);
              auto* domjitGetterComplex = jsDynamicCast&lt;DOMJITGetterComplex*&gt;(vm, object);
              if (domjitGetterComplex) {
                  if (domjitGetterComplex-&gt;m_enableException)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 754,12 ***</span>
  void DOMJITGetterComplex::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
  {
      Base::finishCreation(vm);
      const DOMJIT::GetterSetter* domJIT = &amp;DOMJITGetterComplexDOMJIT;
      auto* customGetterSetter = DOMAttributeGetterSetter::create(vm, domJIT-&gt;getter(), nullptr, DOMAttributeAnnotation { DOMJITGetterComplex::info(), domJIT });
<span class="line-modified">!     putDirectCustomAccessor(vm, Identifier::fromString(&amp;vm, &quot;customGetter&quot;), customGetterSetter, PropertyAttribute::ReadOnly | PropertyAttribute::CustomAccessor);</span>
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;enableException&quot;), 0, functionEnableException, NoIntrinsic, 0);</span>
  }
  
  class DOMJITFunctionObject : public DOMJITNode {
  public:
      DOMJITFunctionObject(VM&amp; vm, Structure* structure)
<span class="line-new-header">--- 760,12 ---</span>
  void DOMJITGetterComplex::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
  {
      Base::finishCreation(vm);
      const DOMJIT::GetterSetter* domJIT = &amp;DOMJITGetterComplexDOMJIT;
      auto* customGetterSetter = DOMAttributeGetterSetter::create(vm, domJIT-&gt;getter(), nullptr, DOMAttributeAnnotation { DOMJITGetterComplex::info(), domJIT });
<span class="line-modified">!     putDirectCustomAccessor(vm, Identifier::fromString(vm, &quot;customGetter&quot;), customGetterSetter, PropertyAttribute::ReadOnly | PropertyAttribute::CustomAccessor);</span>
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;enableException&quot;), 0, functionEnableException, NoIntrinsic, 0);</span>
  }
  
  class DOMJITFunctionObject : public DOMJITNode {
  public:
      DOMJITFunctionObject(VM&amp; vm, Structure* structure)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 777,30 ***</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(JSC::JSType(LastJSCObjectType + 1), StructureFlags), info());
      }
  
      static DOMJITFunctionObject* create(VM&amp; vm, JSGlobalObject* globalObject, Structure* structure)
      {
<span class="line-modified">!         DOMJITFunctionObject* object = new (NotNull, allocateCell&lt;DOMJITFunctionObject&gt;(vm.heap, sizeof(DOMJITFunctionObject))) DOMJITFunctionObject(vm, structure);</span>
          object-&gt;finishCreation(vm, globalObject);
          return object;
      }
  
<span class="line-modified">!     static EncodedJSValue JSC_HOST_CALL safeFunction(ExecState* exec)</span>
      {
          VM&amp; vm = exec-&gt;vm();
          auto scope = DECLARE_THROW_SCOPE(vm);
  
          DOMJITNode* thisObject = jsDynamicCast&lt;DOMJITNode*&gt;(vm, exec-&gt;thisValue());
          if (!thisObject)
              return throwVMTypeError(exec, scope);
          return JSValue::encode(jsNumber(thisObject-&gt;value()));
      }
  
<span class="line-modified">!     static EncodedJSValue JIT_OPERATION unsafeFunction(ExecState* exec, DOMJITNode* node)</span>
      {
          VM&amp; vm = exec-&gt;vm();
<span class="line-modified">!         NativeCallFrameTracer tracer(&amp;vm, exec);</span>
          return JSValue::encode(jsNumber(node-&gt;value()));
      }
  
  #if ENABLE(JIT)
      static Ref&lt;Snippet&gt; checkSubClassSnippet()
<span class="line-new-header">--- 783,30 ---</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(JSC::JSType(LastJSCObjectType + 1), StructureFlags), info());
      }
  
      static DOMJITFunctionObject* create(VM&amp; vm, JSGlobalObject* globalObject, Structure* structure)
      {
<span class="line-modified">!         DOMJITFunctionObject* object = new (NotNull, allocateCell&lt;DOMJITFunctionObject&gt;(vm.heap)) DOMJITFunctionObject(vm, structure);</span>
          object-&gt;finishCreation(vm, globalObject);
          return object;
      }
  
<span class="line-modified">!     static EncodedJSValue JSC_HOST_CALL functionWithTypeCheck(ExecState* exec)</span>
      {
          VM&amp; vm = exec-&gt;vm();
          auto scope = DECLARE_THROW_SCOPE(vm);
  
          DOMJITNode* thisObject = jsDynamicCast&lt;DOMJITNode*&gt;(vm, exec-&gt;thisValue());
          if (!thisObject)
              return throwVMTypeError(exec, scope);
          return JSValue::encode(jsNumber(thisObject-&gt;value()));
      }
  
<span class="line-modified">!     static EncodedJSValue JIT_OPERATION functionWithoutTypeCheck(ExecState* exec, DOMJITNode* node)</span>
      {
          VM&amp; vm = exec-&gt;vm();
<span class="line-modified">!         NativeCallFrameTracer tracer(vm, exec);</span>
          return JSValue::encode(jsNumber(node-&gt;value()));
      }
  
  #if ENABLE(JIT)
      static Ref&lt;Snippet&gt; checkSubClassSnippet()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 821,16 ***</span>
  
  private:
      void finishCreation(VM&amp;, JSGlobalObject*);
  };
  
<span class="line-modified">! static const DOMJIT::Signature DOMJITFunctionObjectSignature((uintptr_t)DOMJITFunctionObject::unsafeFunction, DOMJITFunctionObject::info(), DOMJIT::Effect::forRead(DOMJIT::HeapRange::top()), SpecInt32Only);</span>
  
  void DOMJITFunctionObject::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
  {
      Base::finishCreation(vm);
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;func&quot;), 0, safeFunction, NoIntrinsic, &amp;DOMJITFunctionObjectSignature, static_cast&lt;unsigned&gt;(PropertyAttribute::ReadOnly));</span>
  }
  
  class DOMJITCheckSubClassObject : public DOMJITNode {
  public:
      DOMJITCheckSubClassObject(VM&amp; vm, Structure* structure)
<span class="line-new-header">--- 827,16 ---</span>
  
  private:
      void finishCreation(VM&amp;, JSGlobalObject*);
  };
  
<span class="line-modified">! static const DOMJIT::Signature DOMJITFunctionObjectSignature(DOMJITFunctionObject::functionWithoutTypeCheck, DOMJITFunctionObject::info(), DOMJIT::Effect::forRead(DOMJIT::HeapRange::top()), SpecInt32Only);</span>
  
  void DOMJITFunctionObject::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
  {
      Base::finishCreation(vm);
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;func&quot;), 0, functionWithTypeCheck, NoIntrinsic, &amp;DOMJITFunctionObjectSignature, static_cast&lt;unsigned&gt;(PropertyAttribute::ReadOnly));</span>
  }
  
  class DOMJITCheckSubClassObject : public DOMJITNode {
  public:
      DOMJITCheckSubClassObject(VM&amp; vm, Structure* structure)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 848,43 ***</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(JSC::JSType(LastJSCObjectType + 1), StructureFlags), info());
      }
  
      static DOMJITCheckSubClassObject* create(VM&amp; vm, JSGlobalObject* globalObject, Structure* structure)
      {
<span class="line-modified">!         DOMJITCheckSubClassObject* object = new (NotNull, allocateCell&lt;DOMJITCheckSubClassObject&gt;(vm.heap, sizeof(DOMJITCheckSubClassObject))) DOMJITCheckSubClassObject(vm, structure);</span>
          object-&gt;finishCreation(vm, globalObject);
          return object;
      }
  
<span class="line-modified">!     static EncodedJSValue JSC_HOST_CALL safeFunction(ExecState* exec)</span>
      {
          VM&amp; vm = exec-&gt;vm();
          auto scope = DECLARE_THROW_SCOPE(vm);
  
          auto* thisObject = jsDynamicCast&lt;DOMJITCheckSubClassObject*&gt;(vm, exec-&gt;thisValue());
          if (!thisObject)
              return throwVMTypeError(exec, scope);
          return JSValue::encode(jsNumber(thisObject-&gt;value()));
      }
  
<span class="line-modified">!     static EncodedJSValue JIT_OPERATION unsafeFunction(ExecState* exec, DOMJITNode* node)</span>
      {
          VM&amp; vm = exec-&gt;vm();
<span class="line-modified">!         NativeCallFrameTracer tracer(&amp;vm, exec);</span>
          return JSValue::encode(jsNumber(node-&gt;value()));
      }
  
  private:
      void finishCreation(VM&amp;, JSGlobalObject*);
  };
  
<span class="line-modified">! static const DOMJIT::Signature DOMJITCheckSubClassObjectSignature((uintptr_t)DOMJITCheckSubClassObject::unsafeFunction, DOMJITCheckSubClassObject::info(), DOMJIT::Effect::forRead(DOMJIT::HeapRange::top()), SpecInt32Only);</span>
  
  void DOMJITCheckSubClassObject::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
  {
      Base::finishCreation(vm);
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;func&quot;), 0, safeFunction, NoIntrinsic, &amp;DOMJITCheckSubClassObjectSignature, static_cast&lt;unsigned&gt;(PropertyAttribute::ReadOnly));</span>
  }
  
  class DOMJITGetterBaseJSObject : public DOMJITNode {
  public:
      DOMJITGetterBaseJSObject(VM&amp; vm, Structure* structure)
<span class="line-new-header">--- 854,43 ---</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(JSC::JSType(LastJSCObjectType + 1), StructureFlags), info());
      }
  
      static DOMJITCheckSubClassObject* create(VM&amp; vm, JSGlobalObject* globalObject, Structure* structure)
      {
<span class="line-modified">!         DOMJITCheckSubClassObject* object = new (NotNull, allocateCell&lt;DOMJITCheckSubClassObject&gt;(vm.heap)) DOMJITCheckSubClassObject(vm, structure);</span>
          object-&gt;finishCreation(vm, globalObject);
          return object;
      }
  
<span class="line-modified">!     static EncodedJSValue JSC_HOST_CALL functionWithTypeCheck(ExecState* exec)</span>
      {
          VM&amp; vm = exec-&gt;vm();
          auto scope = DECLARE_THROW_SCOPE(vm);
  
          auto* thisObject = jsDynamicCast&lt;DOMJITCheckSubClassObject*&gt;(vm, exec-&gt;thisValue());
          if (!thisObject)
              return throwVMTypeError(exec, scope);
          return JSValue::encode(jsNumber(thisObject-&gt;value()));
      }
  
<span class="line-modified">!     static EncodedJSValue JIT_OPERATION functionWithoutTypeCheck(ExecState* exec, DOMJITNode* node)</span>
      {
          VM&amp; vm = exec-&gt;vm();
<span class="line-modified">!         NativeCallFrameTracer tracer(vm, exec);</span>
          return JSValue::encode(jsNumber(node-&gt;value()));
      }
  
  private:
      void finishCreation(VM&amp;, JSGlobalObject*);
  };
  
<span class="line-modified">! static const DOMJIT::Signature DOMJITCheckSubClassObjectSignature(DOMJITCheckSubClassObject::functionWithoutTypeCheck, DOMJITCheckSubClassObject::info(), DOMJIT::Effect::forRead(DOMJIT::HeapRange::top()), SpecInt32Only);</span>
  
  void DOMJITCheckSubClassObject::finishCreation(VM&amp; vm, JSGlobalObject* globalObject)
  {
      Base::finishCreation(vm);
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;func&quot;), 0, functionWithTypeCheck, NoIntrinsic, &amp;DOMJITCheckSubClassObjectSignature, static_cast&lt;unsigned&gt;(PropertyAttribute::ReadOnly));</span>
  }
  
  class DOMJITGetterBaseJSObject : public DOMJITNode {
  public:
      DOMJITGetterBaseJSObject(VM&amp; vm, Structure* structure)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 901,11 ***</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(JSC::JSType(LastJSCObjectType + 1), StructureFlags), info());
      }
  
      static DOMJITGetterBaseJSObject* create(VM&amp; vm, Structure* structure)
      {
<span class="line-modified">!         DOMJITGetterBaseJSObject* getter = new (NotNull, allocateCell&lt;DOMJITGetterBaseJSObject&gt;(vm.heap, sizeof(DOMJITGetterBaseJSObject))) DOMJITGetterBaseJSObject(vm, structure);</span>
          getter-&gt;finishCreation(vm);
          return getter;
      }
  
      class DOMJITAttribute : public DOMJIT::GetterSetter {
<span class="line-new-header">--- 907,11 ---</span>
          return Structure::create(vm, globalObject, prototype, TypeInfo(JSC::JSType(LastJSCObjectType + 1), StructureFlags), info());
      }
  
      static DOMJITGetterBaseJSObject* create(VM&amp; vm, Structure* structure)
      {
<span class="line-modified">!         DOMJITGetterBaseJSObject* getter = new (NotNull, allocateCell&lt;DOMJITGetterBaseJSObject&gt;(vm.heap)) DOMJITGetterBaseJSObject(vm, structure);</span>
          getter-&gt;finishCreation(vm);
          return getter;
      }
  
      class DOMJITAttribute : public DOMJIT::GetterSetter {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 924,11 ***</span>
  
  #if ENABLE(JIT)
          static EncodedJSValue JIT_OPERATION slowCall(ExecState* exec, void* pointer)
          {
              VM&amp; vm = exec-&gt;vm();
<span class="line-modified">!             NativeCallFrameTracer tracer(&amp;vm, exec);</span>
              JSObject* object = static_cast&lt;JSObject*&gt;(pointer);
              return JSValue::encode(object-&gt;getPrototypeDirect(vm));
          }
  
          static Ref&lt;DOMJIT::CallDOMGetterSnippet&gt; callDOMGetter()
<span class="line-new-header">--- 930,11 ---</span>
  
  #if ENABLE(JIT)
          static EncodedJSValue JIT_OPERATION slowCall(ExecState* exec, void* pointer)
          {
              VM&amp; vm = exec-&gt;vm();
<span class="line-modified">!             NativeCallFrameTracer tracer(vm, exec);</span>
              JSObject* object = static_cast&lt;JSObject*&gt;(pointer);
              return JSValue::encode(object-&gt;getPrototypeDirect(vm));
          }
  
          static Ref&lt;DOMJIT::CallDOMGetterSnippet&gt; callDOMGetter()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 964,11 ***</span>
  void DOMJITGetterBaseJSObject::finishCreation(VM&amp; vm)
  {
      Base::finishCreation(vm);
      const DOMJIT::GetterSetter* domJIT = &amp;DOMJITGetterBaseJSObjectDOMJIT;
      auto* customGetterSetter = DOMAttributeGetterSetter::create(vm, domJIT-&gt;getter(), nullptr, DOMAttributeAnnotation { JSObject::info(), domJIT });
<span class="line-modified">!     putDirectCustomAccessor(vm, Identifier::fromString(&amp;vm, &quot;customGetter&quot;), customGetterSetter, PropertyAttribute::ReadOnly | PropertyAttribute::CustomAccessor);</span>
  }
  
  class Message : public ThreadSafeRefCounted&lt;Message&gt; {
  public:
      Message(ArrayBufferContents&amp;&amp;, int32_t);
<span class="line-new-header">--- 970,11 ---</span>
  void DOMJITGetterBaseJSObject::finishCreation(VM&amp; vm)
  {
      Base::finishCreation(vm);
      const DOMJIT::GetterSetter* domJIT = &amp;DOMJITGetterBaseJSObjectDOMJIT;
      auto* customGetterSetter = DOMAttributeGetterSetter::create(vm, domJIT-&gt;getter(), nullptr, DOMAttributeAnnotation { JSObject::info(), domJIT });
<span class="line-modified">!     putDirectCustomAccessor(vm, Identifier::fromString(vm, &quot;customGetter&quot;), customGetterSetter, PropertyAttribute::ReadOnly | PropertyAttribute::CustomAccessor);</span>
  }
  
  class Message : public ThreadSafeRefCounted&lt;Message&gt; {
  public:
      Message(ArrayBufferContents&amp;&amp;, int32_t);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 991,11 ***</span>
          : Base(vm, structure)
      { }
  
      static JSTestCustomGetterSetter* create(VM&amp; vm, JSGlobalObject*, Structure* structure)
      {
<span class="line-modified">!         JSTestCustomGetterSetter* result = new (NotNull, allocateCell&lt;JSTestCustomGetterSetter&gt;(vm.heap, sizeof(JSTestCustomGetterSetter))) JSTestCustomGetterSetter(vm, structure);</span>
          result-&gt;finishCreation(vm);
          return result;
      }
  
      void finishCreation(VM&amp;);
<span class="line-new-header">--- 997,11 ---</span>
          : Base(vm, structure)
      { }
  
      static JSTestCustomGetterSetter* create(VM&amp; vm, JSGlobalObject*, Structure* structure)
      {
<span class="line-modified">!         JSTestCustomGetterSetter* result = new (NotNull, allocateCell&lt;JSTestCustomGetterSetter&gt;(vm.heap)) JSTestCustomGetterSetter(vm, structure);</span>
          result-&gt;finishCreation(vm);
          return result;
      }
  
      void finishCreation(VM&amp;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1028,11 ***</span>
  
      JSValue value = JSValue::decode(encodedValue);
      RELEASE_ASSERT(value.isObject());
      JSObject* object = asObject(value);
      PutPropertySlot slot(object);
<span class="line-modified">!     object-&gt;put(object, exec, Identifier::fromString(&amp;vm, &quot;result&quot;), JSValue::decode(thisObject), slot);</span>
  
      return true;
  }
  
  static bool customSetValue(ExecState* exec, EncodedJSValue slotValue, EncodedJSValue encodedValue)
<span class="line-new-header">--- 1034,11 ---</span>
  
      JSValue value = JSValue::decode(encodedValue);
      RELEASE_ASSERT(value.isObject());
      JSObject* object = asObject(value);
      PutPropertySlot slot(object);
<span class="line-modified">!     object-&gt;put(object, exec, Identifier::fromString(vm, &quot;result&quot;), JSValue::decode(thisObject), slot);</span>
  
      return true;
  }
  
  static bool customSetValue(ExecState* exec, EncodedJSValue slotValue, EncodedJSValue encodedValue)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1043,22 ***</span>
  
      JSValue value = JSValue::decode(encodedValue);
      RELEASE_ASSERT(value.isObject());
      JSObject* object = asObject(value);
      PutPropertySlot slot(object);
<span class="line-modified">!     object-&gt;put(object, exec, Identifier::fromString(&amp;vm, &quot;result&quot;), JSValue::decode(slotValue), slot);</span>
  
      return true;
  }
  
  void JSTestCustomGetterSetter::finishCreation(VM&amp; vm)
  {
      Base::finishCreation(vm);
  
<span class="line-modified">!     putDirectCustomAccessor(vm, Identifier::fromString(&amp;vm, &quot;customValue&quot;),</span>
          CustomGetterSetter::create(vm, customGetValue, customSetValue), 0);
<span class="line-modified">!     putDirectCustomAccessor(vm, Identifier::fromString(&amp;vm, &quot;customAccessor&quot;),</span>
          CustomGetterSetter::create(vm, customGetAccessor, customSetAccessor), static_cast&lt;unsigned&gt;(PropertyAttribute::CustomAccessor));
  }
  
  const ClassInfo Element::s_info = { &quot;Element&quot;, &amp;Base::s_info, nullptr, nullptr, CREATE_METHOD_TABLE(Element) };
  const ClassInfo Root::s_info = { &quot;Root&quot;, &amp;Base::s_info, nullptr, nullptr, CREATE_METHOD_TABLE(Root) };
<span class="line-new-header">--- 1049,22 ---</span>
  
      JSValue value = JSValue::decode(encodedValue);
      RELEASE_ASSERT(value.isObject());
      JSObject* object = asObject(value);
      PutPropertySlot slot(object);
<span class="line-modified">!     object-&gt;put(object, exec, Identifier::fromString(vm, &quot;result&quot;), JSValue::decode(slotValue), slot);</span>
  
      return true;
  }
  
  void JSTestCustomGetterSetter::finishCreation(VM&amp; vm)
  {
      Base::finishCreation(vm);
  
<span class="line-modified">!     putDirectCustomAccessor(vm, Identifier::fromString(vm, &quot;customValue&quot;),</span>
          CustomGetterSetter::create(vm, customGetValue, customSetValue), 0);
<span class="line-modified">!     putDirectCustomAccessor(vm, Identifier::fromString(vm, &quot;customAccessor&quot;),</span>
          CustomGetterSetter::create(vm, customGetAccessor, customSetAccessor), static_cast&lt;unsigned&gt;(PropertyAttribute::CustomAccessor));
  }
  
  const ClassInfo Element::s_info = { &quot;Element&quot;, &amp;Base::s_info, nullptr, nullptr, CREATE_METHOD_TABLE(Element) };
  const ClassInfo Root::s_info = { &quot;Root&quot;, &amp;Base::s_info, nullptr, nullptr, CREATE_METHOD_TABLE(Root) };
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1114,11 ***</span>
      using Base = JSDestructibleObject;
  
      static WasmStreamingParser* create(VM&amp; vm, JSGlobalObject* globalObject)
      {
          Structure* structure = createStructure(vm, globalObject, jsNull());
<span class="line-modified">!         WasmStreamingParser* result = new (NotNull, allocateCell&lt;WasmStreamingParser&gt;(vm.heap, sizeof(WasmStreamingParser))) WasmStreamingParser(vm, structure);</span>
          result-&gt;finishCreation(vm);
          return result;
      }
  
      static Structure* createStructure(VM&amp; vm, JSGlobalObject* globalObject, JSValue prototype)
<span class="line-new-header">--- 1120,11 ---</span>
      using Base = JSDestructibleObject;
  
      static WasmStreamingParser* create(VM&amp; vm, JSGlobalObject* globalObject)
      {
          Structure* structure = createStructure(vm, globalObject, jsNull());
<span class="line-modified">!         WasmStreamingParser* result = new (NotNull, allocateCell&lt;WasmStreamingParser&gt;(vm.heap)) WasmStreamingParser(vm, structure);</span>
          result-&gt;finishCreation(vm);
          return result;
      }
  
      static Structure* createStructure(VM&amp; vm, JSGlobalObject* globalObject, JSValue prototype)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1131,12 ***</span>
      void finishCreation(VM&amp; vm)
      {
          Base::finishCreation(vm);
  
          JSGlobalObject* globalObject = this-&gt;globalObject(vm);
<span class="line-modified">!         putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;addBytes&quot;), 0, functionWasmStreamingParserAddBytes, NoIntrinsic, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));</span>
<span class="line-modified">!         putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;finalize&quot;), 0, functionWasmStreamingParserFinalize, NoIntrinsic, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));</span>
      }
  
      DECLARE_INFO;
  
      Ref&lt;Wasm::ModuleInformation&gt; m_info;
<span class="line-new-header">--- 1137,12 ---</span>
      void finishCreation(VM&amp; vm)
      {
          Base::finishCreation(vm);
  
          JSGlobalObject* globalObject = this-&gt;globalObject(vm);
<span class="line-modified">!         putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;addBytes&quot;), 0, functionWasmStreamingParserAddBytes, NoIntrinsic, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));</span>
<span class="line-modified">!         putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;finalize&quot;), 0, functionWasmStreamingParserFinalize, NoIntrinsic, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));</span>
      }
  
      DECLARE_INFO;
  
      Ref&lt;Wasm::ModuleInformation&gt; m_info;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1298,11 ***</span>
  
  class CallerFrameJITTypeFunctor {
  public:
      CallerFrameJITTypeFunctor()
          : m_currentFrame(0)
<span class="line-modified">!         , m_jitType(JITCode::None)</span>
      {
      }
  
      StackVisitor::Status operator()(StackVisitor&amp; visitor) const
      {
<span class="line-new-header">--- 1304,11 ---</span>
  
  class CallerFrameJITTypeFunctor {
  public:
      CallerFrameJITTypeFunctor()
          : m_currentFrame(0)
<span class="line-modified">!         , m_jitType(JITType::None)</span>
      {
      }
  
      StackVisitor::Status operator()(StackVisitor&amp; visitor) const
      {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1311,23 ***</span>
              return StackVisitor::Done;
          }
          return StackVisitor::Continue;
      }
  
<span class="line-modified">!     JITCode::JITType jitType() { return m_jitType; }</span>
  
  private:
      mutable unsigned m_currentFrame;
<span class="line-modified">!     mutable JITCode::JITType m_jitType;</span>
  };
  
  static FunctionExecutable* getExecutableForFunction(JSValue theFunctionValue)
  {
      if (!theFunctionValue.isCell())
          return nullptr;
  
<span class="line-modified">!     VM&amp; vm = *theFunctionValue.asCell()-&gt;vm();</span>
      JSFunction* theFunction = jsDynamicCast&lt;JSFunction*&gt;(vm, theFunctionValue);
      if (!theFunction)
          return nullptr;
  
      FunctionExecutable* executable = jsDynamicCast&lt;FunctionExecutable*&gt;(vm,
<span class="line-new-header">--- 1317,23 ---</span>
              return StackVisitor::Done;
          }
          return StackVisitor::Continue;
      }
  
<span class="line-modified">!     JITType jitType() { return m_jitType; }</span>
  
  private:
      mutable unsigned m_currentFrame;
<span class="line-modified">!     mutable JITType m_jitType;</span>
  };
  
  static FunctionExecutable* getExecutableForFunction(JSValue theFunctionValue)
  {
      if (!theFunctionValue.isCell())
          return nullptr;
  
<span class="line-modified">!     VM&amp; vm = theFunctionValue.asCell()-&gt;vm();</span>
      JSFunction* theFunction = jsDynamicCast&lt;JSFunction*&gt;(vm, theFunctionValue);
      if (!theFunction)
          return nullptr;
  
      FunctionExecutable* executable = jsDynamicCast&lt;FunctionExecutable*&gt;(vm,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1342,22 ***</span>
  {
      if (!exec)
          return JSValue::encode(jsUndefined());
      CallerFrameJITTypeFunctor functor;
      exec-&gt;iterate(functor);
<span class="line-modified">!     return JSValue::encode(jsBoolean(functor.jitType() == JITCode::InterpreterThunk));</span>
  }
  
  // Returns true if the current frame is a baseline JIT frame.
  // Usage: isBaselineJIT = $vm.jitTrue()
  static EncodedJSValue JSC_HOST_CALL functionJITTrue(ExecState* exec)
  {
      if (!exec)
          return JSValue::encode(jsUndefined());
      CallerFrameJITTypeFunctor functor;
      exec-&gt;iterate(functor);
<span class="line-modified">!     return JSValue::encode(jsBoolean(functor.jitType() == JITCode::BaselineJIT));</span>
  }
  
  // Set that the argument function should not be inlined.
  // Usage:
  // function f() { };
<span class="line-new-header">--- 1348,22 ---</span>
  {
      if (!exec)
          return JSValue::encode(jsUndefined());
      CallerFrameJITTypeFunctor functor;
      exec-&gt;iterate(functor);
<span class="line-modified">!     return JSValue::encode(jsBoolean(functor.jitType() == JITType::InterpreterThunk));</span>
  }
  
  // Returns true if the current frame is a baseline JIT frame.
  // Usage: isBaselineJIT = $vm.jitTrue()
  static EncodedJSValue JSC_HOST_CALL functionJITTrue(ExecState* exec)
  {
      if (!exec)
          return JSValue::encode(jsUndefined());
      CallerFrameJITTypeFunctor functor;
      exec-&gt;iterate(functor);
<span class="line-modified">!     return JSValue::encode(jsBoolean(functor.jitType() == JITType::BaselineJIT));</span>
  }
  
  // Set that the argument function should not be inlined.
  // Usage:
  // function f() { };
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1389,10 ***</span>
<span class="line-new-header">--- 1395,19 ---</span>
  {
      VMInspector::edenGC(exec);
      return JSValue::encode(jsUndefined());
  }
  
<span class="line-added">+ // Dumps the hashes of all subspaces currently registered with the VM.</span>
<span class="line-added">+ // Usage: $vm.dumpSubspaceHashes()</span>
<span class="line-added">+ static EncodedJSValue JSC_HOST_CALL functionDumpSubspaceHashes(ExecState* exec)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     VM&amp; vm = exec-&gt;vm();</span>
<span class="line-added">+     VMInspector::dumpSubspaceHashes(&amp;vm);</span>
<span class="line-added">+     return JSValue::encode(jsUndefined());</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  // Gets a JSDollarVMCallFrame for a specified frame index.
  // Usage: var callFrame = $vm.callFrame(0) // frame 0 is the top frame.
  // Usage: var callFrame = $vm.callFrame() // implies frame 0 i.e. current frame.
  //
  // This gives you the ability to query the following:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1482,11 ***</span>
  {
      CodeBlock* codeBlock = codeBlockFromArg(exec);
      WTF::StringPrintStream stream;
      if (codeBlock) {
          stream.print(*codeBlock);
<span class="line-modified">!         return JSValue::encode(jsString(exec, stream.toString()));</span>
      }
      return JSValue::encode(jsUndefined());
  }
  
  // Usage: $vm.dumpSourceFor(functionObj)
<span class="line-new-header">--- 1497,11 ---</span>
  {
      CodeBlock* codeBlock = codeBlockFromArg(exec);
      WTF::StringPrintStream stream;
      if (codeBlock) {
          stream.print(*codeBlock);
<span class="line-modified">!         return JSValue::encode(jsString(exec-&gt;vm(), stream.toString()));</span>
      }
      return JSValue::encode(jsUndefined());
  }
  
  // Usage: $vm.dumpSourceFor(functionObj)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1615,11 ***</span>
      if (!exec-&gt;argument(0).isObject())
          return encodedJSUndefined();
  
      WTF::StringPrintStream stream;
      stream.print(IndexingTypeDump(exec-&gt;uncheckedArgument(0).getObject()-&gt;indexingMode()));
<span class="line-modified">!     return JSValue::encode(jsString(exec, stream.toString()));</span>
  }
  
  static EncodedJSValue JSC_HOST_CALL functionInlineCapacity(ExecState* exec)
  {
      VM&amp; vm = exec-&gt;vm();
<span class="line-new-header">--- 1630,11 ---</span>
      if (!exec-&gt;argument(0).isObject())
          return encodedJSUndefined();
  
      WTF::StringPrintStream stream;
      stream.print(IndexingTypeDump(exec-&gt;uncheckedArgument(0).getObject()-&gt;indexingMode()));
<span class="line-modified">!     return JSValue::encode(jsString(exec-&gt;vm(), stream.toString()));</span>
  }
  
  static EncodedJSValue JSC_HOST_CALL functionInlineCapacity(ExecState* exec)
  {
      VM&amp; vm = exec-&gt;vm();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1638,11 ***</span>
          if (i)
              stream.print(&quot;, &quot;);
          stream.print(exec-&gt;uncheckedArgument(i));
      }
  
<span class="line-modified">!     return JSValue::encode(jsString(exec, stream.toString()));</span>
  }
  
  // Gets the pid of the current process.
  // Usage: $vm.print(&quot;pid = &quot; + $vm.getpid())
  static EncodedJSValue JSC_HOST_CALL functionGetPID(ExecState*)
<span class="line-new-header">--- 1653,11 ---</span>
          if (i)
              stream.print(&quot;, &quot;);
          stream.print(exec-&gt;uncheckedArgument(i));
      }
  
<span class="line-modified">!     return JSValue::encode(jsString(exec-&gt;vm(), stream.toString()));</span>
  }
  
  // Gets the pid of the current process.
  // Usage: $vm.print(&quot;pid = &quot; + $vm.getpid())
  static EncodedJSValue JSC_HOST_CALL functionGetPID(ExecState*)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1719,10 ***</span>
<span class="line-new-header">--- 1734,17 ---</span>
      JSLockHolder lock(exec);
      RuntimeArray* array = RuntimeArray::create(exec);
      return JSValue::encode(array);
  }
  
<span class="line-added">+ static EncodedJSValue JSC_HOST_CALL functionCreateNullRopeString(ExecState* exec)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     VM&amp; vm = exec-&gt;vm();</span>
<span class="line-added">+     JSLockHolder lock(vm);</span>
<span class="line-added">+     return JSValue::encode(JSRopeString::createNullForTesting(vm));</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  static EncodedJSValue JSC_HOST_CALL functionCreateImpureGetter(ExecState* exec)
  {
      VM&amp; vm = exec-&gt;vm();
      JSLockHolder lock(vm);
      JSValue target = exec-&gt;argument(0);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1837,11 ***</span>
  
      String functionText = asString(exec-&gt;argument(0))-&gt;value(exec);
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
  
      const SourceCode&amp; source = makeSource(functionText, { });
<span class="line-modified">!     JSFunction* func = JSFunction::create(vm, createBuiltinExecutable(vm, source, Identifier::fromString(&amp;vm, &quot;foo&quot;), ConstructorKind::None, ConstructAbility::CannotConstruct)-&gt;link(vm, source), exec-&gt;lexicalGlobalObject());</span>
  
      return JSValue::encode(func);
  }
  
  static EncodedJSValue JSC_HOST_CALL functionGetPrivateProperty(ExecState* exec)
<span class="line-new-header">--- 1859,11 ---</span>
  
      String functionText = asString(exec-&gt;argument(0))-&gt;value(exec);
      RETURN_IF_EXCEPTION(scope, encodedJSValue());
  
      const SourceCode&amp; source = makeSource(functionText, { });
<span class="line-modified">!     JSFunction* func = JSFunction::create(vm, createBuiltinExecutable(vm, source, Identifier::fromString(vm, &quot;foo&quot;), ConstructorKind::None, ConstructAbility::CannotConstruct)-&gt;link(vm, nullptr, source), exec-&gt;lexicalGlobalObject());</span>
  
      return JSValue::encode(func);
  }
  
  static EncodedJSValue JSC_HOST_CALL functionGetPrivateProperty(ExecState* exec)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1852,11 ***</span>
      if (exec-&gt;argumentCount() &lt; 2 || !exec-&gt;argument(1).isString())
          return encodedJSUndefined();
  
      String str = asString(exec-&gt;argument(1))-&gt;value(exec);
  
<span class="line-modified">!     SymbolImpl* symbol = vm.propertyNames-&gt;lookUpPrivateName(Identifier::fromString(exec, str));</span>
      if (!symbol)
          return throwVMError(exec, scope, &quot;Unknown private name.&quot;);
  
      RELEASE_AND_RETURN(scope, JSValue::encode(exec-&gt;argument(0).get(exec, symbol)));
  }
<span class="line-new-header">--- 1874,11 ---</span>
      if (exec-&gt;argumentCount() &lt; 2 || !exec-&gt;argument(1).isString())
          return encodedJSUndefined();
  
      String str = asString(exec-&gt;argument(1))-&gt;value(exec);
  
<span class="line-modified">!     SymbolImpl* symbol = vm.propertyNames-&gt;lookUpPrivateName(Identifier::fromString(vm, str));</span>
      if (!symbol)
          return throwVMError(exec, scope, &quot;Unknown private name.&quot;);
  
      RELEASE_AND_RETURN(scope, JSValue::encode(exec-&gt;argument(0).get(exec, symbol)));
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2052,34 ***</span>
  {
      Options::useExceptionFuzz() = true;
      return JSValue::encode(jsUndefined());
  }
  
<span class="line-modified">! static EncodedJSValue changeDebuggerModeWhenIdle(ExecState* exec, DebuggerMode mode)</span>
  {
<span class="line-modified">!     bool newDebuggerMode = (mode == DebuggerOn);</span>
      if (Options::forceDebuggerBytecodeGeneration() == newDebuggerMode)
          return JSValue::encode(jsUndefined());
  
      VM* vm = &amp;exec-&gt;vm();
      vm-&gt;whenIdle([=] () {
          Options::forceDebuggerBytecodeGeneration() = newDebuggerMode;
          vm-&gt;deleteAllCode(PreventCollectionAndDeleteAllCode);
<span class="line-modified">!         if (mode == DebuggerMode::DebuggerOn)</span>
              vm-&gt;ensureShadowChicken();
      });
      return JSValue::encode(jsUndefined());
  }
  
  static EncodedJSValue JSC_HOST_CALL functionEnableDebuggerModeWhenIdle(ExecState* exec)
  {
<span class="line-modified">!     return changeDebuggerModeWhenIdle(exec, DebuggerOn);</span>
  }
  
  static EncodedJSValue JSC_HOST_CALL functionDisableDebuggerModeWhenIdle(ExecState* exec)
  {
<span class="line-modified">!     return changeDebuggerModeWhenIdle(exec, DebuggerOff);</span>
  }
  
  static EncodedJSValue JSC_HOST_CALL functionGlobalObjectCount(ExecState* exec)
  {
      return JSValue::encode(jsNumber(exec-&gt;vm().heap.globalObjectCount()));
<span class="line-new-header">--- 2074,43 ---</span>
  {
      Options::useExceptionFuzz() = true;
      return JSValue::encode(jsUndefined());
  }
  
<span class="line-modified">! static EncodedJSValue changeDebuggerModeWhenIdle(ExecState* exec, OptionSet&lt;CodeGenerationMode&gt; codeGenerationMode)</span>
  {
<span class="line-modified">!     bool newDebuggerMode = codeGenerationMode.contains(CodeGenerationMode::Debugger);</span>
      if (Options::forceDebuggerBytecodeGeneration() == newDebuggerMode)
          return JSValue::encode(jsUndefined());
  
      VM* vm = &amp;exec-&gt;vm();
      vm-&gt;whenIdle([=] () {
          Options::forceDebuggerBytecodeGeneration() = newDebuggerMode;
          vm-&gt;deleteAllCode(PreventCollectionAndDeleteAllCode);
<span class="line-modified">!         if (newDebuggerMode)</span>
              vm-&gt;ensureShadowChicken();
      });
      return JSValue::encode(jsUndefined());
  }
  
  static EncodedJSValue JSC_HOST_CALL functionEnableDebuggerModeWhenIdle(ExecState* exec)
  {
<span class="line-modified">!     return changeDebuggerModeWhenIdle(exec, { CodeGenerationMode::Debugger });</span>
  }
  
  static EncodedJSValue JSC_HOST_CALL functionDisableDebuggerModeWhenIdle(ExecState* exec)
  {
<span class="line-modified">!     return changeDebuggerModeWhenIdle(exec, { });</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ static EncodedJSValue JSC_HOST_CALL functionDeleteAllCodeWhenIdle(ExecState* exec)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     VM* vm = &amp;exec-&gt;vm();</span>
<span class="line-added">+     vm-&gt;whenIdle([=] () {</span>
<span class="line-added">+         vm-&gt;deleteAllCode(PreventCollectionAndDeleteAllCode);</span>
<span class="line-added">+     });</span>
<span class="line-added">+     return JSValue::encode(jsUndefined());</span>
  }
  
  static EncodedJSValue JSC_HOST_CALL functionGlobalObjectCount(ExecState* exec)
  {
      return JSValue::encode(jsNumber(exec-&gt;vm().heap.globalObjectCount()));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2094,20 ***</span>
      return JSValue::encode(globalObject);
  }
  
  static EncodedJSValue JSC_HOST_CALL functionGetGetterSetter(ExecState* exec)
  {
      JSValue value = exec-&gt;argument(0);
      if (!value.isObject())
          return JSValue::encode(jsUndefined());
  
      JSValue property = exec-&gt;argument(1);
      if (!property.isString())
          return JSValue::encode(jsUndefined());
  
      PropertySlot slot(value, PropertySlot::InternalMethodType::VMInquiry);
<span class="line-modified">!     value.getPropertySlot(exec, asString(property)-&gt;toIdentifier(exec), slot);</span>
  
      JSValue result;
      if (slot.isCacheableGetter())
          result = slot.getterSetter();
      else
<span class="line-new-header">--- 2125,27 ---</span>
      return JSValue::encode(globalObject);
  }
  
  static EncodedJSValue JSC_HOST_CALL functionGetGetterSetter(ExecState* exec)
  {
<span class="line-added">+     VM&amp; vm = exec-&gt;vm();</span>
<span class="line-added">+     auto scope = DECLARE_THROW_SCOPE(vm);</span>
<span class="line-added">+ </span>
      JSValue value = exec-&gt;argument(0);
      if (!value.isObject())
          return JSValue::encode(jsUndefined());
  
      JSValue property = exec-&gt;argument(1);
      if (!property.isString())
          return JSValue::encode(jsUndefined());
  
<span class="line-added">+     auto propertyName = asString(property)-&gt;toIdentifier(exec);</span>
<span class="line-added">+     RETURN_IF_EXCEPTION(scope, { });</span>
<span class="line-added">+ </span>
      PropertySlot slot(value, PropertySlot::InternalMethodType::VMInquiry);
<span class="line-modified">!     value.getPropertySlot(exec, propertyName, slot);</span>
<span class="line-added">+     RETURN_IF_EXCEPTION(scope, { });</span>
  
      JSValue result;
      if (slot.isCacheableGetter())
          result = slot.getterSetter();
      else
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2159,10 ***</span>
<span class="line-new-header">--- 2197,24 ---</span>
  {
      VM&amp; vm = exec-&gt;vm();
      return JSValue::encode(jsNumber(vm.heap.totalGCTime().seconds()));
  }
  
<span class="line-added">+ static EncodedJSValue JSC_HOST_CALL functionParseCount(ExecState*)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     return JSValue::encode(jsNumber(globalParseCount.load()));</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
<span class="line-added">+ static EncodedJSValue JSC_HOST_CALL functionIsWasmSupported(ExecState*)</span>
<span class="line-added">+ {</span>
<span class="line-added">+ #if ENABLE(WEBASSEMBLY)</span>
<span class="line-added">+     return JSValue::encode(jsBoolean(Wasm::isSupported()));</span>
<span class="line-added">+ #else</span>
<span class="line-added">+     return JSValue::encode(jsBoolean(false));</span>
<span class="line-added">+ #endif</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  void JSDollarVM::finishCreation(VM&amp; vm)
  {
      Base::finishCreation(vm);
  
      JSGlobalObject* globalObject = this-&gt;globalObject(vm);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2176,26 ***</span>
  
      addFunction(vm, &quot;abort&quot;, functionCrash, 0);
      addFunction(vm, &quot;crash&quot;, functionCrash, 0);
      addFunction(vm, &quot;breakpoint&quot;, functionBreakpoint, 0);
  
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;dfgTrue&quot;), 0, functionDFGTrue, DFGTrueIntrinsic, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));</span>
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;ftlTrue&quot;), 0, functionFTLTrue, FTLTrueIntrinsic, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));</span>
  
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;cpuMfence&quot;), 0, functionCpuMfence, CPUMfenceIntrinsic, 0);</span>
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;cpuRdtsc&quot;), 0, functionCpuRdtsc, CPURdtscIntrinsic, 0);</span>
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;cpuCpuid&quot;), 0, functionCpuCpuid, CPUCpuidIntrinsic, 0);</span>
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(&amp;vm, &quot;cpuPause&quot;), 0, functionCpuPause, CPUPauseIntrinsic, 0);</span>
      addFunction(vm, &quot;cpuClflush&quot;, functionCpuClflush, 2);
  
      addFunction(vm, &quot;llintTrue&quot;, functionLLintTrue, 0);
      addFunction(vm, &quot;jitTrue&quot;, functionJITTrue, 0);
  
      addFunction(vm, &quot;noInline&quot;, functionNoInline, 1);
  
      addFunction(vm, &quot;gc&quot;, functionGC, 0);
      addFunction(vm, &quot;edenGC&quot;, functionEdenGC, 0);
  
      addFunction(vm, &quot;callFrame&quot;, functionCallFrame, 1);
      addFunction(vm, &quot;codeBlockFor&quot;, functionCodeBlockFor, 1);
      addFunction(vm, &quot;codeBlockForFrame&quot;, functionCodeBlockForFrame, 1);
      addFunction(vm, &quot;dumpSourceFor&quot;, functionDumpSourceFor, 1);
<span class="line-new-header">--- 2228,27 ---</span>
  
      addFunction(vm, &quot;abort&quot;, functionCrash, 0);
      addFunction(vm, &quot;crash&quot;, functionCrash, 0);
      addFunction(vm, &quot;breakpoint&quot;, functionBreakpoint, 0);
  
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;dfgTrue&quot;), 0, functionDFGTrue, DFGTrueIntrinsic, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));</span>
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;ftlTrue&quot;), 0, functionFTLTrue, FTLTrueIntrinsic, static_cast&lt;unsigned&gt;(PropertyAttribute::DontEnum));</span>
  
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;cpuMfence&quot;), 0, functionCpuMfence, CPUMfenceIntrinsic, 0);</span>
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;cpuRdtsc&quot;), 0, functionCpuRdtsc, CPURdtscIntrinsic, 0);</span>
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;cpuCpuid&quot;), 0, functionCpuCpuid, CPUCpuidIntrinsic, 0);</span>
<span class="line-modified">!     putDirectNativeFunction(vm, globalObject, Identifier::fromString(vm, &quot;cpuPause&quot;), 0, functionCpuPause, CPUPauseIntrinsic, 0);</span>
      addFunction(vm, &quot;cpuClflush&quot;, functionCpuClflush, 2);
  
      addFunction(vm, &quot;llintTrue&quot;, functionLLintTrue, 0);
      addFunction(vm, &quot;jitTrue&quot;, functionJITTrue, 0);
  
      addFunction(vm, &quot;noInline&quot;, functionNoInline, 1);
  
      addFunction(vm, &quot;gc&quot;, functionGC, 0);
      addFunction(vm, &quot;edenGC&quot;, functionEdenGC, 0);
<span class="line-added">+     addFunction(vm, &quot;dumpSubspaceHashes&quot;, functionDumpSubspaceHashes, 0);</span>
  
      addFunction(vm, &quot;callFrame&quot;, functionCallFrame, 1);
      addFunction(vm, &quot;codeBlockFor&quot;, functionCodeBlockFor, 1);
      addFunction(vm, &quot;codeBlockForFrame&quot;, functionCodeBlockForFrame, 1);
      addFunction(vm, &quot;dumpSourceFor&quot;, functionDumpSourceFor, 1);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2218,10 ***</span>
<span class="line-new-header">--- 2271,11 ---</span>
      addFunction(vm, &quot;isHavingABadTime&quot;, functionIsHavingABadTime, 1);
  
      addFunction(vm, &quot;createGlobalObject&quot;, functionCreateGlobalObject, 0);
      addFunction(vm, &quot;createProxy&quot;, functionCreateProxy, 1);
      addFunction(vm, &quot;createRuntimeArray&quot;, functionCreateRuntimeArray, 0);
<span class="line-added">+     addFunction(vm, &quot;createNullRopeString&quot;, functionCreateNullRopeString, 0);</span>
  
      addFunction(vm, &quot;createImpureGetter&quot;, functionCreateImpureGetter, 1);
      addFunction(vm, &quot;createCustomGetterObject&quot;, functionCreateCustomGetterObject, 0);
      addFunction(vm, &quot;createDOMJITNodeObject&quot;, functionCreateDOMJITNodeObject, 0);
      addFunction(vm, &quot;createDOMJITGetterObject&quot;, functionCreateDOMJITGetterObject, 0);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2259,30 ***</span>
      addFunction(vm, &quot;enableExceptionFuzz&quot;, functionEnableExceptionFuzz, 0);
  
      addFunction(vm, &quot;enableDebuggerModeWhenIdle&quot;, functionEnableDebuggerModeWhenIdle, 0);
      addFunction(vm, &quot;disableDebuggerModeWhenIdle&quot;, functionDisableDebuggerModeWhenIdle, 0);
  
      addFunction(vm, &quot;globalObjectCount&quot;, functionGlobalObjectCount, 0);
      addFunction(vm, &quot;globalObjectForObject&quot;, functionGlobalObjectForObject, 1);
  
      addFunction(vm, &quot;getGetterSetter&quot;, functionGetGetterSetter, 2);
      addFunction(vm, &quot;loadGetterFromGetterSetter&quot;, functionLoadGetterFromGetterSetter, 1);
      addFunction(vm, &quot;createCustomTestGetterSetter&quot;, functionCreateCustomTestGetterSetter, 1);
  
      addFunction(vm, &quot;deltaBetweenButterflies&quot;, functionDeltaBetweenButterflies, 2);
  
      addFunction(vm, &quot;totalGCTime&quot;, functionTotalGCTime, 0);
  }
  
  void JSDollarVM::addFunction(VM&amp; vm, JSGlobalObject* globalObject, const char* name, NativeFunction function, unsigned arguments)
  {
<span class="line-modified">!     Identifier identifier = Identifier::fromString(&amp;vm, name);</span>
      putDirect(vm, identifier, JSFunction::create(vm, globalObject, arguments, identifier.string(), function));
  }
  
  void JSDollarVM::addConstructibleFunction(VM&amp; vm, JSGlobalObject* globalObject, const char* name, NativeFunction function, unsigned arguments)
  {
<span class="line-modified">!     Identifier identifier = Identifier::fromString(&amp;vm, name);</span>
      putDirect(vm, identifier, JSFunction::create(vm, globalObject, arguments, identifier.string(), function, NoIntrinsic, function));
  }
  
  } // namespace JSC
<span class="line-new-header">--- 2313,36 ---</span>
      addFunction(vm, &quot;enableExceptionFuzz&quot;, functionEnableExceptionFuzz, 0);
  
      addFunction(vm, &quot;enableDebuggerModeWhenIdle&quot;, functionEnableDebuggerModeWhenIdle, 0);
      addFunction(vm, &quot;disableDebuggerModeWhenIdle&quot;, functionDisableDebuggerModeWhenIdle, 0);
  
<span class="line-added">+     addFunction(vm, &quot;deleteAllCodeWhenIdle&quot;, functionDeleteAllCodeWhenIdle, 0);</span>
<span class="line-added">+ </span>
      addFunction(vm, &quot;globalObjectCount&quot;, functionGlobalObjectCount, 0);
      addFunction(vm, &quot;globalObjectForObject&quot;, functionGlobalObjectForObject, 1);
  
      addFunction(vm, &quot;getGetterSetter&quot;, functionGetGetterSetter, 2);
      addFunction(vm, &quot;loadGetterFromGetterSetter&quot;, functionLoadGetterFromGetterSetter, 1);
      addFunction(vm, &quot;createCustomTestGetterSetter&quot;, functionCreateCustomTestGetterSetter, 1);
  
      addFunction(vm, &quot;deltaBetweenButterflies&quot;, functionDeltaBetweenButterflies, 2);
  
      addFunction(vm, &quot;totalGCTime&quot;, functionTotalGCTime, 0);
<span class="line-added">+ </span>
<span class="line-added">+     addFunction(vm, &quot;parseCount&quot;, functionParseCount, 0);</span>
<span class="line-added">+ </span>
<span class="line-added">+     addFunction(vm, &quot;isWasmSupported&quot;, functionIsWasmSupported, 0);</span>
  }
  
  void JSDollarVM::addFunction(VM&amp; vm, JSGlobalObject* globalObject, const char* name, NativeFunction function, unsigned arguments)
  {
<span class="line-modified">!     Identifier identifier = Identifier::fromString(vm, name);</span>
      putDirect(vm, identifier, JSFunction::create(vm, globalObject, arguments, identifier.string(), function));
  }
  
  void JSDollarVM::addConstructibleFunction(VM&amp; vm, JSGlobalObject* globalObject, const char* name, NativeFunction function, unsigned arguments)
  {
<span class="line-modified">!     Identifier identifier = Identifier::fromString(vm, name);</span>
      putDirect(vm, identifier, JSFunction::create(vm, globalObject, arguments, identifier.string(), function, NoIntrinsic, function));
  }
  
  } // namespace JSC
</pre>
<center><a href="HeapVerifier.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="SigillCrashAnalyzer.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>
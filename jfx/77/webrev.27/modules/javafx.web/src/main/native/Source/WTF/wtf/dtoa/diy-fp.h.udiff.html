<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/WTF/wtf/dtoa/diy-fp.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="diy-fp.cc.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="double-conversion.cc.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WTF/wtf/dtoa/diy-fp.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -37,84 +37,84 @@</span>
  // with a uint64 significand and an int exponent. Normalized DiyFp numbers will
  // have the most significant bit of the significand set.
  // Multiplication and Subtraction do not normalize their results.
  // DiyFp are not designed to contain special doubles (NaN and Infinity).
  class DiyFp {
<span class="udiff-line-modified-removed">-     public:</span>
<span class="udiff-line-modified-removed">-         static const int kSignificandSize = 64;</span>
<span class="udiff-line-modified-added">+  public:</span>
<span class="udiff-line-modified-added">+   static const int kSignificandSize = 64;</span>
  
<span class="udiff-line-modified-removed">-         DiyFp() : f_(0), e_(0) {}</span>
<span class="udiff-line-modified-added">+   DiyFp() : f_(0), e_(0) {}</span>
    DiyFp(uint64_t significand, int exponent) : f_(significand), e_(exponent) {}
  
<span class="udiff-line-modified-removed">-         // this = this - other.</span>
<span class="udiff-line-modified-removed">-         // The exponents of both numbers must be the same and the significand of this</span>
<span class="udiff-line-modified-removed">-         // must be bigger than the significand of other.</span>
<span class="udiff-line-modified-removed">-         // The result will not be normalized.</span>
<span class="udiff-line-modified-removed">-         void Subtract(const DiyFp&amp; other) {</span>
<span class="udiff-line-modified-removed">-             ASSERT(e_ == other.e_);</span>
<span class="udiff-line-modified-removed">-             ASSERT(f_ &gt;= other.f_);</span>
<span class="udiff-line-modified-removed">-             f_ -= other.f_;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-         // Returns a - b.</span>
<span class="udiff-line-modified-removed">-         // The exponents of both numbers must be the same and this must be bigger</span>
<span class="udiff-line-modified-removed">-         // than other. The result will not be normalized.</span>
<span class="udiff-line-modified-removed">-         static DiyFp Minus(const DiyFp&amp; a, const DiyFp&amp; b) {</span>
<span class="udiff-line-modified-removed">-             DiyFp result = a;</span>
<span class="udiff-line-modified-removed">-             result.Subtract(b);</span>
<span class="udiff-line-modified-removed">-             return result;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-         // this = this * other.</span>
<span class="udiff-line-modified-removed">-         void Multiply(const DiyFp&amp; other);</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-         // returns a * b;</span>
<span class="udiff-line-modified-removed">-         static DiyFp Times(const DiyFp&amp; a, const DiyFp&amp; b) {</span>
<span class="udiff-line-modified-removed">-             DiyFp result = a;</span>
<span class="udiff-line-modified-removed">-             result.Multiply(b);</span>
<span class="udiff-line-modified-removed">-             return result;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-         void Normalize() {</span>
<span class="udiff-line-modified-removed">-             ASSERT(f_ != 0);</span>
<span class="udiff-line-modified-added">+   // this = this - other.</span>
<span class="udiff-line-modified-added">+   // The exponents of both numbers must be the same and the significand of this</span>
<span class="udiff-line-modified-added">+   // must be bigger than the significand of other.</span>
<span class="udiff-line-modified-added">+   // The result will not be normalized.</span>
<span class="udiff-line-modified-added">+   void Subtract(const DiyFp&amp; other) {</span>
<span class="udiff-line-modified-added">+     ASSERT(e_ == other.e_);</span>
<span class="udiff-line-modified-added">+     ASSERT(f_ &gt;= other.f_);</span>
<span class="udiff-line-modified-added">+     f_ -= other.f_;</span>
<span class="udiff-line-modified-added">+   }</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+   // Returns a - b.</span>
<span class="udiff-line-modified-added">+   // The exponents of both numbers must be the same and this must be bigger</span>
<span class="udiff-line-modified-added">+   // than other. The result will not be normalized.</span>
<span class="udiff-line-modified-added">+   static DiyFp Minus(const DiyFp&amp; a, const DiyFp&amp; b) {</span>
<span class="udiff-line-modified-added">+     DiyFp result = a;</span>
<span class="udiff-line-modified-added">+     result.Subtract(b);</span>
<span class="udiff-line-modified-added">+     return result;</span>
<span class="udiff-line-modified-added">+   }</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+   // this = this * other.</span>
<span class="udiff-line-modified-added">+   void Multiply(const DiyFp&amp; other);</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+   // returns a * b;</span>
<span class="udiff-line-modified-added">+   static DiyFp Times(const DiyFp&amp; a, const DiyFp&amp; b) {</span>
<span class="udiff-line-modified-added">+     DiyFp result = a;</span>
<span class="udiff-line-modified-added">+     result.Multiply(b);</span>
<span class="udiff-line-modified-added">+     return result;</span>
<span class="udiff-line-modified-added">+   }</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+   void Normalize() {</span>
<span class="udiff-line-modified-added">+     ASSERT(f_ != 0);</span>
      uint64_t significand = f_;
      int exponent = e_;
  
<span class="udiff-line-modified-removed">-             // This method is mainly called for normalizing boundaries. In general</span>
<span class="udiff-line-modified-removed">-             // boundaries need to be shifted by 10 bits. We thus optimize for this case.</span>
<span class="udiff-line-modified-removed">-             const uint64_t k10MSBits = UINT64_2PART_C(0xFFC00000, 00000000);</span>
<span class="udiff-line-modified-added">+     // This method is mainly called for normalizing boundaries. In general</span>
<span class="udiff-line-modified-added">+     // boundaries need to be shifted by 10 bits. We thus optimize for this case.</span>
<span class="udiff-line-modified-added">+     const uint64_t k10MSBits = UINT64_2PART_C(0xFFC00000, 00000000);</span>
      while ((significand &amp; k10MSBits) == 0) {
        significand &lt;&lt;= 10;
        exponent -= 10;
      }
      while ((significand &amp; kUint64MSB) == 0) {
        significand &lt;&lt;= 1;
        exponent--;
<span class="udiff-line-modified-removed">-             }</span>
<span class="udiff-line-modified-added">+     }</span>
      f_ = significand;
      e_ = exponent;
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-added">+   }</span>
  
<span class="udiff-line-modified-removed">-         static DiyFp Normalize(const DiyFp&amp; a) {</span>
<span class="udiff-line-modified-removed">-             DiyFp result = a;</span>
<span class="udiff-line-modified-removed">-             result.Normalize();</span>
<span class="udiff-line-modified-removed">-             return result;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-added">+   static DiyFp Normalize(const DiyFp&amp; a) {</span>
<span class="udiff-line-modified-added">+     DiyFp result = a;</span>
<span class="udiff-line-modified-added">+     result.Normalize();</span>
<span class="udiff-line-modified-added">+     return result;</span>
<span class="udiff-line-modified-added">+   }</span>
  
<span class="udiff-line-modified-removed">-         uint64_t f() const { return f_; }</span>
<span class="udiff-line-modified-removed">-         int e() const { return e_; }</span>
<span class="udiff-line-modified-added">+   uint64_t f() const { return f_; }</span>
<span class="udiff-line-modified-added">+   int e() const { return e_; }</span>
  
<span class="udiff-line-modified-removed">-         void set_f(uint64_t new_value) { f_ = new_value; }</span>
<span class="udiff-line-modified-removed">-         void set_e(int new_value) { e_ = new_value; }</span>
<span class="udiff-line-modified-added">+   void set_f(uint64_t new_value) { f_ = new_value; }</span>
<span class="udiff-line-modified-added">+   void set_e(int new_value) { e_ = new_value; }</span>
  
<span class="udiff-line-modified-removed">-     private:</span>
<span class="udiff-line-modified-removed">-         static const uint64_t kUint64MSB = UINT64_2PART_C(0x80000000, 00000000);</span>
<span class="udiff-line-modified-added">+  private:</span>
<span class="udiff-line-modified-added">+   static const uint64_t kUint64MSB = UINT64_2PART_C(0x80000000, 00000000);</span>
  
<span class="udiff-line-modified-removed">-         uint64_t f_;</span>
<span class="udiff-line-modified-removed">-         int e_;</span>
<span class="udiff-line-modified-added">+   uint64_t f_;</span>
<span class="udiff-line-modified-added">+   int e_;</span>
  };
  
  }  // namespace double_conversion
<span class="udiff-line-modified-removed">- } // namespace WTF</span>
<span class="udiff-line-modified-added">+ }  // namespace WTF</span>
  
  #endif  // DOUBLE_CONVERSION_DIY_FP_H_
</pre>
<center><a href="diy-fp.cc.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="double-conversion.cc.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WTF/wtf/CryptographicallyRandomNumber.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="CrossThreadTaskHandler.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DateMath.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WTF/wtf/CryptographicallyRandomNumber.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 23  * compatible with RSA Labs &quot;RC4&quot; cipher (the actual description of
 24  * which is a trade secret).  The same algorithm is used as a stream
 25  * cipher called &quot;arcfour&quot; in Tatu Ylonen&#39;s ssh package.
 26  *
 27  * RC4 is a registered trademark of RSA Laboratories.
 28  */
 29 
 30 #include &quot;config.h&quot;
 31 #include &lt;wtf/CryptographicallyRandomNumber.h&gt;
 32 
 33 #include &lt;mutex&gt;
 34 #include &lt;wtf/Lock.h&gt;
 35 #include &lt;wtf/NeverDestroyed.h&gt;
 36 #include &lt;wtf/OSRandomSource.h&gt;
 37 
 38 namespace WTF {
 39 
 40 namespace {
 41 
 42 class ARC4Stream {

 43 public:
 44     ARC4Stream();
 45 
 46     uint8_t i;
 47     uint8_t j;
 48     uint8_t s[256];
 49 };
 50 
 51 class ARC4RandomNumberGenerator {
 52     WTF_MAKE_FAST_ALLOCATED;
 53 public:
 54     ARC4RandomNumberGenerator();
 55 
 56     uint32_t randomNumber();
 57     void randomValues(void* buffer, size_t length);
 58 
 59 private:
 60     inline void addRandomData(unsigned char *data, int length);
 61     void stir();
 62     void stirIfNeeded();
</pre>
</td>
<td>
<hr />
<pre>
 23  * compatible with RSA Labs &quot;RC4&quot; cipher (the actual description of
 24  * which is a trade secret).  The same algorithm is used as a stream
 25  * cipher called &quot;arcfour&quot; in Tatu Ylonen&#39;s ssh package.
 26  *
 27  * RC4 is a registered trademark of RSA Laboratories.
 28  */
 29 
 30 #include &quot;config.h&quot;
 31 #include &lt;wtf/CryptographicallyRandomNumber.h&gt;
 32 
 33 #include &lt;mutex&gt;
 34 #include &lt;wtf/Lock.h&gt;
 35 #include &lt;wtf/NeverDestroyed.h&gt;
 36 #include &lt;wtf/OSRandomSource.h&gt;
 37 
 38 namespace WTF {
 39 
 40 namespace {
 41 
 42 class ARC4Stream {
<span class="line-added"> 43     WTF_MAKE_FAST_ALLOCATED;</span>
 44 public:
 45     ARC4Stream();
 46 
 47     uint8_t i;
 48     uint8_t j;
 49     uint8_t s[256];
 50 };
 51 
 52 class ARC4RandomNumberGenerator {
 53     WTF_MAKE_FAST_ALLOCATED;
 54 public:
 55     ARC4RandomNumberGenerator();
 56 
 57     uint32_t randomNumber();
 58     void randomValues(void* buffer, size_t length);
 59 
 60 private:
 61     inline void addRandomData(unsigned char *data, int length);
 62     void stir();
 63     void stirIfNeeded();
</pre>
</td>
</tr>
</table>
<center><a href="CrossThreadTaskHandler.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="DateMath.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>
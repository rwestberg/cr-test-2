<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/Modules/webgpu/WHLSL/WHLSLLexer.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>   1 /*
   2  * Copyright (C) 2018 Apple Inc. All rights reserved.
   3  *
   4  * Redistribution and use in source and binary forms, with or without
   5  * modification, are permitted provided that the following conditions
   6  * are met:
   7  * 1. Redistributions of source code must retain the above copyright
   8  *    notice, this list of conditions and the following disclaimer.
   9  * 2. Redistributions in binary form must reproduce the above copyright
  10  *    notice, this list of conditions and the following disclaimer in the
  11  *    documentation and/or other materials provided with the distribution.
  12  *
  13  * THIS SOFTWARE IS PROVIDED BY APPLE INC. AND ITS CONTRIBUTORS ``AS IS&#39;&#39;
  14  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  15  * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  16  * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE INC. OR ITS CONTRIBUTORS
  17  * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
  18  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
  19  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
  20  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  21  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
  22  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
  23  * THE POSSIBILITY OF SUCH DAMAGE.
  24  */
  25 
  26 #include &quot;config.h&quot;
  27 #include &quot;WHLSLLexer.h&quot;
  28 
  29 #if ENABLE(WEBGPU)
  30 
  31 namespace WebCore {
  32 
  33 namespace WHLSL {
  34 
<a name="1" id="anc1"></a><span class="line-modified">  35 const char* Token::typeName(Type type)</span>
  36 {
  37     switch (type) {
  38     case Type::IntLiteral:
  39         return &quot;int literal&quot;;
  40     case Type::UintLiteral:
  41         return &quot;uint literal&quot;;
  42     case Type::FloatLiteral:
  43         return &quot;float literal&quot;;
  44     case Type::Struct:
  45         return &quot;struct&quot;;
  46     case Type::Typedef:
  47         return &quot;typedef&quot;;
  48     case Type::Enum:
  49         return &quot;enum&quot;;
  50     case Type::Operator:
  51         return &quot;operator&quot;;
  52     case Type::If:
  53         return &quot;if&quot;;
  54     case Type::Else:
  55         return &quot;else&quot;;
  56     case Type::Continue:
  57         return &quot;continue&quot;;
  58     case Type::Break:
  59         return &quot;break&quot;;
  60     case Type::Switch:
  61         return &quot;switch&quot;;
  62     case Type::Case:
  63         return &quot;case&quot;;
  64     case Type::Default:
  65         return &quot;default&quot;;
  66     case Type::Fallthrough:
  67         return &quot;fallthrough&quot;;
  68     case Type::For:
  69         return &quot;for&quot;;
  70     case Type::While:
  71         return &quot;while&quot;;
  72     case Type::Do:
  73         return &quot;do&quot;;
  74     case Type::Return:
  75         return &quot;return&quot;;
<a name="2" id="anc2"></a>

  76     case Type::Null:
  77         return &quot;null&quot;;
  78     case Type::True:
  79         return &quot;true&quot;;
  80     case Type::False:
  81         return &quot;false&quot;;
  82     case Type::Constant:
  83         return &quot;constant&quot;;
  84     case Type::Device:
  85         return &quot;device&quot;;
  86     case Type::Threadgroup:
  87         return &quot;threadgroup&quot;;
  88     case Type::Thread:
  89         return &quot;thread&quot;;
  90     case Type::Space:
  91         return &quot;space&quot;;
  92     case Type::Vertex:
  93         return &quot;vertex&quot;;
  94     case Type::Fragment:
  95         return &quot;fragment&quot;;
  96     case Type::Compute:
  97         return &quot;compute&quot;;
  98     case Type::NumThreads:
  99         return &quot;numthreads&quot;;
 100     case Type::SVInstanceID:
 101         return &quot;SV_InstanceID&quot;;
 102     case Type::SVVertexID:
 103         return &quot;SV_VertexID&quot;;
 104     case Type::PSize:
 105         return &quot;PSIZE&quot;;
 106     case Type::SVPosition:
 107         return &quot;SV_Position&quot;;
 108     case Type::SVIsFrontFace:
 109         return &quot;SV_IsFrontFace&quot;;
 110     case Type::SVSampleIndex:
 111         return &quot;SV_SampleIndex&quot;;
 112     case Type::SVInnerCoverage:
 113         return &quot;SV_InnerCoverage&quot;;
 114     case Type::SVTarget:
 115         return &quot;SV_Target&quot;;
 116     case Type::SVDepth:
 117         return &quot;SV_Depth&quot;;
 118     case Type::SVCoverage:
 119         return &quot;SV_Coverage&quot;;
 120     case Type::SVDispatchThreadID:
 121         return &quot;SV_DispatchThreadID&quot;;
 122     case Type::SVGroupID:
 123         return &quot;SV_GroupID&quot;;
 124     case Type::SVGroupIndex:
 125         return &quot;SV_GroupIndex&quot;;
 126     case Type::SVGroupThreadID:
 127         return &quot;SV_GroupThreadID&quot;;
 128     case Type::Attribute:
 129         return &quot;SV_Attribute&quot;;
 130     case Type::Register:
 131         return &quot;register&quot;;
 132     case Type::Specialized:
 133         return &quot;specialized&quot;;
 134     case Type::Native:
 135         return &quot;native&quot;;
 136     case Type::Restricted:
 137         return &quot;restricted&quot;;
 138     case Type::Underscore:
 139         return &quot;_&quot;;
 140     case Type::Auto:
 141         return &quot;auto&quot;;
 142     case Type::Protocol:
 143         return &quot;protocol&quot;;
 144     case Type::Const:
 145         return &quot;const&quot;;
 146     case Type::Static:
 147         return &quot;static&quot;;
 148     case Type::Qualifier:
 149         return &quot;qualifier&quot;;
 150     case Type::Identifier:
 151         return &quot;identifier&quot;;
 152     case Type::OperatorName:
 153         return &quot;operator name&quot;;
 154     case Type::EqualsSign:
 155         return &quot;=&quot;;
 156     case Type::Semicolon:
 157         return &quot;;&quot;;
 158     case Type::LeftCurlyBracket:
 159         return &quot;{&quot;;
 160     case Type::RightCurlyBracket:
 161         return &quot;}&quot;;
 162     case Type::Colon:
 163         return &quot;:&quot;;
 164     case Type::Comma:
 165         return &quot;,&quot;;
 166     case Type::LeftParenthesis:
 167         return &quot;(&quot;;
 168     case Type::RightParenthesis:
 169         return &quot;)&quot;;
 170     case Type::SquareBracketPair:
 171         return &quot;[]&quot;;
 172     case Type::LeftSquareBracket:
 173         return &quot;[&quot;;
 174     case Type::RightSquareBracket:
 175         return &quot;]&quot;;
 176     case Type::Star:
 177         return &quot;*&quot;;
 178     case Type::LessThanSign:
 179         return &quot;&lt;&quot;;
 180     case Type::GreaterThanSign:
 181         return &quot;&gt;&quot;;
 182     case Type::FullStop:
 183         return &quot;.&quot;;
 184     case Type::PlusEquals:
 185         return &quot;+=&quot;;
 186     case Type::MinusEquals:
 187         return &quot;-=&quot;;
 188     case Type::TimesEquals:
 189         return &quot;*=&quot;;
 190     case Type::DivideEquals:
 191         return &quot;/=&quot;;
 192     case Type::ModEquals:
 193         return &quot;%=&quot;;
 194     case Type::XorEquals:
 195         return &quot;^=&quot;;
 196     case Type::AndEquals:
 197         return &quot;&amp;=&quot;;
 198     case Type::OrEquals:
 199         return &quot;|=&quot;;
 200     case Type::RightShiftEquals:
 201         return &quot;&gt;&gt;=&quot;;
 202     case Type::LeftShiftEquals:
 203         return &quot;&lt;&lt;=&quot;;
 204     case Type::PlusPlus:
 205         return &quot;++&quot;;
 206     case Type::MinusMinus:
 207         return &quot;--&quot;;
 208     case Type::Arrow:
 209         return &quot;-&gt;&quot;;
 210     case Type::QuestionMark:
 211         return &quot;?&quot;;
 212     case Type::OrOr:
 213         return &quot;||&quot;;
 214     case Type::AndAnd:
 215         return &quot;&amp;&amp;&quot;;
 216     case Type::Or:
 217         return &quot;|&quot;;
 218     case Type::Xor:
 219         return &quot;^&quot;;
 220     case Type::And:
 221         return &quot;&amp;&quot;;
 222     case Type::LessThanOrEqualTo:
 223         return &quot;&lt;=&quot;;
 224     case Type::GreaterThanOrEqualTo:
 225         return &quot;&gt;=&quot;;
 226     case Type::EqualComparison:
 227         return &quot;==&quot;;
 228     case Type::NotEqual:
 229         return &quot;!=&quot;;
 230     case Type::RightShift:
 231         return &quot;&gt;&gt;&quot;;
 232     case Type::LeftShift:
 233         return &quot;&lt;&lt;&quot;;
 234     case Type::Plus:
 235         return &quot;+&quot;;
 236     case Type::Minus:
 237         return &quot;-&quot;;
 238     case Type::Divide:
 239         return &quot;/&quot;;
 240     case Type::Mod:
 241         return &quot;%&quot;;
 242     case Type::Tilde:
 243         return &quot;~&quot;;
 244     case Type::ExclamationPoint:
 245         return &quot;!&quot;;
 246     case Type::At:
 247         return &quot;@&quot;;
<a name="3" id="anc3"></a><span class="line-added"> 248     case Type::EndOfFile:</span>
<span class="line-added"> 249         return &quot;EOF&quot;;</span>
<span class="line-added"> 250     case Type::Invalid:</span>
<span class="line-added"> 251         return &quot;LEXING_ERROR&quot;;</span>
 252     }
 253 }
 254 
<a name="4" id="anc4"></a><span class="line-modified"> 255 static ALWAYS_INLINE bool isValidIdentifierStart(UChar theChar)</span>
 256 {
<a name="5" id="anc5"></a><span class="line-modified"> 257     return (theChar &gt;= &#39;a&#39; &amp;&amp; theChar &lt;= &#39;z&#39;)</span>
<span class="line-modified"> 258         || (theChar &gt;= &#39;A&#39; &amp;&amp; theChar &lt;= &#39;Z&#39;)</span>
<span class="line-modified"> 259         || (theChar == &#39;_&#39;);</span>



















































































































 260 }
 261 
<a name="6" id="anc6"></a><span class="line-modified"> 262 static ALWAYS_INLINE bool isValidNonStartingIdentifierChar(UChar theChar)</span>
 263 {
<a name="7" id="anc7"></a><span class="line-modified"> 264     return (theChar &gt;= &#39;a&#39; &amp;&amp; theChar &lt;= &#39;z&#39;)</span>
<span class="line-modified"> 265         || (theChar &gt;= &#39;A&#39; &amp;&amp; theChar &lt;= &#39;Z&#39;)</span>
<span class="line-modified"> 266         || (theChar &gt;= &#39;0&#39; &amp;&amp; theChar &lt;= &#39;9&#39;)</span>
<span class="line-modified"> 267         || (theChar == &#39;_&#39;);</span>

















































































































 268 }
 269 
<a name="8" id="anc8"></a><span class="line-modified"> 270 static ALWAYS_INLINE bool isHexadecimalCharacter(UChar character)</span>
 271 {
<a name="9" id="anc9"></a><span class="line-modified"> 272     return (character &gt;= &#39;0&#39; &amp;&amp; character &lt;= &#39;9&#39;)</span>
<span class="line-modified"> 273         || (character &gt;= &#39;a&#39; &amp;&amp; character &lt;= &#39;f&#39;)</span>
<span class="line-modified"> 274         || (character &gt;= &#39;A&#39; &amp;&amp; character &lt;= &#39;F&#39;);</span>




 275 }
 276 
<a name="10" id="anc10"></a><span class="line-modified"> 277 static ALWAYS_INLINE bool isDigit(UChar theChar)</span>
 278 {
<a name="11" id="anc11"></a><span class="line-modified"> 279     return theChar &gt;= &#39;0&#39; &amp;&amp; theChar &lt;= &#39;9&#39;;</span>








 280 }
 281 
<a name="12" id="anc12"></a><span class="line-modified"> 282 auto Lexer::consumeTokenFromStream() -&gt; Token</span>
 283 {
<a name="13" id="anc13"></a><span class="line-modified"> 284     UChar current = 0;</span>
<span class="line-modified"> 285     unsigned offset = m_offset;</span>
<span class="line-modified"> 286 </span>
<span class="line-modified"> 287     auto peek = [&amp;] () -&gt; UChar {</span>
<span class="line-modified"> 288         if (offset &lt; m_stringView.length())</span>
<span class="line-added"> 289             return m_stringView[offset];</span>
<span class="line-added"> 290         return 0;</span>
<span class="line-added"> 291     };</span>
<span class="line-added"> 292 </span>
<span class="line-added"> 293     auto shift = [&amp;] {</span>
<span class="line-added"> 294         if (offset &lt; m_stringView.length()) {</span>
<span class="line-added"> 295             current = m_stringView[offset];</span>
<span class="line-added"> 296             ++offset;</span>
<span class="line-added"> 297             return current;</span>
<span class="line-added"> 298         }</span>
<span class="line-added"> 299         current = 0;</span>
<span class="line-added"> 300         return current;</span>
<span class="line-added"> 301     };</span>
<span class="line-added"> 302 </span>
<span class="line-added"> 303     auto consume = [&amp;] (UChar theChar) {</span>
<span class="line-added"> 304         if (peek() == theChar) {</span>
<span class="line-added"> 305             shift();</span>
<span class="line-added"> 306             return true;</span>
<span class="line-added"> 307         }</span>
 308         return false;
<a name="14" id="anc14"></a><span class="line-modified"> 309     };</span>

 310 
<a name="15" id="anc15"></a><span class="line-modified"> 311     auto nextIsIdentifier = [&amp;] {</span>
<span class="line-modified"> 312         return isValidNonStartingIdentifierChar(peek());</span>
<span class="line-modified"> 313     };</span>


 314 
<a name="16" id="anc16"></a><span class="line-modified"> 315     auto token = [&amp;] (Token::Type type) -&gt; Token {</span>
<span class="line-modified"> 316         auto oldOffset = m_offset;</span>
<span class="line-modified"> 317         m_offset = offset;</span>
<span class="line-modified"> 318         skipWhitespaceAndComments();</span>
<span class="line-modified"> 319         return { { oldOffset, offset, m_nameSpace }, type };</span>
<span class="line-modified"> 320     };</span>




 321 
<a name="17" id="anc17"></a><span class="line-modified"> 322     switch (shift()) {</span>
<span class="line-modified"> 323     case &#39;A&#39;:</span>
<span class="line-modified"> 324     case &#39;B&#39;:</span>
<span class="line-modified"> 325     case &#39;C&#39;:</span>
<span class="line-added"> 326     case &#39;D&#39;:</span>
<span class="line-added"> 327     case &#39;E&#39;:</span>
<span class="line-added"> 328     case &#39;F&#39;:</span>
<span class="line-added"> 329     case &#39;G&#39;:</span>
<span class="line-added"> 330     case &#39;H&#39;:</span>
<span class="line-added"> 331     case &#39;I&#39;:</span>
<span class="line-added"> 332     case &#39;J&#39;:</span>
<span class="line-added"> 333     case &#39;K&#39;:</span>
<span class="line-added"> 334     case &#39;L&#39;:</span>
<span class="line-added"> 335     case &#39;M&#39;:</span>
<span class="line-added"> 336     case &#39;N&#39;:</span>
<span class="line-added"> 337     case &#39;O&#39;:</span>
<span class="line-added"> 338     case &#39;Q&#39;:</span>
<span class="line-added"> 339     case &#39;R&#39;:</span>
<span class="line-added"> 340     case &#39;T&#39;:</span>
<span class="line-added"> 341     case &#39;U&#39;:</span>
<span class="line-added"> 342     case &#39;V&#39;:</span>
<span class="line-added"> 343     case &#39;W&#39;:</span>
<span class="line-added"> 344     case &#39;X&#39;:</span>
<span class="line-added"> 345     case &#39;Y&#39;:</span>
<span class="line-added"> 346     case &#39;Z&#39;:</span>
<span class="line-added"> 347     case &#39;g&#39;:</span>
<span class="line-added"> 348     case &#39;h&#39;:</span>
<span class="line-added"> 349     case &#39;j&#39;:</span>
<span class="line-added"> 350     case &#39;k&#39;:</span>
<span class="line-added"> 351     case &#39;l&#39;:</span>
<span class="line-added"> 352     case &#39;m&#39;:</span>
<span class="line-added"> 353     case &#39;q&#39;:</span>
<span class="line-added"> 354     case &#39;x&#39;:</span>
<span class="line-added"> 355     case &#39;y&#39;:</span>
<span class="line-added"> 356     case &#39;z&#39;:</span>
<span class="line-added"> 357 parseIdentifier:</span>
<span class="line-added"> 358         while (isValidNonStartingIdentifierChar(peek()))</span>
<span class="line-added"> 359             shift();</span>
<span class="line-added"> 360         return token(Token::Type::Identifier);</span>
 361 
<a name="18" id="anc18"></a><span class="line-modified"> 362     case &#39;s&#39;:</span>
<span class="line-modified"> 363         switch (peek()) {</span>
<span class="line-modified"> 364         case &#39;a&#39;:</span>
<span class="line-added"> 365             shift();</span>
<span class="line-added"> 366             if (!consume(&#39;m&#39;))</span>
<span class="line-added"> 367                 goto parseIdentifier;</span>
<span class="line-added"> 368             if (!consume(&#39;p&#39;))</span>
<span class="line-added"> 369                 goto parseIdentifier;</span>
<span class="line-added"> 370             if (!consume(&#39;l&#39;))</span>
<span class="line-added"> 371                 goto parseIdentifier;</span>
<span class="line-added"> 372             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 373                 goto parseIdentifier;</span>
<span class="line-added"> 374             if (nextIsIdentifier())</span>
<span class="line-added"> 375                 goto parseIdentifier;</span>
<span class="line-added"> 376             return token(Token::Type::Qualifier);</span>
 377 
<a name="19" id="anc19"></a><span class="line-modified"> 378         case &#39;w&#39;:</span>
<span class="line-modified"> 379             shift();</span>
<span class="line-modified"> 380             if (!consume(&#39;i&#39;))</span>
<span class="line-modified"> 381                 goto parseIdentifier;</span>
<span class="line-modified"> 382             if (!consume(&#39;t&#39;))</span>
<span class="line-modified"> 383                 goto parseIdentifier;</span>
<span class="line-modified"> 384             if (!consume(&#39;c&#39;))</span>
<span class="line-modified"> 385                 goto parseIdentifier;</span>
<span class="line-modified"> 386             if (!consume(&#39;h&#39;))</span>
<span class="line-modified"> 387                 goto parseIdentifier;</span>
<span class="line-modified"> 388             if (nextIsIdentifier())</span>
<span class="line-modified"> 389                 goto parseIdentifier;</span>
<span class="line-modified"> 390             return token(Token::Type::Switch);</span>
<span class="line-added"> 391 </span>
<span class="line-added"> 392         case &#39;t&#39;:</span>
<span class="line-added"> 393             shift();</span>
<span class="line-added"> 394             switch (peek()) {</span>
<span class="line-added"> 395             case &#39;r&#39;:</span>
<span class="line-added"> 396                 shift();</span>
<span class="line-added"> 397                 if (!consume(&#39;u&#39;))</span>
<span class="line-added"> 398                     goto parseIdentifier;</span>
<span class="line-added"> 399                 if (!consume(&#39;c&#39;))</span>
<span class="line-added"> 400                     goto parseIdentifier;</span>
<span class="line-added"> 401                 if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 402                     goto parseIdentifier;</span>
<span class="line-added"> 403                 if (nextIsIdentifier())</span>
<span class="line-added"> 404                     goto parseIdentifier;</span>
<span class="line-added"> 405                 return token(Token::Type::Struct);</span>
<span class="line-added"> 406             case &#39;a&#39;:</span>
<span class="line-added"> 407                 shift();</span>
<span class="line-added"> 408                 if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 409                     goto parseIdentifier;</span>
<span class="line-added"> 410                 if (!consume(&#39;i&#39;))</span>
<span class="line-added"> 411                     goto parseIdentifier;</span>
<span class="line-added"> 412                 if (!consume(&#39;c&#39;))</span>
<span class="line-added"> 413                     goto parseIdentifier;</span>
<span class="line-added"> 414                 if (nextIsIdentifier())</span>
<span class="line-added"> 415                     goto parseIdentifier;</span>
<span class="line-added"> 416                 return token(Token::Type::Static);</span>
<span class="line-added"> 417             default:</span>
<span class="line-added"> 418                 goto parseIdentifier;</span>
<span class="line-added"> 419             }</span>
<span class="line-added"> 420             break;</span>
<span class="line-added"> 421 </span>
<span class="line-added"> 422         case &#39;p&#39;:</span>
<span class="line-added"> 423             shift();</span>
<span class="line-added"> 424             switch (peek()) {</span>
<span class="line-added"> 425             case &#39;a&#39;:</span>
<span class="line-added"> 426                 shift();</span>
<span class="line-added"> 427                 if (!consume(&#39;c&#39;))</span>
<span class="line-added"> 428                     goto parseIdentifier;</span>
<span class="line-added"> 429                 if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 430                     goto parseIdentifier;</span>
<span class="line-added"> 431                 if (nextIsIdentifier())</span>
<span class="line-added"> 432                     goto parseIdentifier;</span>
<span class="line-added"> 433                 return token(Token::Type::Space);</span>
<span class="line-added"> 434             case &#39;e&#39;:</span>
<span class="line-added"> 435                 shift();</span>
<span class="line-added"> 436                 if (!consume(&#39;c&#39;))</span>
<span class="line-added"> 437                     goto parseIdentifier;</span>
<span class="line-added"> 438                 if (!consume(&#39;i&#39;))</span>
<span class="line-added"> 439                     goto parseIdentifier;</span>
<span class="line-added"> 440                 if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 441                     goto parseIdentifier;</span>
<span class="line-added"> 442                 if (!consume(&#39;l&#39;))</span>
<span class="line-added"> 443                     goto parseIdentifier;</span>
<span class="line-added"> 444                 if (!consume(&#39;i&#39;))</span>
<span class="line-added"> 445                     goto parseIdentifier;</span>
<span class="line-added"> 446                 if (!consume(&#39;z&#39;))</span>
<span class="line-added"> 447                     goto parseIdentifier;</span>
<span class="line-added"> 448                 if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 449                     goto parseIdentifier;</span>
<span class="line-added"> 450                 if (!consume(&#39;d&#39;))</span>
<span class="line-added"> 451                     goto parseIdentifier;</span>
<span class="line-added"> 452                 if (nextIsIdentifier())</span>
<span class="line-added"> 453                     goto parseIdentifier;</span>
<span class="line-added"> 454                 return token(Token::Type::Specialized);</span>
<span class="line-added"> 455             default:</span>
<span class="line-added"> 456                 goto parseIdentifier;</span>
<span class="line-added"> 457             }</span>
<span class="line-added"> 458         default:</span>
<span class="line-added"> 459             goto parseIdentifier;</span>
 460         }
<a name="20" id="anc20"></a><span class="line-modified"> 461 </span>
<span class="line-modified"> 462     case &#39;S&#39;:</span>
<span class="line-modified"> 463         if (!consume(&#39;V&#39;))</span>
<span class="line-modified"> 464             goto parseIdentifier;</span>
<span class="line-added"> 465         if (!consume(&#39;_&#39;))</span>
<span class="line-added"> 466             goto parseIdentifier;</span>
<span class="line-added"> 467 </span>
<span class="line-added"> 468         switch (peek()) {</span>
<span class="line-added"> 469         case &#39;G&#39;:</span>
<span class="line-added"> 470             shift();</span>
<span class="line-added"> 471             if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 472                 goto parseIdentifier;</span>
<span class="line-added"> 473             if (!consume(&#39;o&#39;))</span>
<span class="line-added"> 474                 goto parseIdentifier;</span>
<span class="line-added"> 475             if (!consume(&#39;u&#39;))</span>
<span class="line-added"> 476                 goto parseIdentifier;</span>
<span class="line-added"> 477             if (!consume(&#39;p&#39;))</span>
<span class="line-added"> 478                 goto parseIdentifier;</span>
<span class="line-added"> 479 </span>
<span class="line-added"> 480             switch (peek()) {</span>
<span class="line-added"> 481             case &#39;I&#39;:</span>
<span class="line-added"> 482                 shift();</span>
<span class="line-added"> 483                 switch (peek()) {</span>
<span class="line-added"> 484                 case &#39;D&#39;:</span>
<span class="line-added"> 485                     shift();</span>
<span class="line-added"> 486                     if (nextIsIdentifier())</span>
<span class="line-added"> 487                         goto parseIdentifier;</span>
<span class="line-added"> 488                     return token(Token::Type::SVGroupID);</span>
<span class="line-added"> 489                 case &#39;n&#39;:</span>
<span class="line-added"> 490                     shift();</span>
<span class="line-added"> 491                     if (!consume(&#39;d&#39;))</span>
<span class="line-added"> 492                         goto parseIdentifier;</span>
<span class="line-added"> 493                     if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 494                         goto parseIdentifier;</span>
<span class="line-added"> 495                     if (!consume(&#39;x&#39;))</span>
<span class="line-added"> 496                         goto parseIdentifier;</span>
<span class="line-added"> 497                     if (nextIsIdentifier())</span>
<span class="line-added"> 498                         goto parseIdentifier;</span>
<span class="line-added"> 499                     return token(Token::Type::SVGroupIndex);</span>
<span class="line-added"> 500 </span>
<span class="line-added"> 501                 default:</span>
<span class="line-added"> 502                     goto parseIdentifier;</span>
<span class="line-added"> 503                 }</span>
<span class="line-added"> 504 </span>
<span class="line-added"> 505             case &#39;T&#39;:</span>
<span class="line-added"> 506                 shift();</span>
<span class="line-added"> 507                 if (!consume(&#39;h&#39;))</span>
<span class="line-added"> 508                     goto parseIdentifier;</span>
<span class="line-added"> 509                 if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 510                     goto parseIdentifier;</span>
<span class="line-added"> 511                 if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 512                     goto parseIdentifier;</span>
<span class="line-added"> 513                 if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 514                     goto parseIdentifier;</span>
<span class="line-added"> 515                 if (!consume(&#39;d&#39;))</span>
<span class="line-added"> 516                     goto parseIdentifier;</span>
<span class="line-added"> 517                 if (!consume(&#39;I&#39;))</span>
<span class="line-added"> 518                     goto parseIdentifier;</span>
<span class="line-added"> 519                 if (!consume(&#39;D&#39;))</span>
<span class="line-added"> 520                     goto parseIdentifier;</span>
<span class="line-added"> 521                 if (nextIsIdentifier())</span>
<span class="line-added"> 522                     goto parseIdentifier;</span>
<span class="line-added"> 523                 return token(Token::Type::SVGroupThreadID);</span>
<span class="line-added"> 524 </span>
<span class="line-added"> 525             default:</span>
<span class="line-added"> 526                 goto parseIdentifier;</span>
<span class="line-added"> 527             }</span>
<span class="line-added"> 528         case &#39;D&#39;:</span>
<span class="line-added"> 529             shift();</span>
<span class="line-added"> 530             switch (peek()) {</span>
<span class="line-added"> 531             case &#39;e&#39;:</span>
<span class="line-added"> 532                 shift();</span>
<span class="line-added"> 533                 if (!consume(&#39;p&#39;))</span>
<span class="line-added"> 534                     goto parseIdentifier;</span>
<span class="line-added"> 535                 if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 536                     goto parseIdentifier;</span>
<span class="line-added"> 537                 if (!consume(&#39;h&#39;))</span>
<span class="line-added"> 538                     goto parseIdentifier;</span>
<span class="line-added"> 539                 if (nextIsIdentifier())</span>
<span class="line-added"> 540                     goto parseIdentifier;</span>
<span class="line-added"> 541                 return token(Token::Type::SVDepth);</span>
<span class="line-added"> 542             case &#39;i&#39;:</span>
<span class="line-added"> 543                 shift();</span>
<span class="line-added"> 544                 if (!consume(&#39;s&#39;))</span>
<span class="line-added"> 545                     goto parseIdentifier;</span>
<span class="line-added"> 546                 if (!consume(&#39;p&#39;))</span>
<span class="line-added"> 547                     goto parseIdentifier;</span>
<span class="line-added"> 548                 if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 549                     goto parseIdentifier;</span>
<span class="line-added"> 550                 if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 551                     goto parseIdentifier;</span>
<span class="line-added"> 552                 if (!consume(&#39;c&#39;))</span>
<span class="line-added"> 553                     goto parseIdentifier;</span>
<span class="line-added"> 554                 if (!consume(&#39;h&#39;))</span>
<span class="line-added"> 555                     goto parseIdentifier;</span>
<span class="line-added"> 556                 if (!consume(&#39;T&#39;))</span>
<span class="line-added"> 557                     goto parseIdentifier;</span>
<span class="line-added"> 558                 if (!consume(&#39;h&#39;))</span>
<span class="line-added"> 559                     goto parseIdentifier;</span>
<span class="line-added"> 560                 if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 561                     goto parseIdentifier;</span>
<span class="line-added"> 562                 if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 563                     goto parseIdentifier;</span>
<span class="line-added"> 564                 if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 565                     goto parseIdentifier;</span>
<span class="line-added"> 566                 if (!consume(&#39;d&#39;))</span>
<span class="line-added"> 567                     goto parseIdentifier;</span>
<span class="line-added"> 568                 if (!consume(&#39;I&#39;))</span>
<span class="line-added"> 569                     goto parseIdentifier;</span>
<span class="line-added"> 570                 if (!consume(&#39;D&#39;))</span>
<span class="line-added"> 571                     goto parseIdentifier;</span>
<span class="line-added"> 572                 if (nextIsIdentifier())</span>
<span class="line-added"> 573                     goto parseIdentifier;</span>
<span class="line-added"> 574                 return token(Token::Type::SVDispatchThreadID);</span>
<span class="line-added"> 575             default:</span>
<span class="line-added"> 576                 goto parseIdentifier;</span>
<span class="line-added"> 577             }</span>
<span class="line-added"> 578         case &#39;C&#39;:</span>
<span class="line-added"> 579             shift();</span>
<span class="line-added"> 580             if (!consume(&#39;o&#39;))</span>
<span class="line-added"> 581                 goto parseIdentifier;</span>
<span class="line-added"> 582             if (!consume(&#39;v&#39;))</span>
<span class="line-added"> 583                 goto parseIdentifier;</span>
<span class="line-added"> 584             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 585                 goto parseIdentifier;</span>
<span class="line-added"> 586             if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 587                 goto parseIdentifier;</span>
<span class="line-added"> 588             if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 589                 goto parseIdentifier;</span>
<span class="line-added"> 590             if (!consume(&#39;g&#39;))</span>
<span class="line-added"> 591                 goto parseIdentifier;</span>
<span class="line-added"> 592             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 593                 goto parseIdentifier;</span>
<span class="line-added"> 594             if (nextIsIdentifier())</span>
<span class="line-added"> 595                 goto parseIdentifier;</span>
<span class="line-added"> 596             return token(Token::Type::SVCoverage);</span>
<span class="line-added"> 597         case &#39;T&#39;:</span>
<span class="line-added"> 598             shift();</span>
<span class="line-added"> 599             if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 600                 goto parseIdentifier;</span>
<span class="line-added"> 601             if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 602                 goto parseIdentifier;</span>
<span class="line-added"> 603             if (!consume(&#39;g&#39;))</span>
<span class="line-added"> 604                 goto parseIdentifier;</span>
<span class="line-added"> 605             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 606                 goto parseIdentifier;</span>
<span class="line-added"> 607             if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 608                 goto parseIdentifier;</span>
<span class="line-added"> 609             if (nextIsIdentifier())</span>
<span class="line-added"> 610                 goto parseIdentifier;</span>
<span class="line-added"> 611             return token(Token::Type::SVTarget);</span>
<span class="line-added"> 612         case &#39;S&#39;:</span>
<span class="line-added"> 613             shift();</span>
<span class="line-added"> 614             if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 615                 goto parseIdentifier;</span>
<span class="line-added"> 616             if (!consume(&#39;m&#39;))</span>
<span class="line-added"> 617                 goto parseIdentifier;</span>
<span class="line-added"> 618             if (!consume(&#39;p&#39;))</span>
<span class="line-added"> 619                 goto parseIdentifier;</span>
<span class="line-added"> 620             if (!consume(&#39;l&#39;))</span>
<span class="line-added"> 621                 goto parseIdentifier;</span>
<span class="line-added"> 622             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 623                 goto parseIdentifier;</span>
<span class="line-added"> 624             if (!consume(&#39;I&#39;))</span>
<span class="line-added"> 625                 goto parseIdentifier;</span>
<span class="line-added"> 626             if (!consume(&#39;n&#39;))</span>
<span class="line-added"> 627                 goto parseIdentifier;</span>
<span class="line-added"> 628             if (!consume(&#39;d&#39;))</span>
<span class="line-added"> 629                 goto parseIdentifier;</span>
<span class="line-added"> 630             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 631                 goto parseIdentifier;</span>
<span class="line-added"> 632             if (!consume(&#39;x&#39;))</span>
<span class="line-added"> 633                 goto parseIdentifier;</span>
<span class="line-added"> 634             if (nextIsIdentifier())</span>
<span class="line-added"> 635                 goto parseIdentifier;</span>
<span class="line-added"> 636             return token(Token::Type::SVSampleIndex);</span>
<span class="line-added"> 637         case &#39;P&#39;:</span>
<span class="line-added"> 638             shift();</span>
<span class="line-added"> 639             if (!consume(&#39;o&#39;))</span>
<span class="line-added"> 640                 goto parseIdentifier;</span>
<span class="line-added"> 641             if (!consume(&#39;s&#39;))</span>
<span class="line-added"> 642                 goto parseIdentifier;</span>
<span class="line-added"> 643             if (!consume(&#39;i&#39;))</span>
<span class="line-added"> 644                 goto parseIdentifier;</span>
<span class="line-added"> 645             if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 646                 goto parseIdentifier;</span>
<span class="line-added"> 647             if (!consume(&#39;i&#39;))</span>
<span class="line-added"> 648                 goto parseIdentifier;</span>
<span class="line-added"> 649             if (!consume(&#39;o&#39;))</span>
<span class="line-added"> 650                 goto parseIdentifier;</span>
<span class="line-added"> 651             if (!consume(&#39;n&#39;))</span>
<span class="line-added"> 652                 goto parseIdentifier;</span>
<span class="line-added"> 653             if (nextIsIdentifier())</span>
<span class="line-added"> 654                 goto parseIdentifier;</span>
<span class="line-added"> 655             return token(Token::Type::SVPosition);</span>
<span class="line-added"> 656         case &#39;V&#39;:</span>
<span class="line-added"> 657             shift();</span>
<span class="line-added"> 658             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 659                 goto parseIdentifier;</span>
<span class="line-added"> 660             if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 661                 goto parseIdentifier;</span>
<span class="line-added"> 662             if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 663                 goto parseIdentifier;</span>
<span class="line-added"> 664             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 665                 goto parseIdentifier;</span>
<span class="line-added"> 666             if (!consume(&#39;x&#39;))</span>
<span class="line-added"> 667                 goto parseIdentifier;</span>
<span class="line-added"> 668             if (!consume(&#39;I&#39;))</span>
<span class="line-added"> 669                 goto parseIdentifier;</span>
<span class="line-added"> 670             if (!consume(&#39;D&#39;))</span>
<span class="line-added"> 671                 goto parseIdentifier;</span>
<span class="line-added"> 672             if (nextIsIdentifier())</span>
<span class="line-added"> 673                 goto parseIdentifier;</span>
<span class="line-added"> 674             return token(Token::Type::SVVertexID);</span>
<span class="line-added"> 675         case &#39;I&#39;:</span>
<span class="line-added"> 676             shift();</span>
<span class="line-added"> 677             switch (peek()) {</span>
<span class="line-added"> 678             case &#39;s&#39;:</span>
<span class="line-added"> 679                 shift();</span>
<span class="line-added"> 680                 if (!consume(&#39;F&#39;))</span>
<span class="line-added"> 681                     goto parseIdentifier;</span>
<span class="line-added"> 682                 if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 683                     goto parseIdentifier;</span>
<span class="line-added"> 684                 if (!consume(&#39;o&#39;))</span>
<span class="line-added"> 685                     goto parseIdentifier;</span>
<span class="line-added"> 686                 if (!consume(&#39;n&#39;))</span>
<span class="line-added"> 687                     goto parseIdentifier;</span>
<span class="line-added"> 688                 if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 689                     goto parseIdentifier;</span>
<span class="line-added"> 690                 if (!consume(&#39;F&#39;))</span>
<span class="line-added"> 691                     goto parseIdentifier;</span>
<span class="line-added"> 692                 if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 693                     goto parseIdentifier;</span>
<span class="line-added"> 694                 if (!consume(&#39;c&#39;))</span>
<span class="line-added"> 695                     goto parseIdentifier;</span>
<span class="line-added"> 696                 if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 697                     goto parseIdentifier;</span>
<span class="line-added"> 698                 if (nextIsIdentifier())</span>
<span class="line-added"> 699                     goto parseIdentifier;</span>
<span class="line-added"> 700                 return token(Token::Type::SVIsFrontFace);</span>
<span class="line-added"> 701             case &#39;n&#39;:</span>
<span class="line-added"> 702                 shift();</span>
<span class="line-added"> 703                 switch (peek()) {</span>
<span class="line-added"> 704                 case &#39;n&#39;:</span>
<span class="line-added"> 705                     shift();</span>
<span class="line-added"> 706                     if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 707                         goto parseIdentifier;</span>
<span class="line-added"> 708                     if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 709                         goto parseIdentifier;</span>
<span class="line-added"> 710                     if (!consume(&#39;C&#39;))</span>
<span class="line-added"> 711                         goto parseIdentifier;</span>
<span class="line-added"> 712                     if (!consume(&#39;o&#39;))</span>
<span class="line-added"> 713                         goto parseIdentifier;</span>
<span class="line-added"> 714                     if (!consume(&#39;v&#39;))</span>
<span class="line-added"> 715                         goto parseIdentifier;</span>
<span class="line-added"> 716                     if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 717                         goto parseIdentifier;</span>
<span class="line-added"> 718                     if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 719                         goto parseIdentifier;</span>
<span class="line-added"> 720                     if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 721                         goto parseIdentifier;</span>
<span class="line-added"> 722                     if (!consume(&#39;g&#39;))</span>
<span class="line-added"> 723                         goto parseIdentifier;</span>
<span class="line-added"> 724                     if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 725                         goto parseIdentifier;</span>
<span class="line-added"> 726                     if (nextIsIdentifier())</span>
<span class="line-added"> 727                         goto parseIdentifier;</span>
<span class="line-added"> 728                     return token(Token::Type::SVInnerCoverage);</span>
<span class="line-added"> 729                 case &#39;s&#39;:</span>
<span class="line-added"> 730                     shift();</span>
<span class="line-added"> 731                     if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 732                         goto parseIdentifier;</span>
<span class="line-added"> 733                     if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 734                         goto parseIdentifier;</span>
<span class="line-added"> 735                     if (!consume(&#39;n&#39;))</span>
<span class="line-added"> 736                         goto parseIdentifier;</span>
<span class="line-added"> 737                     if (!consume(&#39;c&#39;))</span>
<span class="line-added"> 738                         goto parseIdentifier;</span>
<span class="line-added"> 739                     if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 740                         goto parseIdentifier;</span>
<span class="line-added"> 741                     if (!consume(&#39;I&#39;))</span>
<span class="line-added"> 742                         goto parseIdentifier;</span>
<span class="line-added"> 743                     if (!consume(&#39;D&#39;))</span>
<span class="line-added"> 744                         goto parseIdentifier;</span>
<span class="line-added"> 745                     if (nextIsIdentifier())</span>
<span class="line-added"> 746                         goto parseIdentifier;</span>
<span class="line-added"> 747                     return token(Token::Type::SVInstanceID);</span>
<span class="line-added"> 748                 default:</span>
<span class="line-added"> 749                     goto parseIdentifier;</span>
<span class="line-added"> 750                 }</span>
<span class="line-added"> 751 </span>
<span class="line-added"> 752             default:</span>
<span class="line-added"> 753                 goto parseIdentifier;</span>
<span class="line-added"> 754             }</span>
<span class="line-added"> 755         default:</span>
<span class="line-added"> 756             goto parseIdentifier;</span>
<span class="line-added"> 757         }</span>
<span class="line-added"> 758 </span>
<span class="line-added"> 759     case &#39;t&#39;:</span>
<span class="line-added"> 760         switch (peek()) {</span>
<span class="line-added"> 761         case &#39;r&#39;:</span>
<span class="line-added"> 762             shift();</span>
<span class="line-added"> 763             if (!consume(&#39;u&#39;))</span>
<span class="line-added"> 764                 goto parseIdentifier;</span>
<span class="line-added"> 765             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 766                 goto parseIdentifier;</span>
<span class="line-added"> 767             if (nextIsIdentifier())</span>
<span class="line-added"> 768                 goto parseIdentifier;</span>
<span class="line-added"> 769             return token(Token::Type::True);</span>
<span class="line-added"> 770         case &#39;y&#39;:</span>
<span class="line-added"> 771             shift();</span>
<span class="line-added"> 772             if (!consume(&#39;p&#39;))</span>
<span class="line-added"> 773                 goto parseIdentifier;</span>
<span class="line-added"> 774             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 775                 goto parseIdentifier;</span>
<span class="line-added"> 776             if (!consume(&#39;d&#39;))</span>
<span class="line-added"> 777                 goto parseIdentifier;</span>
<span class="line-added"> 778             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 779                 goto parseIdentifier;</span>
<span class="line-added"> 780             if (!consume(&#39;f&#39;))</span>
<span class="line-added"> 781                 goto parseIdentifier;</span>
<span class="line-added"> 782             if (nextIsIdentifier())</span>
<span class="line-added"> 783                 goto parseIdentifier;</span>
<span class="line-added"> 784             return token(Token::Type::Typedef);</span>
<span class="line-added"> 785         case &#39;h&#39;:</span>
<span class="line-added"> 786             shift();</span>
<span class="line-added"> 787             if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 788                 goto parseIdentifier;</span>
<span class="line-added"> 789             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 790                 goto parseIdentifier;</span>
<span class="line-added"> 791             if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 792                 goto parseIdentifier;</span>
<span class="line-added"> 793             if (!consume(&#39;d&#39;))</span>
<span class="line-added"> 794                 goto parseIdentifier;</span>
<span class="line-added"> 795 </span>
<span class="line-added"> 796             if (!nextIsIdentifier())</span>
<span class="line-added"> 797                 return token(Token::Type::Thread);</span>
<span class="line-added"> 798 </span>
<span class="line-added"> 799             if (peek() != &#39;g&#39;)</span>
<span class="line-added"> 800                 goto parseIdentifier;</span>
<span class="line-added"> 801 </span>
<span class="line-added"> 802             shift();</span>
<span class="line-added"> 803             RELEASE_ASSERT(current == &#39;g&#39;);</span>
<span class="line-added"> 804             if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 805                 goto parseIdentifier;</span>
<span class="line-added"> 806             if (!consume(&#39;o&#39;))</span>
<span class="line-added"> 807                 goto parseIdentifier;</span>
<span class="line-added"> 808             if (!consume(&#39;u&#39;))</span>
<span class="line-added"> 809                 goto parseIdentifier;</span>
<span class="line-added"> 810             if (!consume(&#39;p&#39;))</span>
<span class="line-added"> 811                 goto parseIdentifier;</span>
<span class="line-added"> 812             if (nextIsIdentifier())</span>
<span class="line-added"> 813                 goto parseIdentifier;</span>
<span class="line-added"> 814             return token(Token::Type::Threadgroup);</span>
<span class="line-added"> 815 </span>
<span class="line-added"> 816         default:</span>
<span class="line-added"> 817             goto parseIdentifier;</span>
<span class="line-added"> 818         }</span>
<span class="line-added"> 819 </span>
<span class="line-added"> 820     case &#39;e&#39;:</span>
<span class="line-added"> 821         switch (peek()) {</span>
<span class="line-added"> 822         case &#39;n&#39;:</span>
<span class="line-added"> 823             shift();</span>
<span class="line-added"> 824             if (!consume(&#39;u&#39;))</span>
<span class="line-added"> 825                 goto parseIdentifier;</span>
<span class="line-added"> 826             if (!consume(&#39;m&#39;))</span>
<span class="line-added"> 827                 goto parseIdentifier;</span>
<span class="line-added"> 828             if (nextIsIdentifier())</span>
<span class="line-added"> 829                 goto parseIdentifier;</span>
<span class="line-added"> 830             return token(Token::Type::Enum);</span>
<span class="line-added"> 831         case &#39;l&#39;:</span>
<span class="line-added"> 832             shift();</span>
<span class="line-added"> 833             if (!consume(&#39;s&#39;))</span>
<span class="line-added"> 834                 goto parseIdentifier;</span>
<span class="line-added"> 835             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 836                 goto parseIdentifier;</span>
<span class="line-added"> 837             if (nextIsIdentifier())</span>
<span class="line-added"> 838                 goto parseIdentifier;</span>
<span class="line-added"> 839             return token(Token::Type::Else);</span>
<span class="line-added"> 840         default:</span>
<span class="line-added"> 841             goto parseIdentifier;</span>
<span class="line-added"> 842         }</span>
<span class="line-added"> 843 </span>
<span class="line-added"> 844     case &#39;o&#39;:</span>
<span class="line-added"> 845         if (!consume(&#39;p&#39;))</span>
<span class="line-added"> 846             goto parseIdentifier;</span>
<span class="line-added"> 847         if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 848             goto parseIdentifier;</span>
<span class="line-added"> 849         if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 850             goto parseIdentifier;</span>
<span class="line-added"> 851         if (!consume(&#39;a&#39;))</span>
<span class="line-added"> 852             goto parseIdentifier;</span>
<span class="line-added"> 853         if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 854             goto parseIdentifier;</span>
<span class="line-added"> 855         if (!consume(&#39;o&#39;))</span>
<span class="line-added"> 856             goto parseIdentifier;</span>
<span class="line-added"> 857         if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 858             goto parseIdentifier;</span>
<span class="line-added"> 859         if (nextIsIdentifier())</span>
<span class="line-added"> 860             goto parseIdentifier;</span>
<span class="line-added"> 861 </span>
<span class="line-added"> 862         switch (peek()) {</span>
<span class="line-added"> 863         case &#39;&amp;&#39;:</span>
<span class="line-added"> 864             shift();</span>
<span class="line-added"> 865             switch (peek()) {</span>
<span class="line-added"> 866             case &#39;[&#39;:</span>
<span class="line-added"> 867                 shift();</span>
<span class="line-added"> 868                 if (consume(&#39;]&#39;))</span>
<span class="line-added"> 869                     return token(Token::Type::OperatorName);</span>
<span class="line-added"> 870                 return token(Token::Type::Invalid);</span>
<span class="line-added"> 871             case &#39;.&#39;:</span>
<span class="line-added"> 872                 shift();</span>
<span class="line-added"> 873                 if (!isValidIdentifierStart(peek()))</span>
<span class="line-added"> 874                     return token(Token::Type::Invalid);</span>
<span class="line-added"> 875                 shift();</span>
<span class="line-added"> 876                 while (isValidNonStartingIdentifierChar(peek()))</span>
<span class="line-added"> 877                     shift();</span>
<span class="line-added"> 878                 return token(Token::Type::OperatorName);</span>
<span class="line-added"> 879             default:</span>
<span class="line-added"> 880                 return token(Token::Type::OperatorName);</span>
<span class="line-added"> 881             }</span>
<span class="line-added"> 882 </span>
<span class="line-added"> 883         case &#39;[&#39;:</span>
<span class="line-added"> 884             shift();</span>
<span class="line-added"> 885             if (!consume(&#39;]&#39;))</span>
<span class="line-added"> 886                 return token(Token::Type::Invalid);</span>
<span class="line-added"> 887             consume(&#39;=&#39;);</span>
<span class="line-added"> 888             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 889 </span>
<span class="line-added"> 890         case &#39;&gt;&#39;:</span>
<span class="line-added"> 891             shift();</span>
<span class="line-added"> 892             if (consume(&#39;&gt;&#39;))</span>
<span class="line-added"> 893                 return token(Token::Type::OperatorName);</span>
<span class="line-added"> 894             if (consume(&#39;=&#39;))</span>
<span class="line-added"> 895                 return token(Token::Type::OperatorName);</span>
<span class="line-added"> 896             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 897 </span>
<span class="line-added"> 898         case &#39;&lt;&#39;:</span>
<span class="line-added"> 899             shift();</span>
<span class="line-added"> 900             if (consume(&#39;&lt;&#39;))</span>
<span class="line-added"> 901                 return token(Token::Type::OperatorName);</span>
<span class="line-added"> 902             if (consume(&#39;=&#39;))</span>
<span class="line-added"> 903                 return token(Token::Type::OperatorName);</span>
<span class="line-added"> 904             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 905 </span>
<span class="line-added"> 906         case &#39;+&#39;:</span>
<span class="line-added"> 907             shift();</span>
<span class="line-added"> 908             consume(&#39;+&#39;);</span>
<span class="line-added"> 909             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 910 </span>
<span class="line-added"> 911         case &#39;-&#39;:</span>
<span class="line-added"> 912             shift();</span>
<span class="line-added"> 913             consume(&#39;-&#39;);</span>
<span class="line-added"> 914             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 915 </span>
<span class="line-added"> 916         case &#39;|&#39;:</span>
<span class="line-added"> 917             shift();</span>
<span class="line-added"> 918             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 919 </span>
<span class="line-added"> 920         case &#39;=&#39;:</span>
<span class="line-added"> 921             shift();</span>
<span class="line-added"> 922             if (!consume(&#39;=&#39;))</span>
<span class="line-added"> 923                 return token(Token::Type::Invalid);</span>
<span class="line-added"> 924             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 925 </span>
<span class="line-added"> 926         case &#39;*&#39;:</span>
<span class="line-added"> 927             shift();</span>
<span class="line-added"> 928             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 929 </span>
<span class="line-added"> 930         case &#39;/&#39;:</span>
<span class="line-added"> 931             shift();</span>
<span class="line-added"> 932             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 933 </span>
<span class="line-added"> 934         case &#39;%&#39;:</span>
<span class="line-added"> 935             shift();</span>
<span class="line-added"> 936             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 937 </span>
<span class="line-added"> 938         case &#39;!&#39;:</span>
<span class="line-added"> 939             shift();</span>
<span class="line-added"> 940             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 941 </span>
<span class="line-added"> 942         case &#39;~&#39;:</span>
<span class="line-added"> 943             shift();</span>
<span class="line-added"> 944             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 945 </span>
<span class="line-added"> 946         case &#39;^&#39;:</span>
<span class="line-added"> 947             shift();</span>
<span class="line-added"> 948             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 949 </span>
<span class="line-added"> 950         case &#39;.&#39;:</span>
<span class="line-added"> 951             shift();</span>
<span class="line-added"> 952             if (!isValidIdentifierStart(peek()))</span>
<span class="line-added"> 953                 return token(Token::Type::Invalid);</span>
<span class="line-added"> 954             shift();</span>
<span class="line-added"> 955             while (isValidNonStartingIdentifierChar(peek()))</span>
<span class="line-added"> 956                 shift();</span>
<span class="line-added"> 957             consume(&#39;=&#39;);</span>
<span class="line-added"> 958             return token(Token::Type::OperatorName);</span>
<span class="line-added"> 959         default:</span>
 960             break;
 961         }
<a name="21" id="anc21"></a>

 962 
<a name="22" id="anc22"></a><span class="line-modified"> 963         return token(Token::Type::Operator);</span>
 964 
<a name="23" id="anc23"></a><span class="line-modified"> 965     case &#39;i&#39;:</span>
<span class="line-modified"> 966         if (!consume(&#39;f&#39;))</span>
<span class="line-modified"> 967             goto parseIdentifier;</span>
<span class="line-modified"> 968         if (nextIsIdentifier())</span>
<span class="line-modified"> 969             goto parseIdentifier;</span>
<span class="line-modified"> 970         return token(Token::Type::If);</span>
<span class="line-modified"> 971 </span>
<span class="line-modified"> 972     case &#39;c&#39;:</span>
<span class="line-modified"> 973         switch (peek()) {</span>
<span class="line-added"> 974         case &#39;a&#39;:</span>
<span class="line-added"> 975             shift();</span>
<span class="line-added"> 976             if (!consume(&#39;s&#39;))</span>
<span class="line-added"> 977                 goto parseIdentifier;</span>
<span class="line-added"> 978             if (!consume(&#39;e&#39;))</span>
<span class="line-added"> 979                 goto parseIdentifier;</span>
<span class="line-added"> 980             if (nextIsIdentifier())</span>
<span class="line-added"> 981                 goto parseIdentifier;</span>
<span class="line-added"> 982             return token(Token::Type::Case);</span>
<span class="line-added"> 983 </span>
<span class="line-added"> 984         case &#39;e&#39;:</span>
<span class="line-added"> 985             shift();</span>
<span class="line-added"> 986             if (!consume(&#39;n&#39;))</span>
<span class="line-added"> 987                 goto parseIdentifier;</span>
<span class="line-added"> 988             if (!consume(&#39;t&#39;))</span>
<span class="line-added"> 989                 goto parseIdentifier;</span>
<span class="line-added"> 990             if (!consume(&#39;r&#39;))</span>
<span class="line-added"> 991                 goto parseIdentifier;</span>
<span class="line-added"> 992             if (!consume(&#39;o&#39;))</span>
<span class="line-added"> 993                 goto parseIdentifier;</span>
<span class="line-added"> 994             if (!consume(&#39;i&#39;))</span>
<span class="line-added"> 995                 goto parseIdentifier;</span>
<span class="line-added"> 996             if (!consume(&#39;d&#39;))</span>
<span class="line-added"> 997                 goto parseIdentifier;</span>
<span class="line-added"> 998             if (nextIsIdentifier())</span>
<span class="line-added"> 999                 goto parseIdentifier;</span>
<span class="line-added">1000             return token(Token::Type::Qualifier);</span>
<span class="line-added">1001         case &#39;o&#39;:</span>
<span class="line-added">1002             shift();</span>
<span class="line-added">1003             switch (peek()) {</span>
<span class="line-added">1004             case &#39;m&#39;:</span>
<span class="line-added">1005                 shift();</span>
<span class="line-added">1006                 if (!consume(&#39;p&#39;))</span>
<span class="line-added">1007                     goto parseIdentifier;</span>
<span class="line-added">1008                 if (!consume(&#39;u&#39;))</span>
<span class="line-added">1009                     goto parseIdentifier;</span>
<span class="line-added">1010                 if (!consume(&#39;t&#39;))</span>
<span class="line-added">1011                     goto parseIdentifier;</span>
<span class="line-added">1012                 if (!consume(&#39;e&#39;))</span>
<span class="line-added">1013                     goto parseIdentifier;</span>
<span class="line-added">1014                 if (nextIsIdentifier())</span>
<span class="line-added">1015                     goto parseIdentifier;</span>
<span class="line-added">1016                 return token(Token::Type::Compute);</span>
<span class="line-added">1017             case &#39;n&#39;:</span>
<span class="line-added">1018                 shift();</span>
<span class="line-added">1019                 switch (peek()) {</span>
<span class="line-added">1020                 case &#39;t&#39;:</span>
<span class="line-added">1021                     shift();</span>
<span class="line-added">1022                     if (!consume(&#39;i&#39;))</span>
<span class="line-added">1023                         goto parseIdentifier;</span>
<span class="line-added">1024                     if (!consume(&#39;n&#39;))</span>
<span class="line-added">1025                         goto parseIdentifier;</span>
<span class="line-added">1026                     if (!consume(&#39;u&#39;))</span>
<span class="line-added">1027                         goto parseIdentifier;</span>
<span class="line-added">1028                     if (!consume(&#39;e&#39;))</span>
<span class="line-added">1029                         goto parseIdentifier;</span>
<span class="line-added">1030                     if (nextIsIdentifier())</span>
<span class="line-added">1031                         goto parseIdentifier;</span>
<span class="line-added">1032                     return token(Token::Type::Continue);</span>
<span class="line-added">1033                 case &#39;s&#39;:</span>
<span class="line-added">1034                     shift();</span>
<span class="line-added">1035                     if (!consume(&#39;t&#39;))</span>
<span class="line-added">1036                         goto parseIdentifier;</span>
<span class="line-added">1037 </span>
<span class="line-added">1038                     if (!nextIsIdentifier())</span>
<span class="line-added">1039                         return token(Token::Type::Const);</span>
<span class="line-added">1040 </span>
<span class="line-added">1041                     if (!consume(&#39;a&#39;))</span>
<span class="line-added">1042                         goto parseIdentifier;</span>
<span class="line-added">1043                     if (!consume(&#39;n&#39;))</span>
<span class="line-added">1044                         goto parseIdentifier;</span>
<span class="line-added">1045                     if (!consume(&#39;t&#39;))</span>
<span class="line-added">1046                         goto parseIdentifier;</span>
<span class="line-added">1047                     if (nextIsIdentifier())</span>
<span class="line-added">1048                         goto parseIdentifier;</span>
<span class="line-added">1049                     return token(Token::Type::Constant);</span>
<span class="line-added">1050 </span>
<span class="line-added">1051                 default:</span>
<span class="line-added">1052                     goto parseIdentifier;</span>
<span class="line-added">1053                 }</span>
<span class="line-added">1054 </span>
<span class="line-added">1055             default:</span>
<span class="line-added">1056                 goto parseIdentifier;</span>
<span class="line-added">1057             }</span>
<span class="line-added">1058 </span>
<span class="line-added">1059         default:</span>
<span class="line-added">1060             goto parseIdentifier;</span>
1061         }
<a name="24" id="anc24"></a>



1062 
<a name="25" id="anc25"></a><span class="line-modified">1063     case &#39;b&#39;:</span>
<span class="line-modified">1064         if (!consume(&#39;r&#39;))</span>
<span class="line-modified">1065             goto parseIdentifier;</span>
<span class="line-modified">1066         if (!consume(&#39;e&#39;))</span>
<span class="line-modified">1067             goto parseIdentifier;</span>
<span class="line-modified">1068         if (!consume(&#39;a&#39;))</span>
<span class="line-added">1069             goto parseIdentifier;</span>
<span class="line-added">1070         if (!consume(&#39;k&#39;))</span>
<span class="line-added">1071             goto parseIdentifier;</span>
<span class="line-added">1072         if (nextIsIdentifier())</span>
<span class="line-added">1073             goto parseIdentifier;</span>
<span class="line-added">1074         return token(Token::Type::Break);</span>
1075 
<a name="26" id="anc26"></a><span class="line-modified">1076     case &#39;d&#39;:</span>
<span class="line-modified">1077         switch (peek()) {</span>
<span class="line-modified">1078         case &#39;o&#39;:</span>
<span class="line-modified">1079             shift();</span>
<span class="line-modified">1080             if (nextIsIdentifier())</span>
<span class="line-modified">1081                 goto parseIdentifier;</span>
<span class="line-modified">1082             return token(Token::Type::Do);</span>
<span class="line-modified">1083         case &#39;e&#39;:</span>
<span class="line-modified">1084             shift();</span>
<span class="line-added">1085             switch (peek()) {</span>
<span class="line-added">1086             case &#39;f&#39;:</span>
<span class="line-added">1087                 shift();</span>
<span class="line-added">1088                 if (!consume(&#39;a&#39;))</span>
<span class="line-added">1089                     goto parseIdentifier;</span>
<span class="line-added">1090                 if (!consume(&#39;u&#39;))</span>
<span class="line-added">1091                     goto parseIdentifier;</span>
<span class="line-added">1092                 if (!consume(&#39;l&#39;))</span>
<span class="line-added">1093                     goto parseIdentifier;</span>
<span class="line-added">1094                 if (!consume(&#39;t&#39;))</span>
<span class="line-added">1095                     goto parseIdentifier;</span>
<span class="line-added">1096                 if (nextIsIdentifier())</span>
<span class="line-added">1097                     goto parseIdentifier;</span>
<span class="line-added">1098                 return token(Token::Type::Default);</span>
<span class="line-added">1099             case &#39;v&#39;:</span>
<span class="line-added">1100                 shift();</span>
<span class="line-added">1101                 if (!consume(&#39;i&#39;))</span>
<span class="line-added">1102                     goto parseIdentifier;</span>
<span class="line-added">1103                 if (!consume(&#39;c&#39;))</span>
<span class="line-added">1104                     goto parseIdentifier;</span>
<span class="line-added">1105                 if (!consume(&#39;e&#39;))</span>
<span class="line-added">1106                     goto parseIdentifier;</span>
<span class="line-added">1107                 if (nextIsIdentifier())</span>
<span class="line-added">1108                     goto parseIdentifier;</span>
<span class="line-added">1109                 return token(Token::Type::Device);</span>
<span class="line-added">1110             default:</span>
<span class="line-added">1111                 goto parseIdentifier;</span>
<span class="line-added">1112             }</span>
1113 
<a name="27" id="anc27"></a><span class="line-modified">1114         default:</span>
<span class="line-modified">1115             goto parseIdentifier;</span>
<span class="line-modified">1116         }</span>



1117 
<a name="28" id="anc28"></a>



1118 
<a name="29" id="anc29"></a><span class="line-modified">1119     case &#39;f&#39;:</span>
<span class="line-modified">1120         switch (peek()) {</span>
<span class="line-modified">1121         case &#39;o&#39;:</span>
<span class="line-modified">1122             shift();</span>
<span class="line-modified">1123             if (!consume(&#39;r&#39;))</span>
<span class="line-modified">1124                 goto parseIdentifier;</span>
<span class="line-modified">1125             if (nextIsIdentifier())</span>
<span class="line-modified">1126                 goto parseIdentifier;</span>
<span class="line-added">1127             return token(Token::Type::For);</span>
<span class="line-added">1128         case &#39;r&#39;:</span>
<span class="line-added">1129             shift();</span>
<span class="line-added">1130             if (!consume(&#39;a&#39;))</span>
<span class="line-added">1131                 goto parseIdentifier;</span>
<span class="line-added">1132             if (!consume(&#39;g&#39;))</span>
<span class="line-added">1133                 goto parseIdentifier;</span>
<span class="line-added">1134             if (!consume(&#39;m&#39;))</span>
<span class="line-added">1135                 goto parseIdentifier;</span>
<span class="line-added">1136             if (!consume(&#39;e&#39;))</span>
<span class="line-added">1137                 goto parseIdentifier;</span>
<span class="line-added">1138             if (!consume(&#39;n&#39;))</span>
<span class="line-added">1139                 goto parseIdentifier;</span>
<span class="line-added">1140             if (!consume(&#39;t&#39;))</span>
<span class="line-added">1141                 goto parseIdentifier;</span>
<span class="line-added">1142             if (nextIsIdentifier())</span>
<span class="line-added">1143                 goto parseIdentifier;</span>
<span class="line-added">1144             return token(Token::Type::Fragment);</span>
<span class="line-added">1145         case &#39;a&#39;:</span>
<span class="line-added">1146             shift();</span>
<span class="line-added">1147             if (!consume(&#39;l&#39;))</span>
<span class="line-added">1148                 goto parseIdentifier;</span>
1149 
<a name="30" id="anc30"></a><span class="line-modified">1150             switch (peek()) {</span>
<span class="line-modified">1151             case &#39;l&#39;:</span>
<span class="line-modified">1152                 shift();</span>
<span class="line-modified">1153                 if (!consume(&#39;t&#39;))</span>
<span class="line-modified">1154                     goto parseIdentifier;</span>
<span class="line-modified">1155                 if (!consume(&#39;h&#39;))</span>
<span class="line-added">1156                     goto parseIdentifier;</span>
<span class="line-added">1157                 if (!consume(&#39;r&#39;))</span>
<span class="line-added">1158                     goto parseIdentifier;</span>
<span class="line-added">1159                 if (!consume(&#39;o&#39;))</span>
<span class="line-added">1160                     goto parseIdentifier;</span>
<span class="line-added">1161                 if (!consume(&#39;u&#39;))</span>
<span class="line-added">1162                     goto parseIdentifier;</span>
<span class="line-added">1163                 if (!consume(&#39;g&#39;))</span>
<span class="line-added">1164                     goto parseIdentifier;</span>
<span class="line-added">1165                 if (!consume(&#39;h&#39;))</span>
<span class="line-added">1166                     goto parseIdentifier;</span>
<span class="line-added">1167                 if (nextIsIdentifier())</span>
<span class="line-added">1168                     goto parseIdentifier;</span>
<span class="line-added">1169                 return token(Token::Type::Fallthrough);</span>
1170 
<a name="31" id="anc31"></a><span class="line-modified">1171             case &#39;s&#39;:</span>
<span class="line-modified">1172                 shift();</span>
<span class="line-modified">1173                 if (!consume(&#39;e&#39;))</span>
<span class="line-modified">1174                     goto parseIdentifier;</span>
<span class="line-modified">1175                 if (nextIsIdentifier())</span>
<span class="line-modified">1176                     goto parseIdentifier;</span>
<span class="line-modified">1177                 return token(Token::Type::False);</span>
<span class="line-modified">1178             default:</span>
<span class="line-modified">1179                 goto parseIdentifier;</span>
<span class="line-added">1180             }</span>
<span class="line-added">1181         case &#39;e&#39;:</span>
<span class="line-added">1182             shift();</span>
<span class="line-added">1183             switch (peek()) {</span>
<span class="line-added">1184             case &#39;f&#39;:</span>
<span class="line-added">1185                 shift();</span>
<span class="line-added">1186                 if (!consume(&#39;a&#39;))</span>
<span class="line-added">1187                     goto parseIdentifier;</span>
<span class="line-added">1188                 if (!consume(&#39;u&#39;))</span>
<span class="line-added">1189                     goto parseIdentifier;</span>
<span class="line-added">1190                 if (!consume(&#39;l&#39;))</span>
<span class="line-added">1191                     goto parseIdentifier;</span>
<span class="line-added">1192                 if (!consume(&#39;t&#39;))</span>
<span class="line-added">1193                     goto parseIdentifier;</span>
<span class="line-added">1194                 if (nextIsIdentifier())</span>
<span class="line-added">1195                     goto parseIdentifier;</span>
<span class="line-added">1196                 return token(Token::Type::Default);</span>
<span class="line-added">1197             case &#39;v&#39;:</span>
<span class="line-added">1198                 shift();</span>
<span class="line-added">1199                 if (!consume(&#39;i&#39;))</span>
<span class="line-added">1200                     goto parseIdentifier;</span>
<span class="line-added">1201                 if (!consume(&#39;c&#39;))</span>
<span class="line-added">1202                     goto parseIdentifier;</span>
<span class="line-added">1203                 if (!consume(&#39;e&#39;))</span>
<span class="line-added">1204                     goto parseIdentifier;</span>
<span class="line-added">1205                 if (nextIsIdentifier())</span>
<span class="line-added">1206                     goto parseIdentifier;</span>
<span class="line-added">1207                 return token(Token::Type::Device);</span>
<span class="line-added">1208             default:</span>
<span class="line-added">1209                 goto parseIdentifier;</span>
<span class="line-added">1210             }</span>
1211 
<a name="32" id="anc32"></a><span class="line-modified">1212         default:</span>
<span class="line-modified">1213             goto parseIdentifier;</span>
<span class="line-modified">1214         }</span>





1215 
<a name="33" id="anc33"></a><span class="line-modified">1216     case &#39;w&#39;:</span>
<span class="line-modified">1217         if (!consume(&#39;h&#39;))</span>
<span class="line-modified">1218             goto parseIdentifier;</span>
<span class="line-modified">1219         if (!consume(&#39;i&#39;))</span>
<span class="line-modified">1220             goto parseIdentifier;</span>
<span class="line-modified">1221         if (!consume(&#39;l&#39;))</span>
<span class="line-modified">1222             goto parseIdentifier;</span>
<span class="line-modified">1223         if (!consume(&#39;e&#39;))</span>
<span class="line-added">1224             goto parseIdentifier;</span>
<span class="line-added">1225         if (nextIsIdentifier())</span>
<span class="line-added">1226             goto parseIdentifier;</span>
<span class="line-added">1227         return token(Token::Type::While);</span>
1228 
<a name="34" id="anc34"></a><span class="line-modified">1229     case &#39;r&#39;:</span>
<span class="line-modified">1230         if (!consume(&#39;e&#39;))</span>
<span class="line-modified">1231             goto parseIdentifier;</span>
<span class="line-modified">1232         switch (peek()) {</span>
<span class="line-modified">1233         case &#39;t&#39;:</span>
<span class="line-modified">1234             shift();</span>
<span class="line-added">1235             if (!consume(&#39;u&#39;))</span>
<span class="line-added">1236                 goto parseIdentifier;</span>
<span class="line-added">1237             if (!consume(&#39;r&#39;))</span>
<span class="line-added">1238                 goto parseIdentifier;</span>
<span class="line-added">1239             if (!consume(&#39;n&#39;))</span>
<span class="line-added">1240                 goto parseIdentifier;</span>
<span class="line-added">1241             if (nextIsIdentifier())</span>
<span class="line-added">1242                 goto parseIdentifier;</span>
<span class="line-added">1243             return token(Token::Type::Return);</span>
<span class="line-added">1244         case &#39;g&#39;:</span>
<span class="line-added">1245             shift();</span>
<span class="line-added">1246             if (!consume(&#39;i&#39;))</span>
<span class="line-added">1247                 goto parseIdentifier;</span>
<span class="line-added">1248             if (!consume(&#39;s&#39;))</span>
<span class="line-added">1249                 goto parseIdentifier;</span>
<span class="line-added">1250             if (!consume(&#39;t&#39;))</span>
<span class="line-added">1251                 goto parseIdentifier;</span>
<span class="line-added">1252             if (!consume(&#39;e&#39;))</span>
<span class="line-added">1253                 goto parseIdentifier;</span>
<span class="line-added">1254             if (!consume(&#39;r&#39;))</span>
<span class="line-added">1255                 goto parseIdentifier;</span>
<span class="line-added">1256             if (nextIsIdentifier())</span>
<span class="line-added">1257                 goto parseIdentifier;</span>
<span class="line-added">1258             return token(Token::Type::Register);</span>
<span class="line-added">1259         case &#39;s&#39;:</span>
<span class="line-added">1260             shift();</span>
<span class="line-added">1261             if (!consume(&#39;t&#39;))</span>
<span class="line-added">1262                 goto parseIdentifier;</span>
<span class="line-added">1263             if (!consume(&#39;r&#39;))</span>
<span class="line-added">1264                 goto parseIdentifier;</span>
<span class="line-added">1265             if (!consume(&#39;i&#39;))</span>
<span class="line-added">1266                 goto parseIdentifier;</span>
<span class="line-added">1267             if (!consume(&#39;c&#39;))</span>
<span class="line-added">1268                 goto parseIdentifier;</span>
<span class="line-added">1269             if (!consume(&#39;t&#39;))</span>
<span class="line-added">1270                 goto parseIdentifier;</span>
<span class="line-added">1271             if (!consume(&#39;e&#39;))</span>
<span class="line-added">1272                 goto parseIdentifier;</span>
<span class="line-added">1273             if (!consume(&#39;d&#39;))</span>
<span class="line-added">1274                 goto parseIdentifier;</span>
<span class="line-added">1275             if (nextIsIdentifier())</span>
<span class="line-added">1276                 goto parseIdentifier;</span>
<span class="line-added">1277             return token(Token::Type::Restricted);</span>
<span class="line-added">1278         default:</span>
<span class="line-added">1279             goto parseIdentifier;</span>
<span class="line-added">1280         }</span>
1281 
<a name="35" id="anc35"></a><span class="line-modified">1282     case &#39;n&#39;:</span>
<span class="line-modified">1283         switch (peek()) {</span>
<span class="line-modified">1284         case &#39;a&#39;:</span>
<span class="line-modified">1285             shift();</span>
<span class="line-modified">1286             if (!consume(&#39;t&#39;))</span>
<span class="line-modified">1287                 goto parseIdentifier;</span>
<span class="line-modified">1288             if (!consume(&#39;i&#39;))</span>
<span class="line-added">1289                 goto parseIdentifier;</span>
<span class="line-added">1290             if (!consume(&#39;v&#39;))</span>
<span class="line-added">1291                 goto parseIdentifier;</span>
<span class="line-added">1292             if (!consume(&#39;e&#39;))</span>
<span class="line-added">1293                 goto parseIdentifier;</span>
<span class="line-added">1294             if (nextIsIdentifier())</span>
<span class="line-added">1295                 goto parseIdentifier;</span>
<span class="line-added">1296             return token(Token::Type::Native);</span>
<span class="line-added">1297         case &#39;u&#39;:</span>
<span class="line-added">1298             shift();</span>
<span class="line-added">1299             switch (peek()) {</span>
<span class="line-added">1300             case &#39;l&#39;:</span>
<span class="line-added">1301                 shift();</span>
<span class="line-added">1302                 if (!consume(&#39;l&#39;))</span>
<span class="line-added">1303                     goto parseIdentifier;</span>
<span class="line-added">1304                 if (nextIsIdentifier())</span>
<span class="line-added">1305                     goto parseIdentifier;</span>
<span class="line-added">1306                 return token(Token::Type::Null);</span>
<span class="line-added">1307             case &#39;m&#39;:</span>
<span class="line-added">1308                 shift();</span>
<span class="line-added">1309                 if (!consume(&#39;t&#39;))</span>
<span class="line-added">1310                     goto parseIdentifier;</span>
<span class="line-added">1311                 if (!consume(&#39;h&#39;))</span>
<span class="line-added">1312                     goto parseIdentifier;</span>
<span class="line-added">1313                 if (!consume(&#39;r&#39;))</span>
<span class="line-added">1314                     goto parseIdentifier;</span>
<span class="line-added">1315                 if (!consume(&#39;e&#39;))</span>
<span class="line-added">1316                     goto parseIdentifier;</span>
<span class="line-added">1317                 if (!consume(&#39;a&#39;))</span>
<span class="line-added">1318                     goto parseIdentifier;</span>
<span class="line-added">1319                 if (!consume(&#39;d&#39;))</span>
<span class="line-added">1320                     goto parseIdentifier;</span>
<span class="line-added">1321                 if (!consume(&#39;s&#39;))</span>
<span class="line-added">1322                     goto parseIdentifier;</span>
<span class="line-added">1323                 if (nextIsIdentifier())</span>
<span class="line-added">1324                     goto parseIdentifier;</span>
<span class="line-added">1325                 return token(Token::Type::NumThreads);</span>
<span class="line-added">1326             default:</span>
<span class="line-added">1327                 goto parseIdentifier;</span>
<span class="line-added">1328             }</span>
<span class="line-added">1329 </span>
<span class="line-added">1330         case &#39;o&#39;:</span>
<span class="line-added">1331             shift();</span>
<span class="line-added">1332             switch (peek()) {</span>
<span class="line-added">1333             case &#39;i&#39;:</span>
<span class="line-added">1334                 shift();</span>
<span class="line-added">1335                 if (!consume(&#39;n&#39;))</span>
<span class="line-added">1336                     goto parseIdentifier;</span>
<span class="line-added">1337                 if (!consume(&#39;t&#39;))</span>
<span class="line-added">1338                     goto parseIdentifier;</span>
<span class="line-added">1339                 if (!consume(&#39;e&#39;))</span>
<span class="line-added">1340                     goto parseIdentifier;</span>
<span class="line-added">1341                 if (!consume(&#39;r&#39;))</span>
<span class="line-added">1342                     goto parseIdentifier;</span>
<span class="line-added">1343                 if (!consume(&#39;p&#39;))</span>
<span class="line-added">1344                     goto parseIdentifier;</span>
<span class="line-added">1345                 if (!consume(&#39;o&#39;))</span>
<span class="line-added">1346                     goto parseIdentifier;</span>
<span class="line-added">1347                 if (!consume(&#39;l&#39;))</span>
<span class="line-added">1348                     goto parseIdentifier;</span>
<span class="line-added">1349                 if (!consume(&#39;a&#39;))</span>
<span class="line-added">1350                     goto parseIdentifier;</span>
<span class="line-added">1351                 if (!consume(&#39;t&#39;))</span>
<span class="line-added">1352                     goto parseIdentifier;</span>
<span class="line-added">1353                 if (!consume(&#39;i&#39;))</span>
<span class="line-added">1354                     goto parseIdentifier;</span>
<span class="line-added">1355                 if (!consume(&#39;o&#39;))</span>
<span class="line-added">1356                     goto parseIdentifier;</span>
<span class="line-added">1357                 if (!consume(&#39;n&#39;))</span>
<span class="line-added">1358                     goto parseIdentifier;</span>
<span class="line-added">1359                 if (nextIsIdentifier())</span>
<span class="line-added">1360                     goto parseIdentifier;</span>
<span class="line-added">1361                 return token(Token::Type::Qualifier);</span>
<span class="line-added">1362             case &#39;p&#39;:</span>
<span class="line-added">1363                 shift();</span>
<span class="line-added">1364                 if (!consume(&#39;e&#39;))</span>
<span class="line-added">1365                     goto parseIdentifier;</span>
<span class="line-added">1366                 if (!consume(&#39;r&#39;))</span>
<span class="line-added">1367                     goto parseIdentifier;</span>
<span class="line-added">1368                 if (!consume(&#39;s&#39;))</span>
<span class="line-added">1369                     goto parseIdentifier;</span>
<span class="line-added">1370                 if (!consume(&#39;p&#39;))</span>
<span class="line-added">1371                     goto parseIdentifier;</span>
<span class="line-added">1372                 if (!consume(&#39;e&#39;))</span>
<span class="line-added">1373                     goto parseIdentifier;</span>
<span class="line-added">1374                 if (!consume(&#39;c&#39;))</span>
<span class="line-added">1375                     goto parseIdentifier;</span>
<span class="line-added">1376                 if (!consume(&#39;t&#39;))</span>
<span class="line-added">1377                     goto parseIdentifier;</span>
<span class="line-added">1378                 if (!consume(&#39;i&#39;))</span>
<span class="line-added">1379                     goto parseIdentifier;</span>
<span class="line-added">1380                 if (!consume(&#39;v&#39;))</span>
<span class="line-added">1381                     goto parseIdentifier;</span>
<span class="line-added">1382                 if (!consume(&#39;e&#39;))</span>
<span class="line-added">1383                     goto parseIdentifier;</span>
<span class="line-added">1384                 if (nextIsIdentifier())</span>
<span class="line-added">1385                     goto parseIdentifier;</span>
<span class="line-added">1386                 return token(Token::Type::Qualifier);</span>
<span class="line-added">1387             default:</span>
<span class="line-added">1388                 goto parseIdentifier;</span>
<span class="line-added">1389             }</span>
<span class="line-added">1390 </span>
<span class="line-added">1391         default:</span>
<span class="line-added">1392             goto parseIdentifier;</span>
<span class="line-added">1393         }</span>
<span class="line-added">1394 </span>
<span class="line-added">1395     case &#39;v&#39;:</span>
<span class="line-added">1396         if (!consume(&#39;e&#39;))</span>
<span class="line-added">1397             goto parseIdentifier;</span>
<span class="line-added">1398         if (!consume(&#39;r&#39;))</span>
<span class="line-added">1399             goto parseIdentifier;</span>
<span class="line-added">1400         if (!consume(&#39;t&#39;))</span>
<span class="line-added">1401             goto parseIdentifier;</span>
<span class="line-added">1402         if (!consume(&#39;e&#39;))</span>
<span class="line-added">1403             goto parseIdentifier;</span>
<span class="line-added">1404         if (!consume(&#39;x&#39;))</span>
<span class="line-added">1405             goto parseIdentifier;</span>
<span class="line-added">1406         if (nextIsIdentifier())</span>
<span class="line-added">1407             goto parseIdentifier;</span>
<span class="line-added">1408         return token(Token::Type::Vertex);</span>
<span class="line-added">1409 </span>
<span class="line-added">1410     case &#39;P&#39;:</span>
<span class="line-added">1411         if (!consume(&#39;S&#39;))</span>
<span class="line-added">1412             goto parseIdentifier;</span>
<span class="line-added">1413         if (!consume(&#39;I&#39;))</span>
<span class="line-added">1414             goto parseIdentifier;</span>
<span class="line-added">1415         if (!consume(&#39;Z&#39;))</span>
<span class="line-added">1416             goto parseIdentifier;</span>
<span class="line-added">1417         if (!consume(&#39;E&#39;))</span>
<span class="line-added">1418             goto parseIdentifier;</span>
<span class="line-added">1419         if (nextIsIdentifier())</span>
<span class="line-added">1420             goto parseIdentifier;</span>
<span class="line-added">1421         return token(Token::Type::PSize);</span>
<span class="line-added">1422 </span>
<span class="line-added">1423     case &#39;u&#39;:</span>
<span class="line-added">1424         if (!consume(&#39;n&#39;))</span>
<span class="line-added">1425             goto parseIdentifier;</span>
<span class="line-added">1426         if (!consume(&#39;i&#39;))</span>
<span class="line-added">1427             goto parseIdentifier;</span>
<span class="line-added">1428         if (!consume(&#39;f&#39;))</span>
<span class="line-added">1429             goto parseIdentifier;</span>
<span class="line-added">1430         if (!consume(&#39;o&#39;))</span>
<span class="line-added">1431             goto parseIdentifier;</span>
<span class="line-added">1432         if (!consume(&#39;r&#39;))</span>
<span class="line-added">1433             goto parseIdentifier;</span>
<span class="line-added">1434         if (!consume(&#39;m&#39;))</span>
<span class="line-added">1435             goto parseIdentifier;</span>
<span class="line-added">1436         if (nextIsIdentifier())</span>
<span class="line-added">1437             goto parseIdentifier;</span>
<span class="line-added">1438         return token(Token::Type::Qualifier);</span>
<span class="line-added">1439 </span>
<span class="line-added">1440     case &#39;p&#39;:</span>
<span class="line-added">1441         if (!consume(&#39;r&#39;))</span>
<span class="line-added">1442             goto parseIdentifier;</span>
<span class="line-added">1443         if (!consume(&#39;o&#39;))</span>
<span class="line-added">1444             goto parseIdentifier;</span>
<span class="line-added">1445         if (!consume(&#39;t&#39;))</span>
<span class="line-added">1446             goto parseIdentifier;</span>
<span class="line-added">1447         if (!consume(&#39;o&#39;))</span>
<span class="line-added">1448             goto parseIdentifier;</span>
<span class="line-added">1449         if (!consume(&#39;c&#39;))</span>
<span class="line-added">1450             goto parseIdentifier;</span>
<span class="line-added">1451         if (!consume(&#39;o&#39;))</span>
<span class="line-added">1452             goto parseIdentifier;</span>
<span class="line-added">1453         if (!consume(&#39;l&#39;))</span>
<span class="line-added">1454             goto parseIdentifier;</span>
<span class="line-added">1455         if (nextIsIdentifier())</span>
<span class="line-added">1456             goto parseIdentifier;</span>
<span class="line-added">1457         return token(Token::Type::Protocol);</span>
<span class="line-added">1458 </span>
<span class="line-added">1459     case &#39;_&#39;:</span>
<span class="line-added">1460         if (nextIsIdentifier())</span>
<span class="line-added">1461             goto parseIdentifier;</span>
<span class="line-added">1462         return token(Token::Type::Underscore);</span>
<span class="line-added">1463 </span>
<span class="line-added">1464     case &#39;a&#39;:</span>
<span class="line-added">1465         switch (peek()) {</span>
<span class="line-added">1466         case &#39;t&#39;:</span>
<span class="line-added">1467             shift();</span>
<span class="line-added">1468             if (!consume(&#39;t&#39;))</span>
<span class="line-added">1469                 goto parseIdentifier;</span>
<span class="line-added">1470             if (!consume(&#39;r&#39;))</span>
<span class="line-added">1471                 goto parseIdentifier;</span>
<span class="line-added">1472             if (!consume(&#39;i&#39;))</span>
<span class="line-added">1473                 goto parseIdentifier;</span>
<span class="line-added">1474             if (!consume(&#39;b&#39;))</span>
<span class="line-added">1475                 goto parseIdentifier;</span>
<span class="line-added">1476             if (!consume(&#39;u&#39;))</span>
<span class="line-added">1477                 goto parseIdentifier;</span>
<span class="line-added">1478             if (!consume(&#39;t&#39;))</span>
<span class="line-added">1479                 goto parseIdentifier;</span>
<span class="line-added">1480             if (!consume(&#39;e&#39;))</span>
<span class="line-added">1481                 goto parseIdentifier;</span>
<span class="line-added">1482             if (nextIsIdentifier())</span>
<span class="line-added">1483                 goto parseIdentifier;</span>
<span class="line-added">1484             return token(Token::Type::Attribute);</span>
<span class="line-added">1485         case &#39;u&#39;:</span>
<span class="line-added">1486             shift();</span>
<span class="line-added">1487             if (!consume(&#39;t&#39;))</span>
<span class="line-added">1488                 goto parseIdentifier;</span>
<span class="line-added">1489             if (!consume(&#39;o&#39;))</span>
<span class="line-added">1490                 goto parseIdentifier;</span>
<span class="line-added">1491             if (nextIsIdentifier())</span>
<span class="line-added">1492                 goto parseIdentifier;</span>
<span class="line-added">1493             return token(Token::Type::Auto);</span>
<span class="line-added">1494         default:</span>
<span class="line-added">1495             goto parseIdentifier;</span>
<span class="line-added">1496         }</span>
<span class="line-added">1497 </span>
<span class="line-added">1498     case &#39;&gt;&#39;:</span>
<span class="line-added">1499         if (consume(&#39;&gt;&#39;)) {</span>
<span class="line-added">1500             if (consume(&#39;=&#39;))</span>
<span class="line-added">1501                 return token(Token::Type::RightShiftEquals);</span>
<span class="line-added">1502             return token(Token::Type::RightShift);</span>
<span class="line-added">1503         }</span>
<span class="line-added">1504         if (consume(&#39;=&#39;))</span>
<span class="line-added">1505             return token(Token::Type::GreaterThanOrEqualTo);</span>
<span class="line-added">1506         return token(Token::Type::GreaterThanSign);</span>
<span class="line-added">1507     case &#39;&lt;&#39;:</span>
<span class="line-added">1508         if (consume(&#39;&lt;&#39;)) {</span>
<span class="line-added">1509             if (consume(&#39;=&#39;))</span>
<span class="line-added">1510                 return token(Token::Type::LeftShiftEquals);</span>
<span class="line-added">1511             return token(Token::Type::LeftShift);</span>
<span class="line-added">1512         }</span>
<span class="line-added">1513         if (consume(&#39;=&#39;))</span>
<span class="line-added">1514             return token(Token::Type::LessThanOrEqualTo);</span>
<span class="line-added">1515         return token(Token::Type::LessThanSign);</span>
<span class="line-added">1516 </span>
<span class="line-added">1517     case &#39;+&#39;:</span>
<span class="line-added">1518         if (consume(&#39;=&#39;))</span>
<span class="line-added">1519             return token(Token::Type::PlusEquals);</span>
<span class="line-added">1520         if (consume(&#39;+&#39;))</span>
<span class="line-added">1521             return token(Token::Type::PlusPlus);</span>
<span class="line-added">1522         return token(Token::Type::Plus);</span>
<span class="line-added">1523 </span>
<span class="line-added">1524     case &#39;-&#39;:</span>
<span class="line-added">1525         if (consume(&#39;=&#39;))</span>
<span class="line-added">1526             return token(Token::Type::MinusEquals);</span>
<span class="line-added">1527         if (consume(&#39;-&#39;))</span>
<span class="line-added">1528             return token(Token::Type::MinusMinus);</span>
<span class="line-added">1529         if (consume(&#39;&gt;&#39;))</span>
<span class="line-added">1530             return token(Token::Type::Arrow);</span>
<span class="line-added">1531         if (isDigit(peek())) {</span>
<span class="line-added">1532             shift();</span>
<span class="line-added">1533             goto parseNumber;</span>
<span class="line-added">1534         }</span>
<span class="line-added">1535         if (consume(&#39;.&#39;))</span>
<span class="line-added">1536             goto parseFloatAfterDot;</span>
<span class="line-added">1537         return token(Token::Type::Minus);</span>
<span class="line-added">1538 </span>
<span class="line-added">1539     case &#39;*&#39;:</span>
<span class="line-added">1540         if (consume(&#39;=&#39;))</span>
<span class="line-added">1541             return token(Token::Type::TimesEquals);</span>
<span class="line-added">1542         return token(Token::Type::Star);</span>
<span class="line-added">1543 </span>
<span class="line-added">1544     case &#39;/&#39;:</span>
<span class="line-added">1545         if (consume(&#39;=&#39;))</span>
<span class="line-added">1546             return token(Token::Type::DivideEquals);</span>
<span class="line-added">1547         return token(Token::Type::Divide);</span>
<span class="line-added">1548 </span>
<span class="line-added">1549     case &#39;%&#39;:</span>
<span class="line-added">1550         if (consume(&#39;=&#39;))</span>
<span class="line-added">1551             return token(Token::Type::ModEquals);</span>
<span class="line-added">1552         return token(Token::Type::Mod);</span>
<span class="line-added">1553 </span>
<span class="line-added">1554     case &#39;^&#39;:</span>
<span class="line-added">1555         if (consume(&#39;=&#39;))</span>
<span class="line-added">1556             return token(Token::Type::XorEquals);</span>
<span class="line-added">1557         return token(Token::Type::Xor);</span>
<span class="line-added">1558 </span>
<span class="line-added">1559     case &#39;&amp;&#39;:</span>
<span class="line-added">1560         if (consume(&#39;=&#39;))</span>
<span class="line-added">1561             return token(Token::Type::AndEquals);</span>
<span class="line-added">1562         if (consume(&#39;&amp;&#39;))</span>
<span class="line-added">1563             return token(Token::Type::AndAnd);</span>
<span class="line-added">1564         return token(Token::Type::And);</span>
<span class="line-added">1565 </span>
<span class="line-added">1566     case &#39;|&#39;:</span>
<span class="line-added">1567         if (consume(&#39;=&#39;))</span>
<span class="line-added">1568             return token(Token::Type::OrEquals);</span>
<span class="line-added">1569         if (consume(&#39;|&#39;))</span>
<span class="line-added">1570             return token(Token::Type::OrOr);</span>
<span class="line-added">1571         return token(Token::Type::Or);</span>
<span class="line-added">1572 </span>
<span class="line-added">1573     case &#39;[&#39;:</span>
<span class="line-added">1574         if (consume(&#39;]&#39;))</span>
<span class="line-added">1575             return token(Token::Type::SquareBracketPair);</span>
<span class="line-added">1576         return token(Token::Type::LeftSquareBracket);</span>
<span class="line-added">1577 </span>
<span class="line-added">1578     case &#39;=&#39;:</span>
<span class="line-added">1579         if (consume(&#39;=&#39;))</span>
<span class="line-added">1580             return token(Token::Type::EqualComparison);</span>
<span class="line-added">1581         return token(Token::Type::EqualsSign);</span>
<span class="line-added">1582 </span>
<span class="line-added">1583     case &#39;!&#39;:</span>
<span class="line-added">1584         if (consume(&#39;=&#39;))</span>
<span class="line-added">1585             return token(Token::Type::NotEqual);</span>
<span class="line-added">1586         return token(Token::Type::ExclamationPoint);</span>
<span class="line-added">1587 </span>
<span class="line-added">1588     case &#39;;&#39;:</span>
<span class="line-added">1589         return token(Token::Type::Semicolon);</span>
<span class="line-added">1590 </span>
<span class="line-added">1591     case &#39;{&#39;:</span>
<span class="line-added">1592         return token(Token::Type::LeftCurlyBracket);</span>
<span class="line-added">1593 </span>
<span class="line-added">1594     case &#39;}&#39;:</span>
<span class="line-added">1595         return token(Token::Type::RightCurlyBracket);</span>
<span class="line-added">1596 </span>
<span class="line-added">1597     case &#39;:&#39;:</span>
<span class="line-added">1598         return token(Token::Type::Colon);</span>
<span class="line-added">1599 </span>
<span class="line-added">1600     case &#39;,&#39;:</span>
<span class="line-added">1601         return token(Token::Type::Comma);</span>
<span class="line-added">1602 </span>
<span class="line-added">1603     case &#39;(&#39;:</span>
<span class="line-added">1604         return token(Token::Type::LeftParenthesis);</span>
<span class="line-added">1605 </span>
<span class="line-added">1606     case &#39;)&#39;:</span>
<span class="line-added">1607         return token(Token::Type::RightParenthesis);</span>
<span class="line-added">1608 </span>
<span class="line-added">1609     case &#39;]&#39;:</span>
<span class="line-added">1610         return token(Token::Type::RightSquareBracket);</span>
<span class="line-added">1611 </span>
<span class="line-added">1612     case &#39;.&#39;:</span>
<span class="line-added">1613         if (isDigit(peek()))</span>
<span class="line-added">1614             goto parseFloatAfterDot;</span>
<span class="line-added">1615         return token(Token::Type::FullStop);</span>
<span class="line-added">1616 </span>
<span class="line-added">1617     case &#39;?&#39;:</span>
<span class="line-added">1618         return token(Token::Type::QuestionMark);</span>
<span class="line-added">1619 </span>
<span class="line-added">1620     case &#39;~&#39;:</span>
<span class="line-added">1621         return token(Token::Type::Tilde);</span>
<span class="line-added">1622 </span>
<span class="line-added">1623     case &#39;@&#39;:</span>
<span class="line-added">1624         return token(Token::Type::At);</span>
<span class="line-added">1625 </span>
<span class="line-added">1626     case &#39;0&#39;:</span>
<span class="line-added">1627     case &#39;1&#39;:</span>
<span class="line-added">1628     case &#39;2&#39;:</span>
<span class="line-added">1629     case &#39;3&#39;:</span>
<span class="line-added">1630     case &#39;4&#39;:</span>
<span class="line-added">1631     case &#39;5&#39;:</span>
<span class="line-added">1632     case &#39;6&#39;:</span>
<span class="line-added">1633     case &#39;7&#39;:</span>
<span class="line-added">1634     case &#39;8&#39;:</span>
<span class="line-added">1635     case &#39;9&#39;: {</span>
<span class="line-added">1636 parseNumber:</span>
<span class="line-added">1637         if (current == &#39;0&#39; &amp;&amp; consume(&#39;x&#39;)) {</span>
<span class="line-added">1638             while (isHexadecimalCharacter(peek()))</span>
<span class="line-added">1639                 shift();</span>
<span class="line-added">1640             if (consume(&#39;u&#39;))</span>
<span class="line-added">1641                 return token(Token::Type::UintLiteral);</span>
<span class="line-added">1642             return token(Token::Type::IntLiteral);</span>
<span class="line-added">1643         }</span>
<span class="line-added">1644 </span>
<span class="line-added">1645         while (isDigit(peek()))</span>
<span class="line-added">1646             shift();</span>
<span class="line-added">1647 </span>
<span class="line-added">1648         if (consume(&#39;.&#39;)) {</span>
<span class="line-added">1649 parseFloatAfterDot:</span>
<span class="line-added">1650             while (isDigit(peek()))</span>
<span class="line-added">1651                 shift();</span>
<span class="line-added">1652             consume(&#39;f&#39;);</span>
<span class="line-added">1653             return token(Token::Type::FloatLiteral);</span>
<span class="line-added">1654         }</span>
<span class="line-added">1655 </span>
<span class="line-added">1656         if (consume(&#39;f&#39;))</span>
<span class="line-added">1657             return token(Token::Type::FloatLiteral);</span>
<span class="line-added">1658 </span>
<span class="line-added">1659         if (consume(&#39;u&#39;))</span>
<span class="line-added">1660             return token(Token::Type::UintLiteral);</span>
<span class="line-added">1661 </span>
<span class="line-added">1662         return token(Token::Type::IntLiteral);</span>
1663     }
<a name="36" id="anc36"></a>
1664 
<a name="37" id="anc37"></a><span class="line-modified">1665     default:</span>
<span class="line-modified">1666         break;</span>
<span class="line-modified">1667     }</span>
<span class="line-modified">1668 </span>
<span class="line-modified">1669     if (m_offset == m_stringView.length())</span>
<span class="line-added">1670         return token(Token::Type::EndOfFile);</span>
<span class="line-added">1671     return token(Token::Type::Invalid);</span>
1672 }
1673 
<a name="38" id="anc38"></a><span class="line-modified">1674 </span>
<span class="line-added">1675 // We can take advantage of two properties of Unicode:</span>
<span class="line-added">1676 // 1. The consitutent UTF-16 code units for all non-BMP code points are surrogates,</span>
<span class="line-added">1677 // which means we&#39;ll never see a false match. If we see a BMP code unit, we</span>
<span class="line-added">1678 // really have a BMP code point.</span>
<span class="line-added">1679 // 2. Everything we&#39;re looking for is in BMP</span>
<span class="line-added">1680 </span>
<span class="line-added">1681 static inline bool isWhitespace(UChar codeUnit)</span>
1682 {
<a name="39" id="anc39"></a><span class="line-modified">1683     switch (codeUnit) {</span>
<span class="line-modified">1684     case &#39; &#39;:</span>
<span class="line-modified">1685     case &#39;\t&#39;:</span>
<span class="line-modified">1686     case &#39;\r&#39;:</span>
<span class="line-modified">1687     case &#39;\n&#39;:</span>
<span class="line-modified">1688         return true;</span>
<span class="line-modified">1689     default:</span>
<span class="line-modified">1690         return false;</span>
<span class="line-added">1691     }</span>
1692 }
1693 
<a name="40" id="anc40"></a><span class="line-modified">1694 static inline bool isNewline(UChar codeUnit)</span>
1695 {
<a name="41" id="anc41"></a><span class="line-modified">1696     switch (codeUnit) {</span>
<span class="line-modified">1697     case &#39;\r&#39;:</span>
<span class="line-modified">1698     case &#39;\n&#39;:</span>
<span class="line-modified">1699         return true;</span>
<span class="line-modified">1700     default:</span>
<span class="line-modified">1701         return false;</span>
<span class="line-modified">1702     }</span>



1703 }
1704 
<a name="42" id="anc42"></a><span class="line-modified">1705 auto Lexer::lineAndColumnNumberFromOffset(const StringView&amp; stringView, unsigned targetOffset) -&gt; LineAndColumn</span>
1706 {
<a name="43" id="anc43"></a><span class="line-modified">1707     // Counting from 1 to match most text editors.</span>
<span class="line-modified">1708     unsigned lineNumber = 1;</span>
<span class="line-modified">1709     unsigned columnNumber = 1;</span>
<span class="line-modified">1710     for (unsigned offset = 0; offset &lt; std::min(stringView.length(), targetOffset); ++offset) {</span>
<span class="line-modified">1711         ++columnNumber;</span>
<span class="line-modified">1712         if (isNewline(stringView[offset])) {</span>
<span class="line-modified">1713             ++lineNumber;</span>
<span class="line-modified">1714             columnNumber = 1;</span>
<span class="line-modified">1715         }</span>
<span class="line-added">1716     }</span>
<span class="line-added">1717     return { lineNumber, columnNumber };</span>
1718 }
1719 
<a name="44" id="anc44"></a><span class="line-modified">1720 static Optional&lt;StringView&gt; sourceFromNameSpace(AST::NameSpace nameSpace, const String&amp; source1, const String* source2)</span>
1721 {
<a name="45" id="anc45"></a><span class="line-modified">1722     switch (nameSpace) {</span>
<span class="line-modified">1723     case AST::NameSpace::StandardLibrary:</span>


1724         return WTF::nullopt;
<a name="46" id="anc46"></a><span class="line-modified">1725     case AST::NameSpace::NameSpace1:</span>
<span class="line-modified">1726         return StringView(source1);</span>
<span class="line-modified">1727     case AST::NameSpace::NameSpace2:</span>
<span class="line-modified">1728         ASSERT(source2);</span>
<span class="line-modified">1729         return StringView(*source2);</span>




1730     }
1731 }
1732 
<a name="47" id="anc47"></a><span class="line-modified">1733 String Lexer::errorString(Error error, const String&amp; source1, const String* source2)</span>
1734 {
<a name="48" id="anc48"></a><span class="line-modified">1735     if (auto codeLocation = error.codeLocation()) {</span>
<span class="line-added">1736         if (auto source = sourceFromNameSpace(codeLocation.nameSpace(), source1, source2)) {</span>
<span class="line-added">1737             auto lineAndColumn = lineAndColumnNumberFromOffset(*source, error.codeLocation().startOffset());</span>
<span class="line-added">1738             return makeString(lineAndColumn.line, &#39;:&#39;, lineAndColumn.column, &quot;: &quot;, error.message());</span>
<span class="line-added">1739         }</span>
<span class="line-added">1740     }</span>
<span class="line-added">1741     return error.message();</span>
1742 }
1743 
<a name="49" id="anc49"></a><span class="line-modified">1744 void Lexer::skipWhitespaceAndComments()</span>
1745 {
<a name="50" id="anc50"></a><span class="line-modified">1746     while (m_offset &lt; m_stringView.length()) {</span>
<span class="line-modified">1747         if (isWhitespace(m_stringView[m_offset]))</span>
<span class="line-modified">1748             ++m_offset;</span>
<span class="line-modified">1749         else if (m_stringView[m_offset] == &#39;/&#39; &amp;&amp; m_offset + 1 &lt; m_stringView.length()) {</span>
<span class="line-modified">1750             if (m_stringView[m_offset + 1] == &#39;/&#39;) {</span>
<span class="line-modified">1751                 // Line comment</span>
<span class="line-modified">1752                 m_offset += 2;</span>
<span class="line-modified">1753                 // Note that in the case of \r\n this makes the comment end on the \r. It is fine, as the \n after that is simple whitespace.</span>
<span class="line-modified">1754                 for ( ; m_offset &lt; m_stringView.length() &amp;&amp; !isNewline(m_stringView[m_offset]); ++m_offset) { }</span>
<span class="line-modified">1755             } else if (m_stringView[m_offset + 1] == &#39;*&#39;) {</span>
<span class="line-modified">1756                 // Long comment</span>
<span class="line-modified">1757                 for ( ; m_offset &lt; m_stringView.length() ; ++m_offset) {</span>
<span class="line-modified">1758                     if (m_stringView[m_offset] == &#39;*&#39; &amp;&amp; m_offset + 1 &lt; m_stringView.length() &amp;&amp; m_stringView[m_offset + 1] == &#39;/&#39;) {</span>
<span class="line-modified">1759                         m_offset += 2;</span>
<span class="line-modified">1760                         break;</span>
<span class="line-modified">1761                     }</span>
<span class="line-modified">1762                 }</span>
<span class="line-modified">1763             } else</span>
<span class="line-modified">1764                 break;</span>
<span class="line-modified">1765         } else</span>
<span class="line-modified">1766             break;</span>






































1767     }
<a name="51" id="anc51"></a>
1768 }
1769 
1770 } // namespace WHLSL
1771 
1772 } // namespace WebCore
1773 
1774 #endif // ENABLE(WEBGPU)
<a name="52" id="anc52"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="52" type="hidden" />
</body>
</html>
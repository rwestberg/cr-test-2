<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/platform/PlatformKeyboardEvent.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="PasteboardWriterData.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="PlatformMouseEvent.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/platform/PlatformKeyboardEvent.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 40 OBJC_CLASS WebEvent;
 41 #endif
 42 
 43 #if PLATFORM(GTK)
 44 typedef struct _GdkEventKey GdkEventKey;
 45 #include &quot;CompositionResults.h&quot;
 46 #endif
 47 
 48 #if PLATFORM(JAVA)
 49 #include &lt;jni.h&gt;
 50 #endif
 51 
 52 namespace WebCore {
 53 
 54     class PlatformKeyboardEvent : public PlatformEvent {
 55         WTF_MAKE_FAST_ALLOCATED;
 56     public:
 57         PlatformKeyboardEvent()
 58             : PlatformEvent(PlatformEvent::KeyDown)
 59             , m_windowsVirtualKeyCode(0)
<span class="line-removed"> 60 #if USE(APPKIT) || PLATFORM(GTK)</span>
<span class="line-removed"> 61             , m_handledByInputMethod(false)</span>
<span class="line-removed"> 62 #endif</span>
 63             , m_autoRepeat(false)
 64             , m_isKeypad(false)
 65             , m_isSystemKey(false)
 66 #if PLATFORM(GTK)
 67             , m_gdkEventKey(0)
 68 #endif
 69         {
 70         }
 71 
 72         PlatformKeyboardEvent(Type type, const String&amp; text, const String&amp; unmodifiedText,
 73 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
 74         const String&amp; key,
 75 #endif
 76 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
 77         const String&amp; code,
 78 #endif
 79         const String&amp; keyIdentifier, int windowsVirtualKeyCode, bool isAutoRepeat, bool isKeypad, bool isSystemKey, OptionSet&lt;Modifier&gt; modifiers, WallTime timestamp)
 80             : PlatformEvent(type, modifiers, timestamp)
 81             , m_text(text)
 82             , m_unmodifiedText(unmodifiedText)
 83 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
 84             , m_key(key)
 85 #endif
 86 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
 87             , m_code(code)
 88 #endif
 89             , m_keyIdentifier(keyIdentifier)
 90             , m_windowsVirtualKeyCode(windowsVirtualKeyCode)
<span class="line-removed"> 91 #if USE(APPKIT) || PLATFORM(GTK)</span>
<span class="line-removed"> 92             , m_handledByInputMethod(false)</span>
<span class="line-removed"> 93 #endif</span>
 94             , m_autoRepeat(isAutoRepeat)
 95             , m_isKeypad(isKeypad)
 96             , m_isSystemKey(isSystemKey)
 97         {
 98         }
 99 
100         WEBCORE_EXPORT void disambiguateKeyDownEvent(Type, bool backwardCompatibilityMode = false); // Only used on platforms that need it, i.e. those that generate KeyDown events.
101 
102         // Text as as generated by processing a virtual key code with a keyboard layout
103         // (in most cases, just a character code, but the layout can emit several
104         // characters in a single keypress event on some platforms).
105         // This may bear no resemblance to the ultimately inserted text if an input method
106         // processes the input.
107         // Will be null for KeyUp and RawKeyDown events.
108         String text() const { return m_text; }
109 
110         // Text that would have been generated by the keyboard if no modifiers were pressed
111         // (except for Shift); useful for shortcut (accelerator) key handling.
112         // Otherwise, same as text().
113         String unmodifiedText() const { return m_unmodifiedText; }
114 
115         String keyIdentifier() const { return m_keyIdentifier; }
116 
117 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
118         const String&amp; key() const { return m_key; }
119 #endif
120 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
121         const String&amp; code() const { return m_code; }
122 #endif
123 
124         // Most compatible Windows virtual key code associated with the event.
125         // Zero for Char events.
126         int windowsVirtualKeyCode() const { return m_windowsVirtualKeyCode; }
127         void setWindowsVirtualKeyCode(int code) { m_windowsVirtualKeyCode = code; }
128 
<span class="line-modified">129 #if USE(APPKIT) || PLATFORM(GTK)</span>
130         bool handledByInputMethod() const { return m_handledByInputMethod; }
131 #endif
132 #if USE(APPKIT)
133         const Vector&lt;KeypressCommand&gt;&amp; commands() const { return m_commands; }
134 #elif PLATFORM(GTK)
135         const Vector&lt;String&gt;&amp; commands() const { return m_commands; }
136 #endif
137 
138         bool isAutoRepeat() const { return m_autoRepeat; }
139         bool isKeypad() const { return m_isKeypad; }
140         bool isSystemKey() const { return m_isSystemKey; }
141 



142         WEBCORE_EXPORT static bool currentCapsLockState();
143         WEBCORE_EXPORT static void getCurrentModifierState(bool&amp; shiftKey, bool&amp; ctrlKey, bool&amp; altKey, bool&amp; metaKey);
144         WEBCORE_EXPORT static void setCurrentModifierState(OptionSet&lt;Modifier&gt;);
145         WEBCORE_EXPORT static OptionSet&lt;Modifier&gt; currentStateOfModifierKeys();
146 
147 #if PLATFORM(COCOA)
148 #if !PLATFORM(IOS_FAMILY)
149         NSEvent* macEvent() const { return m_macEvent.get(); }
150 #else
151         ::WebEvent *event() const { return m_Event.get(); }
152 #endif
153 #endif
154 
155 #if PLATFORM(WIN)
156         PlatformKeyboardEvent(HWND, WPARAM, LPARAM, Type, bool);
157 #endif
158 
159 #if PLATFORM(GTK)
160         PlatformKeyboardEvent(GdkEventKey*, const CompositionResults&amp;);
161         GdkEventKey* gdkEventKey() const { return m_gdkEventKey; }
</pre>
<hr />
<pre>
178 
179 #if USE(LIBWPE)
180         static String keyValueForWPEKeyCode(unsigned);
181         static String keyCodeForHardwareKeyCode(unsigned);
182         static String keyIdentifierForWPEKeyCode(unsigned);
183         static int windowsKeyCodeForWPEKeyCode(unsigned);
184         static String singleCharacterString(unsigned);
185 #endif
186 
187     protected:
188         String m_text;
189         String m_unmodifiedText;
190 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
191         String m_key;
192 #endif
193 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
194         String m_code;
195 #endif
196         String m_keyIdentifier;
197         int m_windowsVirtualKeyCode;
<span class="line-modified">198 #if USE(APPKIT) || PLATFORM(GTK)</span>
<span class="line-modified">199         bool m_handledByInputMethod;</span>
200 #endif
201 #if USE(APPKIT)
202         Vector&lt;KeypressCommand&gt; m_commands;
203 #elif PLATFORM(GTK)
204         Vector&lt;String&gt; m_commands;
205 #endif
206         bool m_autoRepeat;
207         bool m_isKeypad;
208         bool m_isSystemKey;
209 


210 #if PLATFORM(COCOA)
211 #if !PLATFORM(IOS_FAMILY)
212         RetainPtr&lt;NSEvent&gt; m_macEvent;
213 #else
214         RetainPtr&lt;::WebEvent&gt; m_Event;
215 #endif
216 #endif
217 #if PLATFORM(GTK)
218         GdkEventKey* m_gdkEventKey;
219         CompositionResults m_compositionResults;
220 #endif
221 
222         // The modifier state is optional, since it is not needed in the UI process or in legacy WebKit.
223         static Optional&lt;OptionSet&lt;Modifier&gt;&gt; s_currentModifiers;
224     };
225 
226 } // namespace WebCore
</pre>
</td>
<td>
<hr />
<pre>
 40 OBJC_CLASS WebEvent;
 41 #endif
 42 
 43 #if PLATFORM(GTK)
 44 typedef struct _GdkEventKey GdkEventKey;
 45 #include &quot;CompositionResults.h&quot;
 46 #endif
 47 
 48 #if PLATFORM(JAVA)
 49 #include &lt;jni.h&gt;
 50 #endif
 51 
 52 namespace WebCore {
 53 
 54     class PlatformKeyboardEvent : public PlatformEvent {
 55         WTF_MAKE_FAST_ALLOCATED;
 56     public:
 57         PlatformKeyboardEvent()
 58             : PlatformEvent(PlatformEvent::KeyDown)
 59             , m_windowsVirtualKeyCode(0)



 60             , m_autoRepeat(false)
 61             , m_isKeypad(false)
 62             , m_isSystemKey(false)
 63 #if PLATFORM(GTK)
 64             , m_gdkEventKey(0)
 65 #endif
 66         {
 67         }
 68 
 69         PlatformKeyboardEvent(Type type, const String&amp; text, const String&amp; unmodifiedText,
 70 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
 71         const String&amp; key,
 72 #endif
 73 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
 74         const String&amp; code,
 75 #endif
 76         const String&amp; keyIdentifier, int windowsVirtualKeyCode, bool isAutoRepeat, bool isKeypad, bool isSystemKey, OptionSet&lt;Modifier&gt; modifiers, WallTime timestamp)
 77             : PlatformEvent(type, modifiers, timestamp)
 78             , m_text(text)
 79             , m_unmodifiedText(unmodifiedText)
 80 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
 81             , m_key(key)
 82 #endif
 83 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
 84             , m_code(code)
 85 #endif
 86             , m_keyIdentifier(keyIdentifier)
 87             , m_windowsVirtualKeyCode(windowsVirtualKeyCode)



 88             , m_autoRepeat(isAutoRepeat)
 89             , m_isKeypad(isKeypad)
 90             , m_isSystemKey(isSystemKey)
 91         {
 92         }
 93 
 94         WEBCORE_EXPORT void disambiguateKeyDownEvent(Type, bool backwardCompatibilityMode = false); // Only used on platforms that need it, i.e. those that generate KeyDown events.
 95 
 96         // Text as as generated by processing a virtual key code with a keyboard layout
 97         // (in most cases, just a character code, but the layout can emit several
 98         // characters in a single keypress event on some platforms).
 99         // This may bear no resemblance to the ultimately inserted text if an input method
100         // processes the input.
101         // Will be null for KeyUp and RawKeyDown events.
102         String text() const { return m_text; }
103 
104         // Text that would have been generated by the keyboard if no modifiers were pressed
105         // (except for Shift); useful for shortcut (accelerator) key handling.
106         // Otherwise, same as text().
107         String unmodifiedText() const { return m_unmodifiedText; }
108 
109         String keyIdentifier() const { return m_keyIdentifier; }
110 
111 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
112         const String&amp; key() const { return m_key; }
113 #endif
114 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
115         const String&amp; code() const { return m_code; }
116 #endif
117 
118         // Most compatible Windows virtual key code associated with the event.
119         // Zero for Char events.
120         int windowsVirtualKeyCode() const { return m_windowsVirtualKeyCode; }
121         void setWindowsVirtualKeyCode(int code) { m_windowsVirtualKeyCode = code; }
122 
<span class="line-modified">123 #if USE(APPKIT) || USE(UIKIT_KEYBOARD_ADDITIONS) || PLATFORM(GTK)</span>
124         bool handledByInputMethod() const { return m_handledByInputMethod; }
125 #endif
126 #if USE(APPKIT)
127         const Vector&lt;KeypressCommand&gt;&amp; commands() const { return m_commands; }
128 #elif PLATFORM(GTK)
129         const Vector&lt;String&gt;&amp; commands() const { return m_commands; }
130 #endif
131 
132         bool isAutoRepeat() const { return m_autoRepeat; }
133         bool isKeypad() const { return m_isKeypad; }
134         bool isSystemKey() const { return m_isSystemKey; }
135 
<span class="line-added">136         bool isSyntheticEvent() const { return m_isSyntheticEvent; }</span>
<span class="line-added">137         void setIsSyntheticEvent() { m_isSyntheticEvent = true; }</span>
<span class="line-added">138 </span>
139         WEBCORE_EXPORT static bool currentCapsLockState();
140         WEBCORE_EXPORT static void getCurrentModifierState(bool&amp; shiftKey, bool&amp; ctrlKey, bool&amp; altKey, bool&amp; metaKey);
141         WEBCORE_EXPORT static void setCurrentModifierState(OptionSet&lt;Modifier&gt;);
142         WEBCORE_EXPORT static OptionSet&lt;Modifier&gt; currentStateOfModifierKeys();
143 
144 #if PLATFORM(COCOA)
145 #if !PLATFORM(IOS_FAMILY)
146         NSEvent* macEvent() const { return m_macEvent.get(); }
147 #else
148         ::WebEvent *event() const { return m_Event.get(); }
149 #endif
150 #endif
151 
152 #if PLATFORM(WIN)
153         PlatformKeyboardEvent(HWND, WPARAM, LPARAM, Type, bool);
154 #endif
155 
156 #if PLATFORM(GTK)
157         PlatformKeyboardEvent(GdkEventKey*, const CompositionResults&amp;);
158         GdkEventKey* gdkEventKey() const { return m_gdkEventKey; }
</pre>
<hr />
<pre>
175 
176 #if USE(LIBWPE)
177         static String keyValueForWPEKeyCode(unsigned);
178         static String keyCodeForHardwareKeyCode(unsigned);
179         static String keyIdentifierForWPEKeyCode(unsigned);
180         static int windowsKeyCodeForWPEKeyCode(unsigned);
181         static String singleCharacterString(unsigned);
182 #endif
183 
184     protected:
185         String m_text;
186         String m_unmodifiedText;
187 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
188         String m_key;
189 #endif
190 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
191         String m_code;
192 #endif
193         String m_keyIdentifier;
194         int m_windowsVirtualKeyCode;
<span class="line-modified">195 #if USE(APPKIT) || USE(UIKIT_KEYBOARD_ADDITIONS) || PLATFORM(GTK)</span>
<span class="line-modified">196         bool m_handledByInputMethod { false };</span>
197 #endif
198 #if USE(APPKIT)
199         Vector&lt;KeypressCommand&gt; m_commands;
200 #elif PLATFORM(GTK)
201         Vector&lt;String&gt; m_commands;
202 #endif
203         bool m_autoRepeat;
204         bool m_isKeypad;
205         bool m_isSystemKey;
206 
<span class="line-added">207         bool m_isSyntheticEvent { false };</span>
<span class="line-added">208 </span>
209 #if PLATFORM(COCOA)
210 #if !PLATFORM(IOS_FAMILY)
211         RetainPtr&lt;NSEvent&gt; m_macEvent;
212 #else
213         RetainPtr&lt;::WebEvent&gt; m_Event;
214 #endif
215 #endif
216 #if PLATFORM(GTK)
217         GdkEventKey* m_gdkEventKey;
218         CompositionResults m_compositionResults;
219 #endif
220 
221         // The modifier state is optional, since it is not needed in the UI process or in legacy WebKit.
222         static Optional&lt;OptionSet&lt;Modifier&gt;&gt; s_currentModifiers;
223     };
224 
225 } // namespace WebCore
</pre>
</td>
</tr>
</table>
<center><a href="PasteboardWriterData.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="PlatformMouseEvent.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>
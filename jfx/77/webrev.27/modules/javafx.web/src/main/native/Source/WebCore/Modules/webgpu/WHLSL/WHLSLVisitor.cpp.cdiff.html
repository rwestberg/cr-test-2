<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/WebCore/Modules/webgpu/WHLSL/WHLSLVisitor.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="WHLSLSynthesizeStructureAccessors.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="WHLSLVisitor.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/Modules/webgpu/WHLSL/WHLSLVisitor.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 26,77 ***</span>
  #include &quot;config.h&quot;
  #include &quot;WHLSLVisitor.h&quot;
  
  #if ENABLE(WEBGPU)
  
<span class="line-modified">! #include &quot;WHLSLArrayReferenceType.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLArrayType.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLAssignmentExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLBaseFunctionAttribute.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLBaseSemantic.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLBlock.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLBooleanLiteral.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLBreak.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLBuiltInSemantic.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLCallExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLCommaExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLConstantExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLContinue.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLDereferenceExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLDoWhileLoop.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLDotExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLEffectfulExpressionStatement.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLEnumerationDefinition.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLEnumerationMember.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLEnumerationMemberLiteral.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLFallthrough.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLFloatLiteral.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLForLoop.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLFunctionAttribute.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLFunctionDeclaration.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLFunctionDefinition.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLIfStatement.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLIndexExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLIntegerLiteral.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLLogicalExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLLogicalNotExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLMakeArrayReferenceExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLMakePointerExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLNativeFunctionDeclaration.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLNativeTypeDeclaration.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLNode.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLNullLiteral.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLNumThreadsFunctionAttribute.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLPointerType.h&quot;</span>
  #include &quot;WHLSLProgram.h&quot;
<span class="line-removed">- #include &quot;WHLSLPropertyAccessExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLQualifier.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLReadModifyWriteExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLReferenceType.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLResourceSemantic.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLReturn.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLSemantic.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLSpecializationConstantSemantic.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLStageInOutSemantic.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLStatement.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLStructureDefinition.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLStructureElement.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLSwitchCase.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLSwitchStatement.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLTernaryExpression.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLTrap.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLType.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLTypeArgument.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLTypeDefinition.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLTypeReference.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLUnsignedIntegerLiteral.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLValue.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLVariableDeclaration.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLVariableDeclarationsStatement.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLVariableReference.h&quot;</span>
<span class="line-removed">- #include &quot;WHLSLWhileLoop.h&quot;</span>
  
  namespace WebCore {
  
  namespace WHLSL {
  
<span class="line-new-header">--- 26,12 ---</span>
  #include &quot;config.h&quot;
  #include &quot;WHLSLVisitor.h&quot;
  
  #if ENABLE(WEBGPU)
  
<span class="line-modified">! #include &quot;WHLSLAST.h&quot;</span>
  #include &quot;WHLSLProgram.h&quot;
  
  namespace WebCore {
  
  namespace WHLSL {
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 123,28 ***</span>
          checkErrorAndVisit(downcast&lt;AST::TypeReference&gt;(unnamedType));
      else if (is&lt;AST::PointerType&gt;(unnamedType))
          checkErrorAndVisit(downcast&lt;AST::PointerType&gt;(unnamedType));
      else if (is&lt;AST::ArrayReferenceType&gt;(unnamedType))
          checkErrorAndVisit(downcast&lt;AST::ArrayReferenceType&gt;(unnamedType));
<span class="line-modified">!     else {</span>
<span class="line-removed">-         ASSERT(is&lt;AST::ArrayType&gt;(unnamedType));</span>
          checkErrorAndVisit(downcast&lt;AST::ArrayType&gt;(unnamedType));
<span class="line-removed">-     }</span>
  }
  
  void Visitor::visit(AST::NamedType&amp; namedType)
  {
      if (is&lt;AST::TypeDefinition&gt;(namedType))
          checkErrorAndVisit(downcast&lt;AST::TypeDefinition&gt;(namedType));
      else if (is&lt;AST::StructureDefinition&gt;(namedType))
          checkErrorAndVisit(downcast&lt;AST::StructureDefinition&gt;(namedType));
      else if (is&lt;AST::EnumerationDefinition&gt;(namedType))
          checkErrorAndVisit(downcast&lt;AST::EnumerationDefinition&gt;(namedType));
<span class="line-modified">!     else {</span>
<span class="line-removed">-         ASSERT(is&lt;AST::NativeTypeDeclaration&gt;(namedType));</span>
          checkErrorAndVisit(downcast&lt;AST::NativeTypeDeclaration&gt;(namedType));
<span class="line-removed">-     }</span>
  }
  
  void Visitor::visit(AST::TypeDefinition&amp; typeDefinition)
  {
      checkErrorAndVisit(typeDefinition.type());
<span class="line-new-header">--- 58,24 ---</span>
          checkErrorAndVisit(downcast&lt;AST::TypeReference&gt;(unnamedType));
      else if (is&lt;AST::PointerType&gt;(unnamedType))
          checkErrorAndVisit(downcast&lt;AST::PointerType&gt;(unnamedType));
      else if (is&lt;AST::ArrayReferenceType&gt;(unnamedType))
          checkErrorAndVisit(downcast&lt;AST::ArrayReferenceType&gt;(unnamedType));
<span class="line-modified">!     else</span>
          checkErrorAndVisit(downcast&lt;AST::ArrayType&gt;(unnamedType));
  }
  
  void Visitor::visit(AST::NamedType&amp; namedType)
  {
      if (is&lt;AST::TypeDefinition&gt;(namedType))
          checkErrorAndVisit(downcast&lt;AST::TypeDefinition&gt;(namedType));
      else if (is&lt;AST::StructureDefinition&gt;(namedType))
          checkErrorAndVisit(downcast&lt;AST::StructureDefinition&gt;(namedType));
      else if (is&lt;AST::EnumerationDefinition&gt;(namedType))
          checkErrorAndVisit(downcast&lt;AST::EnumerationDefinition&gt;(namedType));
<span class="line-modified">!     else</span>
          checkErrorAndVisit(downcast&lt;AST::NativeTypeDeclaration&gt;(namedType));
  }
  
  void Visitor::visit(AST::TypeDefinition&amp; typeDefinition)
  {
      checkErrorAndVisit(typeDefinition.type());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 182,12 ***</span>
  
  void Visitor::visit(AST::TypeReference&amp; typeReference)
  {
      for (auto&amp; typeArgument : typeReference.typeArguments())
          checkErrorAndVisit(typeArgument);
<span class="line-modified">!     if (typeReference.resolvedType() &amp;&amp; is&lt;AST::TypeDefinition&gt;(*typeReference.resolvedType())) {</span>
<span class="line-modified">!         auto&amp; typeDefinition = downcast&lt;AST::TypeDefinition&gt;(*typeReference.resolvedType());</span>
          checkErrorAndVisit(typeDefinition.type());
      }
  }
  
  void Visitor::visit(AST::PointerType&amp; pointerType)
<span class="line-new-header">--- 113,12 ---</span>
  
  void Visitor::visit(AST::TypeReference&amp; typeReference)
  {
      for (auto&amp; typeArgument : typeReference.typeArguments())
          checkErrorAndVisit(typeArgument);
<span class="line-modified">!     if (typeReference.maybeResolvedType() &amp;&amp; is&lt;AST::TypeDefinition&gt;(typeReference.resolvedType())) {</span>
<span class="line-modified">!         auto&amp; typeDefinition = downcast&lt;AST::TypeDefinition&gt;(typeReference.resolvedType());</span>
          checkErrorAndVisit(typeDefinition.type());
      }
  }
  
  void Visitor::visit(AST::PointerType&amp; pointerType)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 210,14 ***</span>
      checkErrorAndVisit(structureElement.type());
      if (structureElement.semantic())
          checkErrorAndVisit(*structureElement.semantic());
  }
  
<span class="line-modified">! void Visitor::visit(AST::EnumerationMember&amp; enumerationMember)</span>
  {
<span class="line-removed">-     if (enumerationMember.value())</span>
<span class="line-removed">-         checkErrorAndVisit(*enumerationMember.value());</span>
  }
  
  void Visitor::visit(AST::FunctionDeclaration&amp; functionDeclaration)
  {
      checkErrorAndVisit(functionDeclaration.attributeBlock());
<span class="line-new-header">--- 141,12 ---</span>
      checkErrorAndVisit(structureElement.type());
      if (structureElement.semantic())
          checkErrorAndVisit(*structureElement.semantic());
  }
  
<span class="line-modified">! void Visitor::visit(AST::EnumerationMember&amp;)</span>
  {
  }
  
  void Visitor::visit(AST::FunctionDeclaration&amp; functionDeclaration)
  {
      checkErrorAndVisit(functionDeclaration.attributeBlock());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 230,11 ***</span>
  
  void Visitor::visit(AST::TypeArgument&amp; typeArgument)
  {
      WTF::visit(WTF::makeVisitor([&amp;](AST::ConstantExpression&amp; constantExpression) {
          checkErrorAndVisit(constantExpression);
<span class="line-modified">!     }, [&amp;](UniqueRef&lt;AST::TypeReference&gt;&amp; typeReference) {</span>
          checkErrorAndVisit(typeReference);
      }), typeArgument);
  }
  
  void Visitor::visit(AST::ReferenceType&amp; referenceType)
<span class="line-new-header">--- 159,11 ---</span>
  
  void Visitor::visit(AST::TypeArgument&amp; typeArgument)
  {
      WTF::visit(WTF::makeVisitor([&amp;](AST::ConstantExpression&amp; constantExpression) {
          checkErrorAndVisit(constantExpression);
<span class="line-modified">!     }, [&amp;](Ref&lt;AST::TypeReference&gt;&amp; typeReference) {</span>
          checkErrorAndVisit(typeReference);
      }), typeArgument);
  }
  
  void Visitor::visit(AST::ReferenceType&amp; referenceType)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 318,33 ***</span>
  {
  }
  
  void Visitor::visit(AST::IntegerLiteralType&amp; integerLiteralType)
  {
<span class="line-modified">!     if (integerLiteralType.resolvedType())</span>
<span class="line-modified">!         checkErrorAndVisit(*integerLiteralType.resolvedType());</span>
      checkErrorAndVisit(integerLiteralType.preferredType());
  }
  
  void Visitor::visit(AST::UnsignedIntegerLiteralType&amp; unsignedIntegerLiteralType)
  {
<span class="line-modified">!     if (unsignedIntegerLiteralType.resolvedType())</span>
<span class="line-modified">!         checkErrorAndVisit(*unsignedIntegerLiteralType.resolvedType());</span>
      checkErrorAndVisit(unsignedIntegerLiteralType.preferredType());
  }
  
  void Visitor::visit(AST::FloatLiteralType&amp; floatLiteralType)
  {
<span class="line-modified">!     if (floatLiteralType.resolvedType())</span>
<span class="line-modified">!         checkErrorAndVisit(*floatLiteralType.resolvedType());</span>
      checkErrorAndVisit(floatLiteralType.preferredType());
  }
  
  void Visitor::visit(AST::NullLiteralType&amp; nullLiteralType)
  {
<span class="line-modified">!     if (nullLiteralType.resolvedType())</span>
<span class="line-modified">!         checkErrorAndVisit(*nullLiteralType.resolvedType());</span>
  }
  
  void Visitor::visit(AST::EnumerationMemberLiteral&amp;)
  {
  }
<span class="line-new-header">--- 247,33 ---</span>
  {
  }
  
  void Visitor::visit(AST::IntegerLiteralType&amp; integerLiteralType)
  {
<span class="line-modified">!     if (integerLiteralType.maybeResolvedType())</span>
<span class="line-modified">!         checkErrorAndVisit(integerLiteralType.resolvedType());</span>
      checkErrorAndVisit(integerLiteralType.preferredType());
  }
  
  void Visitor::visit(AST::UnsignedIntegerLiteralType&amp; unsignedIntegerLiteralType)
  {
<span class="line-modified">!     if (unsignedIntegerLiteralType.maybeResolvedType())</span>
<span class="line-modified">!         checkErrorAndVisit(unsignedIntegerLiteralType.resolvedType());</span>
      checkErrorAndVisit(unsignedIntegerLiteralType.preferredType());
  }
  
  void Visitor::visit(AST::FloatLiteralType&amp; floatLiteralType)
  {
<span class="line-modified">!     if (floatLiteralType.maybeResolvedType())</span>
<span class="line-modified">!         checkErrorAndVisit(floatLiteralType.resolvedType());</span>
      checkErrorAndVisit(floatLiteralType.preferredType());
  }
  
  void Visitor::visit(AST::NullLiteralType&amp; nullLiteralType)
  {
<span class="line-modified">!     if (nullLiteralType.maybeResolvedType())</span>
<span class="line-modified">!         checkErrorAndVisit(nullLiteralType.resolvedType());</span>
  }
  
  void Visitor::visit(AST::EnumerationMemberLiteral&amp;)
  {
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 364,41 ***</span>
  {
      for (auto&amp; statement : block.statements())
          checkErrorAndVisit(statement);
  }
  
  void Visitor::visit(AST::Statement&amp; statement)
  {
<span class="line-modified">!     if (is&lt;AST::Block&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::Block&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::Break&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::Break&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::Continue&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::Continue&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::DoWhileLoop&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::DoWhileLoop&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::EffectfulExpressionStatement&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::EffectfulExpressionStatement&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::Fallthrough&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::Fallthrough&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::ForLoop&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::ForLoop&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::IfStatement&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::IfStatement&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::Return&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::Return&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::SwitchCase&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::SwitchCase&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::SwitchStatement&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::SwitchStatement&gt;(statement));
<span class="line-modified">!     else if (is&lt;AST::Trap&gt;(statement))</span>
<span class="line-modified">!         checkErrorAndVisit(downcast&lt;AST::Trap&gt;(statement));</span>
<span class="line-removed">-     else if (is&lt;AST::VariableDeclarationsStatement&gt;(statement))</span>
          checkErrorAndVisit(downcast&lt;AST::VariableDeclarationsStatement&gt;(statement));
<span class="line-modified">!     else {</span>
<span class="line-modified">!         ASSERT(is&lt;AST::WhileLoop&gt;(statement));</span>
          checkErrorAndVisit(downcast&lt;AST::WhileLoop&gt;(statement));
      }
  }
  
  void Visitor::visit(AST::Break&amp;)
  {
<span class="line-new-header">--- 293,61 ---</span>
  {
      for (auto&amp; statement : block.statements())
          checkErrorAndVisit(statement);
  }
  
<span class="line-added">+ void Visitor::visit(AST::StatementList&amp; statementList)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     for (auto&amp; statement : statementList.statements())</span>
<span class="line-added">+         checkErrorAndVisit(statement);</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  void Visitor::visit(AST::Statement&amp; statement)
  {
<span class="line-modified">!     switch (statement.kind()) {</span>
<span class="line-added">+     case AST::Statement::Kind::Block:</span>
          checkErrorAndVisit(downcast&lt;AST::Block&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Statement::Kind::Break:</span>
          checkErrorAndVisit(downcast&lt;AST::Break&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Statement::Kind::Continue:</span>
          checkErrorAndVisit(downcast&lt;AST::Continue&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Statement::Kind::DoWhileLoop:</span>
          checkErrorAndVisit(downcast&lt;AST::DoWhileLoop&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Statement::Kind::EffectfulExpression:</span>
          checkErrorAndVisit(downcast&lt;AST::EffectfulExpressionStatement&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Statement::Kind::Fallthrough:</span>
          checkErrorAndVisit(downcast&lt;AST::Fallthrough&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Statement::Kind::ForLoop:</span>
          checkErrorAndVisit(downcast&lt;AST::ForLoop&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Statement::Kind::If:</span>
          checkErrorAndVisit(downcast&lt;AST::IfStatement&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Statement::Kind::Return:</span>
          checkErrorAndVisit(downcast&lt;AST::Return&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Statement::Kind::StatementList:</span>
<span class="line-added">+         checkErrorAndVisit(downcast&lt;AST::StatementList&gt;(statement));</span>
<span class="line-added">+         break;</span>
<span class="line-added">+     case AST::Statement::Kind::SwitchCase:</span>
          checkErrorAndVisit(downcast&lt;AST::SwitchCase&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Statement::Kind::Switch:</span>
          checkErrorAndVisit(downcast&lt;AST::SwitchStatement&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-modified">!     case AST::Statement::Kind::VariableDeclarations:</span>
          checkErrorAndVisit(downcast&lt;AST::VariableDeclarationsStatement&gt;(statement));
<span class="line-modified">!         break;</span>
<span class="line-modified">!     case AST::Statement::Kind::WhileLoop:</span>
          checkErrorAndVisit(downcast&lt;AST::WhileLoop&gt;(statement));
<span class="line-added">+         break;</span>
      }
  }
  
  void Visitor::visit(AST::Break&amp;)
  {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 414,57 ***</span>
      checkErrorAndVisit(doWhileLoop.conditional());
  }
  
  void Visitor::visit(AST::Expression&amp; expression)
  {
<span class="line-modified">!     if (is&lt;AST::AssignmentExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::AssignmentExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::BooleanLiteral&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::BooleanLiteral&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::CallExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::CallExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::CommaExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::CommaExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::DereferenceExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::DereferenceExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::FloatLiteral&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::FloatLiteral&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::IntegerLiteral&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::IntegerLiteral&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::LogicalExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::LogicalExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::LogicalNotExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::LogicalNotExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::MakeArrayReferenceExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::MakeArrayReferenceExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::MakePointerExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::MakePointerExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::NullLiteral&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::NullLiteral&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::DotExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::DotExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::IndexExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::IndexExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::ReadModifyWriteExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::ReadModifyWriteExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::TernaryExpression&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::TernaryExpression&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::UnsignedIntegerLiteral&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::UnsignedIntegerLiteral&gt;(expression));
<span class="line-modified">!     else if (is&lt;AST::EnumerationMemberLiteral&gt;(expression))</span>
          checkErrorAndVisit(downcast&lt;AST::EnumerationMemberLiteral&gt;(expression));
<span class="line-modified">!     else {</span>
<span class="line-modified">!         ASSERT(is&lt;AST::VariableReference&gt;(expression));</span>
          checkErrorAndVisit(downcast&lt;AST::VariableReference&gt;(expression));
      }
  }
  
  void Visitor::visit(AST::DotExpression&amp; dotExpression)
  {
      checkErrorAndVisit(static_cast&lt;AST::PropertyAccessExpression&amp;&gt;(dotExpression));
  }
  
  void Visitor::visit(AST::IndexExpression&amp; indexExpression)
  {
      checkErrorAndVisit(indexExpression.indexExpression());
      checkErrorAndVisit(static_cast&lt;AST::PropertyAccessExpression&amp;&gt;(indexExpression));
  }
<span class="line-new-header">--- 363,84 ---</span>
      checkErrorAndVisit(doWhileLoop.conditional());
  }
  
  void Visitor::visit(AST::Expression&amp; expression)
  {
<span class="line-modified">!     switch (expression.kind()) {</span>
<span class="line-added">+     case AST::Expression::Kind::Assignment:</span>
          checkErrorAndVisit(downcast&lt;AST::AssignmentExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::BooleanLiteral:</span>
          checkErrorAndVisit(downcast&lt;AST::BooleanLiteral&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::Call:</span>
          checkErrorAndVisit(downcast&lt;AST::CallExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::Comma:</span>
          checkErrorAndVisit(downcast&lt;AST::CommaExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::Dereference:</span>
          checkErrorAndVisit(downcast&lt;AST::DereferenceExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::FloatLiteral:</span>
          checkErrorAndVisit(downcast&lt;AST::FloatLiteral&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::IntegerLiteral:</span>
          checkErrorAndVisit(downcast&lt;AST::IntegerLiteral&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::Logical:</span>
          checkErrorAndVisit(downcast&lt;AST::LogicalExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::LogicalNot:</span>
          checkErrorAndVisit(downcast&lt;AST::LogicalNotExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::MakeArrayReference:</span>
          checkErrorAndVisit(downcast&lt;AST::MakeArrayReferenceExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::MakePointer:</span>
          checkErrorAndVisit(downcast&lt;AST::MakePointerExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::NullLiteral:</span>
          checkErrorAndVisit(downcast&lt;AST::NullLiteral&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::Dot:</span>
          checkErrorAndVisit(downcast&lt;AST::DotExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::GlobalVariableReference:</span>
<span class="line-added">+         checkErrorAndVisit(downcast&lt;AST::GlobalVariableReference&gt;(expression));</span>
<span class="line-added">+         break;</span>
<span class="line-added">+     case AST::Expression::Kind::Index:</span>
          checkErrorAndVisit(downcast&lt;AST::IndexExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::ReadModifyWrite:</span>
          checkErrorAndVisit(downcast&lt;AST::ReadModifyWriteExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::Ternary:</span>
          checkErrorAndVisit(downcast&lt;AST::TernaryExpression&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::UnsignedIntegerLiteral:</span>
          checkErrorAndVisit(downcast&lt;AST::UnsignedIntegerLiteral&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-added">+     case AST::Expression::Kind::EnumerationMemberLiteral:</span>
          checkErrorAndVisit(downcast&lt;AST::EnumerationMemberLiteral&gt;(expression));
<span class="line-modified">!         break;</span>
<span class="line-modified">!     case AST::Expression::Kind::VariableReference:</span>
          checkErrorAndVisit(downcast&lt;AST::VariableReference&gt;(expression));
<span class="line-added">+         break;</span>
      }
  }
  
  void Visitor::visit(AST::DotExpression&amp; dotExpression)
  {
      checkErrorAndVisit(static_cast&lt;AST::PropertyAccessExpression&amp;&gt;(dotExpression));
  }
  
<span class="line-added">+ void Visitor::visit(AST::GlobalVariableReference&amp; globalVariableReference)</span>
<span class="line-added">+ {</span>
<span class="line-added">+     checkErrorAndVisit(globalVariableReference.base());</span>
<span class="line-added">+ }</span>
<span class="line-added">+ </span>
  void Visitor::visit(AST::IndexExpression&amp; indexExpression)
  {
      checkErrorAndVisit(indexExpression.indexExpression());
      checkErrorAndVisit(static_cast&lt;AST::PropertyAccessExpression&amp;&gt;(indexExpression));
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 483,15 ***</span>
  {
  }
  
  void Visitor::visit(AST::ForLoop&amp; forLoop)
  {
<span class="line-modified">!     WTF::visit(WTF::makeVisitor([&amp;](AST::VariableDeclarationsStatement&amp; variableDeclarationsStatement) {</span>
<span class="line-removed">-         checkErrorAndVisit(variableDeclarationsStatement);</span>
<span class="line-removed">-     }, [&amp;](UniqueRef&lt;AST::Expression&gt;&amp; expression) {</span>
<span class="line-removed">-         checkErrorAndVisit(expression);</span>
<span class="line-removed">-     }), forLoop.initialization());</span>
      if (forLoop.condition())
          checkErrorAndVisit(*forLoop.condition());
      if (forLoop.increment())
          checkErrorAndVisit(*forLoop.increment());
      checkErrorAndVisit(forLoop.body());
<span class="line-new-header">--- 459,11 ---</span>
  {
  }
  
  void Visitor::visit(AST::ForLoop&amp; forLoop)
  {
<span class="line-modified">!     checkErrorAndVisit(forLoop.initialization());</span>
      if (forLoop.condition())
          checkErrorAndVisit(*forLoop.condition());
      if (forLoop.increment())
          checkErrorAndVisit(*forLoop.increment());
      checkErrorAndVisit(forLoop.body());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 523,18 ***</span>
      checkErrorAndVisit(switchStatement.value());
      for (auto&amp; switchCase : switchStatement.switchCases())
          checkErrorAndVisit(switchCase);
  }
  
<span class="line-removed">- void Visitor::visit(AST::Trap&amp;)</span>
<span class="line-removed">- {</span>
<span class="line-removed">- }</span>
<span class="line-removed">- </span>
  void Visitor::visit(AST::VariableDeclarationsStatement&amp; variableDeclarationsStatement)
  {
      for (auto&amp; variableDeclaration : variableDeclarationsStatement.variableDeclarations())
<span class="line-modified">!         checkErrorAndVisit(variableDeclaration);</span>
  }
  
  void Visitor::visit(AST::WhileLoop&amp; whileLoop)
  {
      checkErrorAndVisit(whileLoop.conditional());
<span class="line-new-header">--- 495,14 ---</span>
      checkErrorAndVisit(switchStatement.value());
      for (auto&amp; switchCase : switchStatement.switchCases())
          checkErrorAndVisit(switchCase);
  }
  
  void Visitor::visit(AST::VariableDeclarationsStatement&amp; variableDeclarationsStatement)
  {
      for (auto&amp; variableDeclaration : variableDeclarationsStatement.variableDeclarations())
<span class="line-modified">!         checkErrorAndVisit(variableDeclaration.get());</span>
  }
  
  void Visitor::visit(AST::WhileLoop&amp; whileLoop)
  {
      checkErrorAndVisit(whileLoop.conditional());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 560,11 ***</span>
  void Visitor::visit(AST::CallExpression&amp; callExpression)
  {
      for (auto&amp; argument : callExpression.arguments())
          checkErrorAndVisit(argument);
      if (callExpression.castReturnType())
<span class="line-modified">!         checkErrorAndVisit(callExpression.castReturnType()-&gt;get());</span>
  }
  
  void Visitor::visit(AST::CommaExpression&amp; commaExpression)
  {
      for (auto&amp; expression : commaExpression.list())
<span class="line-new-header">--- 528,11 ---</span>
  void Visitor::visit(AST::CallExpression&amp; callExpression)
  {
      for (auto&amp; argument : callExpression.arguments())
          checkErrorAndVisit(argument);
      if (callExpression.castReturnType())
<span class="line-modified">!         checkErrorAndVisit(*callExpression.castReturnType());</span>
  }
  
  void Visitor::visit(AST::CommaExpression&amp; commaExpression)
  {
      for (auto&amp; expression : commaExpression.list())
</pre>
<hr />
<pre>
<span class="line-old-header">*** 587,27 ***</span>
      checkErrorAndVisit(logicalNotExpression.operand());
  }
  
  void Visitor::visit(AST::MakeArrayReferenceExpression&amp; makeArrayReferenceExpression)
  {
<span class="line-modified">!     checkErrorAndVisit(makeArrayReferenceExpression.lValue());</span>
  }
  
  void Visitor::visit(AST::MakePointerExpression&amp; makePointerExpression)
  {
<span class="line-modified">!     checkErrorAndVisit(makePointerExpression.lValue());</span>
  }
  
  void Visitor::visit(AST::ReadModifyWriteExpression&amp; readModifyWriteExpression)
  {
<span class="line-modified">!     checkErrorAndVisit(readModifyWriteExpression.lValue());</span>
      checkErrorAndVisit(readModifyWriteExpression.oldValue());
      checkErrorAndVisit(readModifyWriteExpression.newValue());
<span class="line-modified">!     if (readModifyWriteExpression.newValueExpression())</span>
<span class="line-modified">!         checkErrorAndVisit(*readModifyWriteExpression.newValueExpression());</span>
<span class="line-removed">-     if (readModifyWriteExpression.resultExpression())</span>
<span class="line-removed">-         checkErrorAndVisit(*readModifyWriteExpression.resultExpression());</span>
  }
  
  void Visitor::visit(AST::TernaryExpression&amp; ternaryExpression)
  {
      checkErrorAndVisit(ternaryExpression.predicate());
<span class="line-new-header">--- 555,25 ---</span>
      checkErrorAndVisit(logicalNotExpression.operand());
  }
  
  void Visitor::visit(AST::MakeArrayReferenceExpression&amp; makeArrayReferenceExpression)
  {
<span class="line-modified">!     checkErrorAndVisit(makeArrayReferenceExpression.leftValue());</span>
  }
  
  void Visitor::visit(AST::MakePointerExpression&amp; makePointerExpression)
  {
<span class="line-modified">!     checkErrorAndVisit(makePointerExpression.leftValue());</span>
  }
  
  void Visitor::visit(AST::ReadModifyWriteExpression&amp; readModifyWriteExpression)
  {
<span class="line-modified">!     checkErrorAndVisit(readModifyWriteExpression.leftValue());</span>
      checkErrorAndVisit(readModifyWriteExpression.oldValue());
      checkErrorAndVisit(readModifyWriteExpression.newValue());
<span class="line-modified">!     checkErrorAndVisit(readModifyWriteExpression.newValueExpression());</span>
<span class="line-modified">!     checkErrorAndVisit(readModifyWriteExpression.resultExpression());</span>
  }
  
  void Visitor::visit(AST::TernaryExpression&amp; ternaryExpression)
  {
      checkErrorAndVisit(ternaryExpression.predicate());
</pre>
<center><a href="WHLSLSynthesizeStructureAccessors.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="WHLSLVisitor.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/testing/InternalSettings.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (C) 2012 Google Inc. All rights reserved.
  3  * Copyright (C) 2013-2016 Apple Inc. All rights reserved.
  4  *
  5  * Redistribution and use in source and binary forms, with or without
  6  * modification, are permitted provided that the following conditions
  7  * are met:
  8  *
  9  * 1.  Redistributions of source code must retain the above copyright
 10  *     notice, this list of conditions and the following disclaimer.
 11  * 2.  Redistributions in binary form must reproduce the above copyright
 12  *     notice, this list of conditions and the following disclaimer in the
 13  *     documentation and/or other materials provided with the distribution.
 14  *
 15  * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS &quot;AS IS&quot; AND ANY
 16  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 17  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 18  * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 19  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 20  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 21  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 22  * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 24  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 25  */
 26 
 27 #pragma once
 28 
 29 // FIXME (121927): This include should not be needed.
 30 #include &lt;wtf/text/AtomStringHash.h&gt;
 31 
 32 #include &quot;EditingBehaviorTypes.h&quot;
 33 #include &quot;ExceptionOr.h&quot;
 34 #include &quot;FontGenericFamilies.h&quot;
 35 #include &quot;IntSize.h&quot;
 36 #include &quot;InternalSettingsGenerated.h&quot;
 37 #include &quot;SecurityOrigin.h&quot;
 38 #include &quot;Settings.h&quot;
 39 #include &quot;WritingMode.h&quot;
 40 
 41 namespace WebCore {
 42 
 43 class Page;
 44 class Settings;
 45 
 46 class InternalSettings : public InternalSettingsGenerated {
 47 public:
 48     static Ref&lt;InternalSettings&gt; create(Page*);
 49     static InternalSettings* from(Page*);
 50     void hostDestroyed();
 51     void resetToConsistentState();
 52 
 53     ExceptionOr&lt;void&gt; setUsesOverlayScrollbars(bool);
 54     ExceptionOr&lt;void&gt; setTouchEventEmulationEnabled(bool);
 55     ExceptionOr&lt;void&gt; setStandardFontFamily(const String&amp; family, const String&amp; script);
 56     ExceptionOr&lt;void&gt; setSerifFontFamily(const String&amp; family, const String&amp; script);
 57     ExceptionOr&lt;void&gt; setSansSerifFontFamily(const String&amp; family, const String&amp; script);
 58     ExceptionOr&lt;void&gt; setFixedFontFamily(const String&amp; family, const String&amp; script);
 59     ExceptionOr&lt;void&gt; setCursiveFontFamily(const String&amp; family, const String&amp; script);
 60     ExceptionOr&lt;void&gt; setFantasyFontFamily(const String&amp; family, const String&amp; script);
 61     ExceptionOr&lt;void&gt; setPictographFontFamily(const String&amp; family, const String&amp; script);
 62     ExceptionOr&lt;void&gt; setTextAutosizingEnabled(bool);
 63     ExceptionOr&lt;void&gt; setTextAutosizingWindowSizeOverride(int width, int height);
 64     ExceptionOr&lt;void&gt; setTextAutosizingUsesIdempotentMode(bool);
 65     ExceptionOr&lt;void&gt; setTextAutosizingFontScaleFactor(float);
 66     ExceptionOr&lt;void&gt; setMediaTypeOverride(const String&amp;);
 67     ExceptionOr&lt;void&gt; setCanStartMedia(bool);
 68     ExceptionOr&lt;void&gt; setAllowsAirPlayForMediaPlayback(bool);
 69     ExceptionOr&lt;void&gt; setMediaCaptureRequiresSecureConnection(bool);
 70 
 71     ExceptionOr&lt;void&gt; setEditingBehavior(const String&amp;);
 72     ExceptionOr&lt;void&gt; setPreferMIMETypeForImages(bool);
 73     ExceptionOr&lt;void&gt; setPDFImageCachingPolicy(const String&amp;);
 74     ExceptionOr&lt;void&gt; setShouldDisplayTrackKind(const String&amp; kind, bool enabled);
 75     ExceptionOr&lt;bool&gt; shouldDisplayTrackKind(const String&amp; kind);
 76     ExceptionOr&lt;void&gt; setUseDarkAppearance(bool);
 77     ExceptionOr&lt;void&gt; setStorageBlockingPolicy(const String&amp;);
 78     ExceptionOr&lt;void&gt; setImagesEnabled(bool);
 79     ExceptionOr&lt;void&gt; setMinimumTimerInterval(double intervalInSeconds);
 80     ExceptionOr&lt;void&gt; setDefaultVideoPosterURL(const String&amp;);
 81     ExceptionOr&lt;void&gt; setForcePendingWebGLPolicy(bool);
 82     ExceptionOr&lt;void&gt; setTimeWithoutMouseMovementBeforeHidingControls(double);
 83     ExceptionOr&lt;void&gt; setUseLegacyBackgroundSizeShorthandBehavior(bool);
 84     ExceptionOr&lt;void&gt; setAutoscrollForDragAndDropEnabled(bool);
 85     ExceptionOr&lt;void&gt; setFontFallbackPrefersPictographs(bool);
 86     enum class FontLoadTimingOverride { Block, Swap, Failure };
 87     ExceptionOr&lt;void&gt; setFontLoadTimingOverride(const FontLoadTimingOverride&amp;);
 88     ExceptionOr&lt;void&gt; setShouldIgnoreFontLoadCompletions(bool);
 89     ExceptionOr&lt;void&gt; setQuickTimePluginReplacementEnabled(bool);
 90     ExceptionOr&lt;void&gt; setYouTubeFlashPluginReplacementEnabled(bool);
 91     ExceptionOr&lt;void&gt; setBackgroundShouldExtendBeyondPage(bool);
 92     ExceptionOr&lt;void&gt; setShouldConvertPositionStyleOnCopy(bool);
 93     ExceptionOr&lt;void&gt; setScrollingTreeIncludesFrames(bool);
 94     ExceptionOr&lt;void&gt; setAllowUnclampedScrollPosition(bool);
 95     ExceptionOr&lt;void&gt; setAllowsInlineMediaPlayback(bool);
 96     ExceptionOr&lt;void&gt; setAllowsInlineMediaPlaybackAfterFullscreen(bool);
 97     ExceptionOr&lt;void&gt; setInlineMediaPlaybackRequiresPlaysInlineAttribute(bool);
 98     ExceptionOr&lt;String&gt; userInterfaceDirectionPolicy();
 99     ExceptionOr&lt;void&gt; setUserInterfaceDirectionPolicy(const String&amp;);
100     ExceptionOr&lt;String&gt; systemLayoutDirection();
101     ExceptionOr&lt;void&gt; setSystemLayoutDirection(const String&amp;);
102     ExceptionOr&lt;void&gt; setShouldMockBoldSystemFontForAccessibility(bool);
103     ExceptionOr&lt;void&gt; setShouldManageAudioSessionCategory(bool);
104     ExceptionOr&lt;void&gt; setCustomPasteboardDataEnabled(bool);
105     ExceptionOr&lt;void&gt; setIncompleteImageBorderEnabled(bool);
106     ExceptionOr&lt;void&gt; setShouldDispatchSyntheticMouseEventsWhenModifyingSelection(bool);
107     ExceptionOr&lt;void&gt; setShouldDispatchSyntheticMouseOutAfterSyntheticClick(bool);
108     ExceptionOr&lt;void&gt; setAnimatedImageDebugCanvasDrawingEnabled(bool);
109 
110     using FrameFlatteningValue = FrameFlattening;
111     ExceptionOr&lt;void&gt; setFrameFlattening(FrameFlatteningValue);
112 
113     static void setAllowsAnySSLCertificate(bool);
114 
115     ExceptionOr&lt;bool&gt; deferredCSSParserEnabled();
116     ExceptionOr&lt;void&gt; setDeferredCSSParserEnabled(bool);
117 
118     enum class ForcedAccessibilityValue { System, On, Off };
119     ForcedAccessibilityValue forcedColorsAreInvertedAccessibilityValue() const;
120     void setForcedColorsAreInvertedAccessibilityValue(ForcedAccessibilityValue);
121     ForcedAccessibilityValue forcedDisplayIsMonochromeAccessibilityValue() const;
122     void setForcedDisplayIsMonochromeAccessibilityValue(ForcedAccessibilityValue);
123     ForcedAccessibilityValue forcedPrefersReducedMotionAccessibilityValue() const;
124     void setForcedPrefersReducedMotionAccessibilityValue(ForcedAccessibilityValue);
125 
126     // RuntimeEnabledFeatures.
127     static void setIndexedDBWorkersEnabled(bool);
128     static void setWebGL2Enabled(bool);
129     static void setWebGPUEnabled(bool);
130     static void setWebVREnabled(bool);
131     static void setScreenCaptureEnabled(bool);
132 
133     static bool webAnimationsCSSIntegrationEnabled();
134 
135     void setShouldDeactivateAudioSession(bool);
136 
137 private:
138     explicit InternalSettings(Page*);
139 
140     Settings&amp; settings() const;
141     static const char* supplementName();
142 
143     void setUseDarkAppearanceInternal(bool);
144 
145     class Backup {
146     public:
147         explicit Backup(Settings&amp;);
148         void restoreTo(Settings&amp;);
149 
150         EditingBehaviorType m_originalEditingBehavior;
151 
152         // Initially empty, only used if changed by a test.
153         ScriptFontFamilyMap m_standardFontFamilies;
154         ScriptFontFamilyMap m_fixedFontFamilies;
155         ScriptFontFamilyMap m_serifFontFamilies;
156         ScriptFontFamilyMap m_sansSerifFontFamilies;
157         ScriptFontFamilyMap m_cursiveFontFamilies;
158         ScriptFontFamilyMap m_fantasyFontFamilies;
159         ScriptFontFamilyMap m_pictographFontFamilies;
160 
161 #if ENABLE(TEXT_AUTOSIZING)
162         bool m_originalTextAutosizingEnabled;
163         IntSize m_originalTextAutosizingWindowSizeOverride;
164         bool m_originalTextAutosizingUsesIdempotentMode;
165 #endif
166 
167         String m_originalMediaTypeOverride;
168         bool m_originalCanvasUsesAcceleratedDrawing;
169         bool m_originalMockScrollbarsEnabled;
170         bool m_originalUsesOverlayScrollbars;
171         bool m_imagesEnabled;
172         bool m_preferMIMETypeForImages;
173         Seconds m_minimumDOMTimerInterval;
174 #if ENABLE(VIDEO_TRACK)
175         bool m_shouldDisplaySubtitles;
176         bool m_shouldDisplayCaptions;
177         bool m_shouldDisplayTextDescriptions;
178 #endif
179         String m_defaultVideoPosterURL;
180         bool m_forcePendingWebGLPolicy;
181         Seconds m_originalTimeWithoutMouseMovementBeforeHidingControls;
182         bool m_useLegacyBackgroundSizeShorthandBehavior;
183         bool m_autoscrollForDragAndDropEnabled;
184         bool m_quickTimePluginReplacementEnabled;
185         bool m_youTubeFlashPluginReplacementEnabled;
186         bool m_shouldConvertPositionStyleOnCopy;
187         bool m_fontFallbackPrefersPictographs;
188         bool m_shouldIgnoreFontLoadCompletions;
189         bool m_backgroundShouldExtendBeyondPage;
190         SecurityOrigin::StorageBlockingPolicy m_storageBlockingPolicy;
191         bool m_scrollingTreeIncludesFrames;
192 #if ENABLE(TOUCH_EVENTS)
193         bool m_touchEventEmulationEnabled;
194 #endif
195 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
196         bool m_allowsAirPlayForMediaPlayback;
197 #endif
198         bool m_allowsInlineMediaPlayback;
199         bool m_allowsInlineMediaPlaybackAfterFullscreen;
200         bool m_inlineMediaPlaybackRequiresPlaysInlineAttribute;
201         bool m_deferredCSSParserEnabled;
202         bool m_inputEventsEnabled;
203         bool m_incompleteImageBorderEnabled;
204         bool m_shouldDispatchSyntheticMouseEventsWhenModifyingSelection;
205         bool m_shouldDispatchSyntheticMouseOutAfterSyntheticClick { false };
206         bool m_shouldDeactivateAudioSession;
207         bool m_animatedImageDebugCanvasDrawingEnabled;
208         UserInterfaceDirectionPolicy m_userInterfaceDirectionPolicy;
209         TextDirection m_systemLayoutDirection;
210         PDFImageCachingPolicy m_pdfImageCachingPolicy;
211         Settings::ForcedAccessibilityValue m_forcedColorsAreInvertedAccessibilityValue;
212         Settings::ForcedAccessibilityValue m_forcedDisplayIsMonochromeAccessibilityValue;
213         Settings::ForcedAccessibilityValue m_forcedPrefersReducedMotionAccessibilityValue;
214         Settings::FontLoadTimingOverride m_fontLoadTimingOverride;
215         FrameFlattening m_frameFlattening;
216 
217         // Runtime enabled settings.
218         bool m_indexedDBWorkersEnabled;
219         bool m_webGL2Enabled;
220         bool m_webVREnabled;
221         bool m_setScreenCaptureEnabled;
222 
223         bool m_shouldMockBoldSystemFontForAccessibility;
224 #if USE(AUDIO_SESSION)
225         bool m_shouldManageAudioSessionCategory;
226 #endif
227         bool m_customPasteboardDataEnabled;
228     };
229 
230     Page* m_page;
231     Backup m_backup;
232 };
233 
234 } // namespace WebCore
    </pre>
  </body>
</html>
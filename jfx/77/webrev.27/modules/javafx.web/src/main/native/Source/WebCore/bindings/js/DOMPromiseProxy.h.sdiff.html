<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/bindings/js/DOMPromiseProxy.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="DOMGCOutputConstraint.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="GCController.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/bindings/js/DOMPromiseProxy.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 43     DOMPromiseProxy() = default;
 44     ~DOMPromiseProxy() = default;
 45 
 46     JSC::JSValue promise(JSC::ExecState&amp;, JSDOMGlobalObject&amp;);
 47 
 48     void clear();
 49 
 50     bool isFulfilled() const;
 51 
 52     void resolve(typename IDLType::ParameterType);
 53     void resolveWithNewlyCreated(typename IDLType::ParameterType);
 54     void reject(Exception);
 55 
 56 private:
 57     Optional&lt;ExceptionOr&lt;Value&gt;&gt; m_valueOrException;
 58     Vector&lt;Ref&lt;DeferredPromise&gt;, 1&gt; m_deferredPromises;
 59 };
 60 
 61 template&lt;&gt;
 62 class DOMPromiseProxy&lt;IDLVoid&gt; {

 63 public:
 64     DOMPromiseProxy() = default;
 65     ~DOMPromiseProxy() = default;
 66 
 67     JSC::JSValue promise(JSC::ExecState&amp;, JSDOMGlobalObject&amp;);
 68 
 69     void clear();
 70 
 71     bool isFulfilled() const;
 72 
 73     void resolve();
 74     void reject(Exception);
 75 
 76 private:
 77     Optional&lt;ExceptionOr&lt;void&gt;&gt; m_valueOrException;
 78     Vector&lt;Ref&lt;DeferredPromise&gt;, 1&gt; m_deferredPromises;
 79 };
 80 
 81 // Instead of storing the value of the resolution directly, DOMPromiseProxyWithResolveCallback
 82 // allows the owner to specify callback to be called when the resolved value is needed. This is
 83 // needed to avoid reference cycles when the resolved value is the owner, such as is the case with
 84 // FontFace and FontFaceSet.
 85 template&lt;typename IDLType&gt;
 86 class DOMPromiseProxyWithResolveCallback {

 87 public:
 88     using ResolveCallback = WTF::Function&lt;typename IDLType::ParameterType ()&gt;;
 89 
 90     template &lt;typename Class, typename BaseClass&gt;
 91     DOMPromiseProxyWithResolveCallback(Class&amp;, typename IDLType::ParameterType (BaseClass::*)());
 92     DOMPromiseProxyWithResolveCallback(ResolveCallback&amp;&amp;);
 93     ~DOMPromiseProxyWithResolveCallback() = default;
 94 
 95     JSC::JSValue promise(JSC::ExecState&amp;, JSDOMGlobalObject&amp;);
 96 
 97     void clear();
 98 
 99     bool isFulfilled() const;
100 
101     void resolve(typename IDLType::ParameterType);
102     void resolveWithNewlyCreated(typename IDLType::ParameterType);
103     void reject(Exception);
104 
105 private:
106     ResolveCallback m_resolveCallback;
</pre>
</td>
<td>
<hr />
<pre>
 43     DOMPromiseProxy() = default;
 44     ~DOMPromiseProxy() = default;
 45 
 46     JSC::JSValue promise(JSC::ExecState&amp;, JSDOMGlobalObject&amp;);
 47 
 48     void clear();
 49 
 50     bool isFulfilled() const;
 51 
 52     void resolve(typename IDLType::ParameterType);
 53     void resolveWithNewlyCreated(typename IDLType::ParameterType);
 54     void reject(Exception);
 55 
 56 private:
 57     Optional&lt;ExceptionOr&lt;Value&gt;&gt; m_valueOrException;
 58     Vector&lt;Ref&lt;DeferredPromise&gt;, 1&gt; m_deferredPromises;
 59 };
 60 
 61 template&lt;&gt;
 62 class DOMPromiseProxy&lt;IDLVoid&gt; {
<span class="line-added"> 63     WTF_MAKE_FAST_ALLOCATED;</span>
 64 public:
 65     DOMPromiseProxy() = default;
 66     ~DOMPromiseProxy() = default;
 67 
 68     JSC::JSValue promise(JSC::ExecState&amp;, JSDOMGlobalObject&amp;);
 69 
 70     void clear();
 71 
 72     bool isFulfilled() const;
 73 
 74     void resolve();
 75     void reject(Exception);
 76 
 77 private:
 78     Optional&lt;ExceptionOr&lt;void&gt;&gt; m_valueOrException;
 79     Vector&lt;Ref&lt;DeferredPromise&gt;, 1&gt; m_deferredPromises;
 80 };
 81 
 82 // Instead of storing the value of the resolution directly, DOMPromiseProxyWithResolveCallback
 83 // allows the owner to specify callback to be called when the resolved value is needed. This is
 84 // needed to avoid reference cycles when the resolved value is the owner, such as is the case with
 85 // FontFace and FontFaceSet.
 86 template&lt;typename IDLType&gt;
 87 class DOMPromiseProxyWithResolveCallback {
<span class="line-added"> 88     WTF_MAKE_FAST_ALLOCATED;</span>
 89 public:
 90     using ResolveCallback = WTF::Function&lt;typename IDLType::ParameterType ()&gt;;
 91 
 92     template &lt;typename Class, typename BaseClass&gt;
 93     DOMPromiseProxyWithResolveCallback(Class&amp;, typename IDLType::ParameterType (BaseClass::*)());
 94     DOMPromiseProxyWithResolveCallback(ResolveCallback&amp;&amp;);
 95     ~DOMPromiseProxyWithResolveCallback() = default;
 96 
 97     JSC::JSValue promise(JSC::ExecState&amp;, JSDOMGlobalObject&amp;);
 98 
 99     void clear();
100 
101     bool isFulfilled() const;
102 
103     void resolve(typename IDLType::ParameterType);
104     void resolveWithNewlyCreated(typename IDLType::ParameterType);
105     void reject(Exception);
106 
107 private:
108     ResolveCallback m_resolveCallback;
</pre>
</td>
</tr>
</table>
<center><a href="DOMGCOutputConstraint.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="GCController.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>
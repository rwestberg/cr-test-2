<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/WebCore/platform/PlatformKeyboardEvent.h</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
  2  * Copyright (C) 2004, 2005, 2006 Apple Inc.  All rights reserved.
  3  * Copyright (C) 2008 Collabora, Ltd.  All rights reserved.
  4  *
  5  * Redistribution and use in source and binary forms, with or without
  6  * modification, are permitted provided that the following conditions
  7  * are met:
  8  * 1. Redistributions of source code must retain the above copyright
  9  *    notice, this list of conditions and the following disclaimer.
 10  * 2. Redistributions in binary form must reproduce the above copyright
 11  *    notice, this list of conditions and the following disclaimer in the
 12  *    documentation and/or other materials provided with the distribution.
 13  *
 14  * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS&#39;&#39; AND ANY
 15  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 16  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 17  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 18  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 19  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 20  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 21  * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 22  * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 24  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 25  */
 26 
 27 #pragma once
 28 
 29 #include &quot;KeypressCommand.h&quot;
 30 #include &quot;PlatformEvent.h&quot;
 31 #include &lt;wtf/WindowsExtras.h&gt;
 32 #include &lt;wtf/text/WTFString.h&gt;
 33 
 34 #if PLATFORM(COCOA)
 35 #include &lt;wtf/RetainPtr.h&gt;
 36 OBJC_CLASS NSEvent;
 37 #endif
 38 
 39 #if PLATFORM(IOS_FAMILY)
 40 OBJC_CLASS WebEvent;
 41 #endif
 42 
 43 #if PLATFORM(GTK)
 44 typedef struct _GdkEventKey GdkEventKey;
 45 #include &quot;CompositionResults.h&quot;
 46 #endif
 47 
 48 #if PLATFORM(JAVA)
 49 #include &lt;jni.h&gt;
 50 #endif
 51 
 52 namespace WebCore {
 53 
 54     class PlatformKeyboardEvent : public PlatformEvent {
 55         WTF_MAKE_FAST_ALLOCATED;
 56     public:
 57         PlatformKeyboardEvent()
 58             : PlatformEvent(PlatformEvent::KeyDown)
 59             , m_windowsVirtualKeyCode(0)
<a name="1" id="anc1"></a>


 60             , m_autoRepeat(false)
 61             , m_isKeypad(false)
 62             , m_isSystemKey(false)
 63 #if PLATFORM(GTK)
 64             , m_gdkEventKey(0)
 65 #endif
 66         {
 67         }
 68 
 69         PlatformKeyboardEvent(Type type, const String&amp; text, const String&amp; unmodifiedText,
 70 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
 71         const String&amp; key,
 72 #endif
 73 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
 74         const String&amp; code,
 75 #endif
 76         const String&amp; keyIdentifier, int windowsVirtualKeyCode, bool isAutoRepeat, bool isKeypad, bool isSystemKey, OptionSet&lt;Modifier&gt; modifiers, WallTime timestamp)
 77             : PlatformEvent(type, modifiers, timestamp)
 78             , m_text(text)
 79             , m_unmodifiedText(unmodifiedText)
 80 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
 81             , m_key(key)
 82 #endif
 83 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
 84             , m_code(code)
 85 #endif
 86             , m_keyIdentifier(keyIdentifier)
 87             , m_windowsVirtualKeyCode(windowsVirtualKeyCode)
<a name="2" id="anc2"></a>


 88             , m_autoRepeat(isAutoRepeat)
 89             , m_isKeypad(isKeypad)
 90             , m_isSystemKey(isSystemKey)
 91         {
 92         }
 93 
 94         WEBCORE_EXPORT void disambiguateKeyDownEvent(Type, bool backwardCompatibilityMode = false); // Only used on platforms that need it, i.e. those that generate KeyDown events.
 95 
 96         // Text as as generated by processing a virtual key code with a keyboard layout
 97         // (in most cases, just a character code, but the layout can emit several
 98         // characters in a single keypress event on some platforms).
 99         // This may bear no resemblance to the ultimately inserted text if an input method
100         // processes the input.
101         // Will be null for KeyUp and RawKeyDown events.
102         String text() const { return m_text; }
103 
104         // Text that would have been generated by the keyboard if no modifiers were pressed
105         // (except for Shift); useful for shortcut (accelerator) key handling.
106         // Otherwise, same as text().
107         String unmodifiedText() const { return m_unmodifiedText; }
108 
109         String keyIdentifier() const { return m_keyIdentifier; }
110 
111 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
112         const String&amp; key() const { return m_key; }
113 #endif
114 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
115         const String&amp; code() const { return m_code; }
116 #endif
117 
118         // Most compatible Windows virtual key code associated with the event.
119         // Zero for Char events.
120         int windowsVirtualKeyCode() const { return m_windowsVirtualKeyCode; }
121         void setWindowsVirtualKeyCode(int code) { m_windowsVirtualKeyCode = code; }
122 
<a name="3" id="anc3"></a><span class="line-modified">123 #if USE(APPKIT) || USE(UIKIT_KEYBOARD_ADDITIONS) || PLATFORM(GTK)</span>
124         bool handledByInputMethod() const { return m_handledByInputMethod; }
125 #endif
126 #if USE(APPKIT)
127         const Vector&lt;KeypressCommand&gt;&amp; commands() const { return m_commands; }
128 #elif PLATFORM(GTK)
129         const Vector&lt;String&gt;&amp; commands() const { return m_commands; }
130 #endif
131 
132         bool isAutoRepeat() const { return m_autoRepeat; }
133         bool isKeypad() const { return m_isKeypad; }
134         bool isSystemKey() const { return m_isSystemKey; }
135 
<a name="4" id="anc4"></a><span class="line-added">136         bool isSyntheticEvent() const { return m_isSyntheticEvent; }</span>
<span class="line-added">137         void setIsSyntheticEvent() { m_isSyntheticEvent = true; }</span>
<span class="line-added">138 </span>
139         WEBCORE_EXPORT static bool currentCapsLockState();
140         WEBCORE_EXPORT static void getCurrentModifierState(bool&amp; shiftKey, bool&amp; ctrlKey, bool&amp; altKey, bool&amp; metaKey);
141         WEBCORE_EXPORT static void setCurrentModifierState(OptionSet&lt;Modifier&gt;);
142         WEBCORE_EXPORT static OptionSet&lt;Modifier&gt; currentStateOfModifierKeys();
143 
144 #if PLATFORM(COCOA)
145 #if !PLATFORM(IOS_FAMILY)
146         NSEvent* macEvent() const { return m_macEvent.get(); }
147 #else
148         ::WebEvent *event() const { return m_Event.get(); }
149 #endif
150 #endif
151 
152 #if PLATFORM(WIN)
153         PlatformKeyboardEvent(HWND, WPARAM, LPARAM, Type, bool);
154 #endif
155 
156 #if PLATFORM(GTK)
157         PlatformKeyboardEvent(GdkEventKey*, const CompositionResults&amp;);
158         GdkEventKey* gdkEventKey() const { return m_gdkEventKey; }
159         const CompositionResults&amp; compositionResults() const { return m_compositionResults; }
160 
161         // Used by WebKit2
162         static String keyValueForGdkKeyCode(unsigned);
163         static String keyCodeForHardwareKeyCode(unsigned);
164         static String keyIdentifierForGdkKeyCode(unsigned);
165         static int windowsKeyCodeForGdkKeyCode(unsigned);
166         static String singleCharacterString(unsigned);
167         static bool modifiersContainCapsLock(unsigned);
168 #endif
169 
170 #if PLATFORM(JAVA)
171         PlatformKeyboardEvent(jint type, jstring text, jstring keyIdentifier,
172                               jint windowsVirtualKeyCode, jboolean shift,
173                               jboolean ctrl, jboolean alt, jboolean meta, jdouble timestamp);
174 #endif
175 
176 #if USE(LIBWPE)
177         static String keyValueForWPEKeyCode(unsigned);
178         static String keyCodeForHardwareKeyCode(unsigned);
179         static String keyIdentifierForWPEKeyCode(unsigned);
180         static int windowsKeyCodeForWPEKeyCode(unsigned);
181         static String singleCharacterString(unsigned);
182 #endif
183 
184     protected:
185         String m_text;
186         String m_unmodifiedText;
187 #if ENABLE(KEYBOARD_KEY_ATTRIBUTE)
188         String m_key;
189 #endif
190 #if ENABLE(KEYBOARD_CODE_ATTRIBUTE)
191         String m_code;
192 #endif
193         String m_keyIdentifier;
194         int m_windowsVirtualKeyCode;
<a name="5" id="anc5"></a><span class="line-modified">195 #if USE(APPKIT) || USE(UIKIT_KEYBOARD_ADDITIONS) || PLATFORM(GTK)</span>
<span class="line-modified">196         bool m_handledByInputMethod { false };</span>
197 #endif
198 #if USE(APPKIT)
199         Vector&lt;KeypressCommand&gt; m_commands;
200 #elif PLATFORM(GTK)
201         Vector&lt;String&gt; m_commands;
202 #endif
203         bool m_autoRepeat;
204         bool m_isKeypad;
205         bool m_isSystemKey;
206 
<a name="6" id="anc6"></a><span class="line-added">207         bool m_isSyntheticEvent { false };</span>
<span class="line-added">208 </span>
209 #if PLATFORM(COCOA)
210 #if !PLATFORM(IOS_FAMILY)
211         RetainPtr&lt;NSEvent&gt; m_macEvent;
212 #else
213         RetainPtr&lt;::WebEvent&gt; m_Event;
214 #endif
215 #endif
216 #if PLATFORM(GTK)
217         GdkEventKey* m_gdkEventKey;
218         CompositionResults m_compositionResults;
219 #endif
220 
221         // The modifier state is optional, since it is not needed in the UI process or in legacy WebKit.
222         static Optional&lt;OptionSet&lt;Modifier&gt;&gt; s_currentModifiers;
223     };
224 
225 } // namespace WebCore
<a name="7" id="anc7"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="7" type="hidden" />
</body>
</html>
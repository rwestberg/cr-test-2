<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/WebCore/testing/InternalSettings.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 /*
   2  * Copyright (C) 2012 Google Inc. All rights reserved.
   3  * Copyright (C) 2013 Apple Inc. All rights reserved.
   4  *
   5  * Redistribution and use in source and binary forms, with or without
   6  * modification, are permitted provided that the following conditions
   7  * are met:
   8  *
   9  * 1.  Redistributions of source code must retain the above copyright
  10  *     notice, this list of conditions and the following disclaimer.
  11  * 2.  Redistributions in binary form must reproduce the above copyright
  12  *     notice, this list of conditions and the following disclaimer in the
  13  *     documentation and/or other materials provided with the distribution.
  14  *
  15  * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS &quot;AS IS&quot; AND ANY
  16  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
  17  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  18  * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
  19  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  20  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  21  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  22  * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  23  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
  24  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  25  */
  26 
  27 #include &quot;config.h&quot;
  28 #include &quot;InternalSettings.h&quot;
  29 
  30 #include &quot;CaptionUserPreferences.h&quot;
  31 #include &quot;DeprecatedGlobalSettings.h&quot;
  32 #include &quot;Document.h&quot;
  33 #include &quot;FontCache.h&quot;
  34 #include &quot;Frame.h&quot;
  35 #include &quot;FrameView.h&quot;
  36 #include &quot;LocaleToScriptMapping.h&quot;
  37 #include &quot;Page.h&quot;
  38 #include &quot;PageGroup.h&quot;
  39 #include &quot;PlatformMediaSessionManager.h&quot;
  40 #include &quot;RenderTheme.h&quot;
  41 #include &quot;RuntimeEnabledFeatures.h&quot;
  42 #include &quot;Settings.h&quot;
  43 #include &quot;Supplementable.h&quot;
  44 #include &lt;wtf/Language.h&gt;
  45 
  46 #if ENABLE(INPUT_TYPE_COLOR)
  47 #include &quot;ColorChooser.h&quot;
  48 #endif
  49 
  50 #if USE(SOUP)
  51 #include &quot;SoupNetworkSession.h&quot;
  52 #endif
  53 
  54 namespace WebCore {
  55 
  56 InternalSettings::Backup::Backup(Settings&amp; settings)
  57     : m_originalEditingBehavior(settings.editingBehaviorType())
  58 #if ENABLE(TEXT_AUTOSIZING)
  59     , m_originalTextAutosizingEnabled(settings.textAutosizingEnabled())
  60     , m_originalTextAutosizingWindowSizeOverride(settings.textAutosizingWindowSizeOverride())
  61     , m_originalTextAutosizingUsesIdempotentMode(settings.textAutosizingUsesIdempotentMode())
  62 #endif
  63     , m_originalMediaTypeOverride(settings.mediaTypeOverride())
  64     , m_originalCanvasUsesAcceleratedDrawing(settings.canvasUsesAcceleratedDrawing())
  65     , m_originalMockScrollbarsEnabled(DeprecatedGlobalSettings::mockScrollbarsEnabled())
  66     , m_imagesEnabled(settings.areImagesEnabled())
  67     , m_preferMIMETypeForImages(settings.preferMIMETypeForImages())
  68     , m_minimumDOMTimerInterval(settings.minimumDOMTimerInterval())
  69 #if ENABLE(VIDEO_TRACK)
  70     , m_shouldDisplaySubtitles(settings.shouldDisplaySubtitles())
  71     , m_shouldDisplayCaptions(settings.shouldDisplayCaptions())
  72     , m_shouldDisplayTextDescriptions(settings.shouldDisplayTextDescriptions())
  73 #endif
  74     , m_defaultVideoPosterURL(settings.defaultVideoPosterURL())
  75     , m_forcePendingWebGLPolicy(settings.isForcePendingWebGLPolicy())
  76     , m_originalTimeWithoutMouseMovementBeforeHidingControls(settings.timeWithoutMouseMovementBeforeHidingControls())
  77     , m_useLegacyBackgroundSizeShorthandBehavior(settings.useLegacyBackgroundSizeShorthandBehavior())
  78     , m_autoscrollForDragAndDropEnabled(settings.autoscrollForDragAndDropEnabled())
  79     , m_quickTimePluginReplacementEnabled(settings.quickTimePluginReplacementEnabled())
  80     , m_youTubeFlashPluginReplacementEnabled(settings.youTubeFlashPluginReplacementEnabled())
  81     , m_shouldConvertPositionStyleOnCopy(settings.shouldConvertPositionStyleOnCopy())
  82     , m_fontFallbackPrefersPictographs(settings.fontFallbackPrefersPictographs())
  83     , m_shouldIgnoreFontLoadCompletions(settings.shouldIgnoreFontLoadCompletions())
  84     , m_backgroundShouldExtendBeyondPage(settings.backgroundShouldExtendBeyondPage())
  85     , m_storageBlockingPolicy(settings.storageBlockingPolicy())
  86     , m_scrollingTreeIncludesFrames(settings.scrollingTreeIncludesFrames())
  87 #if ENABLE(TOUCH_EVENTS)
  88     , m_touchEventEmulationEnabled(settings.isTouchEventEmulationEnabled())
  89 #endif
  90 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
  91     , m_allowsAirPlayForMediaPlayback(settings.allowsAirPlayForMediaPlayback())
  92 #endif
  93     , m_allowsInlineMediaPlayback(settings.allowsInlineMediaPlayback())
  94     , m_allowsInlineMediaPlaybackAfterFullscreen(settings.allowsInlineMediaPlaybackAfterFullscreen())
  95     , m_inlineMediaPlaybackRequiresPlaysInlineAttribute(settings.inlineMediaPlaybackRequiresPlaysInlineAttribute())
  96     , m_deferredCSSParserEnabled(settings.deferredCSSParserEnabled())
  97     , m_inputEventsEnabled(settings.inputEventsEnabled())
  98     , m_incompleteImageBorderEnabled(settings.incompleteImageBorderEnabled())
  99     , m_shouldDispatchSyntheticMouseEventsWhenModifyingSelection(settings.shouldDispatchSyntheticMouseEventsWhenModifyingSelection())
 100     , m_shouldDispatchSyntheticMouseOutAfterSyntheticClick(settings.shouldDispatchSyntheticMouseOutAfterSyntheticClick())
 101     , m_shouldDeactivateAudioSession(PlatformMediaSessionManager::shouldDeactivateAudioSession())
 102     , m_animatedImageDebugCanvasDrawingEnabled(settings.animatedImageDebugCanvasDrawingEnabled())
 103     , m_userInterfaceDirectionPolicy(settings.userInterfaceDirectionPolicy())
 104     , m_systemLayoutDirection(settings.systemLayoutDirection())
 105     , m_pdfImageCachingPolicy(settings.pdfImageCachingPolicy())
 106     , m_forcedColorsAreInvertedAccessibilityValue(settings.forcedColorsAreInvertedAccessibilityValue())
 107     , m_forcedDisplayIsMonochromeAccessibilityValue(settings.forcedDisplayIsMonochromeAccessibilityValue())
 108     , m_forcedPrefersReducedMotionAccessibilityValue(settings.forcedPrefersReducedMotionAccessibilityValue())
 109     , m_fontLoadTimingOverride(settings.fontLoadTimingOverride())
 110     , m_frameFlattening(settings.frameFlattening())
 111 #if ENABLE(INDEXED_DATABASE_IN_WORKERS)
 112     , m_indexedDBWorkersEnabled(RuntimeEnabledFeatures::sharedFeatures().indexedDBWorkersEnabled())
 113 #endif
 114 #if ENABLE(WEBGL2)
 115     , m_webGL2Enabled(RuntimeEnabledFeatures::sharedFeatures().webGL2Enabled())
 116 #endif
 117     , m_webVREnabled(RuntimeEnabledFeatures::sharedFeatures().webVREnabled())
 118 #if ENABLE(MEDIA_STREAM)
 119     , m_setScreenCaptureEnabled(RuntimeEnabledFeatures::sharedFeatures().screenCaptureEnabled())
 120 #endif
 121     , m_shouldMockBoldSystemFontForAccessibility(RenderTheme::singleton().shouldMockBoldSystemFontForAccessibility())
 122 #if USE(AUDIO_SESSION)
 123     , m_shouldManageAudioSessionCategory(DeprecatedGlobalSettings::shouldManageAudioSessionCategory())
 124 #endif
 125     , m_customPasteboardDataEnabled(RuntimeEnabledFeatures::sharedFeatures().customPasteboardDataEnabled())
 126 {
 127 }
 128 
 129 void InternalSettings::Backup::restoreTo(Settings&amp; settings)
 130 {
 131     settings.setEditingBehaviorType(m_originalEditingBehavior);
 132 
 133     for (const auto&amp; standardFont : m_standardFontFamilies)
 134         settings.setStandardFontFamily(standardFont.value, static_cast&lt;UScriptCode&gt;(standardFont.key));
 135     m_standardFontFamilies.clear();
 136 
 137     for (const auto&amp; fixedFont : m_fixedFontFamilies)
 138         settings.setFixedFontFamily(fixedFont.value, static_cast&lt;UScriptCode&gt;(fixedFont.key));
 139     m_fixedFontFamilies.clear();
 140 
 141     for (const auto&amp; serifFont : m_serifFontFamilies)
 142         settings.setSerifFontFamily(serifFont.value, static_cast&lt;UScriptCode&gt;(serifFont.key));
 143     m_serifFontFamilies.clear();
 144 
 145     for (const auto&amp; sansSerifFont : m_sansSerifFontFamilies)
 146         settings.setSansSerifFontFamily(sansSerifFont.value, static_cast&lt;UScriptCode&gt;(sansSerifFont.key));
 147     m_sansSerifFontFamilies.clear();
 148 
 149     for (const auto&amp; cursiveFont : m_cursiveFontFamilies)
 150         settings.setCursiveFontFamily(cursiveFont.value, static_cast&lt;UScriptCode&gt;(cursiveFont.key));
 151     m_cursiveFontFamilies.clear();
 152 
 153     for (const auto&amp; fantasyFont : m_fantasyFontFamilies)
 154         settings.setFantasyFontFamily(fantasyFont.value, static_cast&lt;UScriptCode&gt;(fantasyFont.key));
 155     m_fantasyFontFamilies.clear();
 156 
 157     for (const auto&amp; pictographFont : m_pictographFontFamilies)
 158         settings.setPictographFontFamily(pictographFont.value, static_cast&lt;UScriptCode&gt;(pictographFont.key));
 159     m_pictographFontFamilies.clear();
 160 
 161 #if ENABLE(TEXT_AUTOSIZING)
 162     settings.setTextAutosizingEnabled(m_originalTextAutosizingEnabled);
 163     settings.setTextAutosizingWindowSizeOverride(m_originalTextAutosizingWindowSizeOverride);
 164     settings.setTextAutosizingUsesIdempotentMode(m_originalTextAutosizingUsesIdempotentMode);
 165 #endif
 166     settings.setMediaTypeOverride(m_originalMediaTypeOverride);
 167     settings.setCanvasUsesAcceleratedDrawing(m_originalCanvasUsesAcceleratedDrawing);
 168     settings.setImagesEnabled(m_imagesEnabled);
 169     settings.setPreferMIMETypeForImages(m_preferMIMETypeForImages);
 170     settings.setMinimumDOMTimerInterval(m_minimumDOMTimerInterval);
 171 #if ENABLE(VIDEO_TRACK)
 172     settings.setShouldDisplaySubtitles(m_shouldDisplaySubtitles);
 173     settings.setShouldDisplayCaptions(m_shouldDisplayCaptions);
 174     settings.setShouldDisplayTextDescriptions(m_shouldDisplayTextDescriptions);
 175 #endif
 176     settings.setDefaultVideoPosterURL(m_defaultVideoPosterURL);
 177     settings.setForcePendingWebGLPolicy(m_forcePendingWebGLPolicy);
 178     settings.setTimeWithoutMouseMovementBeforeHidingControls(m_originalTimeWithoutMouseMovementBeforeHidingControls);
 179     settings.setUseLegacyBackgroundSizeShorthandBehavior(m_useLegacyBackgroundSizeShorthandBehavior);
 180     settings.setAutoscrollForDragAndDropEnabled(m_autoscrollForDragAndDropEnabled);
 181     settings.setShouldConvertPositionStyleOnCopy(m_shouldConvertPositionStyleOnCopy);
 182     settings.setFontFallbackPrefersPictographs(m_fontFallbackPrefersPictographs);
 183     settings.setShouldIgnoreFontLoadCompletions(m_shouldIgnoreFontLoadCompletions);
 184     settings.setBackgroundShouldExtendBeyondPage(m_backgroundShouldExtendBeyondPage);
 185     settings.setStorageBlockingPolicy(m_storageBlockingPolicy);
 186     settings.setScrollingTreeIncludesFrames(m_scrollingTreeIncludesFrames);
 187 #if ENABLE(TOUCH_EVENTS)
 188     settings.setTouchEventEmulationEnabled(m_touchEventEmulationEnabled);
 189 #endif
 190     settings.setAllowsInlineMediaPlayback(m_allowsInlineMediaPlayback);
 191     settings.setAllowsInlineMediaPlaybackAfterFullscreen(m_allowsInlineMediaPlaybackAfterFullscreen);
 192     settings.setInlineMediaPlaybackRequiresPlaysInlineAttribute(m_inlineMediaPlaybackRequiresPlaysInlineAttribute);
 193     settings.setQuickTimePluginReplacementEnabled(m_quickTimePluginReplacementEnabled);
 194     settings.setYouTubeFlashPluginReplacementEnabled(m_youTubeFlashPluginReplacementEnabled);
 195     settings.setDeferredCSSParserEnabled(m_deferredCSSParserEnabled);
 196     settings.setInputEventsEnabled(m_inputEventsEnabled);
 197     settings.setUserInterfaceDirectionPolicy(m_userInterfaceDirectionPolicy);
 198     settings.setSystemLayoutDirection(m_systemLayoutDirection);
 199     settings.setPdfImageCachingPolicy(m_pdfImageCachingPolicy);
 200     settings.setForcedColorsAreInvertedAccessibilityValue(m_forcedColorsAreInvertedAccessibilityValue);
 201     settings.setForcedDisplayIsMonochromeAccessibilityValue(m_forcedDisplayIsMonochromeAccessibilityValue);
 202     settings.setForcedPrefersReducedMotionAccessibilityValue(m_forcedPrefersReducedMotionAccessibilityValue);
 203     settings.setFontLoadTimingOverride(m_fontLoadTimingOverride);
 204     DeprecatedGlobalSettings::setAllowsAnySSLCertificate(false);
 205     RenderTheme::singleton().setShouldMockBoldSystemFontForAccessibility(m_shouldMockBoldSystemFontForAccessibility);
 206     FontCache::singleton().setShouldMockBoldSystemFontForAccessibility(m_shouldMockBoldSystemFontForAccessibility);
 207     settings.setFrameFlattening(m_frameFlattening);
 208     settings.setIncompleteImageBorderEnabled(m_incompleteImageBorderEnabled);
 209     settings.setShouldDispatchSyntheticMouseEventsWhenModifyingSelection(m_shouldDispatchSyntheticMouseEventsWhenModifyingSelection);
 210     settings.setShouldDispatchSyntheticMouseOutAfterSyntheticClick(m_shouldDispatchSyntheticMouseOutAfterSyntheticClick);
 211     PlatformMediaSessionManager::setShouldDeactivateAudioSession(m_shouldDeactivateAudioSession);
 212     settings.setAnimatedImageDebugCanvasDrawingEnabled(m_animatedImageDebugCanvasDrawingEnabled);
 213 
 214 #if ENABLE(INDEXED_DATABASE_IN_WORKERS)
 215     RuntimeEnabledFeatures::sharedFeatures().setIndexedDBWorkersEnabled(m_indexedDBWorkersEnabled);
 216 #endif
 217 #if ENABLE(WEBGL2)
 218     RuntimeEnabledFeatures::sharedFeatures().setWebGL2Enabled(m_webGL2Enabled);
 219 #endif
 220     RuntimeEnabledFeatures::sharedFeatures().setWebVREnabled(m_webVREnabled);
 221 #if ENABLE(MEDIA_STREAM)
 222     RuntimeEnabledFeatures::sharedFeatures().setScreenCaptureEnabled(m_setScreenCaptureEnabled);
 223 #endif
 224     RuntimeEnabledFeatures::sharedFeatures().setCustomPasteboardDataEnabled(m_customPasteboardDataEnabled);
 225 
 226 #if USE(AUDIO_SESSION)
 227     DeprecatedGlobalSettings::setShouldManageAudioSessionCategory(m_shouldManageAudioSessionCategory);
 228 #endif
 229 }
 230 
 231 class InternalSettingsWrapper : public Supplement&lt;Page&gt; {
 232     WTF_MAKE_FAST_ALLOCATED;
 233 public:
 234     explicit InternalSettingsWrapper(Page* page)
 235         : m_internalSettings(InternalSettings::create(page)) { }
 236     virtual ~InternalSettingsWrapper() { m_internalSettings-&gt;hostDestroyed(); }
 237 #if !ASSERT_DISABLED
 238     bool isRefCountedWrapper() const override { return true; }
 239 #endif
 240     InternalSettings* internalSettings() const { return m_internalSettings.get(); }
 241 
 242 private:
 243     RefPtr&lt;InternalSettings&gt; m_internalSettings;
 244 };
 245 
 246 const char* InternalSettings::supplementName()
 247 {
 248     return &quot;InternalSettings&quot;;
 249 }
 250 
 251 InternalSettings* InternalSettings::from(Page* page)
 252 {
 253     if (!Supplement&lt;Page&gt;::from(page, supplementName()))
 254         Supplement&lt;Page&gt;::provideTo(page, supplementName(), makeUnique&lt;InternalSettingsWrapper&gt;(page));
 255     return static_cast&lt;InternalSettingsWrapper*&gt;(Supplement&lt;Page&gt;::from(page, supplementName()))-&gt;internalSettings();
 256 }
 257 
 258 void InternalSettings::hostDestroyed()
 259 {
 260     m_page = nullptr;
 261 }
 262 
 263 InternalSettings::InternalSettings(Page* page)
 264     : InternalSettingsGenerated(page)
 265     , m_page(page)
 266     , m_backup(page-&gt;settings())
 267 {
 268 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
 269     setAllowsAirPlayForMediaPlayback(false);
 270 #endif
 271 #if ENABLE(MEDIA_STREAM)
 272     setMediaCaptureRequiresSecureConnection(false);
 273 #endif
 274 }
 275 
 276 Ref&lt;InternalSettings&gt; InternalSettings::create(Page* page)
 277 {
 278     return adoptRef(*new InternalSettings(page));
 279 }
 280 
 281 void InternalSettings::resetToConsistentState()
 282 {
 283     m_page-&gt;setPageScaleFactor(1, { 0, 0 });
 284     m_page-&gt;mainFrame().setPageAndTextZoomFactors(1, 1);
 285     m_page-&gt;setCanStartMedia(true);
 286     setUseDarkAppearanceInternal(false);
 287 
 288     settings().setForcePendingWebGLPolicy(false);
 289 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
 290     settings().setAllowsAirPlayForMediaPlayback(false);
 291 #endif
 292 #if ENABLE(MEDIA_STREAM)
 293     setMediaCaptureRequiresSecureConnection(false);
 294 #endif
 295 
 296     m_backup.restoreTo(settings());
 297     m_backup = Backup { settings() };
 298 
 299     InternalSettingsGenerated::resetToConsistentState();
 300 }
 301 
 302 Settings&amp; InternalSettings::settings() const
 303 {
 304     ASSERT(m_page);
 305     return m_page-&gt;settings();
 306 }
 307 
 308 ExceptionOr&lt;void&gt; InternalSettings::setTouchEventEmulationEnabled(bool enabled)
 309 {
 310     if (!m_page)
 311         return Exception { InvalidAccessError };
 312 #if ENABLE(TOUCH_EVENTS)
 313     settings().setTouchEventEmulationEnabled(enabled);
 314 #else
 315     UNUSED_PARAM(enabled);
 316 #endif
 317     return { };
 318 }
 319 
 320 ExceptionOr&lt;void&gt; InternalSettings::setStandardFontFamily(const String&amp; family, const String&amp; script)
 321 {
 322     if (!m_page)
 323         return Exception { InvalidAccessError };
 324     UScriptCode code = scriptNameToCode(script);
 325     if (code == USCRIPT_INVALID_CODE)
 326         return { };
 327     m_backup.m_standardFontFamilies.add(code, settings().standardFontFamily(code));
 328     settings().setStandardFontFamily(family, code);
 329     return { };
 330 }
 331 
 332 ExceptionOr&lt;void&gt; InternalSettings::setSerifFontFamily(const String&amp; family, const String&amp; script)
 333 {
 334     if (!m_page)
 335         return Exception { InvalidAccessError };
 336     UScriptCode code = scriptNameToCode(script);
 337     if (code == USCRIPT_INVALID_CODE)
 338         return { };
 339     m_backup.m_serifFontFamilies.add(code, settings().serifFontFamily(code));
 340     settings().setSerifFontFamily(family, code);
 341     return { };
 342 }
 343 
 344 ExceptionOr&lt;void&gt; InternalSettings::setSansSerifFontFamily(const String&amp; family, const String&amp; script)
 345 {
 346     if (!m_page)
 347         return Exception { InvalidAccessError };
 348     UScriptCode code = scriptNameToCode(script);
 349     if (code == USCRIPT_INVALID_CODE)
 350         return { };
 351     m_backup.m_sansSerifFontFamilies.add(code, settings().sansSerifFontFamily(code));
 352     settings().setSansSerifFontFamily(family, code);
 353     return { };
 354 }
 355 
 356 ExceptionOr&lt;void&gt; InternalSettings::setFixedFontFamily(const String&amp; family, const String&amp; script)
 357 {
 358     if (!m_page)
 359         return Exception { InvalidAccessError };
 360     UScriptCode code = scriptNameToCode(script);
 361     if (code == USCRIPT_INVALID_CODE)
 362         return { };
 363     m_backup.m_fixedFontFamilies.add(code, settings().fixedFontFamily(code));
 364     settings().setFixedFontFamily(family, code);
 365     return { };
 366 }
 367 
 368 ExceptionOr&lt;void&gt; InternalSettings::setCursiveFontFamily(const String&amp; family, const String&amp; script)
 369 {
 370     if (!m_page)
 371         return Exception { InvalidAccessError };
 372     UScriptCode code = scriptNameToCode(script);
 373     if (code == USCRIPT_INVALID_CODE)
 374         return { };
 375     m_backup.m_cursiveFontFamilies.add(code, settings().cursiveFontFamily(code));
 376     settings().setCursiveFontFamily(family, code);
 377     return { };
 378 }
 379 
 380 ExceptionOr&lt;void&gt; InternalSettings::setFantasyFontFamily(const String&amp; family, const String&amp; script)
 381 {
 382     if (!m_page)
 383         return Exception { InvalidAccessError };
 384     UScriptCode code = scriptNameToCode(script);
 385     if (code == USCRIPT_INVALID_CODE)
 386         return { };
 387     m_backup.m_fantasyFontFamilies.add(code, settings().fantasyFontFamily(code));
 388     settings().setFantasyFontFamily(family, code);
 389     return { };
 390 }
 391 
 392 ExceptionOr&lt;void&gt; InternalSettings::setPictographFontFamily(const String&amp; family, const String&amp; script)
 393 {
 394     if (!m_page)
 395         return Exception { InvalidAccessError };
 396     UScriptCode code = scriptNameToCode(script);
 397     if (code == USCRIPT_INVALID_CODE)
 398         return { };
 399     m_backup.m_pictographFontFamilies.add(code, settings().pictographFontFamily(code));
 400     settings().setPictographFontFamily(family, code);
 401     return { };
 402 }
 403 
 404 ExceptionOr&lt;void&gt; InternalSettings::setTextAutosizingEnabled(bool enabled)
 405 {
 406     if (!m_page)
 407         return Exception { InvalidAccessError };
 408 #if ENABLE(TEXT_AUTOSIZING)
 409     settings().setTextAutosizingEnabled(enabled);
 410 #else
 411     UNUSED_PARAM(enabled);
 412 #endif
 413     return { };
 414 }
 415 
 416 ExceptionOr&lt;void&gt; InternalSettings::setTextAutosizingWindowSizeOverride(int width, int height)
 417 {
 418     if (!m_page)
 419         return Exception { InvalidAccessError };
 420 #if ENABLE(TEXT_AUTOSIZING)
 421     settings().setTextAutosizingWindowSizeOverride(IntSize(width, height));
 422 #else
 423     UNUSED_PARAM(width);
 424     UNUSED_PARAM(height);
 425 #endif
 426     return { };
 427 }
 428 
 429 ExceptionOr&lt;void&gt; InternalSettings::setTextAutosizingUsesIdempotentMode(bool enabled)
 430 {
 431     if (!m_page)
 432         return Exception { InvalidAccessError };
 433 #if ENABLE(TEXT_AUTOSIZING)
 434     settings().setTextAutosizingUsesIdempotentMode(enabled);
 435 #else
 436     UNUSED_PARAM(enabled);
 437 #endif
 438     return { };
 439 }
 440 
 441 ExceptionOr&lt;void&gt; InternalSettings::setMediaTypeOverride(const String&amp; mediaType)
 442 {
 443     if (!m_page)
 444         return Exception { InvalidAccessError };
 445     settings().setMediaTypeOverride(mediaType);
 446     return { };
 447 }
 448 
 449 ExceptionOr&lt;void&gt; InternalSettings::setCanStartMedia(bool enabled)
 450 {
 451     if (!m_page)
 452         return Exception { InvalidAccessError };
 453     m_page-&gt;setCanStartMedia(enabled);
 454     return { };
 455 }
 456 
 457 ExceptionOr&lt;void&gt; InternalSettings::setAllowsAirPlayForMediaPlayback(bool allows)
 458 {
 459     if (!m_page)
 460         return Exception { InvalidAccessError };
 461 #if ENABLE(WIRELESS_PLAYBACK_TARGET)
 462     settings().setAllowsAirPlayForMediaPlayback(allows);
 463 #else
 464     UNUSED_PARAM(allows);
 465 #endif
 466     return { };
 467 }
 468 
 469 ExceptionOr&lt;void&gt; InternalSettings::setMediaCaptureRequiresSecureConnection(bool requires)
 470 {
 471     if (!m_page)
 472         return Exception { InvalidAccessError };
 473 #if ENABLE(MEDIA_STREAM)
 474     m_page-&gt;settings().setMediaCaptureRequiresSecureConnection(requires);
 475 #else
 476     UNUSED_PARAM(requires);
 477 #endif
 478     return { };
 479 }
 480 
 481 ExceptionOr&lt;void&gt; InternalSettings::setEditingBehavior(const String&amp; editingBehavior)
 482 {
 483     if (!m_page)
 484         return Exception { InvalidAccessError };
 485     if (equalLettersIgnoringASCIICase(editingBehavior, &quot;win&quot;))
 486         settings().setEditingBehaviorType(EditingWindowsBehavior);
 487     else if (equalLettersIgnoringASCIICase(editingBehavior, &quot;mac&quot;))
 488         settings().setEditingBehaviorType(EditingMacBehavior);
 489     else if (equalLettersIgnoringASCIICase(editingBehavior, &quot;unix&quot;))
 490         settings().setEditingBehaviorType(EditingUnixBehavior);
 491     else if (equalLettersIgnoringASCIICase(editingBehavior, &quot;ios&quot;))
 492         settings().setEditingBehaviorType(EditingIOSBehavior);
 493     else
 494         return Exception { SyntaxError };
 495     return { };
 496 }
 497 
 498 ExceptionOr&lt;void&gt; InternalSettings::setShouldDisplayTrackKind(const String&amp; kind, bool enabled)
 499 {
 500     if (!m_page)
 501         return Exception { InvalidAccessError };
 502 #if ENABLE(VIDEO_TRACK)
 503     auto&amp; captionPreferences = m_page-&gt;group().captionPreferences();
 504     if (equalLettersIgnoringASCIICase(kind, &quot;subtitles&quot;))
 505         captionPreferences.setUserPrefersSubtitles(enabled);
 506     else if (equalLettersIgnoringASCIICase(kind, &quot;captions&quot;))
 507         captionPreferences.setUserPrefersCaptions(enabled);
 508     else if (equalLettersIgnoringASCIICase(kind, &quot;textdescriptions&quot;))
 509         captionPreferences.setUserPrefersTextDescriptions(enabled);
 510     else
 511         return Exception { SyntaxError };
 512 #else
 513     UNUSED_PARAM(kind);
 514     UNUSED_PARAM(enabled);
 515 #endif
 516     return { };
 517 }
 518 
 519 ExceptionOr&lt;bool&gt; InternalSettings::shouldDisplayTrackKind(const String&amp; kind)
 520 {
 521     if (!m_page)
 522         return Exception { InvalidAccessError };
 523 #if ENABLE(VIDEO_TRACK)
 524     auto&amp; captionPreferences = m_page-&gt;group().captionPreferences();
 525     if (equalLettersIgnoringASCIICase(kind, &quot;subtitles&quot;))
 526         return captionPreferences.userPrefersSubtitles();
 527     if (equalLettersIgnoringASCIICase(kind, &quot;captions&quot;))
 528         return captionPreferences.userPrefersCaptions();
 529     if (equalLettersIgnoringASCIICase(kind, &quot;textdescriptions&quot;))
 530         return captionPreferences.userPrefersTextDescriptions();
 531 
 532     return Exception { SyntaxError };
 533 #else
 534     UNUSED_PARAM(kind);
 535     return false;
 536 #endif
 537 }
 538 
 539 void InternalSettings::setUseDarkAppearanceInternal(bool useDarkAppearance)
 540 {
 541     ASSERT(m_page);
 542     m_page-&gt;effectiveAppearanceDidChange(useDarkAppearance, m_page-&gt;useElevatedUserInterfaceLevel());
 543 }
 544 
 545 ExceptionOr&lt;void&gt; InternalSettings::setUseDarkAppearance(bool useDarkAppearance)
 546 {
 547     if (!m_page)
 548         return Exception { InvalidAccessError };
 549     setUseDarkAppearanceInternal(useDarkAppearance);
 550     return { };
 551 }
 552 
 553 ExceptionOr&lt;void&gt; InternalSettings::setStorageBlockingPolicy(const String&amp; mode)
 554 {
 555     if (!m_page)
 556         return Exception { InvalidAccessError };
 557     if (mode == &quot;AllowAll&quot;)
 558         settings().setStorageBlockingPolicy(SecurityOrigin::AllowAllStorage);
 559     else if (mode == &quot;BlockThirdParty&quot;)
 560         settings().setStorageBlockingPolicy(SecurityOrigin::BlockThirdPartyStorage);
 561     else if (mode == &quot;BlockAll&quot;)
 562         settings().setStorageBlockingPolicy(SecurityOrigin::BlockAllStorage);
 563     else
 564         return Exception { SyntaxError };
 565     return { };
 566 }
 567 
 568 ExceptionOr&lt;void&gt; InternalSettings::setPreferMIMETypeForImages(bool preferMIMETypeForImages)
 569 {
 570     if (!m_page)
 571         return Exception { InvalidAccessError };
 572     settings().setPreferMIMETypeForImages(preferMIMETypeForImages);
 573     return { };
 574 }
 575 
 576 ExceptionOr&lt;void&gt; InternalSettings::setImagesEnabled(bool enabled)
 577 {
 578     if (!m_page)
 579         return Exception { InvalidAccessError };
 580     settings().setImagesEnabled(enabled);
 581     return { };
 582 }
 583 
 584 ExceptionOr&lt;void&gt; InternalSettings::setPDFImageCachingPolicy(const String&amp; policy)
 585 {
 586     if (!m_page)
 587         return Exception { InvalidAccessError };
 588     if (equalLettersIgnoringASCIICase(policy, &quot;disabled&quot;))
 589         settings().setPdfImageCachingPolicy(PDFImageCachingDisabled);
 590     else if (equalLettersIgnoringASCIICase(policy, &quot;belowmemorylimit&quot;))
 591         settings().setPdfImageCachingPolicy(PDFImageCachingBelowMemoryLimit);
 592     else if (equalLettersIgnoringASCIICase(policy, &quot;clipboundsonly&quot;))
 593         settings().setPdfImageCachingPolicy(PDFImageCachingClipBoundsOnly);
 594     else if (equalLettersIgnoringASCIICase(policy, &quot;enabled&quot;))
 595         settings().setPdfImageCachingPolicy(PDFImageCachingEnabled);
 596     else
 597         return Exception { SyntaxError };
 598     return { };
 599 }
 600 
 601 ExceptionOr&lt;void&gt; InternalSettings::setMinimumTimerInterval(double intervalInSeconds)
 602 {
 603     if (!m_page)
 604         return Exception { InvalidAccessError };
 605     settings().setMinimumDOMTimerInterval(Seconds { intervalInSeconds });
 606     return { };
 607 }
 608 
 609 ExceptionOr&lt;void&gt; InternalSettings::setDefaultVideoPosterURL(const String&amp; url)
 610 {
 611     if (!m_page)
 612         return Exception { InvalidAccessError };
 613     settings().setDefaultVideoPosterURL(url);
 614     return { };
 615 }
 616 
 617 ExceptionOr&lt;void&gt; InternalSettings::setForcePendingWebGLPolicy(bool forced)
 618 {
 619     if (!m_page)
 620         return Exception { InvalidAccessError };
 621     settings().setForcePendingWebGLPolicy(forced);
 622     return { };
 623 }
 624 
 625 ExceptionOr&lt;void&gt; InternalSettings::setTimeWithoutMouseMovementBeforeHidingControls(double time)
 626 {
 627     if (!m_page)
 628         return Exception { InvalidAccessError };
 629     settings().setTimeWithoutMouseMovementBeforeHidingControls(Seconds { time });
 630     return { };
 631 }
 632 
 633 ExceptionOr&lt;void&gt; InternalSettings::setUseLegacyBackgroundSizeShorthandBehavior(bool enabled)
 634 {
 635     if (!m_page)
 636         return Exception { InvalidAccessError };
 637     settings().setUseLegacyBackgroundSizeShorthandBehavior(enabled);
 638     return { };
 639 }
 640 
 641 ExceptionOr&lt;void&gt; InternalSettings::setAutoscrollForDragAndDropEnabled(bool enabled)
 642 {
 643     if (!m_page)
 644         return Exception { InvalidAccessError };
 645     settings().setAutoscrollForDragAndDropEnabled(enabled);
 646     return { };
 647 }
 648 
 649 ExceptionOr&lt;void&gt; InternalSettings::setFontFallbackPrefersPictographs(bool preferPictographs)
 650 {
 651     if (!m_page)
 652         return Exception { InvalidAccessError };
 653     settings().setFontFallbackPrefersPictographs(preferPictographs);
 654     return { };
 655 }
 656 
 657 ExceptionOr&lt;void&gt; InternalSettings::setFontLoadTimingOverride(const FontLoadTimingOverride&amp; fontLoadTimingOverride)
 658 {
 659     if (!m_page)
 660         return Exception { InvalidAccessError };
 661     auto policy = Settings::FontLoadTimingOverride::None;
 662     switch (fontLoadTimingOverride) {
 663     case FontLoadTimingOverride::Block:
 664         policy = Settings::FontLoadTimingOverride::Block;
 665         break;
 666     case FontLoadTimingOverride::Swap:
 667         policy = Settings::FontLoadTimingOverride::Swap;
 668         break;
 669     case FontLoadTimingOverride::Failure:
 670         policy = Settings::FontLoadTimingOverride::Failure;
 671         break;
 672     }
 673     settings().setFontLoadTimingOverride(policy);
 674     return { };
 675 }
 676 
 677 ExceptionOr&lt;void&gt; InternalSettings::setShouldIgnoreFontLoadCompletions(bool ignore)
 678 {
 679     if (!m_page)
 680         return Exception { InvalidAccessError };
 681     settings().setShouldIgnoreFontLoadCompletions(ignore);
 682     return { };
 683 }
 684 
 685 ExceptionOr&lt;void&gt; InternalSettings::setQuickTimePluginReplacementEnabled(bool enabled)
 686 {
 687     if (!m_page)
 688         return Exception { InvalidAccessError };
 689     settings().setQuickTimePluginReplacementEnabled(enabled);
 690     return { };
 691 }
 692 
 693 ExceptionOr&lt;void&gt; InternalSettings::setYouTubeFlashPluginReplacementEnabled(bool enabled)
 694 {
 695     if (!m_page)
 696         return Exception { InvalidAccessError };
 697     settings().setYouTubeFlashPluginReplacementEnabled(enabled);
 698     return { };
 699 }
 700 
 701 ExceptionOr&lt;void&gt; InternalSettings::setBackgroundShouldExtendBeyondPage(bool hasExtendedBackground)
 702 {
 703     if (!m_page)
 704         return Exception { InvalidAccessError };
 705     settings().setBackgroundShouldExtendBeyondPage(hasExtendedBackground);
 706     return { };
 707 }
 708 
 709 ExceptionOr&lt;void&gt; InternalSettings::setShouldConvertPositionStyleOnCopy(bool convert)
 710 {
 711     if (!m_page)
 712         return Exception { InvalidAccessError };
 713     settings().setShouldConvertPositionStyleOnCopy(convert);
 714     return { };
 715 }
 716 
 717 ExceptionOr&lt;void&gt; InternalSettings::setScrollingTreeIncludesFrames(bool enabled)
 718 {
 719     if (!m_page)
 720         return Exception { InvalidAccessError };
 721     settings().setScrollingTreeIncludesFrames(enabled);
 722     return { };
 723 }
 724 
 725 ExceptionOr&lt;void&gt; InternalSettings::setAllowUnclampedScrollPosition(bool allowUnclamped)
 726 {
 727     if (!m_page || !m_page-&gt;mainFrame().view())
 728         return Exception { InvalidAccessError };
 729 
 730     m_page-&gt;mainFrame().view()-&gt;setAllowsUnclampedScrollPositionForTesting(allowUnclamped);
 731     return { };
 732 }
 733 
 734 ExceptionOr&lt;void&gt; InternalSettings::setAllowsInlineMediaPlayback(bool allows)
 735 {
 736     if (!m_page)
 737         return Exception { InvalidAccessError };
 738     settings().setAllowsInlineMediaPlayback(allows);
 739     return { };
 740 }
 741 
 742 ExceptionOr&lt;void&gt; InternalSettings::setAllowsInlineMediaPlaybackAfterFullscreen(bool allows)
 743 {
 744     if (!m_page)
 745         return Exception { InvalidAccessError };
 746     settings().setAllowsInlineMediaPlaybackAfterFullscreen(allows);
 747     return { };
 748 }
 749 
 750 ExceptionOr&lt;void&gt; InternalSettings::setInlineMediaPlaybackRequiresPlaysInlineAttribute(bool requires)
 751 {
 752     if (!m_page)
 753         return Exception { InvalidAccessError };
 754     settings().setInlineMediaPlaybackRequiresPlaysInlineAttribute(requires);
 755     return { };
 756 }
 757 
 758 ExceptionOr&lt;void&gt; InternalSettings::setShouldMockBoldSystemFontForAccessibility(bool requires)
 759 {
 760     if (!m_page)
 761         return Exception { InvalidAccessError };
 762     RenderTheme::singleton().setShouldMockBoldSystemFontForAccessibility(requires);
 763     FontCache::singleton().setShouldMockBoldSystemFontForAccessibility(requires);
 764     return { };
 765 }
 766 
 767 ExceptionOr&lt;void&gt; InternalSettings::setAnimatedImageDebugCanvasDrawingEnabled(bool ignore)
 768 {
 769     if (!m_page)
 770         return Exception { InvalidAccessError };
 771     settings().setAnimatedImageDebugCanvasDrawingEnabled(ignore);
 772     return { };
 773 }
 774 
 775 void InternalSettings::setIndexedDBWorkersEnabled(bool enabled)
 776 {
 777 #if ENABLE(INDEXED_DATABASE_IN_WORKERS)
 778     RuntimeEnabledFeatures::sharedFeatures().setIndexedDBWorkersEnabled(enabled);
 779 #else
 780     UNUSED_PARAM(enabled);
 781 #endif
 782 }
 783 
 784 void InternalSettings::setWebGL2Enabled(bool enabled)
 785 {
 786 #if ENABLE(WEBGL2)
 787     RuntimeEnabledFeatures::sharedFeatures().setWebGL2Enabled(enabled);
 788 #else
 789     UNUSED_PARAM(enabled);
 790 #endif
 791 }
 792 
 793 void InternalSettings::setWebGPUEnabled(bool enabled)
 794 {
 795 #if ENABLE(WEBGPU)
 796     RuntimeEnabledFeatures::sharedFeatures().setWebGPUEnabled(enabled);
 797 #else
 798     UNUSED_PARAM(enabled);
 799 #endif
 800 }
 801 
 802 void InternalSettings::setWebVREnabled(bool enabled)
 803 {
 804     RuntimeEnabledFeatures::sharedFeatures().setWebVREnabled(enabled);
 805 }
 806 
 807 void InternalSettings::setScreenCaptureEnabled(bool enabled)
 808 {
 809 #if ENABLE(MEDIA_STREAM)
 810     RuntimeEnabledFeatures::sharedFeatures().setScreenCaptureEnabled(enabled);
 811 #else
 812     UNUSED_PARAM(enabled);
 813 #endif
 814 }
 815 
 816 ExceptionOr&lt;String&gt; InternalSettings::userInterfaceDirectionPolicy()
 817 {
 818     if (!m_page)
 819         return Exception { InvalidAccessError };
 820     switch (settings().userInterfaceDirectionPolicy()) {
 821     case UserInterfaceDirectionPolicy::Content:
 822         return &quot;Content&quot;_str;
 823     case UserInterfaceDirectionPolicy::System:
 824         return &quot;View&quot;_str;
 825     }
 826     ASSERT_NOT_REACHED();
 827     return Exception { InvalidAccessError };
 828 }
 829 
 830 ExceptionOr&lt;void&gt; InternalSettings::setUserInterfaceDirectionPolicy(const String&amp; policy)
 831 {
 832     if (!m_page)
 833         return Exception { InvalidAccessError };
 834     if (equalLettersIgnoringASCIICase(policy, &quot;content&quot;)) {
 835         settings().setUserInterfaceDirectionPolicy(UserInterfaceDirectionPolicy::Content);
 836         return { };
 837     }
 838     if (equalLettersIgnoringASCIICase(policy, &quot;view&quot;)) {
 839         settings().setUserInterfaceDirectionPolicy(UserInterfaceDirectionPolicy::System);
 840         return { };
 841     }
 842     return Exception { InvalidAccessError };
 843 }
 844 
 845 ExceptionOr&lt;String&gt; InternalSettings::systemLayoutDirection()
 846 {
 847     if (!m_page)
 848         return Exception { InvalidAccessError };
 849     switch (settings().systemLayoutDirection()) {
 850     case TextDirection::LTR:
 851         return &quot;LTR&quot;_str;
 852     case TextDirection::RTL:
 853         return &quot;RTL&quot;_str;
 854     }
 855     ASSERT_NOT_REACHED();
 856     return Exception { InvalidAccessError };
 857 }
 858 
 859 ExceptionOr&lt;void&gt; InternalSettings::setSystemLayoutDirection(const String&amp; direction)
 860 {
 861     if (!m_page)
 862         return Exception { InvalidAccessError };
 863     if (equalLettersIgnoringASCIICase(direction, &quot;ltr&quot;)) {
 864         settings().setSystemLayoutDirection(TextDirection::LTR);
 865         return { };
 866     }
 867     if (equalLettersIgnoringASCIICase(direction, &quot;rtl&quot;)) {
 868         settings().setSystemLayoutDirection(TextDirection::RTL);
 869         return { };
 870     }
 871     return Exception { InvalidAccessError };
 872 }
 873 
 874 ExceptionOr&lt;void&gt; InternalSettings::setFrameFlattening(FrameFlatteningValue frameFlattening)
 875 {
 876     if (!m_page)
 877         return Exception { InvalidAccessError };
 878     settings().setFrameFlattening(frameFlattening);
 879     return { };
 880 }
 881 
 882 void InternalSettings::setAllowsAnySSLCertificate(bool allowsAnyCertificate)
 883 {
 884     DeprecatedGlobalSettings::setAllowsAnySSLCertificate(allowsAnyCertificate);
 885 #if USE(SOUP)
 886     SoupNetworkSession::setShouldIgnoreTLSErrors(allowsAnyCertificate);
 887 #endif
 888 }
 889 
 890 ExceptionOr&lt;bool&gt; InternalSettings::deferredCSSParserEnabled()
 891 {
 892     if (!m_page)
 893         return Exception { InvalidAccessError };
 894     return settings().deferredCSSParserEnabled();
 895 }
 896 
 897 ExceptionOr&lt;void&gt; InternalSettings::setDeferredCSSParserEnabled(bool enabled)
 898 {
 899     if (!m_page)
 900         return Exception { InvalidAccessError };
 901     settings().setDeferredCSSParserEnabled(enabled);
 902     return { };
 903 }
 904 
 905 ExceptionOr&lt;void&gt; InternalSettings::setShouldManageAudioSessionCategory(bool should)
 906 {
 907 #if USE(AUDIO_SESSION)
 908     DeprecatedGlobalSettings::setShouldManageAudioSessionCategory(should);
 909     return { };
 910 #else
 911     UNUSED_PARAM(should);
 912     return Exception { InvalidAccessError };
 913 #endif
 914 }
 915 
 916 ExceptionOr&lt;void&gt; InternalSettings::setCustomPasteboardDataEnabled(bool enabled)
 917 {
 918     RuntimeEnabledFeatures::sharedFeatures().setCustomPasteboardDataEnabled(enabled);
 919     return { };
 920 }
 921 
 922 ExceptionOr&lt;void&gt; InternalSettings::setIncompleteImageBorderEnabled(bool enabled)
 923 {
 924     if (!m_page)
 925         return Exception { InvalidAccessError };
 926     settings().setIncompleteImageBorderEnabled(enabled);
 927     return { };
 928 }
 929 
 930 ExceptionOr&lt;void&gt; InternalSettings::setShouldDispatchSyntheticMouseEventsWhenModifyingSelection(bool shouldDispatch)
 931 {
 932     if (!m_page)
 933         return Exception { InvalidAccessError };
 934     settings().setShouldDispatchSyntheticMouseEventsWhenModifyingSelection(shouldDispatch);
 935     return { };
 936 }
 937 
 938 ExceptionOr&lt;void&gt; InternalSettings::setShouldDispatchSyntheticMouseOutAfterSyntheticClick(bool shouldDispatch)
 939 {
 940     if (!m_page)
 941         return Exception { InvalidAccessError };
 942     settings().setShouldDispatchSyntheticMouseOutAfterSyntheticClick(shouldDispatch);
 943     return { };
 944 }
 945 
 946 static InternalSettings::ForcedAccessibilityValue settingsToInternalSettingsValue(Settings::ForcedAccessibilityValue value)
 947 {
 948     switch (value) {
 949     case Settings::ForcedAccessibilityValue::System:
 950         return InternalSettings::ForcedAccessibilityValue::System;
 951     case Settings::ForcedAccessibilityValue::On:
 952         return InternalSettings::ForcedAccessibilityValue::On;
 953     case Settings::ForcedAccessibilityValue::Off:
 954         return InternalSettings::ForcedAccessibilityValue::Off;
 955     }
 956 
 957     ASSERT_NOT_REACHED();
 958     return InternalSettings::ForcedAccessibilityValue::Off;
 959 }
 960 
 961 static Settings::ForcedAccessibilityValue internalSettingsToSettingsValue(InternalSettings::ForcedAccessibilityValue value)
 962 {
 963     switch (value) {
 964     case InternalSettings::ForcedAccessibilityValue::System:
 965         return Settings::ForcedAccessibilityValue::System;
 966     case InternalSettings::ForcedAccessibilityValue::On:
 967         return Settings::ForcedAccessibilityValue::On;
 968     case InternalSettings::ForcedAccessibilityValue::Off:
 969         return Settings::ForcedAccessibilityValue::Off;
 970     }
 971 
 972     ASSERT_NOT_REACHED();
 973     return Settings::ForcedAccessibilityValue::Off;
 974 }
 975 
 976 InternalSettings::ForcedAccessibilityValue InternalSettings::forcedColorsAreInvertedAccessibilityValue() const
 977 {
 978     return settingsToInternalSettingsValue(settings().forcedColorsAreInvertedAccessibilityValue());
 979 }
 980 
 981 void InternalSettings::setForcedColorsAreInvertedAccessibilityValue(InternalSettings::ForcedAccessibilityValue value)
 982 {
 983     settings().setForcedColorsAreInvertedAccessibilityValue(internalSettingsToSettingsValue(value));
 984 }
 985 
 986 InternalSettings::ForcedAccessibilityValue InternalSettings::forcedDisplayIsMonochromeAccessibilityValue() const
 987 {
 988     return settingsToInternalSettingsValue(settings().forcedDisplayIsMonochromeAccessibilityValue());
 989 }
 990 
 991 void InternalSettings::setForcedDisplayIsMonochromeAccessibilityValue(InternalSettings::ForcedAccessibilityValue value)
 992 {
 993     settings().setForcedDisplayIsMonochromeAccessibilityValue(internalSettingsToSettingsValue(value));
 994 }
 995 
 996 InternalSettings::ForcedAccessibilityValue InternalSettings::forcedPrefersReducedMotionAccessibilityValue() const
 997 {
 998     return settingsToInternalSettingsValue(settings().forcedPrefersReducedMotionAccessibilityValue());
 999 }
1000 
1001 void InternalSettings::setForcedPrefersReducedMotionAccessibilityValue(InternalSettings::ForcedAccessibilityValue value)
1002 {
1003     settings().setForcedPrefersReducedMotionAccessibilityValue(internalSettingsToSettingsValue(value));
1004 }
1005 
1006 bool InternalSettings::webAnimationsCSSIntegrationEnabled()
1007 {
1008     return RuntimeEnabledFeatures::sharedFeatures().webAnimationsCSSIntegrationEnabled();
1009 }
1010 
1011 void InternalSettings::setShouldDeactivateAudioSession(bool should)
1012 {
1013     PlatformMediaSessionManager::setShouldDeactivateAudioSession(should);
1014 }
1015 
1016 // If you add to this class, make sure that you update the Backup class for test reproducability!
1017 
1018 }
    </pre>
  </body>
</html>
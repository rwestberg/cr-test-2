<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/java.base/share/classes/java/lang/invoke/X-VarHandle.java.template</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center><a href="VarHandles.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="X-VarHandleByteArrayView.java.template.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.base/share/classes/java/lang/invoke/X-VarHandle.java.template</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  60 
  61         @Override
  62         final MethodType accessModeTypeUncached(AccessMode accessMode) {
  63             return accessMode.at.accessModeType(receiverType, {#if[Object]?fieldType:$type$.class});
  64         }
  65 
  66         @Override
  67         public Optional&lt;VarHandleDesc&gt; describeConstable() {
  68             var receiverTypeRef = receiverType.describeConstable();
  69             var fieldTypeRef = {#if[Object]?fieldType:$type$.class}.describeConstable();
  70             if (!receiverTypeRef.isPresent() || !fieldTypeRef.isPresent())
  71                 return Optional.empty();
  72 
  73             // Reflect on this VarHandle to extract the field name
  74             String name = VarHandles.getFieldFromReceiverAndOffset(
  75                 receiverType, fieldOffset, {#if[Object]?fieldType:$type$.class}).getName();
  76             return Optional.of(VarHandleDesc.ofField(receiverTypeRef.get(), name, fieldTypeRef.get()));
  77         }
  78 
  79         @ForceInline
<span class="line-modified">  80         static $type$ get(FieldInstanceReadOnly handle, Object holder) {</span>

  81             return UNSAFE.get$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
  82                                  handle.fieldOffset);
  83         }
  84 
  85         @ForceInline
<span class="line-modified">  86         static $type$ getVolatile(FieldInstanceReadOnly handle, Object holder) {</span>

  87             return UNSAFE.get$Type$Volatile(Objects.requireNonNull(handle.receiverType.cast(holder)),
  88                                  handle.fieldOffset);
  89         }
  90 
  91         @ForceInline
<span class="line-modified">  92         static $type$ getOpaque(FieldInstanceReadOnly handle, Object holder) {</span>

  93             return UNSAFE.get$Type$Opaque(Objects.requireNonNull(handle.receiverType.cast(holder)),
  94                                  handle.fieldOffset);
  95         }
  96 
  97         @ForceInline
<span class="line-modified">  98         static $type$ getAcquire(FieldInstanceReadOnly handle, Object holder) {</span>

  99             return UNSAFE.get$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 100                                  handle.fieldOffset);
 101         }
 102 
 103         static final VarForm FORM = new VarForm(FieldInstanceReadOnly.class, Object.class, $type$.class);
 104     }
 105 
 106     static final class FieldInstanceReadWrite extends FieldInstanceReadOnly {
 107 
 108         FieldInstanceReadWrite(Class&lt;?&gt; receiverType, long fieldOffset{#if[Object]?, Class&lt;?&gt; fieldType}) {
 109             super(receiverType, fieldOffset{#if[Object]?, fieldType}, FieldInstanceReadWrite.FORM);
 110         }
 111 
 112         @ForceInline
<span class="line-modified"> 113         static void set(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 114             UNSAFE.put$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 115                              handle.fieldOffset,
 116                              {#if[Object]?handle.fieldType.cast(value):value});
 117         }
 118 
 119         @ForceInline
<span class="line-modified"> 120         static void setVolatile(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 121             UNSAFE.put$Type$Volatile(Objects.requireNonNull(handle.receiverType.cast(holder)),
 122                                      handle.fieldOffset,
 123                                      {#if[Object]?handle.fieldType.cast(value):value});
 124         }
 125 
 126         @ForceInline
<span class="line-modified"> 127         static void setOpaque(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 128             UNSAFE.put$Type$Opaque(Objects.requireNonNull(handle.receiverType.cast(holder)),
 129                                    handle.fieldOffset,
 130                                    {#if[Object]?handle.fieldType.cast(value):value});
 131         }
 132 
 133         @ForceInline
<span class="line-modified"> 134         static void setRelease(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 135             UNSAFE.put$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 136                                     handle.fieldOffset,
 137                                     {#if[Object]?handle.fieldType.cast(value):value});
 138         }
 139 #if[CAS]
 140 
 141         @ForceInline
<span class="line-modified"> 142         static boolean compareAndSet(FieldInstanceReadWrite handle, Object holder, $type$ expected, $type$ value) {</span>

 143             return UNSAFE.compareAndSet$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 144                                                handle.fieldOffset,
 145                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 146                                                {#if[Object]?handle.fieldType.cast(value):value});
 147         }
 148 
 149         @ForceInline
<span class="line-modified"> 150         static $type$ compareAndExchange(FieldInstanceReadWrite handle, Object holder, $type$ expected, $type$ value) {</span>

 151             return UNSAFE.compareAndExchange$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 152                                                handle.fieldOffset,
 153                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 154                                                {#if[Object]?handle.fieldType.cast(value):value});
 155         }
 156 
 157         @ForceInline
<span class="line-modified"> 158         static $type$ compareAndExchangeAcquire(FieldInstanceReadWrite handle, Object holder, $type$ expected, $type$ value) {</span>

 159             return UNSAFE.compareAndExchange$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 160                                                handle.fieldOffset,
 161                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 162                                                {#if[Object]?handle.fieldType.cast(value):value});
 163         }
 164 
 165         @ForceInline
<span class="line-modified"> 166         static $type$ compareAndExchangeRelease(FieldInstanceReadWrite handle, Object holder, $type$ expected, $type$ value) {</span>

 167             return UNSAFE.compareAndExchange$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 168                                                handle.fieldOffset,
 169                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 170                                                {#if[Object]?handle.fieldType.cast(value):value});
 171         }
 172 
 173         @ForceInline
<span class="line-modified"> 174         static boolean weakCompareAndSetPlain(FieldInstanceReadWrite handle, Object holder, $type$ expected, $type$ value) {</span>

 175             return UNSAFE.weakCompareAndSet$Type$Plain(Objects.requireNonNull(handle.receiverType.cast(holder)),
 176                                                handle.fieldOffset,
 177                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 178                                                {#if[Object]?handle.fieldType.cast(value):value});
 179         }
 180 
 181         @ForceInline
<span class="line-modified"> 182         static boolean weakCompareAndSet(FieldInstanceReadWrite handle, Object holder, $type$ expected, $type$ value) {</span>

 183             return UNSAFE.weakCompareAndSet$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 184                                                handle.fieldOffset,
 185                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 186                                                {#if[Object]?handle.fieldType.cast(value):value});
 187         }
 188 
 189         @ForceInline
<span class="line-modified"> 190         static boolean weakCompareAndSetAcquire(FieldInstanceReadWrite handle, Object holder, $type$ expected, $type$ value) {</span>

 191             return UNSAFE.weakCompareAndSet$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 192                                                handle.fieldOffset,
 193                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 194                                                {#if[Object]?handle.fieldType.cast(value):value});
 195         }
 196 
 197         @ForceInline
<span class="line-modified"> 198         static boolean weakCompareAndSetRelease(FieldInstanceReadWrite handle, Object holder, $type$ expected, $type$ value) {</span>

 199             return UNSAFE.weakCompareAndSet$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 200                                                handle.fieldOffset,
 201                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 202                                                {#if[Object]?handle.fieldType.cast(value):value});
 203         }
 204 
 205         @ForceInline
<span class="line-modified"> 206         static $type$ getAndSet(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 207             return UNSAFE.getAndSet$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 208                                           handle.fieldOffset,
 209                                           {#if[Object]?handle.fieldType.cast(value):value});
 210         }
 211 
 212         @ForceInline
<span class="line-modified"> 213         static $type$ getAndSetAcquire(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 214             return UNSAFE.getAndSet$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 215                                           handle.fieldOffset,
 216                                           {#if[Object]?handle.fieldType.cast(value):value});
 217         }
 218 
 219         @ForceInline
<span class="line-modified"> 220         static $type$ getAndSetRelease(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 221             return UNSAFE.getAndSet$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 222                                           handle.fieldOffset,
 223                                           {#if[Object]?handle.fieldType.cast(value):value});
 224         }
 225 #end[CAS]
 226 #if[AtomicAdd]
 227 
 228         @ForceInline
<span class="line-modified"> 229         static $type$ getAndAdd(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 230             return UNSAFE.getAndAdd$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 231                                        handle.fieldOffset,
 232                                        value);
 233         }
 234 
 235         @ForceInline
<span class="line-modified"> 236         static $type$ getAndAddAcquire(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 237             return UNSAFE.getAndAdd$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 238                                        handle.fieldOffset,
 239                                        value);
 240         }
 241 
 242         @ForceInline
<span class="line-modified"> 243         static $type$ getAndAddRelease(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 244             return UNSAFE.getAndAdd$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 245                                        handle.fieldOffset,
 246                                        value);
 247         }
 248 
 249 #end[AtomicAdd]
 250 #if[Bitwise]
 251 
 252         @ForceInline
<span class="line-modified"> 253         static $type$ getAndBitwiseOr(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 254             return UNSAFE.getAndBitwiseOr$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 255                                        handle.fieldOffset,
 256                                        value);
 257         }
 258 
 259         @ForceInline
<span class="line-modified"> 260         static $type$ getAndBitwiseOrRelease(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 261             return UNSAFE.getAndBitwiseOr$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 262                                        handle.fieldOffset,
 263                                        value);
 264         }
 265 
 266         @ForceInline
<span class="line-modified"> 267         static $type$ getAndBitwiseOrAcquire(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 268             return UNSAFE.getAndBitwiseOr$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 269                                        handle.fieldOffset,
 270                                        value);
 271         }
 272 
 273         @ForceInline
<span class="line-modified"> 274         static $type$ getAndBitwiseAnd(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 275             return UNSAFE.getAndBitwiseAnd$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 276                                        handle.fieldOffset,
 277                                        value);
 278         }
 279 
 280         @ForceInline
<span class="line-modified"> 281         static $type$ getAndBitwiseAndRelease(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 282             return UNSAFE.getAndBitwiseAnd$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 283                                        handle.fieldOffset,
 284                                        value);
 285         }
 286 
 287         @ForceInline
<span class="line-modified"> 288         static $type$ getAndBitwiseAndAcquire(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 289             return UNSAFE.getAndBitwiseAnd$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 290                                        handle.fieldOffset,
 291                                        value);
 292         }
 293 
 294         @ForceInline
<span class="line-modified"> 295         static $type$ getAndBitwiseXor(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 296             return UNSAFE.getAndBitwiseXor$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 297                                        handle.fieldOffset,
 298                                        value);
 299         }
 300 
 301         @ForceInline
<span class="line-modified"> 302         static $type$ getAndBitwiseXorRelease(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 303             return UNSAFE.getAndBitwiseXor$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 304                                        handle.fieldOffset,
 305                                        value);
 306         }
 307 
 308         @ForceInline
<span class="line-modified"> 309         static $type$ getAndBitwiseXorAcquire(FieldInstanceReadWrite handle, Object holder, $type$ value) {</span>

 310             return UNSAFE.getAndBitwiseXor$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 311                                        handle.fieldOffset,
 312                                        value);
 313         }
 314 #end[Bitwise]
 315 
 316         static final VarForm FORM = new VarForm(FieldInstanceReadWrite.class, Object.class, $type$.class);
 317     }
 318 
 319 
 320     static class FieldStaticReadOnly extends VarHandle {
 321         final Object base;
 322         final long fieldOffset;
 323 #if[Object]
 324         final Class&lt;?&gt; fieldType;
 325 #end[Object]
 326 
 327         FieldStaticReadOnly(Object base, long fieldOffset{#if[Object]?, Class&lt;?&gt; fieldType}) {
 328             this(base, fieldOffset{#if[Object]?, fieldType}, FieldStaticReadOnly.FORM);
 329         }
</pre>
<hr />
<pre>
 342         public Optional&lt;VarHandleDesc&gt; describeConstable() {
 343             var fieldTypeRef = {#if[Object]?fieldType:$type$.class}.describeConstable();
 344             if (!fieldTypeRef.isPresent())
 345                 return Optional.empty();
 346 
 347             // Reflect on this VarHandle to extract the field name
 348             var staticField = VarHandles.getStaticFieldFromBaseAndOffset(
 349                 base, fieldOffset, {#if[Object]?fieldType:$type$.class});
 350             var receiverTypeRef = staticField.getDeclaringClass().describeConstable();
 351             if (!receiverTypeRef.isPresent())
 352                 return Optional.empty();
 353             return Optional.of(VarHandleDesc.ofStaticField(receiverTypeRef.get(), staticField.getName(), fieldTypeRef.get()));
 354         }
 355 
 356         @Override
 357         final MethodType accessModeTypeUncached(AccessMode accessMode) {
 358             return accessMode.at.accessModeType(null, {#if[Object]?fieldType:$type$.class});
 359         }
 360 
 361         @ForceInline
<span class="line-modified"> 362         static $type$ get(FieldStaticReadOnly handle) {</span>

 363             return UNSAFE.get$Type$(handle.base,
 364                                  handle.fieldOffset);
 365         }
 366 
 367         @ForceInline
<span class="line-modified"> 368         static $type$ getVolatile(FieldStaticReadOnly handle) {</span>

 369             return UNSAFE.get$Type$Volatile(handle.base,
 370                                  handle.fieldOffset);
 371         }
 372 
 373         @ForceInline
<span class="line-modified"> 374         static $type$ getOpaque(FieldStaticReadOnly handle) {</span>

 375             return UNSAFE.get$Type$Opaque(handle.base,
 376                                  handle.fieldOffset);
 377         }
 378 
 379         @ForceInline
<span class="line-modified"> 380         static $type$ getAcquire(FieldStaticReadOnly handle) {</span>

 381             return UNSAFE.get$Type$Acquire(handle.base,
 382                                  handle.fieldOffset);
 383         }
 384 
 385         static final VarForm FORM = new VarForm(FieldStaticReadOnly.class, null, $type$.class);
 386     }
 387 
 388     static final class FieldStaticReadWrite extends FieldStaticReadOnly {
 389 
 390         FieldStaticReadWrite(Object base, long fieldOffset{#if[Object]?, Class&lt;?&gt; fieldType}) {
 391             super(base, fieldOffset{#if[Object]?, fieldType}, FieldStaticReadWrite.FORM);
 392         }
 393 
 394         @ForceInline
<span class="line-modified"> 395         static void set(FieldStaticReadWrite handle, $type$ value) {</span>

 396             UNSAFE.put$Type$(handle.base,
 397                              handle.fieldOffset,
 398                              {#if[Object]?handle.fieldType.cast(value):value});
 399         }
 400 
 401         @ForceInline
<span class="line-modified"> 402         static void setVolatile(FieldStaticReadWrite handle, $type$ value) {</span>

 403             UNSAFE.put$Type$Volatile(handle.base,
 404                                      handle.fieldOffset,
 405                                      {#if[Object]?handle.fieldType.cast(value):value});
 406         }
 407 
 408         @ForceInline
<span class="line-modified"> 409         static void setOpaque(FieldStaticReadWrite handle, $type$ value) {</span>

 410             UNSAFE.put$Type$Opaque(handle.base,
 411                                    handle.fieldOffset,
 412                                    {#if[Object]?handle.fieldType.cast(value):value});
 413         }
 414 
 415         @ForceInline
<span class="line-modified"> 416         static void setRelease(FieldStaticReadWrite handle, $type$ value) {</span>

 417             UNSAFE.put$Type$Release(handle.base,
 418                                     handle.fieldOffset,
 419                                     {#if[Object]?handle.fieldType.cast(value):value});
 420         }
 421 #if[CAS]
 422 
 423         @ForceInline
<span class="line-modified"> 424         static boolean compareAndSet(FieldStaticReadWrite handle, $type$ expected, $type$ value) {</span>

 425             return UNSAFE.compareAndSet$Type$(handle.base,
 426                                                handle.fieldOffset,
 427                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 428                                                {#if[Object]?handle.fieldType.cast(value):value});
 429         }
 430 
 431 
 432         @ForceInline
<span class="line-modified"> 433         static $type$ compareAndExchange(FieldStaticReadWrite handle, $type$ expected, $type$ value) {</span>

 434             return UNSAFE.compareAndExchange$Type$(handle.base,
 435                                                handle.fieldOffset,
 436                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 437                                                {#if[Object]?handle.fieldType.cast(value):value});
 438         }
 439 
 440         @ForceInline
<span class="line-modified"> 441         static $type$ compareAndExchangeAcquire(FieldStaticReadWrite handle, $type$ expected, $type$ value) {</span>

 442             return UNSAFE.compareAndExchange$Type$Acquire(handle.base,
 443                                                handle.fieldOffset,
 444                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 445                                                {#if[Object]?handle.fieldType.cast(value):value});
 446         }
 447 
 448         @ForceInline
<span class="line-modified"> 449         static $type$ compareAndExchangeRelease(FieldStaticReadWrite handle, $type$ expected, $type$ value) {</span>

 450             return UNSAFE.compareAndExchange$Type$Release(handle.base,
 451                                                handle.fieldOffset,
 452                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 453                                                {#if[Object]?handle.fieldType.cast(value):value});
 454         }
 455 
 456         @ForceInline
<span class="line-modified"> 457         static boolean weakCompareAndSetPlain(FieldStaticReadWrite handle, $type$ expected, $type$ value) {</span>

 458             return UNSAFE.weakCompareAndSet$Type$Plain(handle.base,
 459                                                handle.fieldOffset,
 460                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 461                                                {#if[Object]?handle.fieldType.cast(value):value});
 462         }
 463 
 464         @ForceInline
<span class="line-modified"> 465         static boolean weakCompareAndSet(FieldStaticReadWrite handle, $type$ expected, $type$ value) {</span>

 466             return UNSAFE.weakCompareAndSet$Type$(handle.base,
 467                                                handle.fieldOffset,
 468                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 469                                                {#if[Object]?handle.fieldType.cast(value):value});
 470         }
 471 
 472         @ForceInline
<span class="line-modified"> 473         static boolean weakCompareAndSetAcquire(FieldStaticReadWrite handle, $type$ expected, $type$ value) {</span>

 474             return UNSAFE.weakCompareAndSet$Type$Acquire(handle.base,
 475                                                handle.fieldOffset,
 476                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 477                                                {#if[Object]?handle.fieldType.cast(value):value});
 478         }
 479 
 480         @ForceInline
<span class="line-modified"> 481         static boolean weakCompareAndSetRelease(FieldStaticReadWrite handle, $type$ expected, $type$ value) {</span>

 482             return UNSAFE.weakCompareAndSet$Type$Release(handle.base,
 483                                                handle.fieldOffset,
 484                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 485                                                {#if[Object]?handle.fieldType.cast(value):value});
 486         }
 487 
 488         @ForceInline
<span class="line-modified"> 489         static $type$ getAndSet(FieldStaticReadWrite handle, $type$ value) {</span>

 490             return UNSAFE.getAndSet$Type$(handle.base,
 491                                           handle.fieldOffset,
 492                                           {#if[Object]?handle.fieldType.cast(value):value});
 493         }
 494 
 495         @ForceInline
<span class="line-modified"> 496         static $type$ getAndSetAcquire(FieldStaticReadWrite handle, $type$ value) {</span>

 497             return UNSAFE.getAndSet$Type$Acquire(handle.base,
 498                                           handle.fieldOffset,
 499                                           {#if[Object]?handle.fieldType.cast(value):value});
 500         }
 501 
 502         @ForceInline
<span class="line-modified"> 503         static $type$ getAndSetRelease(FieldStaticReadWrite handle, $type$ value) {</span>

 504             return UNSAFE.getAndSet$Type$Release(handle.base,
 505                                           handle.fieldOffset,
 506                                           {#if[Object]?handle.fieldType.cast(value):value});
 507         }
 508 #end[CAS]
 509 #if[AtomicAdd]
 510 
 511         @ForceInline
<span class="line-modified"> 512         static $type$ getAndAdd(FieldStaticReadWrite handle, $type$ value) {</span>

 513             return UNSAFE.getAndAdd$Type$(handle.base,
 514                                        handle.fieldOffset,
 515                                        value);
 516         }
 517 
 518         @ForceInline
<span class="line-modified"> 519         static $type$ getAndAddAcquire(FieldStaticReadWrite handle, $type$ value) {</span>

 520             return UNSAFE.getAndAdd$Type$Acquire(handle.base,
 521                                        handle.fieldOffset,
 522                                        value);
 523         }
 524 
 525         @ForceInline
<span class="line-modified"> 526         static $type$ getAndAddRelease(FieldStaticReadWrite handle, $type$ value) {</span>

 527             return UNSAFE.getAndAdd$Type$Release(handle.base,
 528                                        handle.fieldOffset,
 529                                        value);
 530         }
 531 #end[AtomicAdd]
 532 #if[Bitwise]
 533 
 534         @ForceInline
<span class="line-modified"> 535         static $type$ getAndBitwiseOr(FieldStaticReadWrite handle, $type$ value) {</span>

 536             return UNSAFE.getAndBitwiseOr$Type$(handle.base,
 537                                        handle.fieldOffset,
 538                                        value);
 539         }
 540 
 541         @ForceInline
<span class="line-modified"> 542         static $type$ getAndBitwiseOrRelease(FieldStaticReadWrite handle, $type$ value) {</span>

 543             return UNSAFE.getAndBitwiseOr$Type$Release(handle.base,
 544                                        handle.fieldOffset,
 545                                        value);
 546         }
 547 
 548         @ForceInline
<span class="line-modified"> 549         static $type$ getAndBitwiseOrAcquire(FieldStaticReadWrite handle, $type$ value) {</span>

 550             return UNSAFE.getAndBitwiseOr$Type$Acquire(handle.base,
 551                                        handle.fieldOffset,
 552                                        value);
 553         }
 554 
 555         @ForceInline
<span class="line-modified"> 556         static $type$ getAndBitwiseAnd(FieldStaticReadWrite handle, $type$ value) {</span>

 557             return UNSAFE.getAndBitwiseAnd$Type$(handle.base,
 558                                        handle.fieldOffset,
 559                                        value);
 560         }
 561 
 562         @ForceInline
<span class="line-modified"> 563         static $type$ getAndBitwiseAndRelease(FieldStaticReadWrite handle, $type$ value) {</span>

 564             return UNSAFE.getAndBitwiseAnd$Type$Release(handle.base,
 565                                        handle.fieldOffset,
 566                                        value);
 567         }
 568 
 569         @ForceInline
<span class="line-modified"> 570         static $type$ getAndBitwiseAndAcquire(FieldStaticReadWrite handle, $type$ value) {</span>

 571             return UNSAFE.getAndBitwiseAnd$Type$Acquire(handle.base,
 572                                        handle.fieldOffset,
 573                                        value);
 574         }
 575 
 576         @ForceInline
<span class="line-modified"> 577         static $type$ getAndBitwiseXor(FieldStaticReadWrite handle, $type$ value) {</span>

 578             return UNSAFE.getAndBitwiseXor$Type$(handle.base,
 579                                        handle.fieldOffset,
 580                                        value);
 581         }
 582 
 583         @ForceInline
<span class="line-modified"> 584         static $type$ getAndBitwiseXorRelease(FieldStaticReadWrite handle, $type$ value) {</span>

 585             return UNSAFE.getAndBitwiseXor$Type$Release(handle.base,
 586                                        handle.fieldOffset,
 587                                        value);
 588         }
 589 
 590         @ForceInline
<span class="line-modified"> 591         static $type$ getAndBitwiseXorAcquire(FieldStaticReadWrite handle, $type$ value) {</span>

 592             return UNSAFE.getAndBitwiseXor$Type$Acquire(handle.base,
 593                                        handle.fieldOffset,
 594                                        value);
 595         }
 596 #end[Bitwise]
 597 
 598         static final VarForm FORM = new VarForm(FieldStaticReadWrite.class, null, $type$.class);
 599     }
 600 
 601 
 602     static final class Array extends VarHandle {
 603         final int abase;
 604         final int ashift;
 605 #if[Object]
 606         final Class&lt;{#if[Object]??:$type$[]}&gt; arrayType;
 607         final Class&lt;?&gt; componentType;
 608 #end[Object]
 609 
 610         Array(int abase, int ashift{#if[Object]?, Class&lt;?&gt; arrayType}) {
 611             super(Array.FORM);
</pre>
<hr />
<pre>
 637             if (handle.arrayType == oarray.getClass()) {
 638                 // Fast path: static array type same as argument array type
 639                 return handle.componentType.cast(value);
 640             } else {
 641                 // Slow path: check value against argument array component type
 642                 return reflectiveTypeCheck(oarray, value);
 643             }
 644         }
 645 
 646         @ForceInline
 647         static Object reflectiveTypeCheck(Object[] oarray, Object value) {
 648             try {
 649                 return oarray.getClass().getComponentType().cast(value);
 650             } catch (ClassCastException e) {
 651                 throw new ArrayStoreException();
 652             }
 653         }
 654 #end[Object]
 655 
 656         @ForceInline
<span class="line-modified"> 657         static $type$ get(Array handle, Object oarray, int index) {</span>

 658 #if[Object]
 659             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 660 #else[Object]
 661             $type$[] array = ($type$[]) oarray;
 662 #end[Object]
 663             return array[index];
 664         }
 665 
 666         @ForceInline
<span class="line-modified"> 667         static void set(Array handle, Object oarray, int index, $type$ value) {</span>

 668 #if[Object]
 669             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 670 #else[Object]
 671             $type$[] array = ($type$[]) oarray;
 672 #end[Object]
 673             array[index] = {#if[Object]?handle.componentType.cast(value):value};
 674         }
 675 
 676         @ForceInline
<span class="line-modified"> 677         static $type$ getVolatile(Array handle, Object oarray, int index) {</span>

 678 #if[Object]
 679             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 680 #else[Object]
 681             $type$[] array = ($type$[]) oarray;
 682 #end[Object]
 683             return UNSAFE.get$Type$Volatile(array,
 684                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase);
 685         }
 686 
 687         @ForceInline
<span class="line-modified"> 688         static void setVolatile(Array handle, Object oarray, int index, $type$ value) {</span>

 689 #if[Object]
 690             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 691 #else[Object]
 692             $type$[] array = ($type$[]) oarray;
 693 #end[Object]
 694             UNSAFE.put$Type$Volatile(array,
 695                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 696                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 697         }
 698 
 699         @ForceInline
<span class="line-modified"> 700         static $type$ getOpaque(Array handle, Object oarray, int index) {</span>

 701 #if[Object]
 702             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 703 #else[Object]
 704             $type$[] array = ($type$[]) oarray;
 705 #end[Object]
 706             return UNSAFE.get$Type$Opaque(array,
 707                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase);
 708         }
 709 
 710         @ForceInline
<span class="line-modified"> 711         static void setOpaque(Array handle, Object oarray, int index, $type$ value) {</span>

 712 #if[Object]
 713             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 714 #else[Object]
 715             $type$[] array = ($type$[]) oarray;
 716 #end[Object]
 717             UNSAFE.put$Type$Opaque(array,
 718                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 719                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 720         }
 721 
 722         @ForceInline
<span class="line-modified"> 723         static $type$ getAcquire(Array handle, Object oarray, int index) {</span>

 724 #if[Object]
 725             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 726 #else[Object]
 727             $type$[] array = ($type$[]) oarray;
 728 #end[Object]
 729             return UNSAFE.get$Type$Acquire(array,
 730                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase);
 731         }
 732 
 733         @ForceInline
<span class="line-modified"> 734         static void setRelease(Array handle, Object oarray, int index, $type$ value) {</span>

 735 #if[Object]
 736             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 737 #else[Object]
 738             $type$[] array = ($type$[]) oarray;
 739 #end[Object]
 740             UNSAFE.put$Type$Release(array,
 741                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 742                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 743         }
 744 #if[CAS]
 745 
 746         @ForceInline
<span class="line-modified"> 747         static boolean compareAndSet(Array handle, Object oarray, int index, $type$ expected, $type$ value) {</span>

 748 #if[Object]
 749             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 750 #else[Object]
 751             $type$[] array = ($type$[]) oarray;
 752 #end[Object]
 753             return UNSAFE.compareAndSet$Type$(array,
 754                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 755                     {#if[Object]?handle.componentType.cast(expected):expected},
 756                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 757         }
 758 
 759         @ForceInline
<span class="line-modified"> 760         static $type$ compareAndExchange(Array handle, Object oarray, int index, $type$ expected, $type$ value) {</span>

 761 #if[Object]
 762             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 763 #else[Object]
 764             $type$[] array = ($type$[]) oarray;
 765 #end[Object]
 766             return UNSAFE.compareAndExchange$Type$(array,
 767                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 768                     {#if[Object]?handle.componentType.cast(expected):expected},
 769                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 770         }
 771 
 772         @ForceInline
<span class="line-modified"> 773         static $type$ compareAndExchangeAcquire(Array handle, Object oarray, int index, $type$ expected, $type$ value) {</span>

 774 #if[Object]
 775             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 776 #else[Object]
 777             $type$[] array = ($type$[]) oarray;
 778 #end[Object]
 779             return UNSAFE.compareAndExchange$Type$Acquire(array,
 780                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 781                     {#if[Object]?handle.componentType.cast(expected):expected},
 782                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 783         }
 784 
 785         @ForceInline
<span class="line-modified"> 786         static $type$ compareAndExchangeRelease(Array handle, Object oarray, int index, $type$ expected, $type$ value) {</span>

 787 #if[Object]
 788             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 789 #else[Object]
 790             $type$[] array = ($type$[]) oarray;
 791 #end[Object]
 792             return UNSAFE.compareAndExchange$Type$Release(array,
 793                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 794                     {#if[Object]?handle.componentType.cast(expected):expected},
 795                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 796         }
 797 
 798         @ForceInline
<span class="line-modified"> 799         static boolean weakCompareAndSetPlain(Array handle, Object oarray, int index, $type$ expected, $type$ value) {</span>

 800 #if[Object]
 801             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 802 #else[Object]
 803             $type$[] array = ($type$[]) oarray;
 804 #end[Object]
 805             return UNSAFE.weakCompareAndSet$Type$Plain(array,
 806                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 807                     {#if[Object]?handle.componentType.cast(expected):expected},
 808                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 809         }
 810 
 811         @ForceInline
<span class="line-modified"> 812         static boolean weakCompareAndSet(Array handle, Object oarray, int index, $type$ expected, $type$ value) {</span>

 813 #if[Object]
 814             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 815 #else[Object]
 816             $type$[] array = ($type$[]) oarray;
 817 #end[Object]
 818             return UNSAFE.weakCompareAndSet$Type$(array,
 819                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 820                     {#if[Object]?handle.componentType.cast(expected):expected},
 821                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 822         }
 823 
 824         @ForceInline
<span class="line-modified"> 825         static boolean weakCompareAndSetAcquire(Array handle, Object oarray, int index, $type$ expected, $type$ value) {</span>

 826 #if[Object]
 827             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 828 #else[Object]
 829             $type$[] array = ($type$[]) oarray;
 830 #end[Object]
 831             return UNSAFE.weakCompareAndSet$Type$Acquire(array,
 832                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 833                     {#if[Object]?handle.componentType.cast(expected):expected},
 834                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 835         }
 836 
 837         @ForceInline
<span class="line-modified"> 838         static boolean weakCompareAndSetRelease(Array handle, Object oarray, int index, $type$ expected, $type$ value) {</span>

 839 #if[Object]
 840             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 841 #else[Object]
 842             $type$[] array = ($type$[]) oarray;
 843 #end[Object]
 844             return UNSAFE.weakCompareAndSet$Type$Release(array,
 845                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 846                     {#if[Object]?handle.componentType.cast(expected):expected},
 847                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 848         }
 849 
 850         @ForceInline
<span class="line-modified"> 851         static $type$ getAndSet(Array handle, Object oarray, int index, $type$ value) {</span>

 852 #if[Object]
 853             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 854 #else[Object]
 855             $type$[] array = ($type$[]) oarray;
 856 #end[Object]
 857             return UNSAFE.getAndSet$Type$(array,
 858                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 859                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 860         }
 861 
 862         @ForceInline
<span class="line-modified"> 863         static $type$ getAndSetAcquire(Array handle, Object oarray, int index, $type$ value) {</span>

 864 #if[Object]
 865             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 866 #else[Object]
 867             $type$[] array = ($type$[]) oarray;
 868 #end[Object]
 869             return UNSAFE.getAndSet$Type$Acquire(array,
 870                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 871                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 872         }
 873 
 874         @ForceInline
<span class="line-modified"> 875         static $type$ getAndSetRelease(Array handle, Object oarray, int index, $type$ value) {</span>

 876 #if[Object]
 877             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 878 #else[Object]
 879             $type$[] array = ($type$[]) oarray;
 880 #end[Object]
 881             return UNSAFE.getAndSet$Type$Release(array,
 882                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 883                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 884         }
 885 #end[CAS]
 886 #if[AtomicAdd]
 887 
 888         @ForceInline
<span class="line-modified"> 889         static $type$ getAndAdd(Array handle, Object oarray, int index, $type$ value) {</span>

 890             $type$[] array = ($type$[]) oarray;
 891             return UNSAFE.getAndAdd$Type$(array,
 892                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 893                     value);
 894         }
 895 
 896         @ForceInline
<span class="line-modified"> 897         static $type$ getAndAddAcquire(Array handle, Object oarray, int index, $type$ value) {</span>

 898             $type$[] array = ($type$[]) oarray;
 899             return UNSAFE.getAndAdd$Type$Acquire(array,
 900                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 901                     value);
 902         }
 903 
 904         @ForceInline
<span class="line-modified"> 905         static $type$ getAndAddRelease(Array handle, Object oarray, int index, $type$ value) {</span>

 906             $type$[] array = ($type$[]) oarray;
 907             return UNSAFE.getAndAdd$Type$Release(array,
 908                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 909                     value);
 910         }
 911 #end[AtomicAdd]
 912 #if[Bitwise]
 913 
 914         @ForceInline
<span class="line-modified"> 915         static $type$ getAndBitwiseOr(Array handle, Object oarray, int index, $type$ value) {</span>

 916             $type$[] array = ($type$[]) oarray;
 917             return UNSAFE.getAndBitwiseOr$Type$(array,
 918                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 919                                        value);
 920         }
 921 
 922         @ForceInline
<span class="line-modified"> 923         static $type$ getAndBitwiseOrRelease(Array handle, Object oarray, int index, $type$ value) {</span>

 924             $type$[] array = ($type$[]) oarray;
 925             return UNSAFE.getAndBitwiseOr$Type$Release(array,
 926                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 927                                        value);
 928         }
 929 
 930         @ForceInline
<span class="line-modified"> 931         static $type$ getAndBitwiseOrAcquire(Array handle, Object oarray, int index, $type$ value) {</span>

 932             $type$[] array = ($type$[]) oarray;
 933             return UNSAFE.getAndBitwiseOr$Type$Acquire(array,
 934                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 935                                        value);
 936         }
 937 
 938         @ForceInline
<span class="line-modified"> 939         static $type$ getAndBitwiseAnd(Array handle, Object oarray, int index, $type$ value) {</span>

 940             $type$[] array = ($type$[]) oarray;
 941             return UNSAFE.getAndBitwiseAnd$Type$(array,
 942                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 943                                        value);
 944         }
 945 
 946         @ForceInline
<span class="line-modified"> 947         static $type$ getAndBitwiseAndRelease(Array handle, Object oarray, int index, $type$ value) {</span>

 948             $type$[] array = ($type$[]) oarray;
 949             return UNSAFE.getAndBitwiseAnd$Type$Release(array,
 950                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 951                                        value);
 952         }
 953 
 954         @ForceInline
<span class="line-modified"> 955         static $type$ getAndBitwiseAndAcquire(Array handle, Object oarray, int index, $type$ value) {</span>

 956             $type$[] array = ($type$[]) oarray;
 957             return UNSAFE.getAndBitwiseAnd$Type$Acquire(array,
 958                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 959                                        value);
 960         }
 961 
 962         @ForceInline
<span class="line-modified"> 963         static $type$ getAndBitwiseXor(Array handle, Object oarray, int index, $type$ value) {</span>

 964             $type$[] array = ($type$[]) oarray;
 965             return UNSAFE.getAndBitwiseXor$Type$(array,
 966                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 967                                        value);
 968         }
 969 
 970         @ForceInline
<span class="line-modified"> 971         static $type$ getAndBitwiseXorRelease(Array handle, Object oarray, int index, $type$ value) {</span>

 972             $type$[] array = ($type$[]) oarray;
 973             return UNSAFE.getAndBitwiseXor$Type$Release(array,
 974                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 975                                        value);
 976         }
 977 
 978         @ForceInline
<span class="line-modified"> 979         static $type$ getAndBitwiseXorAcquire(Array handle, Object oarray, int index, $type$ value) {</span>

 980             $type$[] array = ($type$[]) oarray;
 981             return UNSAFE.getAndBitwiseXor$Type$Acquire(array,
 982                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 983                                        value);
 984         }
 985 #end[Bitwise]
 986 
 987         static final VarForm FORM = new VarForm(Array.class, {#if[Object]?Object[].class:$type$[].class}, {#if[Object]?Object.class:$type$.class}, int.class);
 988     }
 989 }
</pre>
</td>
<td>
<hr />
<pre>
  60 
  61         @Override
  62         final MethodType accessModeTypeUncached(AccessMode accessMode) {
  63             return accessMode.at.accessModeType(receiverType, {#if[Object]?fieldType:$type$.class});
  64         }
  65 
  66         @Override
  67         public Optional&lt;VarHandleDesc&gt; describeConstable() {
  68             var receiverTypeRef = receiverType.describeConstable();
  69             var fieldTypeRef = {#if[Object]?fieldType:$type$.class}.describeConstable();
  70             if (!receiverTypeRef.isPresent() || !fieldTypeRef.isPresent())
  71                 return Optional.empty();
  72 
  73             // Reflect on this VarHandle to extract the field name
  74             String name = VarHandles.getFieldFromReceiverAndOffset(
  75                 receiverType, fieldOffset, {#if[Object]?fieldType:$type$.class}).getName();
  76             return Optional.of(VarHandleDesc.ofField(receiverTypeRef.get(), name, fieldTypeRef.get()));
  77         }
  78 
  79         @ForceInline
<span class="line-modified">  80         static $type$ get(VarHandle ob, Object holder) {</span>
<span class="line-added">  81             FieldInstanceReadOnly handle = (FieldInstanceReadOnly)ob;</span>
  82             return UNSAFE.get$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
  83                                  handle.fieldOffset);
  84         }
  85 
  86         @ForceInline
<span class="line-modified">  87         static $type$ getVolatile(VarHandle ob, Object holder) {</span>
<span class="line-added">  88             FieldInstanceReadOnly handle = (FieldInstanceReadOnly)ob;</span>
  89             return UNSAFE.get$Type$Volatile(Objects.requireNonNull(handle.receiverType.cast(holder)),
  90                                  handle.fieldOffset);
  91         }
  92 
  93         @ForceInline
<span class="line-modified">  94         static $type$ getOpaque(VarHandle ob, Object holder) {</span>
<span class="line-added">  95             FieldInstanceReadOnly handle = (FieldInstanceReadOnly)ob;</span>
  96             return UNSAFE.get$Type$Opaque(Objects.requireNonNull(handle.receiverType.cast(holder)),
  97                                  handle.fieldOffset);
  98         }
  99 
 100         @ForceInline
<span class="line-modified"> 101         static $type$ getAcquire(VarHandle ob, Object holder) {</span>
<span class="line-added"> 102             FieldInstanceReadOnly handle = (FieldInstanceReadOnly)ob;</span>
 103             return UNSAFE.get$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 104                                  handle.fieldOffset);
 105         }
 106 
 107         static final VarForm FORM = new VarForm(FieldInstanceReadOnly.class, Object.class, $type$.class);
 108     }
 109 
 110     static final class FieldInstanceReadWrite extends FieldInstanceReadOnly {
 111 
 112         FieldInstanceReadWrite(Class&lt;?&gt; receiverType, long fieldOffset{#if[Object]?, Class&lt;?&gt; fieldType}) {
 113             super(receiverType, fieldOffset{#if[Object]?, fieldType}, FieldInstanceReadWrite.FORM);
 114         }
 115 
 116         @ForceInline
<span class="line-modified"> 117         static void set(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 118             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 119             UNSAFE.put$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 120                              handle.fieldOffset,
 121                              {#if[Object]?handle.fieldType.cast(value):value});
 122         }
 123 
 124         @ForceInline
<span class="line-modified"> 125         static void setVolatile(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 126             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 127             UNSAFE.put$Type$Volatile(Objects.requireNonNull(handle.receiverType.cast(holder)),
 128                                      handle.fieldOffset,
 129                                      {#if[Object]?handle.fieldType.cast(value):value});
 130         }
 131 
 132         @ForceInline
<span class="line-modified"> 133         static void setOpaque(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 134             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 135             UNSAFE.put$Type$Opaque(Objects.requireNonNull(handle.receiverType.cast(holder)),
 136                                    handle.fieldOffset,
 137                                    {#if[Object]?handle.fieldType.cast(value):value});
 138         }
 139 
 140         @ForceInline
<span class="line-modified"> 141         static void setRelease(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 142             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 143             UNSAFE.put$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 144                                     handle.fieldOffset,
 145                                     {#if[Object]?handle.fieldType.cast(value):value});
 146         }
 147 #if[CAS]
 148 
 149         @ForceInline
<span class="line-modified"> 150         static boolean compareAndSet(VarHandle ob, Object holder, $type$ expected, $type$ value) {</span>
<span class="line-added"> 151             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 152             return UNSAFE.compareAndSet$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 153                                                handle.fieldOffset,
 154                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 155                                                {#if[Object]?handle.fieldType.cast(value):value});
 156         }
 157 
 158         @ForceInline
<span class="line-modified"> 159         static $type$ compareAndExchange(VarHandle ob, Object holder, $type$ expected, $type$ value) {</span>
<span class="line-added"> 160             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 161             return UNSAFE.compareAndExchange$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 162                                                handle.fieldOffset,
 163                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 164                                                {#if[Object]?handle.fieldType.cast(value):value});
 165         }
 166 
 167         @ForceInline
<span class="line-modified"> 168         static $type$ compareAndExchangeAcquire(VarHandle ob, Object holder, $type$ expected, $type$ value) {</span>
<span class="line-added"> 169             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 170             return UNSAFE.compareAndExchange$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 171                                                handle.fieldOffset,
 172                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 173                                                {#if[Object]?handle.fieldType.cast(value):value});
 174         }
 175 
 176         @ForceInline
<span class="line-modified"> 177         static $type$ compareAndExchangeRelease(VarHandle ob, Object holder, $type$ expected, $type$ value) {</span>
<span class="line-added"> 178             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 179             return UNSAFE.compareAndExchange$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 180                                                handle.fieldOffset,
 181                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 182                                                {#if[Object]?handle.fieldType.cast(value):value});
 183         }
 184 
 185         @ForceInline
<span class="line-modified"> 186         static boolean weakCompareAndSetPlain(VarHandle ob, Object holder, $type$ expected, $type$ value) {</span>
<span class="line-added"> 187             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 188             return UNSAFE.weakCompareAndSet$Type$Plain(Objects.requireNonNull(handle.receiverType.cast(holder)),
 189                                                handle.fieldOffset,
 190                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 191                                                {#if[Object]?handle.fieldType.cast(value):value});
 192         }
 193 
 194         @ForceInline
<span class="line-modified"> 195         static boolean weakCompareAndSet(VarHandle ob, Object holder, $type$ expected, $type$ value) {</span>
<span class="line-added"> 196             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 197             return UNSAFE.weakCompareAndSet$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 198                                                handle.fieldOffset,
 199                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 200                                                {#if[Object]?handle.fieldType.cast(value):value});
 201         }
 202 
 203         @ForceInline
<span class="line-modified"> 204         static boolean weakCompareAndSetAcquire(VarHandle ob, Object holder, $type$ expected, $type$ value) {</span>
<span class="line-added"> 205             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 206             return UNSAFE.weakCompareAndSet$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 207                                                handle.fieldOffset,
 208                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 209                                                {#if[Object]?handle.fieldType.cast(value):value});
 210         }
 211 
 212         @ForceInline
<span class="line-modified"> 213         static boolean weakCompareAndSetRelease(VarHandle ob, Object holder, $type$ expected, $type$ value) {</span>
<span class="line-added"> 214             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 215             return UNSAFE.weakCompareAndSet$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 216                                                handle.fieldOffset,
 217                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 218                                                {#if[Object]?handle.fieldType.cast(value):value});
 219         }
 220 
 221         @ForceInline
<span class="line-modified"> 222         static $type$ getAndSet(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 223             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 224             return UNSAFE.getAndSet$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 225                                           handle.fieldOffset,
 226                                           {#if[Object]?handle.fieldType.cast(value):value});
 227         }
 228 
 229         @ForceInline
<span class="line-modified"> 230         static $type$ getAndSetAcquire(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 231             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 232             return UNSAFE.getAndSet$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 233                                           handle.fieldOffset,
 234                                           {#if[Object]?handle.fieldType.cast(value):value});
 235         }
 236 
 237         @ForceInline
<span class="line-modified"> 238         static $type$ getAndSetRelease(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 239             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 240             return UNSAFE.getAndSet$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 241                                           handle.fieldOffset,
 242                                           {#if[Object]?handle.fieldType.cast(value):value});
 243         }
 244 #end[CAS]
 245 #if[AtomicAdd]
 246 
 247         @ForceInline
<span class="line-modified"> 248         static $type$ getAndAdd(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 249             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 250             return UNSAFE.getAndAdd$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 251                                        handle.fieldOffset,
 252                                        value);
 253         }
 254 
 255         @ForceInline
<span class="line-modified"> 256         static $type$ getAndAddAcquire(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 257             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 258             return UNSAFE.getAndAdd$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 259                                        handle.fieldOffset,
 260                                        value);
 261         }
 262 
 263         @ForceInline
<span class="line-modified"> 264         static $type$ getAndAddRelease(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 265             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 266             return UNSAFE.getAndAdd$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 267                                        handle.fieldOffset,
 268                                        value);
 269         }
 270 
 271 #end[AtomicAdd]
 272 #if[Bitwise]
 273 
 274         @ForceInline
<span class="line-modified"> 275         static $type$ getAndBitwiseOr(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 276             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 277             return UNSAFE.getAndBitwiseOr$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 278                                        handle.fieldOffset,
 279                                        value);
 280         }
 281 
 282         @ForceInline
<span class="line-modified"> 283         static $type$ getAndBitwiseOrRelease(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 284             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 285             return UNSAFE.getAndBitwiseOr$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 286                                        handle.fieldOffset,
 287                                        value);
 288         }
 289 
 290         @ForceInline
<span class="line-modified"> 291         static $type$ getAndBitwiseOrAcquire(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 292             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 293             return UNSAFE.getAndBitwiseOr$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 294                                        handle.fieldOffset,
 295                                        value);
 296         }
 297 
 298         @ForceInline
<span class="line-modified"> 299         static $type$ getAndBitwiseAnd(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 300             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 301             return UNSAFE.getAndBitwiseAnd$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 302                                        handle.fieldOffset,
 303                                        value);
 304         }
 305 
 306         @ForceInline
<span class="line-modified"> 307         static $type$ getAndBitwiseAndRelease(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 308             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 309             return UNSAFE.getAndBitwiseAnd$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 310                                        handle.fieldOffset,
 311                                        value);
 312         }
 313 
 314         @ForceInline
<span class="line-modified"> 315         static $type$ getAndBitwiseAndAcquire(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 316             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 317             return UNSAFE.getAndBitwiseAnd$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 318                                        handle.fieldOffset,
 319                                        value);
 320         }
 321 
 322         @ForceInline
<span class="line-modified"> 323         static $type$ getAndBitwiseXor(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 324             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 325             return UNSAFE.getAndBitwiseXor$Type$(Objects.requireNonNull(handle.receiverType.cast(holder)),
 326                                        handle.fieldOffset,
 327                                        value);
 328         }
 329 
 330         @ForceInline
<span class="line-modified"> 331         static $type$ getAndBitwiseXorRelease(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 332             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 333             return UNSAFE.getAndBitwiseXor$Type$Release(Objects.requireNonNull(handle.receiverType.cast(holder)),
 334                                        handle.fieldOffset,
 335                                        value);
 336         }
 337 
 338         @ForceInline
<span class="line-modified"> 339         static $type$ getAndBitwiseXorAcquire(VarHandle ob, Object holder, $type$ value) {</span>
<span class="line-added"> 340             FieldInstanceReadWrite handle = (FieldInstanceReadWrite)ob;</span>
 341             return UNSAFE.getAndBitwiseXor$Type$Acquire(Objects.requireNonNull(handle.receiverType.cast(holder)),
 342                                        handle.fieldOffset,
 343                                        value);
 344         }
 345 #end[Bitwise]
 346 
 347         static final VarForm FORM = new VarForm(FieldInstanceReadWrite.class, Object.class, $type$.class);
 348     }
 349 
 350 
 351     static class FieldStaticReadOnly extends VarHandle {
 352         final Object base;
 353         final long fieldOffset;
 354 #if[Object]
 355         final Class&lt;?&gt; fieldType;
 356 #end[Object]
 357 
 358         FieldStaticReadOnly(Object base, long fieldOffset{#if[Object]?, Class&lt;?&gt; fieldType}) {
 359             this(base, fieldOffset{#if[Object]?, fieldType}, FieldStaticReadOnly.FORM);
 360         }
</pre>
<hr />
<pre>
 373         public Optional&lt;VarHandleDesc&gt; describeConstable() {
 374             var fieldTypeRef = {#if[Object]?fieldType:$type$.class}.describeConstable();
 375             if (!fieldTypeRef.isPresent())
 376                 return Optional.empty();
 377 
 378             // Reflect on this VarHandle to extract the field name
 379             var staticField = VarHandles.getStaticFieldFromBaseAndOffset(
 380                 base, fieldOffset, {#if[Object]?fieldType:$type$.class});
 381             var receiverTypeRef = staticField.getDeclaringClass().describeConstable();
 382             if (!receiverTypeRef.isPresent())
 383                 return Optional.empty();
 384             return Optional.of(VarHandleDesc.ofStaticField(receiverTypeRef.get(), staticField.getName(), fieldTypeRef.get()));
 385         }
 386 
 387         @Override
 388         final MethodType accessModeTypeUncached(AccessMode accessMode) {
 389             return accessMode.at.accessModeType(null, {#if[Object]?fieldType:$type$.class});
 390         }
 391 
 392         @ForceInline
<span class="line-modified"> 393         static $type$ get(VarHandle ob) {</span>
<span class="line-added"> 394             FieldStaticReadOnly handle = (FieldStaticReadOnly)ob;</span>
 395             return UNSAFE.get$Type$(handle.base,
 396                                  handle.fieldOffset);
 397         }
 398 
 399         @ForceInline
<span class="line-modified"> 400         static $type$ getVolatile(VarHandle ob) {</span>
<span class="line-added"> 401             FieldStaticReadOnly handle = (FieldStaticReadOnly)ob;</span>
 402             return UNSAFE.get$Type$Volatile(handle.base,
 403                                  handle.fieldOffset);
 404         }
 405 
 406         @ForceInline
<span class="line-modified"> 407         static $type$ getOpaque(VarHandle ob) {</span>
<span class="line-added"> 408             FieldStaticReadOnly handle = (FieldStaticReadOnly)ob;</span>
 409             return UNSAFE.get$Type$Opaque(handle.base,
 410                                  handle.fieldOffset);
 411         }
 412 
 413         @ForceInline
<span class="line-modified"> 414         static $type$ getAcquire(VarHandle ob) {</span>
<span class="line-added"> 415             FieldStaticReadOnly handle = (FieldStaticReadOnly)ob;</span>
 416             return UNSAFE.get$Type$Acquire(handle.base,
 417                                  handle.fieldOffset);
 418         }
 419 
 420         static final VarForm FORM = new VarForm(FieldStaticReadOnly.class, null, $type$.class);
 421     }
 422 
 423     static final class FieldStaticReadWrite extends FieldStaticReadOnly {
 424 
 425         FieldStaticReadWrite(Object base, long fieldOffset{#if[Object]?, Class&lt;?&gt; fieldType}) {
 426             super(base, fieldOffset{#if[Object]?, fieldType}, FieldStaticReadWrite.FORM);
 427         }
 428 
 429         @ForceInline
<span class="line-modified"> 430         static void set(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 431             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 432             UNSAFE.put$Type$(handle.base,
 433                              handle.fieldOffset,
 434                              {#if[Object]?handle.fieldType.cast(value):value});
 435         }
 436 
 437         @ForceInline
<span class="line-modified"> 438         static void setVolatile(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 439             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 440             UNSAFE.put$Type$Volatile(handle.base,
 441                                      handle.fieldOffset,
 442                                      {#if[Object]?handle.fieldType.cast(value):value});
 443         }
 444 
 445         @ForceInline
<span class="line-modified"> 446         static void setOpaque(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 447             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 448             UNSAFE.put$Type$Opaque(handle.base,
 449                                    handle.fieldOffset,
 450                                    {#if[Object]?handle.fieldType.cast(value):value});
 451         }
 452 
 453         @ForceInline
<span class="line-modified"> 454         static void setRelease(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 455             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 456             UNSAFE.put$Type$Release(handle.base,
 457                                     handle.fieldOffset,
 458                                     {#if[Object]?handle.fieldType.cast(value):value});
 459         }
 460 #if[CAS]
 461 
 462         @ForceInline
<span class="line-modified"> 463         static boolean compareAndSet(VarHandle ob, $type$ expected, $type$ value) {</span>
<span class="line-added"> 464             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 465             return UNSAFE.compareAndSet$Type$(handle.base,
 466                                                handle.fieldOffset,
 467                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 468                                                {#if[Object]?handle.fieldType.cast(value):value});
 469         }
 470 
 471 
 472         @ForceInline
<span class="line-modified"> 473         static $type$ compareAndExchange(VarHandle ob, $type$ expected, $type$ value) {</span>
<span class="line-added"> 474             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 475             return UNSAFE.compareAndExchange$Type$(handle.base,
 476                                                handle.fieldOffset,
 477                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 478                                                {#if[Object]?handle.fieldType.cast(value):value});
 479         }
 480 
 481         @ForceInline
<span class="line-modified"> 482         static $type$ compareAndExchangeAcquire(VarHandle ob, $type$ expected, $type$ value) {</span>
<span class="line-added"> 483             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 484             return UNSAFE.compareAndExchange$Type$Acquire(handle.base,
 485                                                handle.fieldOffset,
 486                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 487                                                {#if[Object]?handle.fieldType.cast(value):value});
 488         }
 489 
 490         @ForceInline
<span class="line-modified"> 491         static $type$ compareAndExchangeRelease(VarHandle ob, $type$ expected, $type$ value) {</span>
<span class="line-added"> 492             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 493             return UNSAFE.compareAndExchange$Type$Release(handle.base,
 494                                                handle.fieldOffset,
 495                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 496                                                {#if[Object]?handle.fieldType.cast(value):value});
 497         }
 498 
 499         @ForceInline
<span class="line-modified"> 500         static boolean weakCompareAndSetPlain(VarHandle ob, $type$ expected, $type$ value) {</span>
<span class="line-added"> 501             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 502             return UNSAFE.weakCompareAndSet$Type$Plain(handle.base,
 503                                                handle.fieldOffset,
 504                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 505                                                {#if[Object]?handle.fieldType.cast(value):value});
 506         }
 507 
 508         @ForceInline
<span class="line-modified"> 509         static boolean weakCompareAndSet(VarHandle ob, $type$ expected, $type$ value) {</span>
<span class="line-added"> 510             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 511             return UNSAFE.weakCompareAndSet$Type$(handle.base,
 512                                                handle.fieldOffset,
 513                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 514                                                {#if[Object]?handle.fieldType.cast(value):value});
 515         }
 516 
 517         @ForceInline
<span class="line-modified"> 518         static boolean weakCompareAndSetAcquire(VarHandle ob, $type$ expected, $type$ value) {</span>
<span class="line-added"> 519             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 520             return UNSAFE.weakCompareAndSet$Type$Acquire(handle.base,
 521                                                handle.fieldOffset,
 522                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 523                                                {#if[Object]?handle.fieldType.cast(value):value});
 524         }
 525 
 526         @ForceInline
<span class="line-modified"> 527         static boolean weakCompareAndSetRelease(VarHandle ob, $type$ expected, $type$ value) {</span>
<span class="line-added"> 528             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 529             return UNSAFE.weakCompareAndSet$Type$Release(handle.base,
 530                                                handle.fieldOffset,
 531                                                {#if[Object]?handle.fieldType.cast(expected):expected},
 532                                                {#if[Object]?handle.fieldType.cast(value):value});
 533         }
 534 
 535         @ForceInline
<span class="line-modified"> 536         static $type$ getAndSet(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 537             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 538             return UNSAFE.getAndSet$Type$(handle.base,
 539                                           handle.fieldOffset,
 540                                           {#if[Object]?handle.fieldType.cast(value):value});
 541         }
 542 
 543         @ForceInline
<span class="line-modified"> 544         static $type$ getAndSetAcquire(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 545             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 546             return UNSAFE.getAndSet$Type$Acquire(handle.base,
 547                                           handle.fieldOffset,
 548                                           {#if[Object]?handle.fieldType.cast(value):value});
 549         }
 550 
 551         @ForceInline
<span class="line-modified"> 552         static $type$ getAndSetRelease(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 553             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 554             return UNSAFE.getAndSet$Type$Release(handle.base,
 555                                           handle.fieldOffset,
 556                                           {#if[Object]?handle.fieldType.cast(value):value});
 557         }
 558 #end[CAS]
 559 #if[AtomicAdd]
 560 
 561         @ForceInline
<span class="line-modified"> 562         static $type$ getAndAdd(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 563             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 564             return UNSAFE.getAndAdd$Type$(handle.base,
 565                                        handle.fieldOffset,
 566                                        value);
 567         }
 568 
 569         @ForceInline
<span class="line-modified"> 570         static $type$ getAndAddAcquire(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 571             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 572             return UNSAFE.getAndAdd$Type$Acquire(handle.base,
 573                                        handle.fieldOffset,
 574                                        value);
 575         }
 576 
 577         @ForceInline
<span class="line-modified"> 578         static $type$ getAndAddRelease(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 579             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 580             return UNSAFE.getAndAdd$Type$Release(handle.base,
 581                                        handle.fieldOffset,
 582                                        value);
 583         }
 584 #end[AtomicAdd]
 585 #if[Bitwise]
 586 
 587         @ForceInline
<span class="line-modified"> 588         static $type$ getAndBitwiseOr(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 589             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 590             return UNSAFE.getAndBitwiseOr$Type$(handle.base,
 591                                        handle.fieldOffset,
 592                                        value);
 593         }
 594 
 595         @ForceInline
<span class="line-modified"> 596         static $type$ getAndBitwiseOrRelease(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 597             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 598             return UNSAFE.getAndBitwiseOr$Type$Release(handle.base,
 599                                        handle.fieldOffset,
 600                                        value);
 601         }
 602 
 603         @ForceInline
<span class="line-modified"> 604         static $type$ getAndBitwiseOrAcquire(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 605             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 606             return UNSAFE.getAndBitwiseOr$Type$Acquire(handle.base,
 607                                        handle.fieldOffset,
 608                                        value);
 609         }
 610 
 611         @ForceInline
<span class="line-modified"> 612         static $type$ getAndBitwiseAnd(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 613             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 614             return UNSAFE.getAndBitwiseAnd$Type$(handle.base,
 615                                        handle.fieldOffset,
 616                                        value);
 617         }
 618 
 619         @ForceInline
<span class="line-modified"> 620         static $type$ getAndBitwiseAndRelease(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 621             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 622             return UNSAFE.getAndBitwiseAnd$Type$Release(handle.base,
 623                                        handle.fieldOffset,
 624                                        value);
 625         }
 626 
 627         @ForceInline
<span class="line-modified"> 628         static $type$ getAndBitwiseAndAcquire(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 629             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 630             return UNSAFE.getAndBitwiseAnd$Type$Acquire(handle.base,
 631                                        handle.fieldOffset,
 632                                        value);
 633         }
 634 
 635         @ForceInline
<span class="line-modified"> 636         static $type$ getAndBitwiseXor(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 637             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 638             return UNSAFE.getAndBitwiseXor$Type$(handle.base,
 639                                        handle.fieldOffset,
 640                                        value);
 641         }
 642 
 643         @ForceInline
<span class="line-modified"> 644         static $type$ getAndBitwiseXorRelease(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 645             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 646             return UNSAFE.getAndBitwiseXor$Type$Release(handle.base,
 647                                        handle.fieldOffset,
 648                                        value);
 649         }
 650 
 651         @ForceInline
<span class="line-modified"> 652         static $type$ getAndBitwiseXorAcquire(VarHandle ob, $type$ value) {</span>
<span class="line-added"> 653             FieldStaticReadWrite handle = (FieldStaticReadWrite)ob;</span>
 654             return UNSAFE.getAndBitwiseXor$Type$Acquire(handle.base,
 655                                        handle.fieldOffset,
 656                                        value);
 657         }
 658 #end[Bitwise]
 659 
 660         static final VarForm FORM = new VarForm(FieldStaticReadWrite.class, null, $type$.class);
 661     }
 662 
 663 
 664     static final class Array extends VarHandle {
 665         final int abase;
 666         final int ashift;
 667 #if[Object]
 668         final Class&lt;{#if[Object]??:$type$[]}&gt; arrayType;
 669         final Class&lt;?&gt; componentType;
 670 #end[Object]
 671 
 672         Array(int abase, int ashift{#if[Object]?, Class&lt;?&gt; arrayType}) {
 673             super(Array.FORM);
</pre>
<hr />
<pre>
 699             if (handle.arrayType == oarray.getClass()) {
 700                 // Fast path: static array type same as argument array type
 701                 return handle.componentType.cast(value);
 702             } else {
 703                 // Slow path: check value against argument array component type
 704                 return reflectiveTypeCheck(oarray, value);
 705             }
 706         }
 707 
 708         @ForceInline
 709         static Object reflectiveTypeCheck(Object[] oarray, Object value) {
 710             try {
 711                 return oarray.getClass().getComponentType().cast(value);
 712             } catch (ClassCastException e) {
 713                 throw new ArrayStoreException();
 714             }
 715         }
 716 #end[Object]
 717 
 718         @ForceInline
<span class="line-modified"> 719         static $type$ get(VarHandle ob, Object oarray, int index) {</span>
<span class="line-added"> 720             Array handle = (Array)ob;</span>
 721 #if[Object]
 722             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 723 #else[Object]
 724             $type$[] array = ($type$[]) oarray;
 725 #end[Object]
 726             return array[index];
 727         }
 728 
 729         @ForceInline
<span class="line-modified"> 730         static void set(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added"> 731             Array handle = (Array)ob;</span>
 732 #if[Object]
 733             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 734 #else[Object]
 735             $type$[] array = ($type$[]) oarray;
 736 #end[Object]
 737             array[index] = {#if[Object]?handle.componentType.cast(value):value};
 738         }
 739 
 740         @ForceInline
<span class="line-modified"> 741         static $type$ getVolatile(VarHandle ob, Object oarray, int index) {</span>
<span class="line-added"> 742             Array handle = (Array)ob;</span>
 743 #if[Object]
 744             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 745 #else[Object]
 746             $type$[] array = ($type$[]) oarray;
 747 #end[Object]
 748             return UNSAFE.get$Type$Volatile(array,
 749                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase);
 750         }
 751 
 752         @ForceInline
<span class="line-modified"> 753         static void setVolatile(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added"> 754             Array handle = (Array)ob;</span>
 755 #if[Object]
 756             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 757 #else[Object]
 758             $type$[] array = ($type$[]) oarray;
 759 #end[Object]
 760             UNSAFE.put$Type$Volatile(array,
 761                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 762                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 763         }
 764 
 765         @ForceInline
<span class="line-modified"> 766         static $type$ getOpaque(VarHandle ob, Object oarray, int index) {</span>
<span class="line-added"> 767             Array handle = (Array)ob;</span>
 768 #if[Object]
 769             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 770 #else[Object]
 771             $type$[] array = ($type$[]) oarray;
 772 #end[Object]
 773             return UNSAFE.get$Type$Opaque(array,
 774                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase);
 775         }
 776 
 777         @ForceInline
<span class="line-modified"> 778         static void setOpaque(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added"> 779             Array handle = (Array)ob;</span>
 780 #if[Object]
 781             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 782 #else[Object]
 783             $type$[] array = ($type$[]) oarray;
 784 #end[Object]
 785             UNSAFE.put$Type$Opaque(array,
 786                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 787                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 788         }
 789 
 790         @ForceInline
<span class="line-modified"> 791         static $type$ getAcquire(VarHandle ob, Object oarray, int index) {</span>
<span class="line-added"> 792             Array handle = (Array)ob;</span>
 793 #if[Object]
 794             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 795 #else[Object]
 796             $type$[] array = ($type$[]) oarray;
 797 #end[Object]
 798             return UNSAFE.get$Type$Acquire(array,
 799                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase);
 800         }
 801 
 802         @ForceInline
<span class="line-modified"> 803         static void setRelease(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added"> 804             Array handle = (Array)ob;</span>
 805 #if[Object]
 806             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 807 #else[Object]
 808             $type$[] array = ($type$[]) oarray;
 809 #end[Object]
 810             UNSAFE.put$Type$Release(array,
 811                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 812                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 813         }
 814 #if[CAS]
 815 
 816         @ForceInline
<span class="line-modified"> 817         static boolean compareAndSet(VarHandle ob, Object oarray, int index, $type$ expected, $type$ value) {</span>
<span class="line-added"> 818             Array handle = (Array)ob;</span>
 819 #if[Object]
 820             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 821 #else[Object]
 822             $type$[] array = ($type$[]) oarray;
 823 #end[Object]
 824             return UNSAFE.compareAndSet$Type$(array,
 825                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 826                     {#if[Object]?handle.componentType.cast(expected):expected},
 827                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 828         }
 829 
 830         @ForceInline
<span class="line-modified"> 831         static $type$ compareAndExchange(VarHandle ob, Object oarray, int index, $type$ expected, $type$ value) {</span>
<span class="line-added"> 832             Array handle = (Array)ob;</span>
 833 #if[Object]
 834             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 835 #else[Object]
 836             $type$[] array = ($type$[]) oarray;
 837 #end[Object]
 838             return UNSAFE.compareAndExchange$Type$(array,
 839                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 840                     {#if[Object]?handle.componentType.cast(expected):expected},
 841                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 842         }
 843 
 844         @ForceInline
<span class="line-modified"> 845         static $type$ compareAndExchangeAcquire(VarHandle ob, Object oarray, int index, $type$ expected, $type$ value) {</span>
<span class="line-added"> 846             Array handle = (Array)ob;</span>
 847 #if[Object]
 848             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 849 #else[Object]
 850             $type$[] array = ($type$[]) oarray;
 851 #end[Object]
 852             return UNSAFE.compareAndExchange$Type$Acquire(array,
 853                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 854                     {#if[Object]?handle.componentType.cast(expected):expected},
 855                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 856         }
 857 
 858         @ForceInline
<span class="line-modified"> 859         static $type$ compareAndExchangeRelease(VarHandle ob, Object oarray, int index, $type$ expected, $type$ value) {</span>
<span class="line-added"> 860             Array handle = (Array)ob;</span>
 861 #if[Object]
 862             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 863 #else[Object]
 864             $type$[] array = ($type$[]) oarray;
 865 #end[Object]
 866             return UNSAFE.compareAndExchange$Type$Release(array,
 867                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 868                     {#if[Object]?handle.componentType.cast(expected):expected},
 869                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 870         }
 871 
 872         @ForceInline
<span class="line-modified"> 873         static boolean weakCompareAndSetPlain(VarHandle ob, Object oarray, int index, $type$ expected, $type$ value) {</span>
<span class="line-added"> 874             Array handle = (Array)ob;</span>
 875 #if[Object]
 876             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 877 #else[Object]
 878             $type$[] array = ($type$[]) oarray;
 879 #end[Object]
 880             return UNSAFE.weakCompareAndSet$Type$Plain(array,
 881                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 882                     {#if[Object]?handle.componentType.cast(expected):expected},
 883                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 884         }
 885 
 886         @ForceInline
<span class="line-modified"> 887         static boolean weakCompareAndSet(VarHandle ob, Object oarray, int index, $type$ expected, $type$ value) {</span>
<span class="line-added"> 888             Array handle = (Array)ob;</span>
 889 #if[Object]
 890             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 891 #else[Object]
 892             $type$[] array = ($type$[]) oarray;
 893 #end[Object]
 894             return UNSAFE.weakCompareAndSet$Type$(array,
 895                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 896                     {#if[Object]?handle.componentType.cast(expected):expected},
 897                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 898         }
 899 
 900         @ForceInline
<span class="line-modified"> 901         static boolean weakCompareAndSetAcquire(VarHandle ob, Object oarray, int index, $type$ expected, $type$ value) {</span>
<span class="line-added"> 902             Array handle = (Array)ob;</span>
 903 #if[Object]
 904             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 905 #else[Object]
 906             $type$[] array = ($type$[]) oarray;
 907 #end[Object]
 908             return UNSAFE.weakCompareAndSet$Type$Acquire(array,
 909                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 910                     {#if[Object]?handle.componentType.cast(expected):expected},
 911                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 912         }
 913 
 914         @ForceInline
<span class="line-modified"> 915         static boolean weakCompareAndSetRelease(VarHandle ob, Object oarray, int index, $type$ expected, $type$ value) {</span>
<span class="line-added"> 916             Array handle = (Array)ob;</span>
 917 #if[Object]
 918             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 919 #else[Object]
 920             $type$[] array = ($type$[]) oarray;
 921 #end[Object]
 922             return UNSAFE.weakCompareAndSet$Type$Release(array,
 923                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 924                     {#if[Object]?handle.componentType.cast(expected):expected},
 925                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 926         }
 927 
 928         @ForceInline
<span class="line-modified"> 929         static $type$ getAndSet(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added"> 930             Array handle = (Array)ob;</span>
 931 #if[Object]
 932             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 933 #else[Object]
 934             $type$[] array = ($type$[]) oarray;
 935 #end[Object]
 936             return UNSAFE.getAndSet$Type$(array,
 937                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 938                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 939         }
 940 
 941         @ForceInline
<span class="line-modified"> 942         static $type$ getAndSetAcquire(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added"> 943             Array handle = (Array)ob;</span>
 944 #if[Object]
 945             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 946 #else[Object]
 947             $type$[] array = ($type$[]) oarray;
 948 #end[Object]
 949             return UNSAFE.getAndSet$Type$Acquire(array,
 950                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 951                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 952         }
 953 
 954         @ForceInline
<span class="line-modified"> 955         static $type$ getAndSetRelease(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added"> 956             Array handle = (Array)ob;</span>
 957 #if[Object]
 958             Object[] array = (Object[]) handle.arrayType.cast(oarray);
 959 #else[Object]
 960             $type$[] array = ($type$[]) oarray;
 961 #end[Object]
 962             return UNSAFE.getAndSet$Type$Release(array,
 963                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 964                     {#if[Object]?runtimeTypeCheck(handle, array, value):value});
 965         }
 966 #end[CAS]
 967 #if[AtomicAdd]
 968 
 969         @ForceInline
<span class="line-modified"> 970         static $type$ getAndAdd(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added"> 971             Array handle = (Array)ob;</span>
 972             $type$[] array = ($type$[]) oarray;
 973             return UNSAFE.getAndAdd$Type$(array,
 974                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 975                     value);
 976         }
 977 
 978         @ForceInline
<span class="line-modified"> 979         static $type$ getAndAddAcquire(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added"> 980             Array handle = (Array)ob;</span>
 981             $type$[] array = ($type$[]) oarray;
 982             return UNSAFE.getAndAdd$Type$Acquire(array,
 983                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 984                     value);
 985         }
 986 
 987         @ForceInline
<span class="line-modified"> 988         static $type$ getAndAddRelease(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added"> 989             Array handle = (Array)ob;</span>
 990             $type$[] array = ($type$[]) oarray;
 991             return UNSAFE.getAndAdd$Type$Release(array,
 992                     (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
 993                     value);
 994         }
 995 #end[AtomicAdd]
 996 #if[Bitwise]
 997 
 998         @ForceInline
<span class="line-modified"> 999         static $type$ getAndBitwiseOr(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added">1000             Array handle = (Array)ob;</span>
1001             $type$[] array = ($type$[]) oarray;
1002             return UNSAFE.getAndBitwiseOr$Type$(array,
1003                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
1004                                        value);
1005         }
1006 
1007         @ForceInline
<span class="line-modified">1008         static $type$ getAndBitwiseOrRelease(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added">1009             Array handle = (Array)ob;</span>
1010             $type$[] array = ($type$[]) oarray;
1011             return UNSAFE.getAndBitwiseOr$Type$Release(array,
1012                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
1013                                        value);
1014         }
1015 
1016         @ForceInline
<span class="line-modified">1017         static $type$ getAndBitwiseOrAcquire(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added">1018             Array handle = (Array)ob;</span>
1019             $type$[] array = ($type$[]) oarray;
1020             return UNSAFE.getAndBitwiseOr$Type$Acquire(array,
1021                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
1022                                        value);
1023         }
1024 
1025         @ForceInline
<span class="line-modified">1026         static $type$ getAndBitwiseAnd(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added">1027             Array handle = (Array)ob;</span>
1028             $type$[] array = ($type$[]) oarray;
1029             return UNSAFE.getAndBitwiseAnd$Type$(array,
1030                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
1031                                        value);
1032         }
1033 
1034         @ForceInline
<span class="line-modified">1035         static $type$ getAndBitwiseAndRelease(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added">1036             Array handle = (Array)ob;</span>
1037             $type$[] array = ($type$[]) oarray;
1038             return UNSAFE.getAndBitwiseAnd$Type$Release(array,
1039                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
1040                                        value);
1041         }
1042 
1043         @ForceInline
<span class="line-modified">1044         static $type$ getAndBitwiseAndAcquire(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added">1045             Array handle = (Array)ob;</span>
1046             $type$[] array = ($type$[]) oarray;
1047             return UNSAFE.getAndBitwiseAnd$Type$Acquire(array,
1048                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
1049                                        value);
1050         }
1051 
1052         @ForceInline
<span class="line-modified">1053         static $type$ getAndBitwiseXor(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added">1054             Array handle = (Array)ob;</span>
1055             $type$[] array = ($type$[]) oarray;
1056             return UNSAFE.getAndBitwiseXor$Type$(array,
1057                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
1058                                        value);
1059         }
1060 
1061         @ForceInline
<span class="line-modified">1062         static $type$ getAndBitwiseXorRelease(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added">1063             Array handle = (Array)ob;</span>
1064             $type$[] array = ($type$[]) oarray;
1065             return UNSAFE.getAndBitwiseXor$Type$Release(array,
1066                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
1067                                        value);
1068         }
1069 
1070         @ForceInline
<span class="line-modified">1071         static $type$ getAndBitwiseXorAcquire(VarHandle ob, Object oarray, int index, $type$ value) {</span>
<span class="line-added">1072             Array handle = (Array)ob;</span>
1073             $type$[] array = ($type$[]) oarray;
1074             return UNSAFE.getAndBitwiseXor$Type$Acquire(array,
1075                                        (((long) Preconditions.checkIndex(index, array.length, AIOOBE_SUPPLIER)) &lt;&lt; handle.ashift) + handle.abase,
1076                                        value);
1077         }
1078 #end[Bitwise]
1079 
1080         static final VarForm FORM = new VarForm(Array.class, {#if[Object]?Object[].class:$type$[].class}, {#if[Object]?Object.class:$type$.class}, int.class);
1081     }
1082 }
</pre>
</td>
</tr>
</table>
<center><a href="VarHandles.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../index.html" target="_top">index</a> <a href="X-VarHandleByteArrayView.java.template.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>
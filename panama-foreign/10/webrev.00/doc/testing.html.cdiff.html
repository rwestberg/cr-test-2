<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff doc/testing.html</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
<body>
<center><a href="building.md.cdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="testing.md.cdiff.html" target="_top">next &gt;</a></center>    <h2>doc/testing.html</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 3,11 ***</span>
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;generator&quot; content=&quot;pandoc&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, user-scalable=yes&quot; /&gt;
    &lt;title&gt;Testing the JDK&lt;/title&gt;
<span class="line-modified">!   &lt;style&gt;</span>
        code{white-space: pre-wrap;}
        span.smallcaps{font-variant: small-caps;}
        span.underline{text-decoration: underline;}
        div.column{display: inline-block; vertical-align: top; width: 50%;}
    &lt;/style&gt;
<span class="line-new-header">--- 3,11 ---</span>
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;generator&quot; content=&quot;pandoc&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, user-scalable=yes&quot; /&gt;
    &lt;title&gt;Testing the JDK&lt;/title&gt;
<span class="line-modified">!   &lt;style type=&quot;text/css&quot;&gt;</span>
        code{white-space: pre-wrap;}
        span.smallcaps{font-variant: small-caps;}
        span.underline{text-decoration: underline;}
        div.column{display: inline-block; vertical-align: top; width: 50%;}
    &lt;/style&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 19,13 ***</span>
  &lt;/head&gt;
  &lt;body&gt;
  &lt;header id=&quot;title-block-header&quot;&gt;
  &lt;h1 class=&quot;title&quot;&gt;Testing the JDK&lt;/h1&gt;
  &lt;/header&gt;
<span class="line-modified">! &lt;nav id=&quot;TOC&quot; role=&quot;doc-toc&quot;&gt;</span>
  &lt;ul&gt;
<span class="line-modified">! &lt;li&gt;&lt;a href=&quot;#using-make-test-the-run-test-framework&quot;&gt;Using &quot;make test&quot; (the run-test framework)&lt;/a&gt;&lt;ul&gt;</span>
  &lt;li&gt;&lt;a href=&quot;#configuration&quot;&gt;Configuration&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#test-selection&quot;&gt;Test selection&lt;/a&gt;&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#jtreg&quot;&gt;JTReg&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#gtest&quot;&gt;Gtest&lt;/a&gt;&lt;/li&gt;
<span class="line-new-header">--- 19,13 ---</span>
  &lt;/head&gt;
  &lt;body&gt;
  &lt;header id=&quot;title-block-header&quot;&gt;
  &lt;h1 class=&quot;title&quot;&gt;Testing the JDK&lt;/h1&gt;
  &lt;/header&gt;
<span class="line-modified">! &lt;nav id=&quot;TOC&quot;&gt;</span>
  &lt;ul&gt;
<span class="line-modified">! &lt;li&gt;&lt;a href=&quot;#using-make-test-the-run-test-framework&quot;&gt;Using &amp;quot;make test&amp;quot; (the run-test framework)&lt;/a&gt;&lt;ul&gt;</span>
  &lt;li&gt;&lt;a href=&quot;#configuration&quot;&gt;Configuration&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#test-selection&quot;&gt;Test selection&lt;/a&gt;&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#jtreg&quot;&gt;JTReg&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#gtest&quot;&gt;Gtest&lt;/a&gt;&lt;/li&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 45,11 ***</span>
  &lt;li&gt;&lt;a href=&quot;#pkcs11-tests&quot;&gt;PKCS11 Tests&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#client-ui-tests&quot;&gt;Client UI Tests&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;/nav&gt;
<span class="line-modified">! &lt;h2 id=&quot;using-make-test-the-run-test-framework&quot;&gt;Using &quot;make test&quot; (the run-test framework)&lt;/h2&gt;</span>
  &lt;p&gt;This new way of running tests is developer-centric. It assumes that you have built a JDK locally and want to test it. Running common test targets is simple, and more complex ad-hoc combination of tests is possible. The user interface is forgiving, and clearly report errors it cannot resolve.&lt;/p&gt;
  &lt;p&gt;The main target &lt;code&gt;test&lt;/code&gt; uses the jdk-image as the tested product. There is also an alternate target &lt;code&gt;exploded-test&lt;/code&gt; that uses the exploded image instead. Not all tests will run successfully on the exploded image, but using this target can greatly improve rebuild times for certain workflows.&lt;/p&gt;
  &lt;p&gt;Previously, &lt;code&gt;make test&lt;/code&gt; was used to invoke an old system for running tests, and &lt;code&gt;make run-test&lt;/code&gt; was used for the new test framework. For backward compatibility with scripts and muscle memory, &lt;code&gt;run-test&lt;/code&gt; (and variants like &lt;code&gt;exploded-run-test&lt;/code&gt; or &lt;code&gt;run-test-tier1&lt;/code&gt;) are kept as aliases.&lt;/p&gt;
  &lt;p&gt;Some example command-lines:&lt;/p&gt;
  &lt;pre&gt;&lt;code&gt;$ make test-tier1
<span class="line-new-header">--- 45,11 ---</span>
  &lt;li&gt;&lt;a href=&quot;#pkcs11-tests&quot;&gt;PKCS11 Tests&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#client-ui-tests&quot;&gt;Client UI Tests&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;/nav&gt;
<span class="line-modified">! &lt;h2 id=&quot;using-make-test-the-run-test-framework&quot;&gt;Using &amp;quot;make test&amp;quot; (the run-test framework)&lt;/h2&gt;</span>
  &lt;p&gt;This new way of running tests is developer-centric. It assumes that you have built a JDK locally and want to test it. Running common test targets is simple, and more complex ad-hoc combination of tests is possible. The user interface is forgiving, and clearly report errors it cannot resolve.&lt;/p&gt;
  &lt;p&gt;The main target &lt;code&gt;test&lt;/code&gt; uses the jdk-image as the tested product. There is also an alternate target &lt;code&gt;exploded-test&lt;/code&gt; that uses the exploded image instead. Not all tests will run successfully on the exploded image, but using this target can greatly improve rebuild times for certain workflows.&lt;/p&gt;
  &lt;p&gt;Previously, &lt;code&gt;make test&lt;/code&gt; was used to invoke an old system for running tests, and &lt;code&gt;make run-test&lt;/code&gt; was used for the new test framework. For backward compatibility with scripts and muscle memory, &lt;code&gt;run-test&lt;/code&gt; (and variants like &lt;code&gt;exploded-run-test&lt;/code&gt; or &lt;code&gt;run-test-tier1&lt;/code&gt;) are kept as aliases.&lt;/p&gt;
  &lt;p&gt;Some example command-lines:&lt;/p&gt;
  &lt;pre&gt;&lt;code&gt;$ make test-tier1
</pre>
<hr />
<pre>
<span class="line-old-header">*** 63,11 ***</span>
  &lt;h3 id=&quot;configuration&quot;&gt;Configuration&lt;/h3&gt;
  &lt;p&gt;To be able to run JTReg tests, &lt;code&gt;configure&lt;/code&gt; needs to know where to find the JTReg test framework. If it is not picked up automatically by configure, use the &lt;code&gt;--with-jtreg=&amp;lt;path to jtreg home&amp;gt;&lt;/code&gt; option to point to the JTReg framework. Note that this option should point to the JTReg home, i.e. the top directory, containing &lt;code&gt;lib/jtreg.jar&lt;/code&gt; etc. (An alternative is to set the &lt;code&gt;JT_HOME&lt;/code&gt; environment variable to point to the JTReg home before running &lt;code&gt;configure&lt;/code&gt;.)&lt;/p&gt;
  &lt;p&gt;To be able to run microbenchmarks, &lt;code&gt;configure&lt;/code&gt; needs to know where to find the JMH dependency. Use &lt;code&gt;--with-jmh=&amp;lt;path to JMH jars&amp;gt;&lt;/code&gt; to point to a directory containing the core JMH and transitive dependencies. The recommended dependencies can be retrieved by running &lt;code&gt;sh make/devkit/createJMHBundle.sh&lt;/code&gt;, after which &lt;code&gt;--with-jmh=build/jmh/jars&lt;/code&gt; should work.&lt;/p&gt;
  &lt;h2 id=&quot;test-selection&quot;&gt;Test selection&lt;/h2&gt;
  &lt;p&gt;All functionality is available using the &lt;code&gt;test&lt;/code&gt; make target. In this use case, the test or tests to be executed is controlled using the &lt;code&gt;TEST&lt;/code&gt; variable. To speed up subsequent test runs with no source code changes, &lt;code&gt;test-only&lt;/code&gt; can be used instead, which do not depend on the source and test image build.&lt;/p&gt;
<span class="line-modified">! &lt;p&gt;For some common top-level tests, direct make targets have been generated. This includes all JTReg test groups, the hotspot gtest, and custom tests (if present). This means that &lt;code&gt;make test-tier1&lt;/code&gt; is equivalent to &lt;code&gt;make test TEST=&quot;tier1&quot;&lt;/code&gt;, but the latter is more tab-completion friendly. For more complex test runs, the &lt;code&gt;test TEST=&quot;x&quot;&lt;/code&gt; solution needs to be used.&lt;/p&gt;</span>
  &lt;p&gt;The test specifications given in &lt;code&gt;TEST&lt;/code&gt; is parsed into fully qualified test descriptors, which clearly and unambigously show which tests will be run. As an example, &lt;code&gt;:tier1&lt;/code&gt; will expand to &lt;code&gt;jtreg:$(TOPDIR)/test/hotspot/jtreg:tier1 jtreg:$(TOPDIR)/test/jdk:tier1 jtreg:$(TOPDIR)/test/langtools:tier1 jtreg:$(TOPDIR)/test/nashorn:tier1 jtreg:$(TOPDIR)/test/jaxp:tier1&lt;/code&gt;. You can always submit a list of fully qualified test descriptors in the &lt;code&gt;TEST&lt;/code&gt; variable if you want to shortcut the parser.&lt;/p&gt;
  &lt;h3 id=&quot;jtreg&quot;&gt;JTReg&lt;/h3&gt;
  &lt;p&gt;JTReg tests can be selected either by picking a JTReg test group, or a selection of files or directories containing JTReg tests.&lt;/p&gt;
  &lt;p&gt;JTReg test groups can be specified either without a test root, e.g. &lt;code&gt;:tier1&lt;/code&gt; (or &lt;code&gt;tier1&lt;/code&gt;, the initial colon is optional), or with, e.g. &lt;code&gt;hotspot:tier1&lt;/code&gt;, &lt;code&gt;test/jdk:jdk_util&lt;/code&gt; or &lt;code&gt;$(TOPDIR)/test/hotspot/jtreg:hotspot_all&lt;/code&gt;. The test root can be specified either as an absolute path, or a path relative to the JDK top directory, or the &lt;code&gt;test&lt;/code&gt; directory. For simplicity, the hotspot JTReg test root, which really is &lt;code&gt;hotspot/jtreg&lt;/code&gt; can be abbreviated as just &lt;code&gt;hotspot&lt;/code&gt;.&lt;/p&gt;
  &lt;p&gt;When specified without a test root, all matching groups from all test roots will be added. Otherwise, only the group from the specified test root will be added.&lt;/p&gt;
<span class="line-new-header">--- 63,11 ---</span>
  &lt;h3 id=&quot;configuration&quot;&gt;Configuration&lt;/h3&gt;
  &lt;p&gt;To be able to run JTReg tests, &lt;code&gt;configure&lt;/code&gt; needs to know where to find the JTReg test framework. If it is not picked up automatically by configure, use the &lt;code&gt;--with-jtreg=&amp;lt;path to jtreg home&amp;gt;&lt;/code&gt; option to point to the JTReg framework. Note that this option should point to the JTReg home, i.e. the top directory, containing &lt;code&gt;lib/jtreg.jar&lt;/code&gt; etc. (An alternative is to set the &lt;code&gt;JT_HOME&lt;/code&gt; environment variable to point to the JTReg home before running &lt;code&gt;configure&lt;/code&gt;.)&lt;/p&gt;
  &lt;p&gt;To be able to run microbenchmarks, &lt;code&gt;configure&lt;/code&gt; needs to know where to find the JMH dependency. Use &lt;code&gt;--with-jmh=&amp;lt;path to JMH jars&amp;gt;&lt;/code&gt; to point to a directory containing the core JMH and transitive dependencies. The recommended dependencies can be retrieved by running &lt;code&gt;sh make/devkit/createJMHBundle.sh&lt;/code&gt;, after which &lt;code&gt;--with-jmh=build/jmh/jars&lt;/code&gt; should work.&lt;/p&gt;
  &lt;h2 id=&quot;test-selection&quot;&gt;Test selection&lt;/h2&gt;
  &lt;p&gt;All functionality is available using the &lt;code&gt;test&lt;/code&gt; make target. In this use case, the test or tests to be executed is controlled using the &lt;code&gt;TEST&lt;/code&gt; variable. To speed up subsequent test runs with no source code changes, &lt;code&gt;test-only&lt;/code&gt; can be used instead, which do not depend on the source and test image build.&lt;/p&gt;
<span class="line-modified">! &lt;p&gt;For some common top-level tests, direct make targets have been generated. This includes all JTReg test groups, the hotspot gtest, and custom tests (if present). This means that &lt;code&gt;make test-tier1&lt;/code&gt; is equivalent to &lt;code&gt;make test TEST=&amp;quot;tier1&amp;quot;&lt;/code&gt;, but the latter is more tab-completion friendly. For more complex test runs, the &lt;code&gt;test TEST=&amp;quot;x&amp;quot;&lt;/code&gt; solution needs to be used.&lt;/p&gt;</span>
  &lt;p&gt;The test specifications given in &lt;code&gt;TEST&lt;/code&gt; is parsed into fully qualified test descriptors, which clearly and unambigously show which tests will be run. As an example, &lt;code&gt;:tier1&lt;/code&gt; will expand to &lt;code&gt;jtreg:$(TOPDIR)/test/hotspot/jtreg:tier1 jtreg:$(TOPDIR)/test/jdk:tier1 jtreg:$(TOPDIR)/test/langtools:tier1 jtreg:$(TOPDIR)/test/nashorn:tier1 jtreg:$(TOPDIR)/test/jaxp:tier1&lt;/code&gt;. You can always submit a list of fully qualified test descriptors in the &lt;code&gt;TEST&lt;/code&gt; variable if you want to shortcut the parser.&lt;/p&gt;
  &lt;h3 id=&quot;jtreg&quot;&gt;JTReg&lt;/h3&gt;
  &lt;p&gt;JTReg tests can be selected either by picking a JTReg test group, or a selection of files or directories containing JTReg tests.&lt;/p&gt;
  &lt;p&gt;JTReg test groups can be specified either without a test root, e.g. &lt;code&gt;:tier1&lt;/code&gt; (or &lt;code&gt;tier1&lt;/code&gt;, the initial colon is optional), or with, e.g. &lt;code&gt;hotspot:tier1&lt;/code&gt;, &lt;code&gt;test/jdk:jdk_util&lt;/code&gt; or &lt;code&gt;$(TOPDIR)/test/hotspot/jtreg:hotspot_all&lt;/code&gt;. The test root can be specified either as an absolute path, or a path relative to the JDK top directory, or the &lt;code&gt;test&lt;/code&gt; directory. For simplicity, the hotspot JTReg test root, which really is &lt;code&gt;hotspot/jtreg&lt;/code&gt; can be abbreviated as just &lt;code&gt;hotspot&lt;/code&gt;.&lt;/p&gt;
  &lt;p&gt;When specified without a test root, all matching groups from all test roots will be added. Otherwise, only the group from the specified test root will be added.&lt;/p&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 103,12 ***</span>
  &lt;p&gt;In case of test failures, &lt;code&gt;make test&lt;/code&gt; will exit with a non-zero exit value.&lt;/p&gt;
  &lt;p&gt;All tests have their result stored in &lt;code&gt;build/$BUILD/test-results/$TEST_ID&lt;/code&gt;, where TEST_ID is a path-safe conversion from the fully qualified test descriptor, e.g. for &lt;code&gt;jtreg:jdk/test:tier1&lt;/code&gt; the TEST_ID is &lt;code&gt;jtreg_jdk_test_tier1&lt;/code&gt;. This path is also printed in the log at the end of the test run.&lt;/p&gt;
  &lt;p&gt;Additional work data is stored in &lt;code&gt;build/$BUILD/test-support/$TEST_ID&lt;/code&gt;. For some frameworks, this directory might contain information that is useful in determining the cause of a failed test.&lt;/p&gt;
  &lt;h2 id=&quot;test-suite-control&quot;&gt;Test suite control&lt;/h2&gt;
  &lt;p&gt;It is possible to control various aspects of the test suites using make control variables.&lt;/p&gt;
<span class="line-modified">! &lt;p&gt;These variables use a keyword=value approach to allow multiple values to be set. So, for instance, &lt;code&gt;JTREG=&quot;JOBS=1;TIMEOUT_FACTOR=8&quot;&lt;/code&gt; will set the JTReg concurrency level to 1 and the timeout factor to 8. This is equivalent to setting &lt;code&gt;JTREG_JOBS=1 JTREG_TIMEOUT_FACTOR=8&lt;/code&gt;, but using the keyword format means that the &lt;code&gt;JTREG&lt;/code&gt; variable is parsed and verified for correctness, so &lt;code&gt;JTREG=&quot;TMIEOUT_FACTOR=8&quot;&lt;/code&gt; would give an error, while &lt;code&gt;JTREG_TMIEOUT_FACTOR=8&lt;/code&gt; would just pass unnoticed.&lt;/p&gt;</span>
<span class="line-modified">! &lt;p&gt;To separate multiple keyword=value pairs, use &lt;code&gt;;&lt;/code&gt; (semicolon). Since the shell normally eats &lt;code&gt;;&lt;/code&gt;, the recommended usage is to write the assignment inside qoutes, e.g. &lt;code&gt;JTREG=&quot;...;...&quot;&lt;/code&gt;. This will also make sure spaces are preserved, as in &lt;code&gt;JTREG=&quot;VM_OPTIONS=-XshowSettings -Xlog:gc+ref=debug&quot;&lt;/code&gt;.&lt;/p&gt;</span>
  &lt;p&gt;(Other ways are possible, e.g. using backslash: &lt;code&gt;JTREG=JOBS=1\;TIMEOUT_FACTOR=8&lt;/code&gt;. Also, as a special technique, the string &lt;code&gt;%20&lt;/code&gt; will be replaced with space for certain options, e.g. &lt;code&gt;JTREG=VM_OPTIONS=-XshowSettings%20-Xlog:gc+ref=debug&lt;/code&gt;. This can be useful if you have layers of scripts and have trouble getting proper quoting of command line arguments through.)&lt;/p&gt;
  &lt;p&gt;As far as possible, the names of the keywords have been standardized between test suites.&lt;/p&gt;
  &lt;h3 id=&quot;general-keywords-test_opts&quot;&gt;General keywords (TEST_OPTS)&lt;/h3&gt;
  &lt;p&gt;Some keywords are valid across different test suites. If you want to run tests from multiple test suites, or just don&#39;t want to care which test suite specific control variable to use, then you can use the general TEST_OPTS control variable.&lt;/p&gt;
  &lt;p&gt;There are also some keywords that applies globally to the test runner system, not to any specific test suites. These are also available as TEST_OPTS keywords.&lt;/p&gt;
<span class="line-new-header">--- 103,12 ---</span>
  &lt;p&gt;In case of test failures, &lt;code&gt;make test&lt;/code&gt; will exit with a non-zero exit value.&lt;/p&gt;
  &lt;p&gt;All tests have their result stored in &lt;code&gt;build/$BUILD/test-results/$TEST_ID&lt;/code&gt;, where TEST_ID is a path-safe conversion from the fully qualified test descriptor, e.g. for &lt;code&gt;jtreg:jdk/test:tier1&lt;/code&gt; the TEST_ID is &lt;code&gt;jtreg_jdk_test_tier1&lt;/code&gt;. This path is also printed in the log at the end of the test run.&lt;/p&gt;
  &lt;p&gt;Additional work data is stored in &lt;code&gt;build/$BUILD/test-support/$TEST_ID&lt;/code&gt;. For some frameworks, this directory might contain information that is useful in determining the cause of a failed test.&lt;/p&gt;
  &lt;h2 id=&quot;test-suite-control&quot;&gt;Test suite control&lt;/h2&gt;
  &lt;p&gt;It is possible to control various aspects of the test suites using make control variables.&lt;/p&gt;
<span class="line-modified">! &lt;p&gt;These variables use a keyword=value approach to allow multiple values to be set. So, for instance, &lt;code&gt;JTREG=&amp;quot;JOBS=1;TIMEOUT_FACTOR=8&amp;quot;&lt;/code&gt; will set the JTReg concurrency level to 1 and the timeout factor to 8. This is equivalent to setting &lt;code&gt;JTREG_JOBS=1 JTREG_TIMEOUT_FACTOR=8&lt;/code&gt;, but using the keyword format means that the &lt;code&gt;JTREG&lt;/code&gt; variable is parsed and verified for correctness, so &lt;code&gt;JTREG=&amp;quot;TMIEOUT_FACTOR=8&amp;quot;&lt;/code&gt; would give an error, while &lt;code&gt;JTREG_TMIEOUT_FACTOR=8&lt;/code&gt; would just pass unnoticed.&lt;/p&gt;</span>
<span class="line-modified">! &lt;p&gt;To separate multiple keyword=value pairs, use &lt;code&gt;;&lt;/code&gt; (semicolon). Since the shell normally eats &lt;code&gt;;&lt;/code&gt;, the recommended usage is to write the assignment inside qoutes, e.g. &lt;code&gt;JTREG=&amp;quot;...;...&amp;quot;&lt;/code&gt;. This will also make sure spaces are preserved, as in &lt;code&gt;JTREG=&amp;quot;VM_OPTIONS=-XshowSettings -Xlog:gc+ref=debug&amp;quot;&lt;/code&gt;.&lt;/p&gt;</span>
  &lt;p&gt;(Other ways are possible, e.g. using backslash: &lt;code&gt;JTREG=JOBS=1\;TIMEOUT_FACTOR=8&lt;/code&gt;. Also, as a special technique, the string &lt;code&gt;%20&lt;/code&gt; will be replaced with space for certain options, e.g. &lt;code&gt;JTREG=VM_OPTIONS=-XshowSettings%20-Xlog:gc+ref=debug&lt;/code&gt;. This can be useful if you have layers of scripts and have trouble getting proper quoting of command line arguments through.)&lt;/p&gt;
  &lt;p&gt;As far as possible, the names of the keywords have been standardized between test suites.&lt;/p&gt;
  &lt;h3 id=&quot;general-keywords-test_opts&quot;&gt;General keywords (TEST_OPTS)&lt;/h3&gt;
  &lt;p&gt;Some keywords are valid across different test suites. If you want to run tests from multiple test suites, or just don&#39;t want to care which test suite specific control variable to use, then you can use the general TEST_OPTS control variable.&lt;/p&gt;
  &lt;p&gt;There are also some keywords that applies globally to the test runner system, not to any specific test suites. These are also available as TEST_OPTS keywords.&lt;/p&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 133,12 ***</span>
  &lt;p&gt;Defaults to TEST_JOBS (if set by &lt;code&gt;--with-test-jobs=&lt;/code&gt;), otherwise it defaults to JOBS, except for Hotspot, where the default is &lt;em&gt;number of CPU cores/2&lt;/em&gt; (for sparc, if more than 16 cpus, then &lt;em&gt;number of CPU cores/5&lt;/em&gt;, otherwise &lt;em&gt;number of CPU cores/4&lt;/em&gt;), but never more than &lt;em&gt;memory size in GB/2&lt;/em&gt;.&lt;/p&gt;
  &lt;h4 id=&quot;timeout_factor-1&quot;&gt;TIMEOUT_FACTOR&lt;/h4&gt;
  &lt;p&gt;The timeout factor (&lt;code&gt;-timeoutFactor&lt;/code&gt;).&lt;/p&gt;
  &lt;p&gt;Defaults to 4.&lt;/p&gt;
  &lt;h4 id=&quot;test_mode&quot;&gt;TEST_MODE&lt;/h4&gt;
<span class="line-modified">! &lt;p&gt;The test mode (&lt;code&gt;-agentvm&lt;/code&gt;, &lt;code&gt;-samevm&lt;/code&gt; or &lt;code&gt;-othervm&lt;/code&gt;).&lt;/p&gt;</span>
<span class="line-modified">! &lt;p&gt;Defaults to &lt;code&gt;-agentvm&lt;/code&gt;.&lt;/p&gt;</span>
  &lt;h4 id=&quot;assert&quot;&gt;ASSERT&lt;/h4&gt;
  &lt;p&gt;Enable asserts (&lt;code&gt;-ea -esa&lt;/code&gt;, or none).&lt;/p&gt;
  &lt;p&gt;Set to &lt;code&gt;true&lt;/code&gt; or &lt;code&gt;false&lt;/code&gt;. If true, adds &lt;code&gt;-ea -esa&lt;/code&gt;. Defaults to true, except for hotspot.&lt;/p&gt;
  &lt;h4 id=&quot;verbose&quot;&gt;VERBOSE&lt;/h4&gt;
  &lt;p&gt;The verbosity level (&lt;code&gt;-verbose&lt;/code&gt;).&lt;/p&gt;
<span class="line-new-header">--- 133,12 ---</span>
  &lt;p&gt;Defaults to TEST_JOBS (if set by &lt;code&gt;--with-test-jobs=&lt;/code&gt;), otherwise it defaults to JOBS, except for Hotspot, where the default is &lt;em&gt;number of CPU cores/2&lt;/em&gt; (for sparc, if more than 16 cpus, then &lt;em&gt;number of CPU cores/5&lt;/em&gt;, otherwise &lt;em&gt;number of CPU cores/4&lt;/em&gt;), but never more than &lt;em&gt;memory size in GB/2&lt;/em&gt;.&lt;/p&gt;
  &lt;h4 id=&quot;timeout_factor-1&quot;&gt;TIMEOUT_FACTOR&lt;/h4&gt;
  &lt;p&gt;The timeout factor (&lt;code&gt;-timeoutFactor&lt;/code&gt;).&lt;/p&gt;
  &lt;p&gt;Defaults to 4.&lt;/p&gt;
  &lt;h4 id=&quot;test_mode&quot;&gt;TEST_MODE&lt;/h4&gt;
<span class="line-modified">! &lt;p&gt;The test mode (&lt;code&gt;agentvm&lt;/code&gt; or &lt;code&gt;othervm&lt;/code&gt;).&lt;/p&gt;</span>
<span class="line-modified">! &lt;p&gt;Defaults to &lt;code&gt;agentvm&lt;/code&gt;.&lt;/p&gt;</span>
  &lt;h4 id=&quot;assert&quot;&gt;ASSERT&lt;/h4&gt;
  &lt;p&gt;Enable asserts (&lt;code&gt;-ea -esa&lt;/code&gt;, or none).&lt;/p&gt;
  &lt;p&gt;Set to &lt;code&gt;true&lt;/code&gt; or &lt;code&gt;false&lt;/code&gt;. If true, adds &lt;code&gt;-ea -esa&lt;/code&gt;. Defaults to true, except for hotspot.&lt;/p&gt;
  &lt;h4 id=&quot;verbose&quot;&gt;VERBOSE&lt;/h4&gt;
  &lt;p&gt;The verbosity level (&lt;code&gt;-verbose&lt;/code&gt;).&lt;/p&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 159,11 ***</span>
  &lt;h4 id=&quot;run_problem_lists&quot;&gt;RUN_PROBLEM_LISTS&lt;/h4&gt;
  &lt;p&gt;Use the problem lists to select tests instead of excluding them.&lt;/p&gt;
  &lt;p&gt;Set to &lt;code&gt;true&lt;/code&gt; or &lt;code&gt;false&lt;/code&gt;. If &lt;code&gt;true&lt;/code&gt;, JTReg will use &lt;code&gt;-match:&lt;/code&gt; option, otherwise &lt;code&gt;-exclude:&lt;/code&gt; will be used. Default is &lt;code&gt;false&lt;/code&gt;.&lt;/p&gt;
  &lt;h4 id=&quot;options&quot;&gt;OPTIONS&lt;/h4&gt;
  &lt;p&gt;Additional options to the JTReg test framework.&lt;/p&gt;
<span class="line-modified">! &lt;p&gt;Use &lt;code&gt;JTREG=&quot;OPTIONS=--help all&quot;&lt;/code&gt; to see all available JTReg options.&lt;/p&gt;</span>
  &lt;h4 id=&quot;java_options-1&quot;&gt;JAVA_OPTIONS&lt;/h4&gt;
  &lt;p&gt;Additional Java options to JTReg (&lt;code&gt;-javaoption&lt;/code&gt;).&lt;/p&gt;
  &lt;h4 id=&quot;vm_options-1&quot;&gt;VM_OPTIONS&lt;/h4&gt;
  &lt;p&gt;Additional VM options to JTReg (&lt;code&gt;-vmoption&lt;/code&gt;).&lt;/p&gt;
  &lt;h4 id=&quot;aot_modules-1&quot;&gt;AOT_MODULES&lt;/h4&gt;
<span class="line-new-header">--- 159,11 ---</span>
  &lt;h4 id=&quot;run_problem_lists&quot;&gt;RUN_PROBLEM_LISTS&lt;/h4&gt;
  &lt;p&gt;Use the problem lists to select tests instead of excluding them.&lt;/p&gt;
  &lt;p&gt;Set to &lt;code&gt;true&lt;/code&gt; or &lt;code&gt;false&lt;/code&gt;. If &lt;code&gt;true&lt;/code&gt;, JTReg will use &lt;code&gt;-match:&lt;/code&gt; option, otherwise &lt;code&gt;-exclude:&lt;/code&gt; will be used. Default is &lt;code&gt;false&lt;/code&gt;.&lt;/p&gt;
  &lt;h4 id=&quot;options&quot;&gt;OPTIONS&lt;/h4&gt;
  &lt;p&gt;Additional options to the JTReg test framework.&lt;/p&gt;
<span class="line-modified">! &lt;p&gt;Use &lt;code&gt;JTREG=&amp;quot;OPTIONS=--help all&amp;quot;&lt;/code&gt; to see all available JTReg options.&lt;/p&gt;</span>
  &lt;h4 id=&quot;java_options-1&quot;&gt;JAVA_OPTIONS&lt;/h4&gt;
  &lt;p&gt;Additional Java options to JTReg (&lt;code&gt;-javaoption&lt;/code&gt;).&lt;/p&gt;
  &lt;h4 id=&quot;vm_options-1&quot;&gt;VM_OPTIONS&lt;/h4&gt;
  &lt;p&gt;Additional VM options to JTReg (&lt;code&gt;-vmoption&lt;/code&gt;).&lt;/p&gt;
  &lt;h4 id=&quot;aot_modules-1&quot;&gt;AOT_MODULES&lt;/h4&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 174,11 ***</span>
  &lt;h4 id=&quot;repeat&quot;&gt;REPEAT&lt;/h4&gt;
  &lt;p&gt;The number of times to repeat the tests (&lt;code&gt;--gtest_repeat&lt;/code&gt;).&lt;/p&gt;
  &lt;p&gt;Default is 1. Set to -1 to repeat indefinitely. This can be especially useful combined with &lt;code&gt;OPTIONS=--gtest_break_on_failure&lt;/code&gt; to reproduce an intermittent problem.&lt;/p&gt;
  &lt;h4 id=&quot;options-1&quot;&gt;OPTIONS&lt;/h4&gt;
  &lt;p&gt;Additional options to the Gtest test framework.&lt;/p&gt;
<span class="line-modified">! &lt;p&gt;Use &lt;code&gt;GTEST=&quot;OPTIONS=--help&quot;&lt;/code&gt; to see all available Gtest options.&lt;/p&gt;</span>
  &lt;h4 id=&quot;aot_modules-2&quot;&gt;AOT_MODULES&lt;/h4&gt;
  &lt;p&gt;Generate AOT modules before testing for the specified module, or set of modules. If multiple modules are specified, they should be separated by space (or, to help avoid quoting issues, the special value &lt;code&gt;%20&lt;/code&gt;).&lt;/p&gt;
  &lt;h3 id=&quot;microbenchmark-keywords&quot;&gt;Microbenchmark keywords&lt;/h3&gt;
  &lt;h4 id=&quot;fork&quot;&gt;FORK&lt;/h4&gt;
  &lt;p&gt;Override the number of benchmark forks to spawn. Same as specifying &lt;code&gt;-f &amp;lt;num&amp;gt;&lt;/code&gt;.&lt;/p&gt;
<span class="line-new-header">--- 174,11 ---</span>
  &lt;h4 id=&quot;repeat&quot;&gt;REPEAT&lt;/h4&gt;
  &lt;p&gt;The number of times to repeat the tests (&lt;code&gt;--gtest_repeat&lt;/code&gt;).&lt;/p&gt;
  &lt;p&gt;Default is 1. Set to -1 to repeat indefinitely. This can be especially useful combined with &lt;code&gt;OPTIONS=--gtest_break_on_failure&lt;/code&gt; to reproduce an intermittent problem.&lt;/p&gt;
  &lt;h4 id=&quot;options-1&quot;&gt;OPTIONS&lt;/h4&gt;
  &lt;p&gt;Additional options to the Gtest test framework.&lt;/p&gt;
<span class="line-modified">! &lt;p&gt;Use &lt;code&gt;GTEST=&amp;quot;OPTIONS=--help&amp;quot;&lt;/code&gt; to see all available Gtest options.&lt;/p&gt;</span>
  &lt;h4 id=&quot;aot_modules-2&quot;&gt;AOT_MODULES&lt;/h4&gt;
  &lt;p&gt;Generate AOT modules before testing for the specified module, or set of modules. If multiple modules are specified, they should be separated by space (or, to help avoid quoting issues, the special value &lt;code&gt;%20&lt;/code&gt;).&lt;/p&gt;
  &lt;h3 id=&quot;microbenchmark-keywords&quot;&gt;Microbenchmark keywords&lt;/h3&gt;
  &lt;h4 id=&quot;fork&quot;&gt;FORK&lt;/h4&gt;
  &lt;p&gt;Override the number of benchmark forks to spawn. Same as specifying &lt;code&gt;-f &amp;lt;num&amp;gt;&lt;/code&gt;.&lt;/p&gt;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 201,24 ***</span>
  &lt;p&gt;Docker tests with default parameters may fail on systems with glibc versions not compatible with the one used in the default docker image (e.g., Oracle Linux 7.6 for x86). For example, they pass on Ubuntu 16.04 but fail on Ubuntu 18.04 if run like this on x86:&lt;/p&gt;
  &lt;pre&gt;&lt;code&gt;$ make test TEST=&amp;quot;jtreg:test/hotspot/jtreg/containers/docker&amp;quot;&lt;/code&gt;&lt;/pre&gt;
  &lt;p&gt;To run these tests correctly, additional parameters for the correct docker image are required on Ubuntu 18.04 by using &lt;code&gt;JAVA_OPTIONS&lt;/code&gt;.&lt;/p&gt;
  &lt;pre&gt;&lt;code&gt;$ make test TEST=&amp;quot;jtreg:test/hotspot/jtreg/containers/docker&amp;quot; JTREG=&amp;quot;JAVA_OPTIONS=-Djdk.test.docker.image.name=ubuntu -Djdk.test.docker.image.version=latest&amp;quot;&lt;/code&gt;&lt;/pre&gt;
  &lt;h3 id=&quot;non-us-locale&quot;&gt;Non-US locale&lt;/h3&gt;
<span class="line-modified">! &lt;p&gt;If your locale is non-US, some tests are likely to fail. To work around this you can set the locale to US. On Unix platforms simply setting &lt;code&gt;LANG=&quot;en_US&quot;&lt;/code&gt; in the environment before running tests should work. On Windows, setting &lt;code&gt;JTREG=&quot;VM_OPTIONS=-Duser.language=en -Duser.country=US&quot;&lt;/code&gt; helps for most, but not all test cases. For example:&lt;/p&gt;</span>
  &lt;pre&gt;&lt;code&gt;$ export LANG=&amp;quot;en_US&amp;quot; &amp;amp;&amp;amp; make test TEST=...
  $ make test JTREG=&amp;quot;VM_OPTIONS=-Duser.language=en -Duser.country=US&amp;quot; TEST=...&lt;/code&gt;&lt;/pre&gt;
  &lt;h3 id=&quot;pkcs11-tests&quot;&gt;PKCS11 Tests&lt;/h3&gt;
  &lt;p&gt;It is highly recommended to use the latest NSS version when running PKCS11 tests. Improper NSS version may lead to unexpected failures which are hard to diagnose. For example, sun/security/pkcs11/Secmod/AddTrustedCert.java may fail on Ubuntu 18.04 with the default NSS version in the system. To run these tests correctly, the system property &lt;code&gt;test.nss.lib.paths&lt;/code&gt; is required on Ubuntu 18.04 to specify the alternative NSS lib directories. For example:&lt;/p&gt;
  &lt;pre&gt;&lt;code&gt;$ make test TEST=&amp;quot;jtreg:sun/security/pkcs11/Secmod/AddTrustedCert.java&amp;quot; JTREG=&amp;quot;JAVA_OPTIONS=-Dtest.nss.lib.paths=/path/to/your/latest/NSS-libs&amp;quot;&lt;/code&gt;&lt;/pre&gt;
  &lt;p&gt;For more notes about the PKCS11 tests, please refer to test/jdk/sun/security/pkcs11/README.&lt;/p&gt;
  &lt;h3 id=&quot;client-ui-tests&quot;&gt;Client UI Tests&lt;/h3&gt;
  &lt;p&gt;Some Client UI tests use key sequences which may be reserved by the operating system. Usually that causes the test failure. So it is highly recommended to disable system key shortcuts prior testing. The steps to access and disable system key shortcuts for various platforms are provided below.&lt;/p&gt;
  &lt;h4 id=&quot;macos&quot;&gt;MacOS&lt;/h4&gt;
  &lt;p&gt;Choose Apple menu; System Preferences, click Keyboard, then click Shortcuts; select or deselect desired shortcut.&lt;/p&gt;
<span class="line-modified">! &lt;p&gt;For example, test/jdk/javax/swing/TooltipManager/JMenuItemToolTipKeyBindingsTest/JMenuItemToolTipKeyBindingsTest.java fails on MacOS because it uses &lt;code&gt;CTRL + F1&lt;/code&gt; key sequence to show or hide tooltip message but the key combination is reserved by the operating system. To run the test correctly the default global key shortcut should be disabled using the steps described above, and then deselect &quot;Turn keyboard access on or off&quot; option which is responsible for &lt;code&gt;CTRL + F1&lt;/code&gt; combination.&lt;/p&gt;</span>
  &lt;h4 id=&quot;linux&quot;&gt;Linux&lt;/h4&gt;
  &lt;p&gt;Open the Activities overview and start typing Settings; Choose Settings, click Devices, then click Keyboard; set or override desired shortcut.&lt;/p&gt;
  &lt;h4 id=&quot;windows&quot;&gt;Windows&lt;/h4&gt;
<span class="line-modified">! &lt;p&gt;Type &lt;code&gt;gpedit&lt;/code&gt; in the Search and then click Edit group policy; navigate to User Configuration -&amp;gt; Administrative Templates -&amp;gt; Windows Components -&amp;gt; File Explorer; in the right-side pane look for &quot;Turn off Windows key hotkeys&quot; and double click on it; enable or disable hotkeys.&lt;/p&gt;</span>
  &lt;p&gt;Note: restart is required to make the settings take effect.&lt;/p&gt;
  &lt;/body&gt;
  &lt;/html&gt;
<span class="line-new-header">--- 201,24 ---</span>
  &lt;p&gt;Docker tests with default parameters may fail on systems with glibc versions not compatible with the one used in the default docker image (e.g., Oracle Linux 7.6 for x86). For example, they pass on Ubuntu 16.04 but fail on Ubuntu 18.04 if run like this on x86:&lt;/p&gt;
  &lt;pre&gt;&lt;code&gt;$ make test TEST=&amp;quot;jtreg:test/hotspot/jtreg/containers/docker&amp;quot;&lt;/code&gt;&lt;/pre&gt;
  &lt;p&gt;To run these tests correctly, additional parameters for the correct docker image are required on Ubuntu 18.04 by using &lt;code&gt;JAVA_OPTIONS&lt;/code&gt;.&lt;/p&gt;
  &lt;pre&gt;&lt;code&gt;$ make test TEST=&amp;quot;jtreg:test/hotspot/jtreg/containers/docker&amp;quot; JTREG=&amp;quot;JAVA_OPTIONS=-Djdk.test.docker.image.name=ubuntu -Djdk.test.docker.image.version=latest&amp;quot;&lt;/code&gt;&lt;/pre&gt;
  &lt;h3 id=&quot;non-us-locale&quot;&gt;Non-US locale&lt;/h3&gt;
<span class="line-modified">! &lt;p&gt;If your locale is non-US, some tests are likely to fail. To work around this you can set the locale to US. On Unix platforms simply setting &lt;code&gt;LANG=&amp;quot;en_US&amp;quot;&lt;/code&gt; in the environment before running tests should work. On Windows, setting &lt;code&gt;JTREG=&amp;quot;VM_OPTIONS=-Duser.language=en -Duser.country=US&amp;quot;&lt;/code&gt; helps for most, but not all test cases. For example:&lt;/p&gt;</span>
  &lt;pre&gt;&lt;code&gt;$ export LANG=&amp;quot;en_US&amp;quot; &amp;amp;&amp;amp; make test TEST=...
  $ make test JTREG=&amp;quot;VM_OPTIONS=-Duser.language=en -Duser.country=US&amp;quot; TEST=...&lt;/code&gt;&lt;/pre&gt;
  &lt;h3 id=&quot;pkcs11-tests&quot;&gt;PKCS11 Tests&lt;/h3&gt;
  &lt;p&gt;It is highly recommended to use the latest NSS version when running PKCS11 tests. Improper NSS version may lead to unexpected failures which are hard to diagnose. For example, sun/security/pkcs11/Secmod/AddTrustedCert.java may fail on Ubuntu 18.04 with the default NSS version in the system. To run these tests correctly, the system property &lt;code&gt;test.nss.lib.paths&lt;/code&gt; is required on Ubuntu 18.04 to specify the alternative NSS lib directories. For example:&lt;/p&gt;
  &lt;pre&gt;&lt;code&gt;$ make test TEST=&amp;quot;jtreg:sun/security/pkcs11/Secmod/AddTrustedCert.java&amp;quot; JTREG=&amp;quot;JAVA_OPTIONS=-Dtest.nss.lib.paths=/path/to/your/latest/NSS-libs&amp;quot;&lt;/code&gt;&lt;/pre&gt;
  &lt;p&gt;For more notes about the PKCS11 tests, please refer to test/jdk/sun/security/pkcs11/README.&lt;/p&gt;
  &lt;h3 id=&quot;client-ui-tests&quot;&gt;Client UI Tests&lt;/h3&gt;
  &lt;p&gt;Some Client UI tests use key sequences which may be reserved by the operating system. Usually that causes the test failure. So it is highly recommended to disable system key shortcuts prior testing. The steps to access and disable system key shortcuts for various platforms are provided below.&lt;/p&gt;
  &lt;h4 id=&quot;macos&quot;&gt;MacOS&lt;/h4&gt;
  &lt;p&gt;Choose Apple menu; System Preferences, click Keyboard, then click Shortcuts; select or deselect desired shortcut.&lt;/p&gt;
<span class="line-modified">! &lt;p&gt;For example, test/jdk/javax/swing/TooltipManager/JMenuItemToolTipKeyBindingsTest/JMenuItemToolTipKeyBindingsTest.java fails on MacOS because it uses &lt;code&gt;CTRL + F1&lt;/code&gt; key sequence to show or hide tooltip message but the key combination is reserved by the operating system. To run the test correctly the default global key shortcut should be disabled using the steps described above, and then deselect &amp;quot;Turn keyboard access on or off&amp;quot; option which is responsible for &lt;code&gt;CTRL + F1&lt;/code&gt; combination.&lt;/p&gt;</span>
  &lt;h4 id=&quot;linux&quot;&gt;Linux&lt;/h4&gt;
  &lt;p&gt;Open the Activities overview and start typing Settings; Choose Settings, click Devices, then click Keyboard; set or override desired shortcut.&lt;/p&gt;
  &lt;h4 id=&quot;windows&quot;&gt;Windows&lt;/h4&gt;
<span class="line-modified">! &lt;p&gt;Type &lt;code&gt;gpedit&lt;/code&gt; in the Search and then click Edit group policy; navigate to User Configuration -&amp;gt; Administrative Templates -&amp;gt; Windows Components -&amp;gt; File Explorer; in the right-side pane look for &amp;quot;Turn off Windows key hotkeys&amp;quot; and double click on it; enable or disable hotkeys.&lt;/p&gt;</span>
  &lt;p&gt;Note: restart is required to make the settings take effect.&lt;/p&gt;
  &lt;/body&gt;
  &lt;/html&gt;
</pre>
<center><a href="building.md.cdiff.html" target="_top">&lt; prev</a> <a href="../index.html" target="_top">index</a> <a href="testing.md.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>